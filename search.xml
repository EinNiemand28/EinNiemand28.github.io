<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>数据结构</title>
      <link href="/79666db.html"/>
      <url>/79666db.html</url>
      
        <content type="html"><![CDATA[<h2 id="绪论">绪论</h2><h3 id="算法">算法</h3><ul><li>计算 = 信息处理 = 借助某种工具，遵照一定规则，以明确而机械的形式进行</li><li>计算模型 = 计算机 = 信息处理工具</li></ul><blockquote><p>算法，是指基于特定的计算模型，旨在解决某一信息处理问题的指令序列。</p></blockquote><ul><li>有穷性：任意算法都应在执行有限次基本操作之后终止并给出输出</li><li>正确性：所给的输出应能符合由问题本身在事先确定的条件</li><li>健壮性：能处理各种极端的输入实例</li><li>可计算性</li><li>效率</li></ul><h4 id="起泡排序">起泡排序</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">bubblesort1A</span><span class="params">(<span class="type">int</span> A[], <span class="type">int</span> n)</span> </span>&#123; <span class="comment">// 0 &lt;= n</span></span><br><span class="line">    <span class="type">bool</span> sorted = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!sorted) &#123;</span><br><span class="line">        sorted = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[i - <span class="number">1</span>] &gt; A[i]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(A[i - <span class="number">1</span>], A[i]);</span><br><span class="line">                sorted = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        n--; <span class="comment">// 至此末位元素必然就位</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="复杂度度量">复杂度度量</h3><blockquote><p>问题实例的规模，往往是决定计算成本的最主要因素。通常，规模接近，计算成本也接近；规模扩大，计算成本亦上升。</p></blockquote><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_A(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> = 算法 A 求解某一规模为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的实例所需的计算成本，简化为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>T</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mrow><mo fence="true">∣</mo><mi>P</mi><mo fence="true">∣</mo></mrow><mo>=</mo><mi>n</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T(n) = \max\{T(P) | \left\vert P \right\vert = n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">}</span></span></span></span></li></ul></li></ul><h4 id="计算模型">计算模型</h4><h5 id="图灵机">图灵机</h5><ul><li><p>部件</p><ul><li><code>Tape</code>：依次均匀地划分为单元格，各存有某一字符，初始均为“#”<ul><li>字符的种类有限</li></ul></li><li><code>Head</code><ul><li>总是对准某一单元格，并可读取或改写其中的字符</li><li>每经过一个节拍，可转向左侧或右侧的邻格</li></ul></li><li><code>State</code><ul><li>TM 总是处于有限种状态中的某一种</li><li>每经过一个节拍可按照规则转向另一种状态</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mtext>halt</mtext></mrow><annotation encoding="application/x-tex">h = \text{halt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">halt</span></span></span></span></span></li></ul></li></ul></li><li><p><code>Transition Function</code>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>q</mi><mo separator="true">,</mo><mi>c</mi><mo separator="true">;</mo><mi>d</mi><mo separator="true">,</mo><mi>L</mi><mi mathvariant="normal">/</mi><mi>R</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(q,c;d,L/R,p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></p><ul><li>若当前状态为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> ，且当前字符为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> ，则<ul><li>将当前字符改写为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span></li><li>转向左/右侧邻格</li><li>转入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 状态</li></ul></li></ul></li><li><p>从启动至停机，所经历的节拍数目即可用以度量计算的成本</p></li><li><p>实例</p><ul><li><p>将二进制非负整数加一</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(&lt;, <span class="number">1</span>; <span class="number">0</span>, L, &lt;) <span class="comment">// 左行, 1-&gt; 0</span></span><br><span class="line">(&lt;, <span class="number">0</span>; <span class="number">1</span>, R, &gt;) <span class="comment">// 调头, 0-&gt; 1</span></span><br><span class="line">(&lt;, #; <span class="number">1</span>, R, &gt;) <span class="comment">// 调头, #-&gt; 1</span></span><br><span class="line">(&gt;, <span class="number">0</span>; <span class="number">0</span>, R, &gt;) <span class="comment">// 右行</span></span><br><span class="line">(&gt;, #; #, L, h/&lt;) <span class="comment">// 停止/进行下一轮运行</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h5 id="ram">RAM</h5><ul><li>组成<ul><li>寄存器顺序编号，总数没有限制</li><li>可通过编号直接访问任意寄存器（<code>call-by-rank</code>）</li><li>每一基本操作只需常数时间</li></ul></li><li>在这些模型中<ul><li>算法的运行时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∝</mo></mrow><annotation encoding="application/x-tex">\propto</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mrel">∝</span></span></span></span> 算法需要执行的基本操作次数</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> = 算法为求解规模为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的问题，所需执行的基本操作次数</li></ul></li></ul><h4 id="渐近复杂度">渐近复杂度</h4><p>问题规模足够大之后，计算成本的增长趋势</p><h5 id="big-o-notation">big-O notation</h5><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi mathvariant="normal">∃</mi><mi>c</mi><mo>&gt;</mo><mn>0</mn><mspace width="1em"/><mtext>s.t.</mtext><mspace width="1em"/><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>c</mi><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">T(n) = O(f(n)) \iff \exist c &gt; 0 \quad \text{s.t.} \quad T(n) &lt; c \cdot f(n) \quad \forall n \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">∃</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></p></blockquote><p>由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span> 记号提供的渐近上界不一定是紧确的。使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">o</span></span></span></span> 记号表示一个非渐近紧确的上界。</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>o</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi mathvariant="normal">∀</mi><mi>c</mi><mo>&gt;</mo><mn>0</mn><mspace width="1em"/><mtext>s.t.</mtext><mspace width="1em"/><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>c</mi><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">T(n) = o(f(n)) \iff \forall c &gt; 0 \quad \text{s.t.} \quad T(n) &lt; c \cdot f(n) \quad \forall n \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></li><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>o</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n) = o(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\lim_{n \to \infty} \frac{f(n)}{g(n)} = 0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.6630000000000003em;vertical-align:-1.0815000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5815000000000001em;"><span style="top:-3.5815em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0815000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></li><li>渐近符号也可以用来刻画算法的某个其他方面（如使用的空间数量）</li></ul><h5 id="其他记号">其他记号</h5><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi mathvariant="normal">∃</mi><mi>c</mi><mo>&gt;</mo><mn>0</mn><mspace width="1em"/><mtext>s.t.</mtext><mspace width="1em"/><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>c</mi><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">T(n) = \Omega(f(n)) \iff \exist c &gt; 0 \quad \text{s.t.} \quad T(n) &gt; c \cdot f(n) \quad \forall n \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">∃</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span></span></span></span> 记号同 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">o</span></span></span></span> 理</li></ul></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi mathvariant="normal">∃</mi><msub><mi>c</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>c</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn><mspace width="1em"/><mtext>s.t.</mtext><mspace width="1em"/><msub><mi>c</mi><mn>1</mn></msub><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&gt;</mo><msub><mi>c</mi><mn>2</mn></msub><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">T(n) = \Theta(f(n)) \iff \exist c_1 &gt; c_2 &gt; 0 \quad\text{s.t.} \quad c_1 \cdot f(n) &gt; T(n) &gt; c_2 \cdot f(n) \quad \forall n \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">∃</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.59445em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></p></li></ul><p>定义多重对数函数为 $\log^*(n) = \min{i\ge 0 : \log^{(i)}(n) \le 1 } $</p><ul><li>由此可得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">∃</mi><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><munder><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∞</mi><mspace width="1em"/><mtext>s.t.</mtext><mspace width="1em"/><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\exist f(n), \lim_{n \to \infty} f(n) = \infty \quad \text{s.t.} \quad f(n) = \Theta(f(\log n))\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.6700000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.17em;"><span style="top:-3.33em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∃</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∞</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6700000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></li><li><code>for (i = 1; i &lt; n; i = (1 &lt;&lt; i))</code></li></ul><h5 id="复杂度分析">复杂度分析</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ：常数<ul><li><strong>通常</strong> 不含循环、分支、子程序调用</li><li>仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 辅助空间的算法，称为就地算法</li><li>C++等高级语言的基本指令，均等效于常数条 RAM 的基本指令</li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mo><mi>log</mi><mo>⁡</mo></mo><mi>c</mi></msup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log^c n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.748732em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ：对数<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>c</mi><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"/><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\forall c &gt; 0, \quad \log  n = O(n^c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo><mo>≈</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>0.5</mn><mo stretchy="false">)</mo><mi>ln</mi><mo>⁡</mo><mi>n</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\ln (n!) \approx (n + 0.5) \ln n - n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mi>i</mi></mfrac><mo>=</mo><mi>ln</mi><mo>⁡</mo><mi>n</mi><mo>+</mo><mi>γ</mi><mo>+</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>n</mi></mrow></mfrac><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi>γ</mi><mo>≈</mo><mn>0.577216</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\sum_{i=1}^n \frac{1}{i} = \ln n + \gamma + \Theta(\frac{1}{2n}),\quad \gamma \approx 0.577216\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.2290660000000004em;vertical-align:-1.364533em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645330000000004em;"><span style="top:-3.8645330000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mord">7</span><span class="mord">7</span><span class="mord">2</span><span class="mord">1</span><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.364533em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ：多项式<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>⋅</mo><msup><mi>n</mi><mi>k</mi></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><msup><mi>n</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>⋅</mo><mi>n</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>k</mi></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mi>a</mi><mi>k</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_k \cdot n^k + a_{k-1} \cdot n^{k - 1} + \cdots + a_1 \cdot n + a_0 = O(n^k), \quad a_k &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.59445em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6527810000000001em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9324379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.59445em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ：指数<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>a</mi><mi>n</mi></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi>a</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T(n) = O(a^n), \quad a &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li><li>从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，是从有效算法到无效算法的分水岭</li><li>Subset Sum <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> NP-complete</li></ul></li></ul><h5 id="输入规模">输入规模</h5><p>待计算问题的输入规模，应严格定义为“用以描述输入所需的空间规模”。</p><h5 id="封底估算">封底估算</h5><p>根据数据结构和算法的渐近复杂度，凭借在实际计算环境中积累的经验，针对计算过程主要部分进行的粗略估算。</p><h3 id="迭代与递归">迭代与递归</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> A[], <span class="type">int</span> n)</span> </span>&#123; <span class="comment">// 数组求和(线性递归版)</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1</span>) <span class="comment">// 平凡情况, 递归基</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(A, n - <span class="number">1</span>) + A[n - <span class="number">1</span>];</span><br><span class="line">&#125; <span class="comment">// O(1)*递归深度 = O(1)*(n+1) = O(n)</span></span><br></pre></td></tr></table></figure><h4 id="线性递归">线性递归</h4><p>每一层次至多有一个实例，且它们构成一个线性的次序关系。</p><h4 id="减而治之">减而治之</h4><ul><li>为求解一个大规模的问题，可以<ul><li>将其划分为两个子问题：其一平凡，另一规模缩减</li><li>分别求解子问题；再由子问题的解，得到原问题的解</li></ul></li><li>递归每深入一层，待求解问题的规模都缩减一个常数，直至最终蜕化为平凡的小（简单）问题。</li><li>计算过程中出现过的所有递归实例，其所需时间总和，即为整体运行时间</li><li>空间复杂度：递归 <strong>深度</strong> + 额外申请空间</li></ul><h4 id="尾递归和递归消除">尾递归和递归消除</h4><ul><li>在线性递归算法中，若递归调用在递归实例中恰好以 <strong>最后一步操作</strong> 的形式出现，则称作尾递归</li><li>属于尾递归形式的算法，均可简捷地转换为等效的迭代版本</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> *A, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">swap</span>(A[<span class="number">0</span>], A[n - <span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">reverse</span>(A + <span class="number">1</span>, n - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> *A, <span class="type">int</span> lo, <span class="type">int</span> hi)</span> </span>&#123;</span><br><span class="line"><span class="keyword">while</span> (lo &lt; hi)</span><br><span class="line">        <span class="built_in">swap</span>(A[lo++], A[hi--]);</span><br><span class="line">&#125; <span class="comment">// O(hi - lo + 1), cache-friendly</span></span><br></pre></td></tr></table></figure><h4 id="分而治之">分而治之</h4><ul><li>为求解一个大规模的问题，可以<ul><li>将其划分为若干子问题（通常两个，且规模 <strong>大体相当</strong>）</li><li>分别求解子问题；再由子问题的解，得到原问题的解</li></ul></li><li>为使分治策略真正有效，需要保证<ul><li>子问题之间相互独立</li><li>子问题划分和子解答合并能高效实现</li></ul></li></ul><h5 id="主定理">主定理</h5><ul><li><p>分治策略对应的递推式，通常形如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = a \cdot T(n / b) + O(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p><ul><li>原问题被分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> 个规模均为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">n/b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">b</span></span></span></span> 的子任务</li><li>任务的划分、解的合并，总共耗时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi><mo>+</mo><mi>ϵ</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n) = \Omega(n^{\log_b a + \epsilon})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">ϵ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = \Theta(g(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\epsilon  &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 意味着存在多项式级别的差距</li><li><code>quickSelect</code>（average case）： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 1 \cdot T(n / 2) + O(n) = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi><mo>−</mo><mi>ϵ</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n) = O(n^{\log_b a - \epsilon})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">ϵ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = \Theta(n^{\log_b a})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><ul><li><code>large integer multiplicaton</code>： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mn>3</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 3 \cdot T(n / 2) + O(n) = O(n^{\log_2 3})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.19444571428571428em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi></mrow></msup><mo>⋅</mo><msup><mo><mi>log</mi><mo>⁡</mo></mo><mi>k</mi></msup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(n) = \Theta(n^{\log_b a} \cdot \log^k n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1834479999999998em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi></mrow></msup><mo>⋅</mo><msup><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>&gt;</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi></mrow></msup><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>b</mi></msub><mi>a</mi></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>&lt;</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">T(n) = \begin{cases} \Theta(n^{\log_b a} \cdot \log^{k + 1} n), &amp; k &gt; -1 \\ \Theta(n^{\log_b a} \cdot \log\log n), &amp; k = - 1 \\ \Theta(n^{\log_b a}), &amp; k &lt; -1 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.14734em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23015999999999992em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><ul><li><code>STL mergesort</code>： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 2 \cdot T(n / 2) + O(n \cdot \log n) = O(n \cdot \log^2 n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.148448em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8984479999999999em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h5 id="akra-bazzi-theorem">Akra-Bazzi Theorem</h5><ul><li>分治策略对应的递推式，更一般地形如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>a</mi><mi>i</mi></msub><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo>⋅</mo><mi>n</mi><mo>+</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}T(n) = \sum_{i = 1}^k a_i \cdot T(b_i \cdot n + h_i(n)) + O(g(n))\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.4137820000000003em;vertical-align:-1.4568910000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9568910000000002em;"><span style="top:-3.9568909999999997em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4568910000000002em;"><span></span></span></span></span></span></span></span></span></span></span><ul><li>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><msub><mi>b</mi><mi>i</mi></msub><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mrow><mo fence="true">∣</mo><msub><mi>h</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><msup><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 &lt; a_i, 0 &lt; b_i  &lt; 1, \left\vert h_i(n) \right\vert = O(n / \log^2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.148448em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8984479999999999em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 \le g(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 且存在正常数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><msup><mi>g</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>d</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left\vert g&#x27;(n) \right\vert = O(n^d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>只要取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>a</mi><mi>i</mi></msub><mo>⋅</mo><msubsup><mi>b</mi><mi>i</mi><mi>p</mi></msubsup><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\sum_{i = 1}^k a_i \cdot b_i^p = 1\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.4137820000000003em;vertical-align:-1.4568910000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9568910000000002em;"><span style="top:-3.9568909999999997em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7822999999999999em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.180908em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4568910000000002em;"><span></span></span></span></span></span></span></span></span></span></span> ，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>p</mi></msup><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mo>∫</mo><mn>1</mn><mi>n</mi></msubsup><mi>g</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msup><mi>u</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mtext> </mtext><mi mathvariant="normal">d</mi><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = \Theta(n^p \cdot (1 + \int_1^n g(u) / u^{p + 1}\, {\rm d}u))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.215112em;vertical-align:-0.35582em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8592920000000001em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span></span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>如对于算法 <code>LinearSelect</code> ，有<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mn>3</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo>⋅</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>5</mn><mo>⋅</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 1 \cdot T(3/4 \cdot n) + 1 \cdot T(1/5 \cdot n) + O(n) = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">3</span><span class="mord">/</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><h4 id="总和最大区段">总和最大区段</h4><h5 id="分而治之">分而治之</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>m</mi><mi>i</mi><mo stretchy="false">)</mo><mo>∪</mo><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">P</mi><mo>∪</mo><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}[lo, hi) = \mathcal{A}[lo, mi) \cup \mathcal{A}[mi, hi) = \mathcal{P} \cup \mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span></li><li>借助递归，求得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mtext>、</mtext><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}、\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span> 内部的 GS，并考察跨越切分线的区段</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gs_DC</span><span class="params">(<span class="type">int</span> A[], <span class="type">int</span> lo, <span class="type">int</span> hi)</span> </span>&#123; <span class="comment">// O(nlogn)</span></span><br><span class="line">    <span class="keyword">if</span> (hi - lo &lt; <span class="number">2</span>) <span class="keyword">return</span> A[lo];</span><br><span class="line">    <span class="type">int</span> mi = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> gsL = A[mi - <span class="number">1</span>], sL = <span class="number">0</span>, i = mi;</span><br><span class="line">    <span class="keyword">while</span> (lo &lt; i--)</span><br><span class="line">        <span class="keyword">if</span> (gsL &lt; (sL += A[i])) gsL = sL;</span><br><span class="line">    <span class="type">int</span> gsR = A[mi], sR = <span class="number">0</span>, j = mi - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (++j &lt; hi)</span><br><span class="line">        <span class="keyword">if</span> (gsR &lt; (sR += A[j])) gsR = sR;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(gsL + gsR, <span class="built_in">max</span>(<span class="built_in">gs_DC</span>(A, lo, mi), <span class="built_in">gs_DC</span>(A, mi, hi)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="减而治之">减而治之</h5><ul><li>最短的总和非正的后缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 总和最大区段</li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>x</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>k</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi>k</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>l</mi><mi>o</mi><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>h</mi><mi>i</mi><mi mathvariant="normal">∣</mi><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">suffix(k) = \mathcal{A}[k, hi), \quad k = \max\{lo \le i &lt; hi | sum[i, hi) \le 0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord">∣</span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span><ul><li>则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>S</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">GS(lo, hi) = \mathcal{A}[i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 要么是其 <strong>后缀</strong>，要么与之无交</li><li>可用反证法证明</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gs_LS</span><span class="params">(<span class="type">int</span> A[], <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> gs = A[<span class="number">0</span>], s = <span class="number">0</span>, i = n;</span><br><span class="line">    <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        s += A[i];</span><br><span class="line">        <span class="keyword">if</span> (gs &lt; s) gs = s;</span><br><span class="line">        <span class="keyword">if</span> (s &lt;= <span class="number">0</span>) s = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="更相减损术">更相减损术</h4><ul><li>渐进时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log(a+b))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>，且可推广至多个整数的情况</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">gcdCN</span><span class="params">(__int64 a, __int64 b)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!((a &amp; <span class="number">1</span>) || (b &amp; <span class="number">1</span>))) &#123;</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span>, b &gt;&gt;= <span class="number">1</span>, r++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (~(a &amp; <span class="number">1</span>)) a &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (~(b &amp; <span class="number">1</span>)) b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (a &gt; b) a = a - b;</span><br><span class="line">        <span class="keyword">else</span> b = b - a;</span><br><span class="line">        <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="keyword">return</span> b &lt;&lt; r;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="keyword">return</span> a &lt;&lt; r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动态规划">动态规划</h3><h4 id="fib"><code>fib()</code></h4><h5 id="递归">递归</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fib</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> (n &lt; <span class="number">2</span>) ? n : <span class="built_in">fib</span>(n - <span class="number">1</span>) + <span class="built_in">fib</span>(n - <span class="number">2</span>); &#125;</span><br></pre></td></tr></table></figure><ul><li>复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T(0) = T(1) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T(n) = T(n - 1) + T(n - 2), \quad \forall n &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><ul><li>令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(n) = [T(n) + 1] / 2 = S(n - 1) + S(n - 2) = fib(n + 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">/</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>ϕ</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 2 \cdot S(n) - 1 = 2 \cdot fib(n + 1) - 1 = O(fib(n + 1)) = O(\phi ^ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msqrt><mn>5</mn></msqrt><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\phi = (1 + \sqrt{5}) / 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1572200000000001em;vertical-align:-0.25em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span></span></li></ul></li><li>低效的根源在于，有大量重复的递归实例<ul><li>去重之后，总共不过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 种</li></ul></li><li>记忆化：记住答案，直接“抄袭”（n-1）</li></ul><h5 id="dynamic-programming">Dynamic Programming</h5><ul><li>由自顶向下递归，改为自底向上迭代</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fib</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> f = <span class="number">1</span>, g = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        g = g + f;</span><br><span class="line">        f = g - f;</span><br><span class="line">    &#125; <span class="comment">// (f, g) -&gt; (g, f + g)</span></span><br><span class="line"><span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，且仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 空间</li></ul><h4 id="最长公共子序列">最长公共子序列</h4><ul><li>子序列：由序列中若干字符，按原相对次序构成（子串则需要连续）</li><li>Longest Common Subsequence：两个序列之间公共子序列中的最长者</li></ul><h5 id="分治递归">分治递归</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">lcs</span><span class="params">(<span class="type">char</span> <span class="type">const</span> *A, <span class="type">int</span> n, <span class="type">const</span> <span class="type">char</span> *B, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1</span> || m &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (A[n - <span class="number">1</span>] == B[m - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + <span class="built_in">lcs</span>(A, n - <span class="number">1</span>, B, m - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">lcs</span>(A, n - <span class="number">1</span>, B, m), <span class="built_in">lcs</span>(A, n, B, m));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>LCS 的每一个解，对应于（0，0）与（n，m）之间的一条单调通路；反之亦然</li><li>最好情况 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li><li>最坏情况，就是 <code>LCS(A[0], B[0])</code> 的重复次数，可达 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>+</mo><mi>m</mi></mrow><mi>n</mi></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{n + m}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2023409999999999em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.852331em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><ul><li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n = m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ，为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>4</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(4^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>）</li></ul></li><li>记忆化（或 DP）则只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul><h2 id="向量">向量</h2><h3 id="抽象数据类型">抽象数据类型</h3><ul><li>数据结构都可看作是由若干数据项组成的集合，同时对数据项定义一组标准的操作。</li><li>抽象数据类型（Abstract Data Type，ADT）<ul><li>将数据结构的外部特性与其内部实现相分离，提供一致且标准的对外接口，隐藏内部的实现细节</li></ul></li><li>数据结构（Data Structure）<ul><li>基于某种特定语言，实现 ADT 的一整套算法</li></ul></li></ul><h4 id="从数组到向量">从数组到向量</h4><ul><li><p>数组</p><ul><li>元素各由编号唯一指代，并可直接访问</li><li>若每个元素占用空间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>（包含 padding），则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span> 的物理地址为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><mi>i</mi><mo>×</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">A + i \times s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span></li></ul></li><li><p>向量</p><ul><li><p>数组的抽象和泛化，由一组元素按线性次序封装而成</p></li><li><p>各元素与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 内的秩一一对应</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Rank = <span class="type">unsigned</span> <span class="type">int</span>; <span class="comment">// call-by-rank</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="vector-adt">Vector ADT</h4><table><thead><tr><th>操作</th><th>功能</th><th>适用对象</th></tr></thead><tbody><tr><td><code>size() / empty()</code></td><td>报告元素总数 ／ 判定是否为空</td><td>向量</td></tr><tr><td><code>get(r) / put(r, e)</code></td><td>获取秩为 r 的元素 / 用 e 替换秩为 r 元素的数值</td><td>向量</td></tr><tr><td><code>insert(r, e) / insert(e)</code></td><td>将 e 作为秩为 r 的 ／ 最后一个元素插入</td><td>向量</td></tr><tr><td><code>remove(r) / remove(lo, hi)</code></td><td>删除秩为 r／ 区间内的元素</td><td>向量</td></tr><tr><td><code>disordered() / sort(lo, hi) / unsort(lo, hi)</code></td><td>检测是否整体有序 ／ 整体排序 ／ 整体置乱</td><td>向量</td></tr><tr><td><code>find(e, lo, hi) / search(e, lo, hi)</code></td><td>在指定区间内查找目标 e</td><td>向量 / 有序向量</td></tr><tr><td><code>dedup() / uniquify()</code></td><td>剔除相等的元素</td><td>向量 / 有序向量</td></tr><tr><td><code>traverse( visit() )</code></td><td>遍历向量，统一按 <code>visit()</code> 处理所有元素</td><td>向量</td></tr></tbody></table><h3 id="可扩充的向量">可扩充的向量</h3><ul><li>动态空间管理<ul><li>在即将上溢时，适当扩大内部数组的容量</li></ul></li></ul><h4 id="扩容算法">扩容算法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">copyFrom</span>(T <span class="type">const</span> *A, Rank lo, Rank hi) &#123;</span><br><span class="line">    _elem = <span class="keyword">new</span> T[_capacity = (hi - lo) * <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (_size = <span class="number">0</span>; lo &lt; hi; _size++, lo++) &#123;</span><br><span class="line">        _elem[_size] = A[lo];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">expand</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_size &lt; _capacity) <span class="keyword">return</span>;</span><br><span class="line">    T* oldElem = _elem;</span><br><span class="line">    <span class="built_in">copyFrom</span>(oldElem, <span class="number">0</span>, _capacity);</span><br><span class="line">    <span class="keyword">delete</span> oldElem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="分摊分析">分摊分析</h4><ul><li><p>平均（average complexity）：根据各种操作出现概率的分布，将对应的成本加权平均</p><ul><li>各种可能的操作，作为独立事件分别考查</li><li>割裂了操作之间的相关性和连贯性</li></ul></li><li><p>分摊（amortized complexity）：连续实施的足够多次操作，所需总体成本摊还至单次操作</p><ul><li>从实际可行的角度，对一系列操作做整体的考量</li><li>更加忠实地刻画了 <strong>可能出现的操作序列</strong></li></ul></li></ul><h5 id="容量递增策略">容量递增策略</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_elem = <span class="keyword">new</span> T[_capacity += INCREMENT];</span><br></pre></td></tr></table></figure><ul><li>最坏情况：初始容量 0 的空向量，连续插入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>⋅</mo><mi>I</mi><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n = m \cdot I \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个元素，无删除<ul><li>总体耗时 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>+</mo><mi>I</mi><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>I</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">0 + I + \cdots + (m - 1) \cdot I = O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>每次插入删除操作分摊成本为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>空间利用率（装填因子）：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">_</mi><mi>c</mi><mi>a</mi><mi>p</mi><mi>a</mi><mi>c</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>≈</mo><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">\lambda = \_size / \_capacity \approx 100\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mord">/</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">%</span></span></span></span></li></ul><h5 id="容量加倍策略">容量加倍策略</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_elem = <span class="keyword">new</span> T[_capacity *= <span class="number">2</span>];</span><br></pre></td></tr></table></figure><ul><li>最坏情况：初始容量 1 的满向量，连续插入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>m</mi></msup><mo>≫</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n = 2^m \gg 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.703492em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个元素，无删除<ul><li>总体耗时 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1 + 2 + \cdots + 2^{m - 1} = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>每次（insert/remove）操作分摊成本为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>50</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">\lambda &gt; 50\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord">%</span></span></span></span></li></ul><h3 id="无序向量">无序向量</h3><h4 id="删除">删除</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">shrink</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_size &lt;&lt; <span class="number">2</span> &gt; _capacity) <span class="keyword">return</span>; <span class="comment">// 以 25%(必须 &lt; 50%)为界</span></span><br><span class="line">    T* oldElem = _elem; _elem = <span class="keyword">new</span> T[_capacity &gt;&gt;= <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; _size; i++) _elem[i] = oldElem[i];</span><br><span class="line">    <span class="keyword">delete</span> oldElem[];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank <span class="title">remove</span><span class="params">(Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lo == hi) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (hi &lt; _size) _elem[lo++] = _elem[hi++]; <span class="comment">// 后缀[hi, n)前移</span></span><br><span class="line">    _size = lo; <span class="built_in">shrink</span>();</span><br><span class="line">    <span class="keyword">return</span> hi - lo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="查找">查找</h4><ul><li>顺序查找<ul><li>输入敏感（input-sensitive）</li><li>最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ，最差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="去重">去重</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank Vector&lt;T&gt;::<span class="built_in">dedup</span>() &#123;</span><br><span class="line">    Rank oldSize = _size;</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">1</span>; i &lt; _size;) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(_elem[i], <span class="number">0</span>, i) == <span class="number">-1</span>) i++; <span class="comment">// O(i)</span></span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">remove</span>(i); <span class="comment">// O(_size - i)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> oldSize - _size;</span><br><span class="line">&#125; <span class="comment">// O(n^2)</span></span><br></pre></td></tr></table></figure><h3 id="有序向量">有序向量</h3><ul><li>在有序序列中，任何一对相邻元素必顺序<ul><li>相邻逆序对的数目，可在一定程度上度量向量的紊乱程度</li></ul></li><li>无序向量经预处理转换为有序向量之后，相关算法多可优化</li></ul><h4 id="唯一化">唯一化</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank Vector&lt;T&gt;::<span class="built_in">uniquify</span>() &#123;</span><br><span class="line">Rank i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (++j &lt; _size) &#123;</span><br><span class="line">        <span class="keyword">if</span> (_elem[i] != _elem[j]) &#123;</span><br><span class="line">            _elem[++i] = _elem[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    _size = ++i; <span class="built_in">shrink</span>();</span><br><span class="line">    <span class="keyword">return</span> j - i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="二分查找-版本-a">二分查找（版本 A）</h4><ul><li>减而治之<ul><li>若轴点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">mi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span></span></span></span> 取作重点，则每经过 <strong>至多两次</strong> 比较<ul><li>或者能够命中</li><li>或者将问题规模减半</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> Rank <span class="title">binSearch</span><span class="params">(T *S, T <span class="type">const</span> &amp;e, Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">        Rank mi = (lo + hi) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; S[mi]) hi = mi;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (S[mi] &lt; e) lo = mi + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> mi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// 失败</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>线性“递归”：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = T(n / 2) + O(1) = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>“递归跟踪”：轴点总能取到中点，递归深度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>关键码的比较次数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 平均查找长度<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi></mrow></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1.50</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ASL_{succ} = O(1.50 \cdot \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1.50</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ASL_{fail} = O(1.50 \cdot \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="fibonacci-查找">Fibonacci 查找</h4><ul><li>版本 A：转向左、右分支前的关键码比较次数不等，而递归深度却相同<ul><li>可以通过递归深度的不均衡对转向成本的不均衡做补偿</li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n = fib(k) - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，则可取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mo>=</mo><mi>l</mi><mi>o</mi><mo>+</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mi = lo + fib(k - 1) - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><ul><li>前、后子向量长度分别为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">fib(k - 1) - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">fib(k - 2) - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li><li>失败查找长度，最大为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，最小为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k - 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></li><li>成功查找长度，最大为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，最小为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> Rank <span class="title">fibSearch</span><span class="params">(T *S, T <span class="type">const</span> &amp;e, Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Fib <span class="built_in">fib</span>(hi - lo); lo &lt; hi;) &#123; <span class="comment">// Fib 数列制表备查</span></span><br><span class="line">        <span class="keyword">while</span> (hi - lo &lt; fib.<span class="built_in">get</span>()) fib.<span class="built_in">prev</span>(); <span class="comment">// 自后向前顺序查找轴点(分摊 O(1))</span></span><br><span class="line">        Rank mi = lo + fib.<span class="built_in">get</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; S[mi]) hi = mi;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (S[mi] &lt; e) lo = mi + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> mi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125; <span class="comment">// 有多个命中元素时, 不能保证返回秩最大者; 失败时, 简单地返回 －1, 而不能指示失败的位置</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/2.png" alt="2"></p><h5 id="通用策略">通用策略</h5><ul><li>在任何区间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 内，总是选取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>λ</mi><mo>⋅</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\lambda \cdot n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span> 作为轴点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>λ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \le \lambda &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><ul><li>Fibonacci 查找对应 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mn>1</mn><mi>ϕ</mi></mfrac><mo>=</mo><mfrac><mrow><msqrt><mn>5</mn></msqrt><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\lambda = \frac{1}{\phi} = \frac{\sqrt{5} - 1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3829999999999998em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0379999999999998em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.3990085em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.912845em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">5</span></span></span><span style="top:-2.872845em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12715500000000002em;"><span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>这类查找算法的渐近复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha(\lambda) \cdot \log_2 n = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>递推式：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi><mo>=</mo><mi>λ</mi><mo>⋅</mo><mo stretchy="false">[</mo><mn>1</mn><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>λ</mi><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">[</mo><mn>2</mn><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\alpha(\lambda) \cdot \log_2 n = \lambda \cdot [1 + \alpha(\lambda) \cdot \log_2 (\lambda n)] + (1 - \lambda) \cdot [2 + \alpha(\lambda) \cdot \log_2 ((1 - \lambda) n)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></li><li>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mrow><msqrt><mn>5</mn></msqrt><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\lambda = \frac{\sqrt{5} - 1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3829999999999998em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0379999999999998em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.3990085em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.912845em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">5</span></span></span><span style="top:-2.872845em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12715500000000002em;"><span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo stretchy="false">(</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1.440420...</mn></mrow><annotation encoding="application/x-tex">\alpha(\lambda) = 1.440420...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span><span class="mord">4</span><span class="mord">0</span><span class="mord">4</span><span class="mord">2</span><span class="mord">0</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span> 达到最小</li></ul></li></ul><h4 id="二分查找-版本-b">二分查找（版本 B）</h4><ul><li>每次迭代仅做一次关键码比较<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>&lt;</mo><mi>x</mi><mo>→</mo><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>m</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e &lt; x \rightarrow [lo, mi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≤</mo><mi>e</mi><mo>→</mo><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x \le e \rightarrow [mi, hi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></li></ul></li><li>直到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">hi - lo = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，才判断是否命中</li><li>相较于版本 A，最好（坏）情况下更坏（好），整体性能更趋均衡</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> Rank <span class="title">binSearch</span><span class="params">(T *S, T <span class="type">const</span> &amp;e, Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (hi - lo &gt; <span class="number">1</span>) &#123; <span class="comment">// 有效查找区间的宽度缩短至 1 时, 算法才终止</span></span><br><span class="line">        Rank mi = (lo + hi) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; S[mi]) hi = mi;</span><br><span class="line">        <span class="keyword">else</span> lo = mi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e == S[lo] ? lo : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="返回值改进">返回值改进</h5><ul><li>约定总是返回 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>s</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>h</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m = search(e) = M - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi mathvariant="normal">∞</mi><mo>≤</mo><mi>m</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>k</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>≤</mo><mi>e</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">-\infty \le m = \max\{k | [k] \le e\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord">−</span><span class="mord">∞</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord">∣</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">}</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>k</mi><mi mathvariant="normal">∣</mi><mi>e</mi><mo>&lt;</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo><mo>=</mo><mi>M</mi><mo>≤</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\min\{k | e &lt; [k]\} = M \le +\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord">∣</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span><span class="mord">∞</span></span></span></span></li></ul></li><li>直接改进版本 B<ul><li><code>return e &lt; S[lo] ? lo - 1 : lo;</code></li></ul></li></ul><h4 id="二分查找-版本-c">二分查找（版本 C）</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> Rank <span class="title">binSearch</span><span class="params">(T *S, T <span class="type">const</span> &amp;e, Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (lo &lt; hi) &#123; <span class="comment">// [0, lo) &lt;= e &lt; [hi, n)</span></span><br><span class="line">        Rank mi = (lo + hi) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; S[mi]) hi = mi;</span><br><span class="line">        <span class="keyword">else</span> lo = mi + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 出口时, 区间宽度缩减至 0, 且必有 [lo = hi] = M</span></span><br><span class="line">    <span class="keyword">return</span> lo - <span class="number">1</span>; <span class="comment">// 至此, [lo] 为大于 e 的最小者</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在算法执行过程中的任意时刻<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[lo - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 总是（已确认的）不大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 的最大者</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>h</mi><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[hi]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span> 总是（已确认的）大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 的最小者</li></ul></li><li>算法终止时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mi>h</mi><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[lo - 1] = [hi - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 即为全局不大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 的最大者</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi></mrow></msub><mo>=</mo><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1.00</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ASL_{succ} = ASL_{fail} = O(1.00 \cdot \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h4 id="插值查找">插值查找</h4><ul><li><p>大数定律：越长的序列，元素的分布越有规律</p><ul><li>最为常见：独立且均匀的随机分布</li></ul></li><li><p>因此，通过猜测轴点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">mi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span></span></span></span> ，可以极大地提高收敛速度</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mo>≈</mo><mi>l</mi><mi>o</mi><mo>+</mo><mo stretchy="false">(</mo><mi>h</mi><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mo stretchy="false">)</mo><mo>⋅</mo><mfrac><mrow><mi>e</mi><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo stretchy="false">]</mo></mrow><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>h</mi><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo stretchy="false">]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">mi \approx lo + (hi - lo) \cdot \frac{e - A[lo]}{A[hi] - A[lo]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">A</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">A</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li><p>最坏情况：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>i</mi><mo>−</mo><mi>l</mi><mi>o</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hi - lo = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> （<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><msup><mn>0</mn><mn>10</mn></msup></mrow><annotation encoding="application/x-tex">1, 1, \dots, 2, 10^{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span> 中查找“2”）</p></li><li><p>平均：每经过一次比较，待查找区间宽度由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 缩至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mn>1</mn></msup></mrow></msup><mo>→</mo><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mn>2</mn></msup></mrow></msup><mo>→</mo><mo>⋯</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n \rightarrow n^{1/2^1} \rightarrow n^{1/2^2} \rightarrow \cdots 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9869199999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9869199999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999998em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>每经过一次比较，查找区间宽度的数值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 开方，有效字长 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span> 减半</p><ul><li>插值查找 = 在字长意义上的折半查找</li><li>二分查找 = 在字长意义上的顺序查找</li></ul></li><li><p>实际可行的方法：<strong>算法接力</strong></p><ul><li>先插值查找，迅速缩小查找范围</li><li>再改为二分查找，进一步缩小</li><li>最后顺序查找</li></ul></li></ul><h3 id="起泡排序">起泡排序</h3><blockquote><p>扫描交换，依次比较每一对相邻元素；如有必要，交换之。直至某趟扫描后，确认相邻元素均以顺序。</p></blockquote><ul><li>经过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 趟扫描交换后，最大的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 个元素必然就位，问题规模缩减至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n - k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></li><li>至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 趟扫描后，算法必然终止，并给出正确解答</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">bubbleSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Rank last; lo &lt; hi; hi = last) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Rank i = (last = lo) + <span class="number">1</span>; i &lt; hi; ) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_elem[i - <span class="number">1</span>] &gt; _elem[i]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(_elem[i - <span class="number">1</span>], _elem[i]);</span><br><span class="line">                last = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// 跳跃版, 每次扫描后[last, hi)为已有序后缀</span></span><br></pre></td></tr></table></figure><ul><li>时间效率：最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，最坏 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>在起泡排序中，唯有相邻元素才可交换，故是稳定的<ul><li>排序算法的稳定性：相等的元素在输入、输出序列中的相对次序，是否保持不变？</li></ul></li></ul><h4 id="比较树">比较树</h4><ul><li>基于比较式算法（Comparison-Based Algorithm，CBA）可以被转换为一个树形结构。该树形结构具有以下性质：<ul><li>每一内部节点各对应于一次比对操作</li><li>内部节点的左、右分支，分别对应与在两种比对结果下的执行方向</li><li>叶节点（或根到叶节点的路径）对应于算法某次执行的完整过程及输出</li><li>反过来，算法的每一运行过程都对应于从根到某一叶节点的路径</li></ul></li><li>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>T</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">CT(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span></span></span></span> 为某一 CBA 式算法 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 对应的比较树<ul><li>那么算法 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 在最坏情况下的运行时间，取决于该树的高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>C</mi><mi>T</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(CT(A))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>算法 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 的时间复杂度应不低于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><mi>C</mi><mi>T</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(h(CT(A)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li></ul></li><li>若某一问题的输出结果不少于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 种，则<ul><li>比较树叶节点不可能少于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 个，树高不可能低于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>N</mi></mrow><annotation encoding="application/x-tex">\log_2 N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span></li></ul></li><li>由此任一 CBA 式排序算法对应的比较树高度应为<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>≥</mo><mrow><mo fence="true">⌈</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>3</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo><mo fence="true">⌉</mo></mrow><mo>=</mo><mrow><mo fence="true">⌈</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>3</mn></msub><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo><mo fence="true">⌉</mo></mrow><mo>=</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h \ge \left \lceil \log_3(n!) \right \rceil = \left \lceil \log_3(e) \cdot \ln(n!) \right \rceil = \Omega(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">⌉</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">⌉</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>最坏情况下 CBA 式排序算法至少需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 为待排序元素数目</li></ul></li></ul><h3 id="归并排序">归并排序</h3><ul><li>分而治之，向量和列表通用<ul><li>序列一分为二</li><li>子序列递归排序</li><li>合并有序子序列</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">mergeSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hi - lo &lt; <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    Rank mi = (lo + hi) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">mergeSort</span>(lo, mi);</span><br><span class="line">    <span class="built_in">mergeSort</span>(mi, hi);</span><br><span class="line">    <span class="built_in">merge</span>(lo, mi, hi); <span class="comment">// 归并</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="二路归并">二路归并</h4><ul><li>有序序列合二为一，保持有序</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">merge</span>(Rank lo, Rank mi, Rank hi) &#123;</span><br><span class="line">Rank i = <span class="number">0</span>; T* A = _elem + lo;</span><br><span class="line">    Rank j = <span class="number">0</span>, lb = mi - lo; T* B = <span class="keyword">new</span> T[lb];</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; lb; i++) B[i] = A[i];</span><br><span class="line">    Rank k = <span class="number">0</span>, lc = hi - mi; T* C = _elem + mi;</span><br><span class="line">    <span class="comment">// 后缀 C[0, lc) = _elem[mi, hi), 就地</span></span><br><span class="line">    <span class="keyword">while</span> ((j &lt; lb) &amp;&amp; (k &lt; lc))</span><br><span class="line">        A[i++] = (B[j] &lt;= C[k]) ? B[j++] : C[k++];</span><br><span class="line">    <span class="keyword">while</span> (j &lt; lb)</span><br><span class="line">        A[i++] = B[j++]; <span class="comment">// 若 B 先耗尽, A 中对应的 C 的残余已然有序</span></span><br><span class="line">    <span class="keyword">delete</span>[] B;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="复杂度">复杂度</h4><ul><li>二路归并每次累计迭代步数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo><mi>l</mi><mi>b</mi><mo>+</mo><mi>l</mi><mi>c</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\le lb + lc = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ，只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>总体 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 2 \cdot T(n / 2) + O(n) = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>优点<ul><li>最坏情况下最优 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 性能</li><li>不需随机读写，完全顺序访问</li><li>实现恰当，可保证稳定</li><li>适用于外部排序，易于并行化</li></ul></li><li>缺点<ul><li><strong>非就地</strong></li><li>即使输入已完全（或接近）有序，仍需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间</li></ul></li></ul><h3 id="位图">位图</h3><ul><li><p>期望功能，对于有限整数集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mn>0</mn><mo>≤</mo><mi>k</mi><mo>&lt;</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">\forall 0 \le k &lt; U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord">∀</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mi>S</mi><mtext> </mtext><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">k \in S\, ?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">?</span></span></span></span> ，<code>bool test(int k)</code></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mi>k</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S \cup \{k\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">}</span></span></span></span> ，<code>void set(int k)</code></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∖</mo><mo stretchy="false">{</mo><mi>k</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S \setminus \{k\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">}</span></span></span></span> ，<code>void clear(int k)</code></li></ul></li><li><p>结构：用每一个比特位标记一个整数，8 位压缩为一个 <code>char</code></p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bitmap</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *M;</span><br><span class="line">    Rank N, _sz;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Bitmap</span>(Rank n = <span class="number">8</span>) &#123;</span><br><span class="line">        M = <span class="keyword">new</span> <span class="type">unsigned</span> <span class="type">char</span>[N = (n + <span class="number">7</span>) / <span class="number">8</span>];</span><br><span class="line">        <span class="built_in">memset</span>(M, <span class="number">0</span>, N); _sz = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Bitmap</span>() &#123; <span class="keyword">delete</span>[] M; M = <span class="literal">NULL</span>; _sz = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(<span class="type">int</span> k)</span></span>; <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> k)</span></span>; <span class="function"><span class="type">bool</span> <span class="title">test</span><span class="params">(<span class="type">int</span> k)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>实现</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">test</span><span class="params">(Rank k)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">expand</span>(k);</span><br><span class="line">    <span class="keyword">return</span> M[k &gt;&gt; <span class="number">3</span>] &amp; (<span class="number">0x80</span> &gt;&gt; (k &amp; <span class="number">0x07</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(Rank k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">test</span>(k)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">expand</span>(k); _sz++;</span><br><span class="line">    M[k &gt;&gt; <span class="number">3</span>] |= (<span class="number">0x80</span> &gt;&gt; (k &amp; <span class="number">0x07</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(Rank k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">test</span>(k)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">expand</span>(k); _sz--;</span><br><span class="line">    M[k &gt;&gt; <span class="number">3</span>] &amp;= ~(<span class="number">0x80</span> &gt;&gt; (k &amp; <span class="number">0x07</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="典型应用">典型应用</h4><h5 id="小集合-大数据">小集合+大数据</h5><ul><li>数据体量大，但有大量相等数据<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≪</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \ll n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></li></ul></li></ul><h5 id="筛法">筛法</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Erathsthenes</span><span class="params">(Rank n, <span class="type">char</span> *file)</span> </span>&#123;</span><br><span class="line">    <span class="function">Bitmap <span class="title">B</span><span class="params">(n)</span></span>; B.<span class="built_in">set</span>(<span class="number">0</span>), B.<span class="built_in">set</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!B.<span class="built_in">test</span>(i)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Rank j = <span class="number">2</span> * i; j &lt; n; j+= i) &#123;</span><br><span class="line">                B.<span class="built_in">set</span>(j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    B.<span class="built_in">dump</span>(file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>内循环每趟迭代 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n / i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span> 步，由素数定理外循环至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>n</mi><mrow><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{n}{\ln n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 趟，累计耗时</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>+</mo><mfrac><mi>n</mi><mn>3</mn></mfrac><mo>+</mo><mfrac><mi>n</mi><mn>5</mn></mfrac><mo>+</mo><mo>⋯</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>&lt;</mo><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>+</mo><mfrac><mi>n</mi><mn>3</mn></mfrac><mo>+</mo><mfrac><mi>n</mi><mn>4</mn></mfrac><mo>+</mo><mo>⋯</mo><mo>+</mo><mfrac><mi>n</mi><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>=</mo><mspace width="1em"/></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>ln</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}&amp;\frac{n}{2} + \frac{n}{3} + \frac{n}{5} + \cdots \\ &lt; \quad &amp;\frac{n}{2} + \frac{n}{3} + \frac{n}{4} + \cdots + \frac{n}{n / \ln n} \\ = \quad &amp;O(n \cdot (\ln(n / \ln n) - 1)) = O(n \cdot \log n) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.93712em;vertical-align:-2.71856em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2185599999999996em;"><span style="top:-5.218559999999999em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"></span></span><span style="top:-3.125em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mrel">&lt;</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.0490000000000004em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.71856em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2185599999999996em;"><span style="top:-5.218559999999999em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span></span></span><span style="top:-3.125em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.0490000000000004em;"><span class="pstrut" style="height:3.1075600000000003em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.71856em;"><span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>常系数优化：内循环的起点可以改为 <code>i * i</code> ，外循环的终止条件可以改为 <code>i * i &lt; n</code></p></li></ul><h4 id="快速初始化">快速初始化</h4><ul><li><p>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">B[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> 拆分成一对等长向量</p><ul><li><code>F[k]</code> （初始）存储元素的插入顺序（可能发生变化，主要用来检验数据是否有效），同时也是 <code>T[]</code> 中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 对应的下标。<code>T[]</code> 用来存储元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></li></ul></li><li><p>每个有效元素满足 <code>T[F[k]] == k &amp;&amp; F[T[i]] = i</code> ，构成 <strong>校验环</strong></p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Rank F[m]; <span class="comment">// From</span></span><br><span class="line">Rank T[m], top = <span class="number">0</span>; <span class="comment">// To 及栈顶位置标记</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Bitmap::test</span><span class="params">(Rank k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (F[k] != <span class="number">-1</span>) &amp;&amp; (F[k] &lt; top) &amp;&amp; (k == T[F[k]]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Bitmap::reset</span><span class="params">()</span> </span>&#123; top = <span class="number">0</span>; &#125; <span class="comment">// O(1)复位</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Bitmap::set</span><span class="params">(Rank k)</span> </span>&#123; <span class="comment">// O(1)插入</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">test</span>(k)) &#123;</span><br><span class="line">        T[top] = k;</span><br><span class="line">        F[k] = top++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Bitmap::clear</span><span class="params">(Rank k)</span> </span>&#123; <span class="comment">// O(1)删除</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">test</span>(k) &amp;&amp; (--top)) &#123;</span><br><span class="line">        F[T[top]] = F[k];</span><br><span class="line">        T[F[k]] = T[top];</span><br><span class="line">    &#125; <span class="comment">// 相当于使用栈顶的元素顶替被删除的空位</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="列表">列表</h2><h3 id="循位置访问">循位置访问</h3><ul><li>列表（list）是采用 <strong>动态</strong> 储存策略的典型结构<ul><li>元素称为节点，通过引用或者指针彼此联接</li><li>在 <strong>逻辑上</strong> 构成一个线性序列，各元素的物理地址将不再决定逻辑次序</li><li>动态操作可以在局部完成，复杂度有望控制在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li><li>循位置访问：利用节点之间的相互引用，找到特定的节点<ul><li>如果按逻辑次序进行连续访问，单次也是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><code>call-by-position</code></li></ul></li></ul><h3 id="接口与实现">接口与实现</h3><h4 id="listnode">ListNode</h4><table><thead><tr><th>操作接口</th><th>功能</th></tr></thead><tbody><tr><td><code>pred()</code> / <code>succ()</code></td><td>当前节点的前驱/后继节点的位置</td></tr><tr><td><code>data()</code></td><td>当前节点所存数据对象</td></tr><tr><td><code>insertPred()</code> / <code>insertSucc()</code></td><td>插入前驱/后继节点，返回新节点位置</td></tr></tbody></table><h4 id="list-adt">List ADT</h4><table><thead><tr><th>操作接口</th><th>功能</th><th>适用对象</th></tr></thead><tbody><tr><td><code>size()</code> / <code>empty()</code></td><td>报告节点总数 / 判定是否为空</td><td>列表</td></tr><tr><td><code>first()</code> / <code>last()</code></td><td>返回首 / 末节点的位置</td><td>列表</td></tr><tr><td><code>insertFirst()</code> / <code>insertLast()</code></td><td>将 e 当作首 ／ 末节点插入</td><td>列表</td></tr><tr><td><code>insert(p, e)</code> / <code>insert(e, p)</code></td><td>将 e 当作节点 p 的 <strong>直接</strong> 后继、前驱插入</td><td>列表</td></tr><tr><td><code>remove(p)</code></td><td>删除节点 p</td><td>列表</td></tr><tr><td><code>sort(p, n)</code> / <code>sort()</code></td><td>区间 ／ 整体排序</td><td>列表</td></tr><tr><td><code>find(e, n, p)</code> / <code>search(e, n, p)</code></td><td>在指定区间内查找目标 e</td><td>列表 / 有序列表</td></tr><tr><td><code>dedup()</code> / <code>uniquify()</code></td><td>剔除相等的节点</td><td>列表 / 有序列表</td></tr><tr><td><code>traverse(visit())</code></td><td>遍历列表，统一按 <code>visit()</code> 处理所有节点</td><td>列表</td></tr></tbody></table><ul><li>可设置哨兵节点</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ListNodePosi&lt;T&gt; head, tail;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> List&lt;T&gt;::<span class="built_in">init</span>() &#123;</span><br><span class="line">    head = <span class="keyword">new</span> ListNode&lt;T&gt;;</span><br><span class="line">    tail = <span class="keyword">new</span> ListNode&lt;T&gt;;</span><br><span class="line">    </span><br><span class="line">    head-&gt;succ = tail; head-&gt;pred = null;</span><br><span class="line">    tail-&gt;pred = head; tail-&gt;succ = null;</span><br><span class="line">    _size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>动态储存策略带来的静态操作效率低下</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T&amp; List&lt;T&gt;::<span class="keyword">operator</span>[] (Rank r) <span class="type">const</span> &#123;</span><br><span class="line">    ListNodePosi&lt;T&gt; p = <span class="built_in">first</span>();</span><br><span class="line">    <span class="keyword">while</span> (r-- &gt; <span class="number">0</span>) p = p-&gt;succ;</span><br><span class="line">    <span class="keyword">return</span> p-&gt;data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="有序列表">有序列表</h3><h4 id="唯一化">唯一化</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank List&lt;T&gt;::<span class="built_in">uniquify</span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> (_size &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Rank oldSize = _size;</span><br><span class="line">    ListNodePost&lt;T&gt; p = <span class="built_in">first</span>(), q;</span><br><span class="line">    <span class="keyword">while</span> (tail != (q = p-&gt;<span class="built_in">succ</span>())) &#123; <span class="comment">// 反复考察紧邻节点对(p, q)</span></span><br><span class="line">        <span class="keyword">if</span> (p-&gt;data != q-&gt;data) p = q;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">remove</span>(q);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// O(n)</span></span><br></pre></td></tr></table></figure><h4 id="查找">查找</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; ListNodePost&lt;T&gt; List&lt;T&gt;::<span class="built_in">search</span>(T <span class="type">const</span> &amp;e, Rank n, ListNodePosi&lt;T&gt; p) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        p = p-&gt;pred; n--;</span><br><span class="line">    &#125; <span class="keyword">while</span> ((n != <span class="number">-1</span>) &amp;&amp; (e &lt; p-&gt;data));</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125; <span class="comment">// 在有序列表内节点 p 的 n 个真前驱中, 找到不大于 e 的最靠后者</span></span><br></pre></td></tr></table></figure><ul><li>最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ，最坏 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ；等概率时平均 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>不能借助有序性提高查找效率，因为无法高效实现秩的随机访问</li></ul><h3 id="选择排序">选择排序</h3><ul><li>起泡排序扫描交换的实质无非是<ul><li>通过比较找到当前的最大元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> ，并通过交换使其就位</li><li>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次交换完全没有必要</li></ul></li><li>在经 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次比较确定 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 后，仅需一次交换即可</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; ListNodePosi&lt;T&gt; List&lt;T&gt;::<span class="built_in">selectMax</span>(ListNodePosi&lt;T&gt; p, rank n) &#123;</span><br><span class="line">    ListNodePosi&lt;T&gt; max = p;</span><br><span class="line">    <span class="keyword">for</span> (ListNodePosi&lt;T&gt; cur = p; n &gt; <span class="number">1</span>; n--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!((cur = cur-&gt;succ)-&gt;data &lt; max-&gt;data))</span><br><span class="line">            max = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> List&lt;T&gt;::<span class="built_in">selectionSort</span>(ListNodePosi&lt;T&gt; p, Rank n) &#123;</span><br><span class="line">    ListNodePosi&lt;T&gt; h = p-&gt;pred;</span><br><span class="line">    ListNodePosi&lt;T&gt; t = p;</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; n; i++) t = t-&gt;succ;</span><br><span class="line">    <span class="comment">// 待排序区间为(h, t)</span></span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">insert</span>(<span class="built_in">remove</span>(<span class="built_in">selectMax</span>(h-&gt;succ, n)), t);</span><br><span class="line">        <span class="comment">// 可改为互换 data, 减少额外开销</span></span><br><span class="line">        t = t-&gt;pred; n--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>采用 <strong>平移法</strong>，可保证稳定性；每一组相等的元素，都保持输入时的相对次序</li><li>总体时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，主要来自于元素的比较操作</li></ul><h4 id="循环节">循环节</h4><ul><li>任何一个序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{A}[0,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，都可分解为若干个循环节<ul><li>元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathcal{A}[k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> 在序列对应的有序序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}[0, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 中的秩，记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="script">A</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r(\mathcal{A}[k]) = r(k) \in [0, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal">A</span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，其所属循环节为<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">(</mo><mo>…</mo><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k, r(k), r(r(k)), \dots, r(\dots (r(r(k))) \dots) = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mn>0</mn></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>r</mi><mn>1</mn></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mi>r</mi><mrow><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">r^0(k), r^1(k), r^2(k), \dots, r^{(d)}(k) = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">d</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></li></ul></li></ul></li><li>任意循环节长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">d \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ，循环节之间互不相交</li></ul><p>对于 <strong>交换法</strong> 选择排序</p><ul><li>每迭代一步，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 都会脱离原属的循环节，自成一个循环节<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 原属循环节，长度恰好减少一个单位；其他循环节保持不变</li></ul></li><li>多余的交换：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 已经就位，实际上无需交换<ul><li>最初有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 个循环节，则这种情况会出现 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 次（不计入最后一次迭代）<ul><li>若交换不多余，则循环节数量 +1</li></ul></li><li>最大值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ，期望 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h3 id="插入排序">插入排序</h3><ul><li>始终将序列视为两部分<ul><li>前缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S[0, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> ：有序</li><li>后缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false">[</mo><mi>r</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U[r, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ：待排序</li></ul></li><li>反复地，针对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">e = A[r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> ，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> 中查找适当位置，插入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> ++</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> List&lt;T&gt;::<span class="built_in">insertionSort</span>(ListNodePosi&lt;T&gt; p, Rank n) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Rank r = <span class="number">0</span>; r &lt; n; r++) &#123;</span><br><span class="line">        <span class="built_in">insert</span>(<span class="built_in">search</span>(p-&gt;data, r, p), p-&gt;data);</span><br><span class="line">        p = p-&gt;<span class="built_in">succ</span>(); <span class="built_in">remove</span>(p-&gt;pred);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// 就地算法</span></span><br></pre></td></tr></table></figure><ul><li>前缀总是保持有序且稳定</li><li>最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，最坏 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，平均（期望）<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>可 <strong>在线</strong> 执行</li></ul><h3 id="归并排序">归并排序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; ListNodePosi&lt;T&gt; List&lt;T&gt;::<span class="built_in">merge</span>(ListNodePosi&lt;T&gt; p, Rank n, List&lt;T&gt; &amp;L, ListNodePosi&lt;T&gt; q, Rank m) &#123;</span><br><span class="line">    ListNodePosi&lt;T&gt; pp = p-&gt;pred;</span><br><span class="line">    <span class="keyword">while</span> (m &gt; <span class="number">0</span> &amp;&amp; p != q) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span> &amp;&amp; p-&gt;data &lt;= q-&gt;data) &#123;</span><br><span class="line">            p = p-&gt;succ; n--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">insert</span>(L.<span class="built_in">remove</span>((q = q-&gt;succ)-&gt;pred), p); m--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pp-&gt;succ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> List&lt;T&gt;::<span class="built_in">mergeSort</span>(ListNodePosi&lt;T&gt; &amp;p, Rank n) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    ListNodePosi&lt;T&gt; q = p; Rank m = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; m; i++) q = q-&gt;succ;</span><br><span class="line">    <span class="built_in">mergeSort</span>(p, m); <span class="built_in">mergeSort</span>(q, n - m);</span><br><span class="line">    p = <span class="built_in">merge</span>(p, m, *<span class="keyword">this</span>, q, n - m);</span><br><span class="line">&#125; <span class="comment">// O(nlogn)</span></span><br></pre></td></tr></table></figure><h3 id="逆序对">逆序对</h3><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∥</mo><mo stretchy="false">{</mo><mn>0</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>A</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo><mo stretchy="false">∥</mo></mrow><annotation encoding="application/x-tex">\mathcal{I}(j) = \lVert \{ 0 \le i &lt; j \, | \, A[i] &gt; A[j]\} \rVert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mopen">{</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mclose">}</span><span class="mclose">∥</span></span></span></span></li><li>逆序对总数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mo>=</mo><mo>∑</mo><mi mathvariant="script">I</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo>≤</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>n</mi><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{I} = \sum \mathcal{I}(j) \le \binom{n}{2} = O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7453919999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul><h4 id="bubblesort">BubbleSort</h4><ul><li>在序列中交换一对紧邻的逆序元素，逆序对总数恰好减一</li><li>对于起泡排序而言，交换操作的次数恰等于输入序列所含逆序对总数</li></ul><h4 id="insertionsort">InsertionSort</h4><ul><li>每次迭代查找插入位置，恰好需要做 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{I}(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> 次比较</li><li>若序列共含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi></mrow><annotation encoding="application/x-tex">\mathcal{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span></span></span></span> 个逆序对，则<ul><li>关键码比较次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="script">I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\mathcal{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mclose">)</span></span></span></span></li><li>运行时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi mathvariant="script">I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + \mathcal{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span></span><span class="mclose">)</span></span></span></span></li></ul></li><li>若任意逆序对距离不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>，则复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo>⋅</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(k \cdot n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h4 id="计数">计数</h4><ul><li>朴素算法需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，借助归并排序仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h3 id="游标实现">游标实现</h3><ul><li>在一块连续的静态内存（数组）中，模拟出链表的动态链接特性</li><li>所需结构如下：<ul><li>一个结构数组或两个独立数组<ul><li><code>elem[]</code> ：存放数据元素的数组</li><li><code>link[]</code> ：存放“指针”的数组，称之为游标<ul><li><code>link[i]</code> 的值是 <code>elem[i]</code> 的后继元素所在的 <code>elem[]</code> 下标</li></ul></li></ul></li><li>两个 <strong>逻辑</strong> 上互补的链表<ul><li><code>data</code> ：存放当前存在的所有数据</li><li><code>free</code> ：存放所有当前空闲、可被分配的数组槽位</li></ul></li><li>两个“头指针”（头游标）<ul><li><code>dataHead</code> ：存储 <code>data</code> 链表的第一个元素所在的数组下标</li><li><code>freeHead</code> ：存储 <code>free</code> 链表的第一个可用槽位所在的数组下标</li></ul></li><li>空指针标记<ul><li>需要一个特殊值来表示链表的末尾（相当于 NULL），约定使用 <code>-1</code> 来表示</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000</span>;</span><br><span class="line"><span class="type">int</span> elem[N], link[N], data, free;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    free = <span class="number">0</span>, data = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N - <span class="number">1</span>; i++) link[i] = i + <span class="number">1</span>;</span><br><span class="line">    link[N - <span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="核心操作">核心操作</h4><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/PixPin_2025-12-16_15-44-51.png" alt="PixPin_2025-12-16_15-44-51" style="zoom: 67%;" /><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">allocNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (free == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> nw = free; free = link[free];</span><br><span class="line">    <span class="keyword">return</span> nw;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">freeNode</span><span class="params">(<span class="type">int</span> index)</span> </span>&#123;</span><br><span class="line">    link[index] = free; free = index;</span><br><span class="line">&#125; <span class="comment">// 将被释放的节点放入 free 链表头部</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123; <span class="comment">// 相当于在 data 链表头部插入</span></span><br><span class="line">    <span class="type">int</span> newIndex = <span class="built_in">allocNode</span>();</span><br><span class="line">    <span class="keyword">if</span> (newIndex == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    elem[newIndex] = value;</span><br><span class="line">    link[newIndex] = data;</span><br><span class="line">    data = newIndex;</span><br><span class="line">    <span class="keyword">return</span> newIndex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    <span class="keyword">for</span> (r = data; r != <span class="number">-1</span>; r = link[r]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (elem[r] == value) <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">remove</span><span class="params">(<span class="type">int</span> pos)</span> </span>&#123; <span class="comment">// 删除下标为 pos 的节点的后继节点</span></span><br><span class="line">    <span class="type">int</span> idx = link[pos];</span><br><span class="line">    <span class="keyword">if</span> (idx == <span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    link[pos] = link[idx]; <span class="comment">// 绕过删除目标</span></span><br><span class="line">    <span class="built_in">freeNode</span>(idx);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="栈和队列">栈和队列</h2><h3 id="栈">栈</h3><h4 id="接口与实现">接口与实现</h4><ul><li>栈（stack）是受限的序列<ul><li>只能在栈顶（top）插入和删除，栈底为盲端</li><li>后进先出（LIFO）</li></ul></li><li>可直接基于向量或者列表派生</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class</span> <span class="title class_">Stack</span> : <span class="keyword">public</span> Vector&lt;T&gt; &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(T <span class="type">const</span> &amp;e)</span> </span>&#123; <span class="built_in">insert</span>(e); &#125;</span><br><span class="line">    <span class="function">T <span class="title">pop</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">remove</span>(<span class="built_in">size</span>() - <span class="number">1</span>); &#125;</span><br><span class="line">    <span class="function">T &amp;<span class="title">top</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (*<span class="keyword">this</span>)[<span class="built_in">size</span>() - <span class="number">1</span>]; &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>以向量首端为栈底，末端为栈顶，由此实现的栈接口，均只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><ul><li>基于列表派生，也可只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="调用栈">调用栈</h4><ul><li>递归算法所需的空间主要取决于递归深度，而非递归实例总数</li></ul><h5 id="消除递归">消除递归</h5><ul><li>隐式地维护调用栈，需要花费额外的空间、时间；为此可<ul><li>显示地维护调用栈</li><li>将递归算法改写为迭代版本（改写尾递归）</li></ul></li><li>时间复杂度有常系数改进，空间复杂度 <strong>或有</strong> 渐近改进</li></ul><h4 id="进制转换">进制转换</h4><ul><li>短除法：对进制 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> 反复整除、留余，即可自低而高得出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> 进制的各位<ul><li>位数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>+</mo><mn>1</mn><mo>=</mo><mrow><mo fence="true">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>λ</mi></msub><mi>n</mi><mo fence="true">⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m + 1 = \left \lfloor \log_\lambda n \right \rfloor + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">convert</span><span class="params">(Stack&lt;<span class="type">char</span>&gt; &amp;S, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> n, <span class="type">int</span> base)</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> digit[] = <span class="string">&quot;0123456789ABCDEF&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        S.<span class="built_in">push</span>(digit[n % base]);</span><br><span class="line">        n /= base;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">main</span>() &#123;</span><br><span class="line">    Stack&lt;<span class="type">char</span>&gt; S;</span><br><span class="line">    (n &gt; <span class="number">0</span>) ? <span class="built_in">convert</span>(S, n, base) : S.<span class="built_in">push</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span> (!S.<span class="built_in">empty</span>()) S.<span class="built_in">pop</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="括号匹配">括号匹配</h4><ul><li>平凡：无括号的表达式是匹配的</li><li>为有效简化问题，需发现和借助 <strong>必要性</strong><ul><li>消去一对紧邻的左右括号，不影响全局的匹配判断<ul><li>顺序扫描表达式，用栈记录已扫描的部分</li><li>反复迭代：凡遇 <code>(</code> ，则进栈；凡遇 <code>)</code> ，则出栈</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">paren</span><span class="params">(<span class="type">const</span> <span class="type">char</span> exp[], Rank lo, Rank hi)</span> </span>&#123;</span><br><span class="line">    Stack&lt;<span class="type">char</span>&gt; S;</span><br><span class="line">    <span class="keyword">for</span> (Rank i = lo; i &lt; hi; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exp[i] != <span class="string">&#x27;(&#x27;</span>) S.<span class="built_in">push</span>(exp[i]);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!S.<span class="built_in">empty</span>()) S.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> S.<span class="built_in">empty</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>可推广至多种括号的情况</li></ul><h4 id="中缀表达式求值">中缀表达式求值</h4><blockquote><p>给定语法正确的算数表达式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span> ，计算与之对应的数值</p></blockquote><ul><li>减而治之：优先级高的局部表达式执行计算，并被代以其数值，运算符减少，直至得到最终结果</li><li>但仅根据表达式的前缀，不足以确定各运算符的计算次序<ul><li>为处理某一前缀，必须提前 <strong>预读并分析更长的前缀</strong></li><li>需借助某种支持延迟缓冲的机制</li></ul></li><li>求值算法 = 栈 + 线性扫描</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> pri[N_OPTR][N_OPTR] = &#123;</span><br><span class="line"><span class="comment">// 运算法优先等级 [栈顶][当前]</span></span><br><span class="line">    <span class="comment">// &#x27;&lt;&#x27;: 栈顶运算符优先级更低, 当前运算符进栈</span></span><br><span class="line">    <span class="comment">// &#x27;&gt;&#x27;: 时机已到, 可以进行计算</span></span><br><span class="line">    <span class="comment">// &#x27;~&#x27;: 部分计算结束</span></span><br><span class="line">    <span class="comment">// &#x27; &#x27;: padding</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">evaluate</span><span class="params">(<span class="type">char</span> *S, <span class="type">char</span> *RPN)</span> </span>&#123;</span><br><span class="line">    Stack&lt;<span class="type">double</span>&gt; opnd; Stack&lt;<span class="type">char</span>&gt; optr; <span class="comment">// 运算数栈和运算符栈</span></span><br><span class="line">    optr.<span class="built_in">push</span>(<span class="string">&#x27;\0&#x27;</span>); <span class="comment">// 哨兵</span></span><br><span class="line">    <span class="keyword">while</span> (!optr.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(*S)) &#123;</span><br><span class="line">            <span class="built_in">readNumber</span>(S, opnd);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 若为运算符</span></span><br><span class="line">            <span class="comment">// 视其与栈顶运算符之间优先级的高低分别处理</span></span><br><span class="line">            <span class="keyword">switch</span>(<span class="built_in">priority</span>(optr.<span class="built_in">top</span>(), *S)) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">                    optr.<span class="built_in">push</span>(*S);</span><br><span class="line">                    S++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">                    <span class="type">char</span> op = optr.<span class="built_in">pop</span>();</span><br><span class="line">                    <span class="keyword">if</span> (op != <span class="string">&#x27;!&#x27;</span>) &#123; <span class="comment">// 一元运算符</span></span><br><span class="line">                        opnd.<span class="built_in">push</span>(<span class="built_in">calcu</span>(op, opnd.<span class="built_in">pop</span>()));</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="type">double</span> opnd2 = opnd.<span class="built_in">pop</span>(), opnd1 = opnd.<span class="built_in">pop</span>();</span><br><span class="line">                        opnd.<span class="built_in">push</span>(<span class="built_in">calcu</span>(opnd1, op, opnd2));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">                    <span class="comment">// pri [&#x27;(&#x27;][&#x27;)&#x27;] = pri [&#x27;\0&#x27;][&#x27;\0&#x27;] = &#x27;~&#x27;</span></span><br><span class="line">                    optr.<span class="built_in">pop</span>();</span><br><span class="line">                    S++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>: <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> opnd.<span class="built_in">pop</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="逆波兰表达式">逆波兰表达式</h4><h5 id="定义和求值">定义和求值</h5><ul><li><p>Reverse Polish Notation，在由运算符（operator）和操作数（operand）组成的表达式中，不使用括号，即可表示带优先级的运算关系</p></li><li><p>相较于日常使用的中缀式（infix），RPN 亦称作后缀式（postfix）</p></li><li><p>作为补偿，须额外引入一个起分隔作用的原字符（如空格）</p><ul><li>相较原表达式，长度未必更短</li></ul></li><li><p>栈式求值（不会检查式子合法性）</p><ul><li>引入栈 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span> （存放操作数）</li><li>逐个处理下一元素 x<ul><li>若 x 是操作数，则将其压入 S</li><li>否则（运算符无序缓冲）<ul><li>从 S 中弹出 x 所需数目的操作数</li><li>进行运算，结果压入 S</li></ul></li></ul></li><li>返回栈顶结果</li></ul></li></ul><h5 id="转换">转换</h5><ul><li><p>手工转换</p><ul><li>为每一个运算添加括号</li><li>以运算符替换右括号，并清除对应左括号</li></ul></li><li><p>自动转换</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">double</span> <span class="title">evaluate</span><span class="params">(<span class="type">char</span> *S, <span class="type">char</span> *RPN)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">    <span class="keyword">while</span> (!optr.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(*S)) &#123;</span><br><span class="line">            <span class="built_in">readNumber</span>(S, pond);</span><br><span class="line">            <span class="built_in">append</span>(RPN, opnd.<span class="built_in">top</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span>(<span class="built_in">priority</span>(optr.<span class="built_in">top</span>(), *S)) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">                    <span class="comment">// 若可立即计算, 则在执行计算同时将其接入 RPN</span></span><br><span class="line">                    <span class="type">char</span> op = optr.<span class="built_in">pop</span>();</span><br><span class="line">                    <span class="built_in">append</span>(RPN, op);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* ... */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="栈混洗">栈混洗</h4><blockquote><ul><li>考察栈 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><mo stretchy="false">]</mo><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="script">B</mi><mo>=</mo><mi mathvariant="script">S</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\mathcal{A} = \left \langle a_1, a_2, \dots, a_n \right.], \quad \mathcal{B} = \mathcal{S} = \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">A</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">∅</span></span></span></span></li><li>只允许<ul><li>将 A 的顶元素弹出并压入 S</li><li>将 S 的顶元素弹出并压入 B</li></ul></li><li>经一系列上述操作，A 中元素全部转入 B 中<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">B</mi><mo>=</mo><mo stretchy="false">[</mo><mrow><msub><mi>a</mi><msub><mi>k</mi><mn>1</mn></msub></msub><mo separator="true">,</mo><msub><mi>a</mi><msub><mi>k</mi><mn>2</mn></msub></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><msub><mi>k</mi><mi>n</mi></msub></msub><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{B} = [\left. a_{k_1}, a_{k_2}, \dots, a_{k_n} \right \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mopen">[</span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03148em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> 则称为 A 的一个栈混洗</li></ul></li></ul></blockquote><h5 id="计数">计数</h5><ul><li><p>同一输入序列，可有多种栈混洗</p><ul><li>对于长度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的序列，混洗总数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>P</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">SP(n) \le n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mclose">!</span></span></span></span></li></ul></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>P</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">SP(1) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p></li><li><p>考查 S 再度变空（A 首元素从 S 中弹出）的时刻，无非 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 种情况</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mi>P</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>S</mi><mi>P</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>S</mi><mi>P</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>Catalan</mtext><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mo>⋅</mo><mi>n</mi><mo stretchy="false">!</mo></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} SP(n) &amp;= \sum_{k = 1}^n SP(k - 1) \cdot SP(n - k) \\ &amp;=\text{Catalan}(n) = \frac{(2n)!}{(n + 1)! \cdot n!} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.916510000000001em;vertical-align:-2.7082550000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2082550000000003em;"><span style="top:-5.208255em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-2.179142em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7082550000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2082550000000003em;"><span style="top:-5.208255em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-2.179142em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord text"><span class="mord">Catalan</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">n</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">!</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7082550000000003em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><h5 id="甄别">甄别</h5><blockquote><p>输入序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">⟨</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\left \langle 1, 2, 3, \dots, n \right.]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span> 的任一排列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>3</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>p</mi><mi>n</mi></msub><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">[\left. p_1, p_2, p_3, \dots, p_n \right \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> 是否为栈混洗？</p></blockquote><ul><li><p>禁形：对任何 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi><mo>≤</mo><mi>n</mi><mo separator="true">,</mo><mspace width="1em"/><mo stretchy="false">[</mo><mrow><mo>…</mo><mo separator="true">,</mo><mi>k</mi><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">1 \le i &lt; j &lt; k \le n, \quad [\left. \dots, k, \dots, i, \dots, j, \dots \right \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">[</span><span class="minner"><span class="mopen nulldelimiter"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> 必非栈混洗</p></li><li><p>不存在 <code>“312(915)”</code> 模式的序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\iff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span> 是栈混洗，可得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的甄别算法</p></li><li><p>进一步，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>p</mi><mi>n</mi></msub><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">[\left. p_1, p_2, \dots, p_n \right \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">⟨</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\left \langle 1, 2, \dots, n \right.]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span> 的栈混洗，当且仅当</p><p>对于任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i &lt; j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> ，不含模式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mrow><mo>…</mo><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">[\left. \dots, j + 1, \dots, i, \dots, j, \dots \right \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="minner"><span class="mopen nulldelimiter"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> （615）</p><ul><li>如此可得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 算法：借助栈 A、B 和 S，直接模拟栈混洗过程</p><ul><li>逐个检视各目标元素<ul><li>若在（或能腾挪至）S 顶部，则继续</li><li>否则（在 S 中，却非栈顶，无法洗出）失败</li></ul></li></ul></li></ul><h5 id="总结">总结</h5><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Catalan</mtext><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Catalan}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Catalan</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 的情况总结</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个元素栈混洗（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次 <code>push</code> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次 <code>pop</code> 对应的合法操作序列数）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 对匹配的括号的可能情况数</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点二叉树的形态</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点互异的 BST 的种类</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个 <strong>叶节点</strong>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个内部节点）的真二叉树的形态</li><li>中序遍历是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>∼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的二叉树的全部后序遍历序列数（先序遍历是入栈序列，后序遍历是出栈序列）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个节点的有序多叉树（对应一棵唯一的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 节点二叉树）采用“长子-兄弟表示法”得到二叉树形态数</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个顶点的凸多边形进行三角剖分的方案数</li><li>圆上 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault">n</span></span></span></span> 个点连接 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 条不相交弦的方法数</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 网格中不越过对角线的 Dyck 路径数</li></ul><h3 id="队列">队列</h3><h4 id="接口与实现">接口与实现</h4><ul><li>队列（queue）也是受限的序列</li><li>只能在队尾插入（查询）<ul><li><code>enqueue()</code> / <code>rear()</code></li></ul></li><li>只能在队头删除（查询）<ul><li><code>dequeue()</code> / <code>front()</code></li></ul></li><li>先进先出（FIFO）</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">class</span> <span class="title class_">Queue</span> : <span class="keyword">public</span> List&lt;T&gt; &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">enqueue</span><span class="params">(T <span class="type">const</span> &amp;e)</span> </span>&#123; <span class="built_in">insertLast</span>(e); &#125;</span><br><span class="line">    <span class="function">T <span class="title">dequeue</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">remove</span>(<span class="built_in">first</span>()); &#125;</span><br><span class="line">    <span class="function">T &amp;<span class="title">front</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">first</span>()-&gt;data; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>如此实现的队列接口，均只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间<ul><li>基于向量派生也是如此</li></ul></li></ul><h4 id="队列应用">队列应用</h4><ul><li>资源循环分配</li><li>银行服务模拟</li></ul><h3 id="直方图内最大矩形">直方图内最大矩形</h3><ul><li>对每个位置 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> ，计算<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>k</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mn>0</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>r</mi><mo>∩</mo><mi>H</mi><mo stretchy="false">[</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>&lt;</mo><mi>H</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">s(r) = \max\{k \, | \, 0 \le k \le r \cap H[k - 1] &lt; H[r]\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.55556em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mclose">}</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>k</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>r</mi><mo>&lt;</mo><mi>k</mi><mo>≤</mo><mi>n</mi><mo>∩</mo><mi>H</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>H</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">t(r) = \min\{k \, | \, r &lt; k \le n \cap H[r] &gt; H[k]\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.55556em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mclose">}</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>n</mi><mi>s</mi><mi>w</mi><mi>e</mi><mi>r</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>H</mi><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>−</mo><mi>s</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">answer = \max\{H[r] \cdot (t(r) - s(r))\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></li><li>可以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 暴力计算，也可使用 <strong>单调栈</strong> 通过两次线性扫描得出</li></ul></li><li>若要优化至一次扫描，则可使用单调栈 S 维持高度 H 的单调递增<ul><li>若栈空或 <code>H[t] &lt; H[S.top()]</code> ，则直接压栈</li><li>否则，不断弹栈，直到将当前高度压栈后可保持单调性；同时在这过程中不断计算更新面积最大值</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Stack&lt;Rank&gt; SR; <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> maxRect = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (Rank t = <span class="number">0</span>; t &lt;= n; t++) &#123; <span class="comment">// 循环到 n(哨兵)</span></span><br><span class="line">    <span class="keyword">while</span> (!SR.<span class="built_in">empty</span>() &amp;&amp; (t == n || H[SR.<span class="built_in">top</span>()] &gt; H[t])) &#123;</span><br><span class="line">        Rank r = SR.<span class="built_in">pop</span>(), s = SR.<span class="built_in">empty</span>() ? <span class="number">0</span> : SR.<span class="built_in">top</span>() + <span class="number">1</span>;</span><br><span class="line">        maxRect =  <span class="built_in">max</span>(maxRect, (t - s) * H[r]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (t &lt; n) SR.<span class="built_in">push</span>(t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxRect;</span><br></pre></td></tr></table></figure><h3 id="steap">Steap</h3><ul><li><code>Steap = Stack + Heap = push + pop +getMax = S + P</code></li><li>P 中每个元素，都是 S 中对应前缀的最大者</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Steap::<span class="built_in">getMax</span>() &#123; <span class="keyword">return</span> P.<span class="built_in">top</span>(); &#125;</span><br><span class="line">Steap::<span class="built_in">pop</span>() &#123; P.<span class="built_in">pop</span>(); <span class="keyword">return</span> S.<span class="built_in">pop</span>(); &#125;</span><br><span class="line">Steap::<span class="built_in">push</span>() &#123; P.<span class="built_in">push</span>(<span class="built_in">max</span>(e, P.<span class="built_in">top</span>())); S.<span class="built_in">push</span>(e); &#125;</span><br></pre></td></tr></table></figure><ul><li>可对 P 升级：使用计数器而不用保存过多重复元素</li></ul><h3 id="queap">Queap</h3><ul><li><code>Queap = Queue + Heap = enqueue + dequeue + getMax = Q + P</code></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Queap::<span class="built_in">dequeue</span>() &#123; P.<span class="built_in">dequeue</span>(); <span class="keyword">return</span> Q.<span class="built_in">dequeue</span>(); &#125;</span><br><span class="line">Queap::<span class="built_in">enqueue</span>() &#123; <span class="comment">// 最坏 O(n)</span></span><br><span class="line">    Q.<span class="built_in">enqueue</span>(e); P.<span class="built_in">enqueue</span>(e);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> x = P.<span class="built_in">rear</span>(); x &amp;&amp; (e &gt;= x-&gt;key); x = x-&gt;pred) &#123;</span><br><span class="line">        x-&gt;key = e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>同样可对 P 维护一个计数器</li></ul><h3 id="双栈当队">双栈当队</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Q</span>.enqueue(e):</span><br><span class="line">    R.push(e)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Q</span>.dequeue():</span><br><span class="line">    <span class="keyword">if</span> F.empty():</span><br><span class="line">        <span class="keyword">while</span> !R.empty():</span><br><span class="line">            F.push(R.pop())</span><br><span class="line">    <span class="keyword">return</span> F.pop()</span><br></pre></td></tr></table></figure><ul><li>均摊复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1) / O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul><h2 id="二叉树">二叉树</h2><h3 id="概述">概述</h3><ul><li>动机<ul><li>层次结构的表示</li><li>兼具 <code>Vector</code> 和 <code>List</code> 的优点，兼顾高效的查找、插入、删除</li><li>不再是简单的线性结构，<ul><li>但确定某种次序后，具有线性特征</li></ul></li></ul></li></ul><h4 id="有根树">有根树</h4><blockquote><p>树是极小连通图、极大无环图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">;</mo><mtext> </mtext><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{T} = (V; \, E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></p><ul><li>节点数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>V</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">n = \left\vert V \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> ，边数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>E</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">e = \left\vert E \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></li><li>删边不连通，加边必成环</li></ul></blockquote><ul><li>指定任一节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">r \in V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span> 作为根后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span></span></span></span> 即称作有根树</li><li>相对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 称作以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为根的子树，记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mi>i</mi></msub><mo>=</mo><mtext>subtree</mtext><mo stretchy="false">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{T}_i = \text{subtree}(r_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">subtree</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul><h4 id="有序树">有序树</h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 称作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> 的孩子，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 之间互称兄弟</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mtext>degree</mtext><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d = \text{degree}(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">degree</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> 的（出）度<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow></msub><mtext>degree</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e = \sum_{v \in V} \text{degree}(v) = n - 1 = \Theta(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">degree</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>若指定 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span></span></span></span> 的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 棵子树，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> 的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 个孩子，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span></span></span></span> 称作有序树</li></ul><h4 id="深度">深度</h4><ul><li>路径长度即为所含边数<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><mi>π</mi><mo fence="true">∣</mo></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo fence="true">∣</mo></mrow><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\left\vert \pi \right\vert = \left\vert \{(v_0, v_1), (v_1, v_2), \dots, (v_{k - 1}, v_k)\} \right\vert = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">}</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></li><li>环路：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_0 = v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ul></li><li>任一节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 与根之间存在唯一路径<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>path</mtext><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>path</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{path}(v, r) = \text{path}(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">path</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">path</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></li><li>该路径上节点，均为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的祖先</li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的深度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>depth</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">∣</mo><mtext>path</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\text{depth}(v) = \left\vert \text{path}(v) \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">depth</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord text"><span class="mord">path</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span><ul><li>根节点是所有节点的公共祖先，深度为 0</li></ul></li><li>没有后代的节点称作叶子节点<ul><li>所有叶子 <strong>深度</strong> 中的最大者称作（子）树的高度<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>height</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>height</mtext><mo stretchy="false">(</mo><mtext>subtree</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{height}(v) = \text{height}(\text{subtree}(v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">height</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">height</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">subtree</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>空树高度为-1</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>depth</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mtext>height</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>≤</mo><mtext>height</mtext><mo stretchy="false">(</mo><mi mathvariant="script">T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{depth}(v) + \text{height}(v) \le \text{height}(\mathcal{T})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">depth</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">height</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">height</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><h3 id="二叉树">二叉树</h3><blockquote><p>节点度数不超过 2，孩子可以左、右区分（隐含有序）</p></blockquote><ul><li>有根且有序的多叉树，可以转化表示为二叉树<ul><li>长子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 左孩子</li><li>兄弟 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 右孩子</li></ul></li></ul><h4 id="基数">基数</h4><blockquote><p>设度数为 0、1 和 2 的节点，各有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">n_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 个</p></blockquote><ul><li>边数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e = n - 1 = n_1 + 2 n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>叶节点数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_0 = n_2 + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul><h5 id="真二叉树">真二叉树</h5><blockquote><p>所有节点度数均为偶数（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n_1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>）</p></blockquote><ul><li>所有二叉树均可通过引入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>n</mi><mn>0</mn></msub><mo>+</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">2 n_0 + n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 个 <strong>外部节点</strong> 转换为二叉树<ul><li><strong>原有</strong> 节点度数统一为 2</li></ul></li><li>转换之后，全树复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 并未实质增加<ul><li>但简化了描述、实现、分析</li></ul></li><li>节点总数为奇数，树的最大高度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{n - 1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul><h4 id="满树">满树</h4><ul><li>深度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的节点，至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span> 个</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点、高 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 的二叉树满足：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>+</mo><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h + 1 \le n \le 2^{h + 1} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9324379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>h</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n = h + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ：退化为单链</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n = 2^{h + 1} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9324379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ：即为满二叉树</li></ul></li></ul><h3 id="模版类和实现">模版类和实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> BinNodePosi = BinNode&lt;T&gt;*;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">struct</span> <span class="title class_">BinNode</span> &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; parent, lc, rc;</span><br><span class="line">    T data; Rank height, npl; RBColor color; <span class="comment">// 数据, 高度, null path length, 颜色</span></span><br><span class="line">    <span class="function">Rank <span class="title">size</span><span class="params">()</span></span>; <span class="function">Rank <span class="title">updateHeight</span><span class="params">()</span></span>; <span class="function"><span class="type">void</span> <span class="title">updateHeightAbove</span><span class="params">()</span></span>; <span class="comment">// 更新规模, 高度</span></span><br><span class="line">    </span><br><span class="line">    <span class="function">BinNodePosi&lt;T&gt; <span class="title">insertLc</span><span class="params">(T <span class="type">const</span> &amp;)</span></span>;</span><br><span class="line">    <span class="function">BinNodePosi&lt;T&gt; <span class="title">insertRc</span><span class="params">(T <span class="type">const</span> &amp;)</span></span>;</span><br><span class="line">    <span class="function">BinNodePosi&lt;T&gt; <span class="title">succ</span><span class="params">()</span></span>; <span class="comment">// (中序遍历意义下)当前节点的直接后继</span></span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="先序遍历">先序遍历</h3><blockquote><p>遍历：按照某种次序访问树中各节点，每个节点被访问恰好一次</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250922222653826.png" alt="image-20250922222653826"></p><h4 id="递归实现">递归实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt; <span class="type">void</span> <span class="title">traverse</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;lc, visit);</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;rc, visit);</span><br><span class="line">&#125; <span class="comment">// O(n)</span></span><br></pre></td></tr></table></figure><h4 id="迭代实现">迭代实现</h4><ul><li>藤 = 起始于根的 <strong>左侧</strong> 通路 = 长子通路<ul><li>沿着藤，整个遍历过程可被分为<ul><li>自上而下访问藤上节点</li><li>再自下而上遍历各右子树</li></ul></li><li>各右子树的遍历彼此独立，自成一个子任务</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt; <span class="type">static</span> <span class="type">void</span> <span class="title">visitAlongVine</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit, Stack&lt;BinNodePosi&lt;T&gt;&gt; &amp;S)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">        <span class="keyword">if</span> (x-&gt;rc) S.<span class="built_in">push</span>(x-&gt;rc);</span><br><span class="line">        x = x-&gt;lc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt; <span class="type">void</span> <span class="title">travPre_I2</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit)</span> </span>&#123;</span><br><span class="line">    Stack&lt;BinNodePosi&gt; S;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">visitAlongVine</span>(x, visit, S);</span><br><span class="line">        <span class="comment">// 访问子树 x 的藤蔓, 各右子树(根)入栈缓冲</span></span><br><span class="line">        <span class="keyword">if</span> (S.<span class="built_in">empty</span>()) <span class="keyword">break</span>;</span><br><span class="line">        x = S.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="中序遍历">中序遍历</h3><blockquote><p>整个树结构向下投影即为中序遍历序列</p></blockquote><h4 id="递归实现">递归实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">traverse</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;lc, visit);</span><br><span class="line">    <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;rc, visit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="迭代实现">迭代实现</h4><ul><li>沿藤分解，遍历过程可 <strong>自底向上</strong> 分解为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 步迭代<ul><li>访问藤上节点，再遍历其右子树</li></ul></li><li>各右子树的遍历彼此独立，自成一个 <strong>子任务</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> <span class="type">void</span> <span class="title">goAloneVine</span><span class="params">(BinNodePosi&lt;T&gt; x, Stack&lt;BinNodePosi&lt;T&gt;&gt; &amp;S)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        S.<span class="built_in">push</span>(x);</span><br><span class="line">        x = x-&gt;lc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt; <span class="type">void</span> <span class="title">travIn_I1</span><span class="params">(BinNodePosi&lt;T&gt; x, V &amp;visit)</span> </span>&#123;</span><br><span class="line">    Stack&lt;BinNodePosi&lt;T&gt;&gt; S;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">goAloneVine</span>(x, S);</span><br><span class="line">        <span class="keyword">if</span> (S.<span class="built_in">empty</span>()) <span class="keyword">break</span>;</span><br><span class="line">        x = S.<span class="built_in">pop</span>(); <span class="comment">// 此时 x 的左子树为空, 或已遍历</span></span><br><span class="line">        <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">        x = x-&gt;rc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="直接后继">直接后继</h4><ul><li><p>简明遍历</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (BinNodePosi&lt;T&gt; t = <span class="built_in">first</span>(); t; t = t-&gt;<span class="built_in">succ</span>()) &#123; <span class="comment">/* ... */</span> &#125;</span><br></pre></td></tr></table></figure><ul><li>若节点有右孩子，则直接后继为最靠左的右后代</li><li>否则，其直接后继为最低的左祖先</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; BinNode&lt;T&gt;::<span class="built_in">succ</span>() &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; s = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">if</span> (rc) &#123;</span><br><span class="line">        s = rc;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">HasLChild</span>(s)) s = s-&gt;lc;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isRChild</span>(s)) s = s-&gt;parent;</span><br><span class="line">        s = s-&gt;parent;</span><br><span class="line">    &#125; <span class="comment">// 两种情况均为 O(h)</span></span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt; <span class="type">void</span> <span class="title">travIn_I4</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">HasLChild</span>(x)) x = x-&gt;lc;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">            <span class="keyword">while</span> (!<span class="built_in">HasRChild</span>(x)) &#123; <span class="comment">// 不断在无右分支处回溯到直接后继</span></span><br><span class="line">                <span class="keyword">if</span> (!(x = x-&gt;<span class="built_in">succ</span>())) <span class="keyword">return</span>;</span><br><span class="line">                <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">            &#125;</span><br><span class="line">            x = x-&gt;rc;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// O(n), 每条边被经过的次数 &lt;= 2</span></span><br></pre></td></tr></table></figure><p>实际上，在由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点构成的二叉树中，将任意节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 之间的距离取作二者之间那条唯一通路的长度，记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∣</mo><mi>u</mi><mi>v</mi><mo fence="true">∣</mo></mrow><annotation encoding="application/x-tex">\left\vert uv \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span>。若二叉树的先序/中序/后序遍历序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>v</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{v_0,v_1,v_2,\dots,v_{n-1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，则有：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><msub><mi>v</mi><mn>0</mn></msub><msub><mi>v</mi><mn>1</mn></msub><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><msub><mi>v</mi><mn>1</mn></msub><msub><mi>v</mi><mn>2</mn></msub><mo fence="true">∣</mo></mrow><mo>+</mo><mo>⋯</mo><mo>+</mo><mrow><mo fence="true">∣</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><msub><mi>v</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><msub><mi>v</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>v</mi><mn>0</mn></msub><mo fence="true">∣</mo></mrow><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left\vert v_0v_1 \right\vert + \left\vert v_1v_2 \right\vert + \dots + \left\vert v_{n-2}v_{n-1} \right\vert + \left\vert v_{n-1}v_0 \right\vert = 2(n-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><h3 id="后序遍历">后序遍历</h3><h4 id="递归实现">递归实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">traverse</span><span class="params">(BinNodePosi&lt;T&gt; x, VST &amp;visit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;lc, visit);</span><br><span class="line">    <span class="built_in">traverse</span>(x-&gt;rc, visit);</span><br><span class="line">    <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="迭代实现">迭代实现</h4><ul><li><p>目标是逐次访问当前的最靠左的叶子节点</p></li><li><p>沿藤分解，从根出发下行 <strong>尽可能沿左分支</strong>，实不得已才沿右分支</p><ul><li>最后一个节点必是叶子，也是中序次序中最靠左的叶子</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> <span class="type">void</span> <span class="title">gotoLeftmostLeaf</span><span class="params">(Stack&lt;BinNodePosi&lt;T&gt;&gt; &amp;S)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (BinNodePosi&lt;T&gt; x = S.<span class="built_in">top</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">HasLChild</span>(x)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">HasRChild</span>(x)) &#123;</span><br><span class="line">                S.<span class="built_in">push</span>(x-&gt;rc); <span class="comment">// 若有右孩子, 优先入栈</span></span><br><span class="line">            &#125;</span><br><span class="line">            S.<span class="built_in">push</span>(x-&gt;lc);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            S.<span class="built_in">push</span>(x-&gt;rc); <span class="comment">// 转向右分支</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    S.<span class="built_in">pop</span>(); <span class="comment">// 返回之前，弹出栈顶的空节点</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">travPost_I</span><span class="params">(BinNodePosi&lt;T&gt; x, V &amp;visit)</span> </span>&#123;</span><br><span class="line">    Stack&lt;BinNodePosi&lt;T&gt;&gt; S;</span><br><span class="line">    <span class="keyword">if</span> (x) S.<span class="built_in">push</span>(x); <span class="comment">// 根节点最后访问</span></span><br><span class="line">    <span class="keyword">while</span> (!S.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (S.<span class="built_in">top</span>() != x-&gt;parent) &#123;</span><br><span class="line">            <span class="built_in">gotoLeftmostLeaf</span>(S); <span class="comment">// 寻找右兄子树中的左叶子</span></span><br><span class="line">        &#125;</span><br><span class="line">        x = S.<span class="built_in">pop</span>(); <span class="comment">// 此时以 x 为根的子树仅剩 x 还未访问</span></span><br><span class="line">        <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="表达式树">表达式树</h4><ul><li>Expression Tree <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> Postorder <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> RPN</li></ul><blockquote><p>由 RPN 转表达式树：</p><ul><li>从左至右依次遍历<ul><li>操作数则形成叶子节点压入栈中</li><li>操作符则弹出相应数目节点组成子树，再入栈</li></ul></li></ul></blockquote><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250923153249784.png" alt="image-20250923153249784"></p><h3 id="层次遍历">层次遍历</h3><h4 id="实现">实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> VST&gt;</span><br><span class="line"><span class="type">void</span> BinNode&lt;T&gt;::<span class="built_in">travLevel</span>(VST &amp;visit) &#123;</span><br><span class="line">    <span class="comment">// 使用辅助队列</span></span><br><span class="line">    Queue&lt;BinNodePosi&lt;T&gt;&gt; Q; Q.<span class="built_in">enqueue</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        BinNodePosi&lt;T&gt; x = Q.<span class="built_in">dequeue</span>();</span><br><span class="line">        <span class="built_in">visit</span>(x-&gt;data);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">HasLChild</span>(x)) Q.<span class="built_in">enqueue</span>(x-&gt;lc);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">HasRChild</span>(x)) Q.<span class="built_in">enqueue</span>(x-&gt;rc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="完全二叉树">完全二叉树</h4><ul><li><p>叶节点仅限于最低两层</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>h</mi></msup><mo>≤</mo><mi>n</mi><mo>&lt;</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^h \le n &lt; 2^{h + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.985078em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></li><li>底层叶子，均居于次底层叶子 <strong>左侧</strong>（相较于它们的 LCA）</li><li>除末节点的父亲，其余 <strong>内部节点</strong> 均有两个孩子</li></ul></li><li><p>叶节点数目不致少于内部节点，且至多多出一个</p></li><li><p>此时考察层次遍历的迭代过程</p><ul><li><p>前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">⌈</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo fence="true">⌉</mo></mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\left \lceil n / 2 \right \rceil - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose delimcenter" style="top:0em;">⌉</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 步迭代中，均有右孩子入队</p><p>前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">⌊</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo fence="true">⌋</mo></mrow><annotation encoding="application/x-tex">\left \lfloor n / 2 \right \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌊</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span></span></span></span> 步迭代中，均有左孩子入队</p><p>累计至少 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 次入队</p></li><li><p>辅助队列规模先增后减，单峰且对称</p><ul><li>最大规模 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">⌈</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo fence="true">⌉</mo></mrow><annotation encoding="application/x-tex">\left \lceil n / 2 \right \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌈</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">2</span><span class="mclose delimcenter" style="top:0em;">⌉</span></span></span></span></span> ，可能出现两次</li></ul></li></ul></li><li><p>一棵完全二叉树 = 根 + 一棵完全二叉（子）树 + 一棵满二叉（子）树</p><ul><li>可借助向量结构，实现紧凑存储和高效访问</li></ul></li></ul><h3 id="重构">重构</h3><ul><li>由 [ 先序 | 后序 | 层次 ] + 中序可确定一棵树的形态<ul><li>原理在于前者可以确定根，后者可以由根将左右子树区分开</li></ul></li><li>由 [ 先序 + 后序 ] 则无法确定形态<ul><li>但如果二叉树是真二叉树，则可以</li></ul></li><li>在无法确定树的几何结构的情况下<ul><li>[ 后序 + 层次 ] 可以得出唯一的先序遍历序列</li><li>[ 先序 + 后序 ] 可以得出唯一的层次遍历序列</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250923160458769.png" alt="image-20250923160458769"></p><h4 id="增强序列">增强序列</h4><ul><li>将每个 NULL 也看作真实节点，并在遍历时输出约定的元字符（如“^”）<ul><li>可归纳证明，在增强的先序、后序遍历序列中<ul><li>任一子树依然对应一个子序列，并且</li><li>其中 NULL 节点恰好比非 NULL 节点多一（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_0 = n_2 + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>）</li></ul></li><li>可以对增强序列分而治之，重构出原树<ul><li>但是增强的中序遍历序列无法重构</li><li>增强的层次遍历序列可以重构</li></ul></li></ul></li></ul><h3 id="huffman-编码树">Huffman 编码树</h3><h4 id="二进制编码">二进制编码</h4><ul><li>组成数据文件的字符来自字符集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Σ</span></span></span></span></li><li>字符被赋予 <strong>互异</strong> 的二进制串</li></ul><h5 id="pfc-编码">PFC 编码</h5><ul><li><code>Prefix-Free Code</code>，为了避免某字符的编码恰是另一字符编码的前缀</li><li>二叉编码树<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Σ</span></span></span></span> 中的每个字符 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>，对应于二叉树的叶节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></li><li>x 的编码串由根到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> 的通路决定，向左、向右分别对应 0、1</li><li>如此自然保证了 Prefix-Free</li></ul></li><li>效率度量：平均编码长度<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ald</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi></mrow></msub><mtext>depth</mtext><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Σ</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\text{ald}(T) = \sum_{x \in \Sigma} \text{depth}(v(x)) / \left\vert \Sigma \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">ald</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight">Σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">depth</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Σ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></li></ul></li></ul><h4 id="最优编码树">最优编码树</h4><ul><li>叶子只能出现在倒数两层以内——否则，通过节点交换一定可以更优<ul><li><strong>真</strong> 完全树即为最优编码树</li></ul></li></ul><h5 id="带权编码">带权编码</h5><ul><li><p>各字符的期望频率已知，则</p><ul><li>文件长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∝</mo></mrow><annotation encoding="application/x-tex">\propto</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mrel">∝</span></span></span></span> 平均带权深度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>wald</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mi>x</mi></msub><mi>r</mi><mi>p</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>×</mo><mi>w</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{wald}(T) = \sum_x rps(x) \times w(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">wald</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">p</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></li><li>此时完全树 <strong>未必就是</strong> 最优编码树</li></ul></li><li><p>最优带权编码树</p><ul><li>仍具有 <strong>双子</strong> 性</li><li>频率高/低的字符，应尽可能放在高/低处<ul><li>通过适当交换，可以缩短 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>wald</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{wald}(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">wald</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></li></ul></li><li>出现频率最低的字符 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ，必在某棵最优编码树中处于最底层，且互为兄弟<ul><li>否则，进行适当交换后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>wald</mtext></mrow><annotation encoding="application/x-tex">\text{wald}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">wald</span></span></span></span></span> 不致增加</li></ul></li></ul></li></ul><h5 id="huffman-编码树">Huffman 编码树</h5><h6 id="贪心策略">贪心策略</h6><ul><li>频率低的字符优先引入，其位置亦更低</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">为每个字符创建一棵单节点的树, 组成森林F</span><br><span class="line">按照出现频率对所有树排序</span><br><span class="line">while F中的树不止一棵</span><br><span class="line">取出频率最小的两棵树: T1, T2</span><br><span class="line">将他们合并成一棵新树T, 并令</span><br><span class="line">lc(T) = T1, rc(T) = T2</span><br><span class="line">w(root(T)) = w(root(T1)) + w(root(T2))</span><br></pre></td></tr></table></figure><ul><li>如此的贪心算法可以得到最优编码树 <strong>之一</strong><ul><li>可由数学归纳证明</li></ul></li></ul><h6 id="实现与改进">实现与改进</h6><ul><li>使用向量或列表，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>使用优先级队列，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>使用预排序 + 栈 + 队列，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>所有字符按频率非升序入栈（也可使用队列）</li><li>维护另一队列有序，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>过程类似于二路归并</li></ul></li></ul><h2 id="二叉搜索树">二叉搜索树</h2><h3 id="概述">概述</h3><ul><li>向量、列表并不能兼顾静态查找与动态修改</li><li>综合二者优点，各数据项依所持关键码而彼此区分<ul><li><code>call-by-key</code></li><li>关键码之间必须支持比较（大小）和比对（相等）（全序）</li></ul></li><li>二叉搜索树<ul><li>顺序性：任一节点均不小/大于其左/右后代</li><li>BST 的中序遍历序列，必然 <strong>单调</strong> 非降</li></ul></li></ul><h3 id="算法及实现">算法及实现</h3><h4 id="查找">查找</h4><ul><li>从根节点出发，逐步地缩小查找范围，直到<ul><li>发现目标（成功），或抵达空树（失败）</li><li>整个过程仿效有序向量的二分查找</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt;&amp; <span class="title">BST::search</span><span class="params">(<span class="type">const</span> T &amp;e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_root || e == _root-&gt;data) &#123;</span><br><span class="line">        _hot = <span class="literal">NULL</span>; <span class="keyword">return</span> _root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (_hot = _root; ; ) &#123;</span><br><span class="line">        BinNodePosi&lt;T&gt; &amp;v = (e &lt; _hot-&gt;data) ? _hot-&gt;lc : _hot-&gt;rc;</span><br><span class="line">        <span class="keyword">if</span> (!v || e == v-&gt;data) <span class="keyword">return</span> v;</span><br><span class="line">        _hot = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// 无论命中或失败, _hot 均指向 v 之父亲(v 是根时, hot 为 NULL)</span></span><br></pre></td></tr></table></figure><ul><li>可将失败的情况假想为，将该空节点转换为一个数值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 的哨兵节点（随后可视需要进行修改）</li></ul><h4 id="插入">插入</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; BST::&lt;T&gt;<span class="built_in">insert</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (x) <span class="keyword">return</span> x; <span class="comment">// 简化, 禁止词条关键码相等(实际不必要)</span></span><br><span class="line">    x = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, _hot); <span class="comment">// _hot 为父亲</span></span><br><span class="line">    _size++; x-&gt;<span class="built_in">updateHeightAbove</span>();</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>时间主要消耗于 <code>search(e)</code> 和 <code>updateHeightAbove(x)</code><ul><li>均线性正比于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的深度，不超过树高</li></ul></li></ul><h4 id="删除">删除</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> BST&lt;T&gt;::<span class="built_in">remove</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">removeAt</span>(x, _hot); <span class="comment">// 分两类情况进行删除</span></span><br><span class="line">    _size--; _hot-&gt;<span class="built_in">updateHeightAbove</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="comment">// 累计时间也为 O(h)</span></span><br></pre></td></tr></table></figure><ul><li>单分支<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的某一子树为空，则可 <strong>直接替换</strong> 为另一棵子树<ul><li>如此操作后，仍然满足 BST 的拓扑结构和顺序性</li></ul></li></ul></li><li>双分支<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 左右孩子并存<ul><li>则找到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的后继 <code>w = x.succ()</code></li><li>交换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> ，问题转化为删除 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> （<strong>必无左孩子</strong>）</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">static</span> BinNodePosi&lt;T&gt; <span class="title">removeAt</span><span class="params">(BinNodePosi&lt;T&gt; &amp;x, BinNodePosi&lt;T&gt; hot)</span> </span>&#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; w = x, succ = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">HasLChild</span>(x)) succ = x = x-&gt;rc;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">HasRChild</span>(x)) succ = x = x-&gt;lc;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        w = w-&gt;<span class="built_in">succ</span>(); <span class="built_in">swap</span>(x-&gt;data, w-&gt;data);</span><br><span class="line">        BinNodePosi&lt;T&gt; u = w-&gt;parent;</span><br><span class="line">        (u == x ? u-&gt;rc : u-&gt;lc) = succ = w-&gt;rc;</span><br><span class="line">        <span class="comment">// u 可能就是 x</span></span><br><span class="line">    &#125;</span><br><span class="line">    hot = x-&gt;parent;</span><br><span class="line">    <span class="keyword">if</span> (succ) succ-&gt;parent = hot;</span><br><span class="line">    <span class="keyword">delete</span> w; <span class="keyword">return</span> succ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="平衡">平衡</h3><ul><li>BST 的主要接口 <code>search()</code> 、<code>insert()</code> 、<code>remove()</code> 在最坏情况下，均线性正比于树高 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span><ul><li>若不能有效地控制树高，最（较）坏情况下 BST 将会退化为列表</li></ul></li><li>随机生成分析<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个词条 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>e</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>e</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>e</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{e_1, e_2, \dots, e_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 按随机排列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>e</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>e</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\sigma = \{e_{i1}, e_{i2}, \dots, e_{in}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>若各排列出现的概率均等，则 BST 平均高度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>计入 <code>remove()</code> ，则可通过随机使用 <code>succ()</code> 和 <code>pred()</code> ，避免逐渐倾侧</li></ul></li><li>随机组成分析<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个互异节点，在遵循顺序性的前提下，随机确定它们之间的 <strong>拓扑联接</strong></li><li>由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个互异节点随机组成的 BST，共计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 棵<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>S</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>catalan</mtext><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mn>2</mn><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow><mrow><mi>n</mi><mo stretchy="false">!</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">S(n) = \sum_{k = 1}^n S(k - 1) \cdot S(n - k) = \text{catalan}(n) = \frac{(2n)!}{n! \cdot (n + 1)!}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">catalan</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mclose mtight">!</span><span class="mbin mtight">⋅</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>假定所有 BST 等概率出现，则平均高度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.05028em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span><ul><li>在 Huffman 编码等应用中，二叉树的确是逐渐 <strong>拼合</strong> 而成的</li></ul></li></ul></li></ul><h4 id="理想平衡">理想平衡</h4><ul><li>由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点组成的二叉树，高度不致低于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi><mo fence="true">⌋</mo></mrow><annotation encoding="application/x-tex">\left\lfloor \log_2 n \right\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose delimcenter" style="top:0em;">⌋</span></span></span></span></span><ul><li>达到这一下界时，为理想平衡</li><li>大致相当于完全二叉树甚至满树</li></ul></li><li>维护成本过高<ul><li>高度渐进地不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，即可接受</li><li>渐进平衡的 BST，简称为平衡二叉搜索树 BBST</li></ul></li></ul><h4 id="等价变换">等价变换</h4><ul><li><p>等价 BST</p><ul><li>中序遍历序列相同</li><li>上下可变：联接关系不尽相同</li><li>左右不乱：保持中序遍历序列的 <strong>单调</strong> 非降</li></ul></li><li><p>各种 BBST 都可视为 BST 的某一子集，相应地满足各自设计的 <strong>限制条件</strong></p><ul><li>单次动态修改后，至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 处 <strong>局部</strong> 不再满足限制条件（可能相继而非同时违反）</li><li>可在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间内，使这些局部乃至全树重新满足</li></ul></li></ul><h5 id="旋转调整">旋转调整</h5><ul><li>刚刚失衡的 BBST，必可迅速转换为一棵等价的 BBST<ul><li>为此只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 甚至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 次旋转<ul><li>旋转可在常数时间内完成</li></ul></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924170111411.png" alt="image-20250924170111411"></p><ul><li>实际上，经过不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次旋转，等价的 BST 均可互相转化<ul><li><strong>规模</strong> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的任何 BST ，经过不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 次旋转调整，都可等价变换为向左倾斜的单链<ul><li>考虑 BST 的最左侧通路，从该通路的末端节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">L_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 开始逐步迭代地延长该路径，直至不能继续延长<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">L_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 右子树不为空，则进行 <code>zag</code> 调整，否则上升至父节点继续</li></ul></li><li>任一节点需要通过旋转归入最左侧通路，当且仅当它最初不在该通路上</li></ul></li></ul></li></ul><h3 id="avl-树">AVL 树</h3><h4 id="渐进平衡">渐进平衡</h4><ul><li>平衡因子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>l</mi><mi>F</mi><mi>a</mi><mi>c</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>l</mi><mi>c</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>r</mi><mi>c</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">balFac(v) = height(lc(v)) - height(rc(v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>v</mi><mo>∈</mo><mtext>AVL</mtext><mo separator="true">,</mo><mtext> </mtext><mrow><mo fence="true">∣</mo><mi>b</mi><mi>a</mi><mi>l</mi><mi>F</mi><mi>a</mi><mi>c</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\forall v \in \text{AVL}, \, \left\vert balFac(v) \right\vert \le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">AVL</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul></li><li>高度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 的 AVL 树，至少包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>3</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">S(h) = fib(h + 3) - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个节点<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(h) = 1 + S(h - 1) + S(h - 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li><li>反过来，由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点构成的 AVL 树，高度不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>高度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 的 AVL 树中，任一叶节点的深度不小于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>h</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil h / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">h</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span></li></ul></li></ul><h5 id="失衡和恢复">失衡和恢复</h5><ul><li><p>按 BST 规则动态修改后，AVL 平衡性可能被破坏（只涉及祖先）</p><ul><li>插入：从 <strong>祖父</strong> 开始，每个祖先都可能失衡，且可能同时</li><li>删除：从父亲开始，每个祖先都可能失衡，但 <strong>至多一个</strong></li></ul></li><li><p>借助等价变换进行重平衡</p><ul><li>所有旋转都在局部进行，每次 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li>每个深度只需检查并旋转至多一次，共 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="插入">插入</h4><ul><li>黄色节点 <strong>恰好</strong> 存在其一</li><li>可能有多个失衡节点，最低者 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 不低于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的祖父<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 经单旋调整后恢复平衡，子树 <strong>高度复原</strong></li><li>更高祖先也必平衡，全树复衡</li></ul></li><li>逐层上溯，即可找到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span><ul><li><code>p = tallerChild(g)</code> ，<code>v = tallerChild(p)</code></li></ul></li><li>p、v 方向一致则单旋，否则双旋，至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 次调整</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924172557714.png" alt="image-20250924172557714"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924172616337.png" alt="image-20250924172616337"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; AVL&lt;T&gt;::<span class="built_in">insert</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (x) <span class="keyword">return</span> x;</span><br><span class="line">    BinNodePosi&lt;T&gt; xx = x = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, _hot); _size++;</span><br><span class="line">    <span class="keyword">for</span> (BinNodePosi&lt;T&gt; g = _hot; g; g-&gt;<span class="built_in">updateHeight</span>(), g = g-&gt;parent) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">AvlBalanced</span>(g)) &#123;</span><br><span class="line">            <span class="built_in">rotateAt</span>(<span class="built_in">tallerChild</span>(<span class="built_in">tallerChild</span>(g)));</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="删除">删除</h4><ul><li>黄色节点至少存在其一，红色节点可有可无</li><li>瞬时至多一个失衡节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> ，可能就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的父亲 <code>_hot</code><ul><li>复衡后子树高度 <strong>未必复原</strong></li><li>故失衡可能持续向上传播，最多需要做 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次调整</li></ul></li><li>逐层上溯，找到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span><ul><li><code>p = tallerChild(g)</code> ，<code>v = tallerChild(p)</code></li></ul></li><li>p、v 方向一致则单旋，否则双旋</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924174623057.png" alt="image-20250924174623057"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924174646870.png" alt="image-20250924174646870"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> AVL&lt;T&gt;::<span class="built_in">remove</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">removeAt</span>(x, _hot); _size--;</span><br><span class="line">    <span class="keyword">for</span> (BinNodePosi&lt;T&gt; g = _hot; g; g-&gt;<span class="built_in">updateHeight</span>(), g = g-&gt;parent) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">AvlBalanced</span>(g)) &#123; <span class="comment">// 一直检查到根</span></span><br><span class="line">            <span class="built_in">rotateAt</span>(<span class="built_in">tallerChild</span>(<span class="built_in">tallerChild</span>(g)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4-重构">(3+4)-重构</h4><ul><li><p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 为最低的失衡节点，沿 <strong>最长分支</strong> 考察祖孙三代 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>∼</mo><mi>p</mi><mo>∼</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">g \sim p \sim v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></p><p>按中序遍历次序，重命名为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a &lt; b &lt; c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span></p></li><li><p>四棵子树（可能空），按中序遍历次序，重命名为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub><mo>&lt;</mo><msub><mi>T</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>T</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>T</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">T_0 &lt; T_1 &lt; T_2 &lt; T_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>将原先以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 为根的子树，替换为以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> 为根的新子树</p><p>等价代换，保持中序遍历次序 $ T_0 &lt; a &lt; T_1 &lt; b &lt; T_2 &lt; c &lt; T_3$</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924175330019.png" alt="image-20250924175330019"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; BST&lt;T&gt;::<span class="built_in">connect34</span>(</span><br><span class="line">BinNodePosi&lt;T&gt; a, BinNodePosi&lt;T&gt; b, BinNodePosi&lt;T&gt; c,</span><br><span class="line">    BinNodePosi&lt;T&gt; T0, BinNodePosi&lt;T&gt; T1, </span><br><span class="line">    BinNodePosi&lt;T&gt; T2, BinNodePosi&lt;T&gt; T3</span><br><span class="line">) &#123;</span><br><span class="line">    a-&gt;lc = T0; <span class="keyword">if</span> (T0) T0-&gt;parent = a;</span><br><span class="line">    a-&gt;rc = T1; <span class="keyword">if</span> (T1) T1-&gt;parent = a;</span><br><span class="line">    c-&gt;lc = T2; <span class="keyword">if</span> (T2) T2-&gt;parent = c;</span><br><span class="line">    c-&gt;rc = T3; <span class="keyword">if</span> (T3) T3-&gt;parent = c;</span><br><span class="line">    b-&gt;lc = a, a-&gt;parent = b; b-&gt;rc = c, c-&gt;parent = b;</span><br><span class="line">    a-&gt;<span class="built_in">updateHeight</span>(); c-&gt;<span class="built_in">updateHeight</span>(); b-&gt;<span class="built_in">updateHeight</span>(); <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>视 p、v 的拐向，无非四种情况</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924180148789.png" alt="image-20250924180148789"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; BST&lt;T&gt;::<span class="built_in">rotateAt</span>(BinNodePosi&lt;T&gt; v) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; p = v-&gt;parent; <span class="type">int</span> TurnV = <span class="built_in">IsRChild</span>(v);</span><br><span class="line">    BinNodePosi&lt;T&gt; g = p-&gt;parent; <span class="type">int</span> TurnP = <span class="built_in">IsRChild</span>(p);</span><br><span class="line">    BinNodePosi&lt;T&gt; r = (TurnP == TurnV) ? p : v; <span class="comment">// 子树新根节点</span></span><br><span class="line">    (<span class="built_in">FromParentTo</span>(g) = r)-&gt;parent = g-&gt;parent;</span><br><span class="line">    <span class="keyword">switch</span>((TurnP &lt;&lt; <span class="number">1</span>) | TurnV) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0b00</span>: <span class="keyword">return</span> <span class="built_in">connect34</span>(v, p, g, v-&gt;lc, v-&gt;rc, p-&gt;rc, g-&gt;rc);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0b01</span>: <span class="keyword">return</span> <span class="built_in">connect34</span>(p, v, g, p-&gt;lc, v-&gt;lc, v-&gt;rc, g-&gt;rc);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0b10</span>: <span class="keyword">return</span> <span class="built_in">connect34</span>(g, v, p, g-&gt;lc, v-&gt;lc, v-&gt;rc, p-&gt;rc);</span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="built_in">connect34</span>(g, p, v, g-&gt;lc, p-&gt;lc, v-&gt;lc, v-&gt;rc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="总结">总结</h4><ul><li>优点<ul><li>无论查找、插入或删除，最坏情况下的复杂度均为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>存储空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li>缺点<ul><li>借助高度或平衡因子，为此需改造元素结构，或额外封装</li><li>实测复杂度与理论值尚有差距<ul><li>插入/删除后的旋转，成本不菲</li><li>删除操作后，最多旋转 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次（平均仅 <strong>0.21</strong> 次）</li></ul></li><li>单次动态调整后，全树 <strong>拓扑结构的变化量</strong> 可能高达 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h2 id="高级搜索树">高级搜索树</h2><h3 id="伸展树">伸展树</h3><ul><li>局部性：刚被访问过的数据，极有可能很快地再次被访问</li><li>BST 的局部性<ul><li>时间：刚被访问过的节点，极有可能很快地再次被访问</li><li>空间：下一将要访问的节点，极有可能就在刚被访问过节点的附近</li></ul></li><li>对于 AVL 的连续 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≫</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \gg n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次查找，共需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>利用局部性加速：BST 的节点一旦被访问，随即调整到树根</li></ul></li></ul><h4 id="单层伸展">单层伸展</h4><ul><li>节点 v 一旦被访问，随即被推送至根<ul><li>自下而上，<strong>逐层旋转</strong></li></ul></li><li>旋转次数呈周期性的算术级数（周期访问所有节点）<ul><li>每一周期结构会复原，累计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，分摊 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="双层伸展">双层伸展</h4><ul><li>反复考察祖孙三代<ul><li><code>g = parent(p), p = parent(v), v</code></li><li>根据他们的相对位置，经 <strong>两次旋转</strong>，使 <code>v</code> 上升两层，成为子树根<ul><li><code>zig-zag</code> 操作本身就是平衡的，效果很好</li><li>对于 <code>zig-zig</code>，先 <code>p</code> 后 <code>g</code> 只会拉长和移动访问路径，无法改善树的整体结构；而先 <code>g</code> 后 <code>p</code> 则能够“折叠”和“打散”访问路径</li></ul></li><li>zig 和 zag 不同组合，共计 4 种<ul><li>可能会在 <strong>最后</strong> 进行一次单次旋转</li></ul></li></ul></li><li>节点访问之后，对应路径的长度随即 <strong>折半</strong><ul><li>最坏情况显然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，但最坏情况不致持续发生<ul><li>分摊仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006154901125.png" alt="image-20251006154901125"></p><h4 id="算法实现">算法实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodeposi&lt;T&gt; Splay&lt;T&gt;::<span class="built_in">splay</span>(BinNodePosi&lt;T&gt; v) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; p, q;</span><br><span class="line">    <span class="keyword">while</span> ((p = v-&gt;parent) &amp;&amp; (g = p-&gt;parent)) &#123;</span><br><span class="line">        BinNodePosi&lt;T&gt; gg = g-&gt;parent;</span><br><span class="line">        <span class="keyword">switch</span> ((<span class="built_in">IsLChild</span>(p) &lt;&lt; <span class="number">1</span>) | <span class="built_in">IsLChild</span>(v)) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0b00</span>: <span class="comment">/* zig-zig */</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0b01</span>: <span class="comment">/* zig-zag */</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0b10</span>: <span class="comment">/* zag-zig */</span>;</span><br><span class="line">            <span class="keyword">default</span>:   <span class="comment">/* zag-zag */</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!gg) v-&gt;parent = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">else</span> (g == gg-&gt;lc) ? gg-&gt;<span class="built_in">attachLc</span>(v) : gg-&gt;<span class="built_in">attachRc</span>(v);</span><br><span class="line">        g-&gt;<span class="built_in">updateHeight</span>(); p-&gt;<span class="built_in">updateHeight</span>(); v-&gt;<span class="built_in">updateHeight</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p = v-&gt;parent) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">IsLChild</span>(v)) &#123; <span class="comment">// zig</span></span><br><span class="line">            p-&gt;<span class="built_in">attachLc</span>(v-&gt;rc);</span><br><span class="line">            v-&gt;<span class="built_in">attachRc</span>(p);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// zag</span></span><br><span class="line">            p-&gt;<span class="built_in">attachRc</span>(v-&gt;lc);</span><br><span class="line">            v-&gt;<span class="built_in">attachLc</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">        p-&gt;<span class="built_in">updateHeight</span>(); v-&gt;<span class="built_in">updateHeight</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    v-&gt;parent = <span class="literal">NULL</span>; <span class="keyword">return</span> v; <span class="comment">// 伸展完成, v 抵达树根</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="查找">查找</h5><ul><li>与常规 <code>BST::search()</code> 不同，很可能会改变树的拓扑结构， <strong>不再属于静态操作</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt;&amp; Splay&lt;T&gt;::<span class="built_in">search</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; p = BST&lt;T&gt;::<span class="built_in">search</span>(e);</span><br><span class="line">    _root = p ? <span class="built_in">splay</span>(p) : _hot ? <span class="built_in">splay</span>(_hot) : <span class="literal">NULL</span>; <span class="comment">// 成功、失败、空树</span></span><br><span class="line">    <span class="keyword">return</span> _root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="插入">插入</h5><ul><li><code>Splay::search()</code> 查找失败后，<code>_hot</code> 即为根<ul><li>直接在树根附近接入新节点</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; Splay&lt;T&gt;::<span class="built_in">insert</span>(T <span class="type">const</span> &amp;e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (_root) &#123; _size = <span class="number">1</span>; <span class="keyword">return</span> _root = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e); &#125;</span><br><span class="line">    BinNodePosi&lt;T&gt; t = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (t-&gt;data == e) <span class="keyword">return</span> t;</span><br><span class="line">    <span class="keyword">if</span> (t-&gt;data &lt; e) &#123;</span><br><span class="line">        _root = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, <span class="literal">NULL</span>, t, t-&gt;rc);</span><br><span class="line">        t-&gt;rc = <span class="literal">NULL</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _root = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, <span class="literal">NULL</span>, t-&gt;lc, t);</span><br><span class="line">        t-&gt;lc = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    _size++; t-&gt;<span class="built_in">updateHeightAbove</span>(); <span class="keyword">return</span> _root;</span><br><span class="line">&#125; <span class="comment">// 无论何时, 总有 _root-&gt; data == e</span></span><br></pre></td></tr></table></figure><h5 id="删除">删除</h5><ul><li>同插入，<code>search()</code> 后可直接在树根附近摘除节点</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> Splay&lt;T&gt;::<span class="built_in">remove</span>(T <span class="type">const</span> &amp;e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!root || e != <span class="built_in">search</span>(e)-&gt;data) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    BinNodePosi&lt;T&gt; L = _root-&gt;lc, R = _root-&gt;rc;</span><br><span class="line">    <span class="keyword">delete</span> _root;</span><br><span class="line">    <span class="keyword">if</span> (!R) &#123;</span><br><span class="line">        <span class="keyword">if</span> (L) L-&gt;parent = <span class="literal">NULL</span>;</span><br><span class="line">        _root = L;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _root = R; R-&gt;parent = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="built_in">search</span>(e); <span class="comment">// 查找必败, 是为了伸展最小节点作为新的根</span></span><br><span class="line">        _root-&gt;<span class="built_in">attachLc</span>(L);</span><br><span class="line">    &#125;</span><br><span class="line">    _size--; <span class="keyword">if</span> (_root) _root-&gt;<span class="built_in">updateHeight</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="总结">总结</h4><ul><li>无需记录高度或平衡因子，编程实现简单，分摊复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>局部性强，缓存命中率极高时（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≪</mo><mi>n</mi><mo>≪</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">k \ll n \ll m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>）（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 为访问范围）<ul><li>效率甚至可以更高，自适应的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li><li>任何 <strong>连续</strong> 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 次查找，仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo>⁡</mo><mi>k</mi><mo>+</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m\log k + n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>若 <strong>反复地顺序</strong> 访问任意子集，分摊成本仅为常数</li><li>不能杜绝 <strong>单次最坏</strong> 情况，不适用于对效率敏感的场合</li></ul><h4 id="分摊分析">分摊分析</h4><h5 id="势能">势能</h5><ul><li><p>任何一棵伸展树在任何时刻，都可假想地视作具有势能</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mo>∏</mo><mrow><mi>v</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mi>S</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">\Phi(S) = \log(\prod_{v \in S} size(v)) = \sum_{v \in S} \log(size(v)) = \sum_{v \in S} rank(v) = \sum_{v \in S} \log V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></li></ul></li><li><p>越平衡/倾侧的树，势能越小/大</p><ul><li><p>单链</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">!</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(S) = \log n! = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p></li><li><p>满树</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mo>⁡</mo><munderover><mo>∏</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>h</mi></munderover><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>−</mo><mi>d</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><msup><mn>2</mn><mi>d</mi></msup></msup><mo>≤</mo><mi>log</mi><mo>⁡</mo><munderover><mo>∏</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>k</mi></munderover><msup><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mn>2</mn><mi>d</mi></msup></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>h</mi></munderover><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mn>2</mn><mi>d</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>+</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>−</mo><mi>h</mi><mo>−</mo><mn>3</mn><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\Phi(S) &amp;= \log \prod_{d = 0}^h (2^{h - d + 1} - 1)^{2^d} \le \log \prod_{d = 0}^k 2^{(h - d + 1) \cdot 2^d} \\ &amp;= \sum_{d = 0}^h (h - d + 1) \cdot 2^d = (h + 1) \cdot (2^{h + 1} - 1) - [(h - 1)\cdot 2^{h + 1} + 2] \\ &amp;= 2^{h + 2} - h - 3 = O(n) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.43556em;vertical-align:-3.9677800000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.46778em;"><span style="top:-6.46778em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span><span style="top:-3.029554em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span><span style="top:-0.5283329999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9677800000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.46778em;"><span style="top:-6.46778em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0619199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285713em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0619199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">⋅</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285713em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.029554em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span><span style="top:-0.5283329999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9677800000000003em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul></li></ul><h5 id="总体关系推导">总体关系推导</h5><ul><li>考察对伸展树 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≫</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \gg n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次连续访问（不妨仅考察 <code>search()</code> ）</li><li>记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi mathvariant="normal">Δ</mi><msup><mi mathvariant="normal">Φ</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A^{(k)} = T^{(k)} + \Delta \Phi^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9713299999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> ，其中<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">T^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> ：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 次操作的实际时间复杂度</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msup><mi mathvariant="normal">Φ</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mrow><mi>a</mi><mi>f</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mrow><mi>b</mi><mi>e</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta \Phi^{(k)} = \Phi_{after} - \Phi_{before}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ：第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 次操作后势能函数的变化</li></ul></li><li>则有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi mathvariant="normal">Δ</mi><msup><mi mathvariant="normal">Φ</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">T = \sum_{k = 1}^m T^{(k)} = \sum_{k = 1}^m (A^{(k)} - \Delta \Phi^{(k)}) = A - \Delta \Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.18771em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.18771em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Δ</span><span class="mord">Φ</span></span></span></span><ul><li>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi><mo fence="true">∣</mo></mrow><mo>≤</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left\vert \Delta\Phi \right\vert \le O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Δ</span><span class="mord">Φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>故 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mi>A</mi><mo>±</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T = A \pm O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">T^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> 的变化幅度可能很大，但可以证明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">A^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> 都不致超过节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的势能变化量<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>r</mi><mi>a</mi><mi>n</mi><msup><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msup><mi>k</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A^{(k)} = O(rank^{(k)}(v) - rank^{(k - 1)}(v)) = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h5 id="伸展操作分析">伸展操作分析</h5><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924212758866.png" alt="image-20250924212758866"></p><ul><li><p>单旋到根（zig / zag）</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>A</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>T</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi mathvariant="normal">Φ</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mn>1</mn><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>1</mn><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} A^{(k)}_i &amp;= T^{(k)}_i + \Delta\Phi^{(k)}_i = 1 + \Delta rank_i(v) + \Delta rank_i(r) \\ &amp;= 1 + [rank_i(v) - rank_{i - 1}(v)] + [rank_i(r) - rank_{i - 1}(r)] \\ &amp;&lt; 1 + [rank_i(v) - rank_{i - 1}(v)] \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.7048000000000005em;vertical-align:-2.1024000000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6024000000000003em;"><span style="top:-4.6024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-1.6023999999999998em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1024000000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6024000000000003em;"><span style="top:-4.6024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span><span style="top:-3.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-1.6023999999999998em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1024000000000003em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924212705444.png" alt="image-20250924212705444"></p><ul><li><p>反向双旋（zig-zag / zag-zig），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><msub><mi>G</mi><mi>i</mi></msub><mo>+</mo><mi>log</mi><mo>⁡</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>≤</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>G</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>&lt;</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>V</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\log G_i + \log P_i) /  2\le \log ((G_i + P_i) / 2) &lt; \log (V_i / 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>A</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>T</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi mathvariant="normal">Φ</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mn>2</mn><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>−</mo><menclose notation="updiagonalstrike"><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow></menclose><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><menclose notation="updiagonalstrike"><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></menclose><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>2</mn><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>2</mn><mo>+</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>⋅</mo><mo stretchy="false">(</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} A^{(k)}_i &amp;= T^{(k)}_i + \Delta\Phi^{(k)}_i = 2 + \Delta rank_i(g) + \Delta rank_i(p) + \Delta rank_i(v) \\ &amp;= 2 + [rank_i(g) - \cancel{rank_{i - 1}(g)}] + [rank_i(p) - rank_{i - 1}(p)] + [\cancel{rank_i(v)} - rank_{i - 1}(v)] \\ &amp;&lt; 2 + rank_i(g) + rank_i(p) - 2 \cdot rank_{i - 1}(v) \\ &amp;&lt; 2 + 2 \cdot rank_i(v) - 2 - 2 \cdot rank_{i - 1}(v) \\ &amp;= 2 \cdot(rank_i(v) - rank_{i - 1}(v)) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.7048000000000005em;vertical-align:-3.6024000000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1024em;"><span style="top:-6.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.602399999999999em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-3.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-1.6023999999999998em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-0.10239999999999982em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6024000000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.1024em;"><span style="top:-6.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-4.602399999999999em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord cancel-pad"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-2.75em;"><span class="pstrut" style="height:3em;"></span><span style="height:1em;"><svg width='100%' height='1em'><line x1='0' y1='100%' x2='100%' y2='0' stroke-width='0.046em'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord cancel-pad"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-2.75em;"><span class="pstrut" style="height:3em;"></span><span style="height:1em;"><svg width='100%' height='1em'><line x1='0' y1='100%' x2='100%' y2='0' stroke-width='0.046em'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-3.1024em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-1.6023999999999998em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-0.10239999999999982em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6024000000000003em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924212723442.png" alt="image-20250924212723442"></p><ul><li><p>同向双旋（zig-zig / zag-zag），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><msub><mi>G</mi><mi>i</mi></msub><mo>+</mo><mi>log</mi><mo>⁡</mo><msub><mi>V</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>≤</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>G</mi><mi>i</mi></msub><mo>+</mo><msub><mi>V</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>&lt;</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>V</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\log G_i + \log V_{i - 1}) / 2 \le \log ((G_i + V_{i - 1}) / 2) &lt; \log (V_i / 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>A</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>T</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi mathvariant="normal">Φ</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mn>2</mn><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>−</mo><menclose notation="updiagonalstrike"><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow></menclose><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><menclose notation="updiagonalstrike"><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></menclose><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>2</mn><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>2</mn><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mn>2</mn><mo>+</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn><mo>⋅</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>3</mn><mo>⋅</mo><mo stretchy="false">(</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} A^{(k)}_i &amp;= T^{(k)}_i + \Delta\Phi^{(k)}_i = 2 + \Delta rank_i(g) + \Delta rank_i(p) + \Delta rank_i(v) \\ &amp;= 2 + [rank_i(g) - \cancel{rank_{i - 1}(g)}] + [rank_i(p) - rank_{i - 1}(p)] + [\cancel{rank_i(v)} - rank_{i - 1}(v)] \\ &amp;&lt; 2 + rank_i(g) + rank_i(p) - 2 \cdot rank_{i - 1}(v) \\ &amp;&lt; 2 + rank_i(g) + rank_i(v) - 2 \cdot rank_{i - 1}(v) \\ &amp;&lt; 2 + 2 \cdot rank_i(v) - rank_{i - 1}(v) - 2 + rank_i(v) - 2 \cdot rank_{i - 1}(v) \\ &amp;= 3 \cdot(rank_i(v) - rank_{i - 1}(v)) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.204799999999999em;vertical-align:-4.352399999999999em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8524em;"><span style="top:-6.8524em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.352399999999999em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-3.8524em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-2.3524000000000003em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:-0.8524000000000003em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span><span style="top:0.6475999999999993em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.352399999999999em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.8524em;"><span style="top:-6.8524em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-5.352399999999999em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord cancel-pad"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-2.75em;"><span class="pstrut" style="height:3em;"></span><span style="height:1em;"><svg width='100%' height='1em'><line x1='0' y1='100%' x2='100%' y2='0' stroke-width='0.046em'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">[</span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord cancel-pad"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-2.75em;"><span class="pstrut" style="height:3em;"></span><span style="height:1em;"><svg width='100%' height='1em'><line x1='0' y1='100%' x2='100%' y2='0' stroke-width='0.046em'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-3.8524em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-2.3524000000000003em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-0.8524000000000003em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:0.6475999999999993em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.352399999999999em;"><span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>单次伸展总复杂度为</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>A</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mi>A</mi><mi>i</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>≤</mo><mn>3</mn><mo>⋅</mo><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">(</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>3</mn><mo>⋅</mo><mo stretchy="false">(</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≤</mo><mn>3</mn><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} A^{(k)} &amp;= \sum_i A^{(k)}_i \le 3 \cdot \sum_i (rank_i(v) - rank_{i - 1}(v)) \\ &amp;= 3 \cdot (rank(root) - rank(v)) \le 3 \cdot \log n = O(\log n)  \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.127674000000001em;vertical-align:-1.8138370000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3138370000000004em;"><span style="top:-4.313837em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.8961680000000003em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8138370000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3138370000000004em;"><span style="top:-4.313837em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.276864em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-1.8961680000000003em;"><span class="pstrut" style="height:3.0500050000000005em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8138370000000004em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><h3 id="b-树">B-树</h3><ul><li><p>分级存储：利用数据访问的局部性</p><ul><li>常用的数据，复制到更高层、更小的存储器中</li><li>找不到，才向更低层、更大的存储器索取</li></ul></li><li><p>缓存的体现： <strong>就地</strong> 循环位移的倒置版本</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">shift</span><span class="params">(<span class="type">int</span> *A, <span class="type">int</span> n, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(A, k);</span><br><span class="line">    <span class="built_in">reverse</span>(A + k, n - k);</span><br><span class="line">    <span class="built_in">reverse</span>(A, n);</span><br><span class="line">&#125; <span class="comment">// O(3n)</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="结构">结构</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924220548410.png" alt="image-20250924220548410"></p><ul><li><p>等价变换：平衡的多路搜索树</p><ul><li>每 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 代合并为超级节点<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mn>2</mn><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">m = 2^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span> 路，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个关键码</li></ul></li><li>逻辑上与 BBST 完全等价</li></ul></li><li><p>IO 优化：<strong>多级</strong> 存储系统中使用 B-树，可针对外部查找，大大减少 I/O 次数</p><ul><li>利用外存的 <strong>批量访问</strong>，每下降一层，都以超级节点为单位，读入一组关键码<ul><li>适宜于在相对更小的内存中，实现对大规模数据的高效操作</li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>p</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo fence="true">∣</mo></mrow><mi mathvariant="normal">/</mi><mrow><mo fence="true">∣</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">m = \left\vert page \right\vert / \left\vert key \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">/</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></li></ul></li></ul><h5 id="外部节点-叶子">外部节点+叶子</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 阶 B-树，即为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 路完全平衡搜索树（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m \ge 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>）</li><li>外部节点的深度 <strong>统一相等</strong>，并以此深度作为树高 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span><ul><li>外部节点可看作 <strong>“可被插入的空隙”</strong></li><li>叶节点的深度统一相等（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>）</li></ul></li></ul><h5 id="内部节点">内部节点</h5><ul><li>各含有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≤</mo><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \le m - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个关键码</li><li>各有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>≤</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n + 1 \le m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 个分支<ul><li>反过来，分支数也不能太少<ul><li>树根：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>≤</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2 \le n + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li><li>其余：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>≤</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>≤</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil \le n + 1 \le m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></li></ul></li><li>故亦称作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\lceil m / 2 \rceil, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>-树</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250924223607468.png" alt="image-20250924223607468"></p><h4 id="查找">查找</h4><h5 id="算法">算法</h5><ol><li>从（<strong>常驻 RAM</strong> 的）根节点开始</li><li>只要当前节点不是外部节点<ul><li>在当前节点中顺序查找（RAM 内部）</li><li>若找到目标关键码，则返回查找成功</li><li>否则，沿引用找到孩子节点，将其 <strong>读入内存</strong><ul><li><strong>外部节点不需要 IO</strong></li></ul></li></ul></li><li>返回查找失败</li></ol><h5 id="实现">实现</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BTNodePosi&lt;T&gt; BTree&lt;T&gt;::<span class="built_in">search</span>(T <span class="type">const</span> &amp;e) &#123;</span><br><span class="line">    _hot = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">for</span> (BTNodePosi&lt;T&gt; v = _root; v; ) &#123;</span><br><span class="line">        Rank r = v-&gt;key.<span class="built_in">search</span>(e); <span class="comment">// 在当前节点中, 找到不大于 e 的最大关键码</span></span><br><span class="line">        <span class="comment">// 对通常的_m, 顺序查找效率比二分高</span></span><br><span class="line">        <span class="keyword">if</span> (r != <span class="number">-1</span> &amp;&amp; (e == v-&gt;key[r])) <span class="keyword">return</span> v;</span><br><span class="line">        _hot = v; v = v-&gt;child[r + <span class="number">1</span>]; <span class="comment">// 沿引用转至对应的孩子节点(I/O)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="性能">性能</h5><ul><li>忽略内存中的查找，运行时间主要取决于 I/O 次数</li><li>在每一深度至多一次 I/O，故运行时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>m</mi></msub><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mi>h</mi><mo>≤</mo><mn>1</mn><mo>+</mo><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow></msub><mfrac><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\log_m (N + 1) \le h \le 1 + \lfloor \log_{\lceil m / 2 \rceil} \frac{N + 1}{2} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.291471em;vertical-align:-0.41913999999999996em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span><ul><li>树最高的情况<ul><li>对于内部节点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>k</mi></msub><mo>≥</mo><mn>2</mn><mo>×</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n_k \ge 2 \times \lceil m / 2 \rceil ^{k - 1}, \quad \forall k &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li><li>考察外部节点所在高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn><mo>=</mo><msub><mi>n</mi><mi>h</mi></msub><mo>≥</mo><mn>2</mn><mo>×</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">N + 1 = n_h \ge 2 \times \lceil m / 2 \rceil ^{h - 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>≤</mo><mn>1</mn><mo>+</mo><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow></msub><mfrac><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">⌋</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>m</mi></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h \le 1 + \lfloor \log_{\lceil m / 2 \rceil} \frac{N + 1}{2} \rfloor = O(\log_m N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.291471em;vertical-align:-0.41913999999999996em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><h4 id="插入">插入</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> BTree&lt;T&gt;::<span class="built_in">insert</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BTNodePosi&lt;T&gt; v = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (v) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Rank r = _hot-&gt;key.<span class="built_in">search</span>(e); <span class="comment">// 在_hot 节点(叶子)中确定插入位置</span></span><br><span class="line">    _hot-&gt;key.<span class="built_in">insert</span>(r + <span class="number">1</span>, e);</span><br><span class="line">    _hot-&gt;child.<span class="built_in">insert</span>(r + <span class="number">2</span>, <span class="literal">NULL</span>); <span class="comment">// 创建一个空子树</span></span><br><span class="line">    _size++; <span class="built_in">solveOverflow</span>(_hot); <span class="comment">// 若上溢, 则分裂</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="上溢修复">上溢修复</h5><ul><li>设上溢节点中的关键码依次为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>k</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{k_0, k_1, \dots, k_{m - 1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span><ul><li>取中位数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy="false">⌊</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">s = \lfloor m / 2 \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌋</span></span></span></span> ，划分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>k</mi><mn>0</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{k_0, \dots, k_{s - 1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>k</mi><mi>s</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{k_s\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>k</mi><mrow><mi>s</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{k_{s + 1}, \dots, k_{m - 1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>关键码分裂，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">k_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上升成为父节点的孩子，其余两部分成为它的左、右孩子</li><li>此时左、右孩子的关键码数目，均满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 阶 B-树条件</li></ul></li><li>若父节点本已饱和，则继续上溢<ul><li>最坏情况 <strong>上溢持续</strong> 向上传播到根<ul><li>此时可令最后被提升的关键码自成节点，作为新的根</li><li>B-树因此增高</li></ul></li></ul></li><li>总体执行时间正比于分裂次数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span></li><li>上溢也可采用旋转来修复</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> BTree&lt;T&gt;::<span class="built_in">solveOverflow</span>(BTNodePosi&lt;T&gt; v) &#123;</span><br><span class="line">    <span class="keyword">while</span> (_m &lt;= v-&gt;key.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        Rank s = _m / <span class="number">2</span>;</span><br><span class="line">        BTNodePosi&lt;T&gt; u = <span class="keyword">new</span> <span class="built_in">BTNode</span>&lt;T&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Rank j = <span class="number">0</span>; j &lt; _m - s - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="comment">// 分裂出右侧节点 u</span></span><br><span class="line">            u-&gt;child.<span class="built_in">insert</span>(j, v-&gt;child.<span class="built_in">remove</span>(s + <span class="number">1</span>));</span><br><span class="line">            u-&gt;key.<span class="built_in">insert</span>(j, v-&gt;key.<span class="built_in">remove</span>(s + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        u-&gt;child.insert[_m - s - <span class="number">1</span>] = v-&gt;child.<span class="built_in">remove</span>(s + <span class="number">1</span>); <span class="comment">// 此时 v 最靠右的孩子</span></span><br><span class="line">        <span class="keyword">if</span> (u-&gt;child[<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Rank j = <span class="number">0</span>; j &lt; _m - s; j++)</span><br><span class="line">                u-&gt;child[j]-&gt;parent = u;</span><br><span class="line">        &#125;</span><br><span class="line">        BTNodePosi&lt;T&gt; p = v-&gt;parent;</span><br><span class="line">        <span class="keyword">if</span> (!p) &#123;</span><br><span class="line">            _root = p = <span class="keyword">new</span> <span class="built_in">BTNode</span>&lt;T&gt;();</span><br><span class="line">            p-&gt;child[<span class="number">0</span>] = v, v-&gt;parent = p;</span><br><span class="line">        &#125;</span><br><span class="line">        Rank r = <span class="number">1</span> + p-&gt;key.<span class="built_in">search</span>(v-&gt;key[<span class="number">0</span>]); <span class="comment">// p 中指向 u 的节点的指针的秩</span></span><br><span class="line">        p-&gt;key.<span class="built_in">insert</span>(r, v-&gt;key.<span class="built_in">remove</span>(s));</span><br><span class="line">        p-&gt;child.<span class="built_in">insert</span>(r + <span class="number">1</span>, u); u-&gt;parent = p;</span><br><span class="line">        v = p; <span class="comment">// 如有必要继续分裂</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006163221558.png" alt="image-20251006163221558"></p><p>一棵存有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 个关键码的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 阶 B-树插入特定关键码后，引发 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>m</mi></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(\log_m N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> 次分裂的情况：</p><ul><li>全树总规模为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>N</mi><mo>^</mo></mover><mo>=</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo stretchy="false">(</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mrow><mi>h</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mrow><mi>h</mi><mo>−</mo><mn>3</mn></mrow></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mn>0</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{N} = \lceil m / 2 \rceil^{h - 1} + (m - 1) \cdot (\lceil m / 2 \rceil ^{h - 2} + \lceil m / 2 \rceil^{h-3} + \dots + \lceil m / 2 \rceil^{0})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><ul><li>对应高度可取为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>h</mi><mo>=</mo><mn>1</mn><mo>+</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow></msub><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mover accent="true"><mi>N</mi><mo>^</mo></mover><mo>⋅</mo><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow></msub><mover accent="true"><mi>N</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>m</mi></msub><mover accent="true"><mi>N</mi><mo>^</mo></mover><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}h = 1 + \log_{\lceil m / 2 \rceil}((\hat{N} \cdot (\lceil m / 2 \rceil - 1) + m - 1) / (m + \lceil m / 2 \rceil - 2)) =\Theta(\log_{\lceil m / 2 \rceil} \hat{N}) = \Theta(\log_{m} \hat{N})\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6659099999999998em;vertical-align:-0.582955em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0829549999999997em;"><span style="top:-3.136185em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.582955em;"><span></span></span></span></span></span></span></span></span></span></span></li><li>对于给定的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>，可由代入上式计算出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 进而估算出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>N</mi><mo>^</mo></mover><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\hat{N} \le N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0827399999999998em;vertical-align:-0.13597em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>（多余的关键码散布至其他子树中）</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/PixPin_2025-12-03_16-32-29.png" alt="PixPin_2025-12-03_16-32-29"></p><blockquote><p>图示某一黑关键码和对应白关键码构成的 <strong>高度</strong> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的子树规模为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><msup><mo stretchy="false">⌉</mo><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose"><span class="mclose">⌉</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></p></blockquote><h4 id="删除">删除</h4><ul><li>若被删除元素非叶子，则先通过旋转 <strong>腾挪</strong>（与后继交换），使其位于最底层</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> BTree&lt;T&gt;::<span class="built_in">remove</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BTNodePosi&lt;T&gt; v = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (!v) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Rank r = v-&gt;key.<span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (v-&gt;child[<span class="number">0</span>]) &#123; <span class="comment">//非叶子</span></span><br><span class="line">    BTNodePosi&lt;T&gt; u = v-&gt;child[r + <span class="number">1</span>]; <span class="comment">// 后继在右子树中</span></span><br><span class="line">        <span class="keyword">while</span> (u-&gt;child[<span class="number">0</span>]) u = u-&gt;child[<span class="number">0</span>];</span><br><span class="line">        v-&gt;key[r] = u-&gt;key[<span class="number">0</span>]; v = u, r = <span class="number">0</span>; <span class="comment">// 交换</span></span><br><span class="line">    &#125;</span><br><span class="line">    v-&gt;key.<span class="built_in">remove</span>(r); v-&gt;child.<span class="built_in">remove</span>(r + <span class="number">1</span>);</span><br><span class="line">    _size--; <span class="built_in">solveUnderflow</span>(); <span class="comment">// 下溢, 需做旋转或合并</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="下溢修复">下溢修复</h5><ul><li>非根节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 下溢时，必恰有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil - 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个关键码和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个分支<ul><li>若左兄弟 L 存在，且至少包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 个关键码（<strong>够借</strong>）<ul><li>将 P 中分界关键码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> 移至 V 中（作为最小关键码）</li><li>将 L 中最大关键码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 移至 P 中（取代 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>）</li><li>修复完成</li></ul></li><li>若右兄弟 R 存在，且至少包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 个关键码<ul><li>同上处理</li></ul></li><li>若 L 和 R 或不存在，或均不足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil m / 2\rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 个关键码<ul><li>即便如此 L 和 R 必有其一，且恰含有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lceil m / 2 \rceil -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault">m</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个关键码</li><li>从 P 中抽出介于 L（R） 和 V 之间的关键码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ，三者合成一个新的节点，同时合并此前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> 的孩子引用</li><li>这可能导致 P 继续下溢，重复整个过程即可</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> BTree&lt;T&gt;::<span class="built_in">solveUnderflow</span>(BTNodePosi&lt;T&gt; v) &#123;</span><br><span class="line">    <span class="keyword">while</span> ((_m + <span class="number">1</span>) / <span class="number">2</span> &gt; v-&gt;child.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        BTNodePosi&lt;T&gt; p = v-&gt;parent;</span><br><span class="line">        <span class="keyword">if</span> (!p) &#123; <span class="comment">/* 已到根节点 */</span> &#125;</span><br><span class="line">        Rank r = <span class="number">0</span>; <span class="keyword">while</span> (p-&gt;child[r] != v) r++; <span class="comment">// 确定 v 是 p 的第 r 个孩子</span></span><br><span class="line">        <span class="keyword">if</span> (r &gt; <span class="number">0</span> &amp;&amp; (_m + <span class="number">1</span>) / <span class="number">2</span> &lt; p-&gt;child[r - <span class="number">1</span>]-&gt;child.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="comment">/* 情况 1 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (r &lt; p-&gt;child.<span class="built_in">size</span>() - <span class="number">1</span> &amp;&amp; (_m + <span class="number">1</span>) / <span class="number">2</span> &lt; p-&gt;child[r + <span class="number">1</span>]-&gt;child.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="comment">/* 情况 2 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">/* 情况 3 */</span></span><br><span class="line">            <span class="keyword">if</span> (r &gt; <span class="number">0</span>) &#123; <span class="comment">/* 与左兄弟合并 */</span> &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="comment">/* 与右兄弟合并 */</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v = p; <span class="comment">// 如有必要继续旋转或合并</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006163823996.png" alt="image-20251006163823996"></p><h3 id="红黑树">红黑树</h3><h4 id="动机">动机</h4><ul><li>并发性：对于 BST 而言，结构变化处需要加锁（产生访问延迟）<ul><li>Splay 结构变化剧烈，最差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>AVL 插入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 但删除 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>持久性：支持对历史版本的访问<ul><li>蛮力保存，单次操作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>h</mi><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log h + \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，累计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \cdot h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span> 时间/空间</li><li>压缩更新：大量共享，少量更新（仅支持对历史版本的读取）<ul><li>每个版本的新增复杂度，仅为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>可进一步提高至总体 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span> 、单版本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><ul><li>为此，就树的 <strong>代数结构</strong> 而言，相邻版本之间的差异不能超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul></li></ul><h4 id="结构">结构</h4><ul><li><p>红黑树：由红、黑两类节点组成的 BST；统一引入外部节点 NULL，形成 <strong>真二叉树</strong>。规则如下</p><ul><li>树根：必为黑色</li><li>外部节点：必为黑色</li><li>红节点：只能有黑孩子以及黑父亲</li><li>外部节点：<strong>黑深度</strong>（黑的真祖先数目）相等<ul><li>亦即根（全树）的黑高度</li><li>子树的黑高度，即为后代 NULL 的相对黑深度</li></ul></li></ul></li><li><p>红黑树 = <strong>（2,4）B-树</strong></p><ul><li>将红节点提升至与其黑父亲等高，则可对应一棵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span></span></span></span>-树<ul><li>将黑节点和其红孩子视作关键码，合并为 B-树的超级节点</li></ul></li></ul></li><li><p>红黑树 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span> BBST</p><ul><li><p>设红/黑高度为 R/H，则</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>≤</mo><mi>h</mi><mo>≤</mo><mi>H</mi><mo>+</mo><mi>R</mi><mo>≤</mo><mn>2</mn><mo>⋅</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">H \le h \le H + R \le 2 \cdot H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span> 即为对应 B-树 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">T_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的树高，而 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">T_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中的每个节点都 <strong>恰好</strong> 包含 <strong>一个</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> 的黑节点<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>≤</mo><mn>1</mn><mo>+</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mo stretchy="false">⌈</mo><mi>m</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow></msub><mfrac><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>=</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H \le 1 + \log_{\lceil m / 2 \rceil} \frac{n + 1}{2} = \log_2(n + 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2642479999999998em;vertical-align:-0.41913999999999996em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">⌈</span><span class="mord mathdefault mtight">m</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mclose mtight">⌉</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li><p>包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个 <strong>内部</strong> 节点的红黑树，高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p><ul><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mi>h</mi><mo>≤</mo><mn>2</mn><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(n + 1) \le h \le 2 \cdot \log_2(n + 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p></li><li><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 为偶数，则对应 B-树高度至少为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">h / 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord">/</span><span class="mord">2</span></span></span></span></p><ul><li><p>至少包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>min</mi><mo>⁡</mo></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>4</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><msup><mn>2</mn><mrow><mi>h</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>h</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">N_{\min} = 2 \times (1 + 2 + 4 + \dots + 2^{h / 2 - 1}) = 2^{h / 2 + 1} - 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9713299999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个节点</p><p>故 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>max</mi><mo>⁡</mo></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_{\max} = 2 \times (\lfloor \log_2(N + 2) \rfloor - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p></li></ul></li><li><p>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> 为奇数，则对应 B-树高度至少为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">(h + 1) / 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span></span></span></span></p><ul><li><p>至少包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>min</mi><mo>⁡</mo></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>4</mn><mo>+</mo><mo>⋯</mo><mo>+</mo><msup><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><msup><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>3</mn><mo>⋅</mo><msup><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">N_{\min} = 2 \times (1 + 2 + 4 + \dots + 2^{(h - 1) / 2 - 1}) + 2^{(h + 1) / 2 - 1} = 3 \cdot 2^{(h - 1) / 2} - 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9713299999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个节点</p><p>故 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>max</mi><mo>⁡</mo></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mo>+</mo><mn>2</mn></mrow><mn>3</mn></mfrac><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h_{\max} = 2 \times \lfloor \log_2 (\frac{N + 2}{3}) \rfloor + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p></li></ul></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/PixPin_2025-11-08_13-15-10.png" alt="PixPin_2025-11-08_13-15-10"></p></li></ul><h4 id="插入">插入</h4><ul><li>按 BST 规则插入新关键码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span><ul><li>除非是首个节点，否则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 的父亲 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 必存在</li><li>先将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 染红，条件 1、2、4 依然满足</li><li>但可能出现双红，此时考查<ul><li>祖父 <code>g = p-&gt;parent</code> 必存在且为黑</li><li>叔父 <code>u = uncle(x) = sibling(p)</code> ，无非两种情况</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; RedBlack&lt;T&gt;::<span class="built_in">insert</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (x) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="comment">// 创建红节点 x, 以_hot 为父, 黑高度 = 0</span></span><br><span class="line">    x = <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, _hot, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="number">0</span>); _size++;</span><br><span class="line">    BinNodePosi&lt;T&gt; xOld = x;</span><br><span class="line">    <span class="built_in">solveDoubleRed</span>(x); <span class="keyword">return</span> xOld;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="双红修正">双红修正</h5><h6 id="rr-1-u-color-b">RR-1: <code>u-&gt;color = B</code></h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006165120348.png" alt="image-20251006165120348"></p><ul><li>此时，x、p、g 的四个孩子（可能是外部节点）全黑，且黑高度相同</li><li>可进行局部“3+4”重构，b 转黑，a 或 c 转红<ul><li>从 B-树的角度，相当于原三叉节点插入红关键码后，原黑关键码不再居中</li></ul></li></ul><h6 id="rr-2-u-color-r">RR-2: <code>u-&gt;color = R</code></h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006165410103.png" alt="image-20251006165410103"></p><ul><li>等效于在 B-树中，超级节点发生上溢</li><li>故可以让 p 和 u 转黑，g 转红<ul><li>等效于 <strong>节点分裂，关键码 g 上升一层</strong></li><li>所以可能将双红向上传播<ul><li>继续如法炮制即可</li><li>直至不再双红，或抵达树根（整树黑高度+1）</li></ul></li></ul></li></ul><h6 id="复杂度">复杂度</h6><ul><li>重构、染色均只需常数时间</li><li>故 <code>RedBlack::insert()</code> 仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间<ul><li>期间至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次重染色、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 次旋转</li><li>分摊意义下，重染色次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><table><thead><tr><th></th><th>旋转</th><th>染色</th><th>此后</th></tr></thead><tbody><tr><td>u 为黑</td><td>1~2</td><td>2</td><td>调整随即完成</td></tr><tr><td>u 为红</td><td>0</td><td>3</td><td>可能再次双红，但必上升两层</td></tr></tbody></table><h4 id="删除">删除</h4><ul><li>首先按 BST 常规算法进行删除 <code>r = removeAt(x, _hot)</code><ul><li>实际被摘除的可能是 x 的前驱或者后继</li></ul></li><li><strong>x 由其孩子 r 接替</strong>，此时另一孩子 k 必为 NULL<ul><li>但实际调整过程中，x 可能逐层上升</li><li>故等效地理解为，k 是一棵 <strong>黑高度</strong> 与 r 相等的子树</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251006172058188.png" alt="image-20251006172058188"></p><ul><li><p>此时条件 1、2 依然满足，但条件 3、4 未必</p><ul><li><p>其一为红</p><ul><li>若 x 为红，则 3、4 自然满足</li><li>若 r 为红，则令其与 x <strong>交换颜色</strong> 即可</li></ul></li><li><p>若 x 和 r 均黑，则此时全树黑深度不再统一</p><ul><li><p>等效于 B-树中 x 所属节点发生下溢</p></li><li><p>在 <strong>新树</strong> 中，考查 r 的父亲，兄弟</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = r-&gt;parent;</span><br><span class="line">s = <span class="built_in">sibling</span>(r);</span><br></pre></td></tr></table></figure><p>无非四种情况，分别处理</p></li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">bool</span> RedBlack&lt;T&gt;::<span class="built_in">remove</span>(<span class="type">const</span> T &amp;e) &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; &amp;x = <span class="built_in">search</span>(e);</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    BinNodePosi&lt;T&gt; r = <span class="built_in">removeAt</span>(x, _hot); <span class="comment">// 删除_hot 的某孩子, r 指向其接替者</span></span><br><span class="line">    <span class="keyword">if</span> (!(--_size)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!_hot) &#123; <span class="comment">// 删除的是根, 直接染黑</span></span><br><span class="line">        _root-&gt;color = RB_BLACK; _root-&gt;<span class="built_in">updateHeight</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">BlackHeightUpdated</span>(_hot)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">IsRed</span>(r)) &#123;</span><br><span class="line">        r-&gt;color = RB_BLACK;</span><br><span class="line">        r-&gt;height++; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">solveDoubleBlack</span>(r); <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="双黑修正">双黑修正</h5><h6 id="bb-1">BB-1</h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250925172550770.png" alt="image-20250925172550770"></p><ul><li>s 为黑，且至少有一个红孩子 t</li><li>进行“3+4”重构，r 保持黑，a、c 染黑，b 继承 p 的原色<ul><li>在 B-树中，等效于旋转修复下溢（<strong>够借</strong>）</li></ul></li></ul><h6 id="bb-2r">BB-2R</h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250925173025672.png" alt="image-20250925173025672"></p><ul><li>s 为黑，且两个孩子均为黑；p 为红</li><li>r 保持黑，s 转红，p 转黑<ul><li>等效于下溢节点与兄弟节点合并</li><li>同时因为 p 左右还有黑关键码，不会导致下溢传播</li></ul></li></ul><h6 id="bb-2b">BB-2B</h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250925173228411.png" alt="image-20250925173228411"></p><ul><li>s 为黑，且两个孩子均为黑；p 为黑</li><li>r 保持黑，s 转红，p 转黑<ul><li>也等效于下溢节点与兄弟节点合并</li><li>但合并前，p 和 s 均属于单关键码节点，故 <strong>父节点继续下溢</strong><ul><li>继续处理即可，至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 步</li></ul></li></ul></li></ul><h6 id="bb-3">BB-3</h6><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250925173504104.png" alt="image-20250925173504104"></p><ul><li>s 为红（其孩子均为黑）</li><li>绕 p 单旋，s 由红转黑，p 由黑转红<ul><li>黑高度依然异常，但 r 有了新的（黑）兄弟</li><li>且由于 p 转红，接下来的情况变为 BB-1 或 BB-2R</li><li>再调整一轮，即可恢复</li><li>道理是“存在红色就可以在子树中腾挪”，但需要先调整一下形态<ul><li>想在红黑树的等效 B-树节点中交换节点颜色（即在 B-树中改变与上层节点的联接），需要进行旋转</li></ul></li></ul></li></ul><h6 id="复杂度">复杂度</h6><ul><li><code>RedBlack&lt;T&gt;::remove</code> 仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间<ul><li>期间至多 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 次重染色、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 次旋转</li><li>分摊意义下，重染色次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><table><thead><tr><th></th><th>旋转</th><th>染色</th><th>此后</th></tr></thead><tbody><tr><td>（1）黑 s 有红子 t</td><td>1~2</td><td>3</td><td>调整随即完成</td></tr><tr><td>（2R）黑 s 无红子，p 红</td><td>0</td><td>2</td><td>调整随即完成</td></tr><tr><td>（2B）黑 s 无红子，p 黑</td><td>0</td><td>1</td><td>必再次双黑，但上升一层</td></tr><tr><td>（3）红 s</td><td>1</td><td>2</td><td>转为（1）或（2R）</td></tr></tbody></table><h2 id="词典">词典</h2><h3 id="散列">散列</h3><ul><li><strong>循对象访问</strong><ul><li><code>entry = (key, value)</code></li><li>关键码未必可定义大小（但可判等），查找对象不限于最大/最小词条</li></ul></li></ul><h4 id="散列表-散列函数">散列表/散列函数</h4><ul><li>桶（bucket）：直接存放或间接指向一个词条<ul><li>Bucket array <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> Hash table<ul><li>容量：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">M</span></span></span></span></span></li><li>满足：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">N</mi><mo>&lt;</mo><mi mathvariant="script">M</mi><mo>≪</mo><mi mathvariant="script">R</mi></mrow><annotation encoding="application/x-tex">\mathcal{N} &lt; \mathcal{M} \ll \mathcal{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathcal">M</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">R</span></span></span></span></span> （所有可能的对象）</li><li>空间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi mathvariant="script">N</mi><mo>+</mo><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi mathvariant="script">N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(\mathcal{N} + \mathcal{M}) = \mathcal{O}(\mathcal{N})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li>定址<ul><li>根据词条的 key（未必可比较）， <strong>“直接”确定散列表入口</strong> （无论表有多长）<ul><li>散列函数<ul><li><code>hash()</code>: $ key \rightarrow &amp;entry$</li><li>如 <code>hash(key) = key % M</code></li></ul></li><li>“直接”：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mo>−</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">expected-O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><h4 id="冲突">冲突</h4><ul><li><p>同义词：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>1</mn></msub><mo mathvariant="normal">≠</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>2</mn></msub><mspace width="1em"/><mtext>but</mtext><mspace width="1em"/><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">key_1 \ne key_2 \quad \text{but} \quad hash(key_1) = hash(key_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">but</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p></li><li><p>装填因子 <code>load factor</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 空间利用率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mi>N</mi><mi mathvariant="normal">/</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">\lambda = N / M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> 越大/小<ul><li>空间利用率越高/低</li><li>冲突的情况越严重/轻微</li></ul></li><li>降低 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> ，冲突程度将会有所改善<ul><li>但只要数据集动态变化，就无法根除</li></ul></li></ul></li><li><p>完美散列：数据集已知且固定时，可实现完美散列</p><ul><li>采用两级散列模式</li><li>仅需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 空间</li><li>关键码之间互不冲突</li><li>最坏情况下的查找时间也不过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>基本任务</p><ul><li>精心设计散列表及散列函数，尽可能 <strong>降低</strong> 冲突的概率</li><li>制定可行的预案，以便在发生冲突时，能够尽快予以排解</li></ul></li></ul><h3 id="散列函数">散列函数</h3><ul><li>评价和设计原则<ul><li>确定：同一关键码总是被映射至 <strong>同一</strong> 位置</li><li>快速：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mo>−</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">expected-O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li>满射：尽可能充分利用整个散列空间</li><li>均匀：关键码映射到散列表各位置的概率尽量接近<ul><li>避免聚集现象</li></ul></li></ul></li></ul><h4 id="基本">基本</h4><h5 id="除余法">除余法</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mi>e</mi><mi>y</mi><mtext> </mtext><mi mathvariant="normal">%</mi><mtext> </mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">hash(key) = key \, \% \, M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">%</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span><ul><li>据说 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 为素数时，数据对散列表的覆盖最充分，分布最均匀<ul><li>但对于理想随机的序列，表长是否素数，无关紧要</li></ul></li><li>序列的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Kolmogorov</mtext></mrow><annotation encoding="application/x-tex">\text{Kolmogorov}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">Kolmogorov</span></span></span></span></span> 复杂度：生成该序列的算法，最短可用多少行代码实现？</li><li>实际应用中的数据序列 <strong>远非理想随机</strong><ul><li>面对往往具有周期的词条，将 <strong>散列表长</strong> 取作素数，可将 <strong>聚集</strong> 之概率降至最低</li></ul></li></ul></li></ul><h5 id="mad-法">MAD 法</h5><ul><li>除余法的缺陷<ul><li>不动点：无论表长 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 取值如何，总有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>≡</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">hash(0) \equiv 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li><li>相关性：虽然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 的关键码平均分配至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 个桶，但 <strong>相邻</strong> 关键码的散列地址也必相邻</li></ul></li><li><code>Multiply-Add-Divide</code><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>×</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><mi>M</mi><mo separator="true">,</mo><mtext> </mtext><mi>M</mi><mtext> </mtext><mtext>prime</mtext><mo separator="true">,</mo><mi>a</mi><mo>&gt;</mo><mn>1</mn><mo separator="true">,</mo><mi>b</mi><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo><mi>M</mi><mo>∤</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">hash(key) = (a \times key + b) \% M, \, M \, \text{prime}, a &gt; 1, b &gt; 0, M \nmid a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord">%</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">prime</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.99253em;vertical-align:-0.25142em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span></li></ul></li></ul><h5 id="更多">更多</h5><ul><li>平方取中/mid-square</li><li>折叠法</li><li>位异或法</li><li>总之，越是随机，越是 <strong>没有规律</strong>，越好</li></ul><h4 id="随机数">随机数</h4><h5 id="伪-随机数法">（伪）随机数法</h5><ul><li>径取：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>×</mo><msup><mi>a</mi><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></msup><mo stretchy="false">]</mo><mi mathvariant="normal">%</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">hash(key) = rand(key) = [rand(0) \times a^{key}] \% M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">%</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li><li>种子：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">rand(0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> next = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">srand</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> seed)</span> </span>&#123; next = seed; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rand</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    next = next * <span class="number">1103515425</span> + <span class="number">12345</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>) (M / <span class="number">65536</span>) % <span class="number">32768</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>创建的散列表可移植性差</li></ul><h5 id="就地随机置乱">就地随机置乱</h5><ul><li>任给一个数组 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A[0, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，理想地将其中元素的次序随机打乱</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">shuffle</span><span class="params">(<span class="type">int</span> A[], <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; n &gt; <span class="number">1</span>; n--)</span><br><span class="line">        <span class="built_in">swap</span>(A[<span class="built_in">rand</span>() % M], A[n - <span class="number">1</span>]);</span><br><span class="line">&#125; <span class="comment">// 20! &lt; 2^64 &lt; 21!</span></span><br></pre></td></tr></table></figure><h4 id="hashcode-与多项式法">hashCode 与多项式法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> Rank <span class="title">hashCode</span><span class="params">(<span class="type">char</span> s[])</span> </span>&#123;</span><br><span class="line">    Rank n = <span class="built_in">strlen</span>(s); Rank h = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        h = (h &lt;&lt; <span class="number">5</span>) | (h &gt;&gt; <span class="number">27</span>);</span><br><span class="line">        h += s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="排解冲突">排解冲突</h3><h4 id="开放散列">开放散列</h4><h5 id="多槽位">多槽位</h5><ul><li><p>桶单元细分成若干槽位，存放（与同一单元）冲突的词条</p></li><li><p>只要槽位数目不太多，可以保证 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 的时间效率</p></li><li><p>但可能导致空间浪费，或极端情况下始终不够</p></li></ul><h5 id="独立链">独立链</h5><ul><li>每个桶拥有一个列表，存放对应的一组同义词</li><li>优点<ul><li>无需为每个桶预备多个槽位</li><li>任意多次的冲突都可解决</li></ul></li><li>缺点<ul><li>耗费更多空间和时间</li><li>空间未必连续分布，缓存难以生效</li></ul></li></ul><h6 id="两个结论">两个结论</h6><blockquote><p>在 <strong>简单均匀</strong> 散列的假设下，对于使用 <strong>独立链</strong> 法解决冲突的散列表</p><ul><li><p>一次不成功查找的平均时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(1+\lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span></p></li><li><p>一次成功查找的平均时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(1+\lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span></p></li></ul></blockquote><p>装填因子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mi>n</mi><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">\lambda = \frac{n}{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ，在简单均匀散列的假设下，意味着每条独立链的期望长度即为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span></p><p>故一次不成功的查找平均要检查 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> 个元素，总平均时间（包括计算 hash 的时间）为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(1 + \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span></p><p>而对于成功查找，考虑顺序插入的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个关键字 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>k</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">k_1, k_2, \dots, k_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>根据简单均匀散列假设，<strong>任意两个关键字被插入同一链条的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></strong></p><p>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，其所在链条中排在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 之前的元素数量期望为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>−</mo><mi>i</mi></mrow><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{n - i}{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.200664em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.855664em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>故总期望查找时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mi>i</mi></mrow><mi>m</mi></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mi>m</mi></mrow></mfrac><mo stretchy="false">[</mo><msup><mi>n</mi><mn>2</mn></msup><mo>−</mo><mfrac><mrow><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mi>λ</mi><mn>2</mn></mfrac><mo>−</mo><mfrac><mi>λ</mi><mrow><mn>2</mn><mi>n</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \frac{1}{n}\sum_{i = 1}^n(1 + \frac{n - i}{m}) &amp;= 1 + \frac{1}{nm} \sum_{i = 1}^n (n - i) \\ &amp;= 1 + \frac{1}{nm}[n^2 - \frac{n(n + 1)}{2}] \\ &amp;= 1 + \frac{n - 1}{2m} = 1 + \frac{\lambda}{2} - \frac{\lambda}{2n} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.999506000000001em;vertical-align:-3.749753000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.249753em;"><span style="top:-6.249753em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.245083999999999em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span><span style="top:-0.8876439999999993em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.749753000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.249753em;"><span style="top:-6.249753em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span><span style="top:-3.245083999999999em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span><span style="top:-0.8876439999999993em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.749753000000001em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>因此总平均时间（包括计算散列函数的时间）为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>2</mn><mo>+</mo><mfrac><mi>λ</mi><mn>2</mn></mfrac><mo>−</mo><mfrac><mi>λ</mi><mrow><mn>2</mn><mi>n</mi></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(2 + \frac{\lambda}{2} - \frac{\lambda}{2n}) = \Theta(1 + \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span></p><h5 id="公共溢出区">公共溢出区</h5><ul><li>单独开辟一块连续空间，发生冲突的词条，顺序存入此区域</li><li>结构简单易于实现</li><li>一旦发生冲突，最坏情况下，处理冲突的时间将正比于溢出区的规模</li></ul><h4 id="封闭散列">封闭散列</h4><ul><li>封闭散列：散列表的物理空间相对固定，所有冲突都在 <strong>内部</strong> 寻求解决</li><li><strong>开放定址</strong>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo mathvariant="normal">≠</mo></mrow><annotation encoding="application/x-tex">\ne</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span></span></span></span> 开放散列）：只要有必要，任何散列桶都可以接纳任何词条</li><li>试探链（Probe Chain）：为每一组同义词，都 <strong>事先约定了若干备用桶</strong>，一次串接成序列/链<ul><li>查找算法：沿试探链逐个检视，直到命中成功，或抵达空桶而失败</li></ul></li><li>相对于开放散列，整体结构更加整饬，cache 机制易生效</li></ul><blockquote><p>给定一个装填因子 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mi>n</mi><mi>m</mi></mfrac><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda = \frac{n}{m} &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 的开放寻址散列表，假设是均匀散列且各关键字被查找可能性相同，则</p><ul><li>一次不成功的查找，期望探查次数至多为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{1 - \lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>一次成功的查找，期望探查次数至多为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>λ</mi></mfrac><mi>ln</mi><mo>⁡</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{\lambda} \ln \frac{1}{1 - \lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></blockquote><ul><li>在一次不成功的查找（最后一次槽为空）中，令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> 为探查次数<ul><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，在前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 次探查都是已占用槽的前提下，第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 次探查且探查到的仍是占用槽的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>n</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{n - i + 1}{m - i + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.258995em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.855664em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>X</mi><mo>≥</mo><mi>i</mi><mo stretchy="false">}</mo><mo>=</mo><mfrac><mi>n</mi><mi>m</mi></mfrac><mo>⋅</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>2</mn></mrow></mfrac><mo>⋯</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>2</mn></mrow></mfrac><mo>≤</mo><mo stretchy="false">(</mo><mfrac><mi>n</mi><mi>m</mi></mfrac><msup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\Pr\{X \ge i\} = \frac{n}{m} \cdot \frac{n - 1}{m - 1} \cdot \frac{n - 2}{m - 2} \cdots \frac{n - i + 2}{m - i + 2} \le (\frac{n}{m})^{i - 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.258995em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.855664em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.169664em;vertical-align:-0.345em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>E</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mi>i</mi><mo>⋅</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>X</mi><mo>=</mo><mi>i</mi><mo stretchy="false">}</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>X</mi><mo>≥</mo><mi>i</mi><mo stretchy="false">}</mo><mo>≤</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></munderover><msup><mi>λ</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}E[X] = \sum_{i=1}^\infty i \cdot \Pr\{X = i\} =  \sum_{i = 1}^\infty \Pr\{X \ge i\} \le \sum_{i = 1}^\infty \lambda^{i - 1} = \frac{1}{1 -\lambda} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.2290660000000004em;vertical-align:-1.364533em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8645330000000004em;"><span style="top:-3.8645330000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">Pr</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">Pr</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">i</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.364533em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul></li><li>对第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个被插入表中的关键字 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的一次查找，探查的期望次数至多为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>i</mi><mi mathvariant="normal">/</mi><mi>m</mi></mrow></mfrac><mo>=</mo><mfrac><mi>m</mi><mrow><mi>m</mi><mo>−</mo><mi>i</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{1 - i / m} = \frac{m}{m - i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0987230000000001em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ，故一次成功查找的期望探查次数至多为<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mfrac><mi>m</mi><mrow><mi>m</mi><mo>−</mo><mi>i</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>λ</mi></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mi>m</mi><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>m</mi></munderover><mfrac><mn>1</mn><mi>k</mi></mfrac><mo>≤</mo><mfrac><mn>1</mn><mi>λ</mi></mfrac><msubsup><mo>∫</mo><mrow><mi>m</mi><mo>−</mo><mi>n</mi></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>x</mi><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">d</mi><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><mi>λ</mi></mfrac><mi>ln</mi><mo>⁡</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\frac{1}{n}\sum_{i = 0}^{n - 1}\frac{m}{m - i} = \frac{1}{\lambda} \sum_{k = m - n + 1}^m \frac{1}{k} \le \frac{1}{\lambda} \int_{m-n}^{m} (1/x)\, {\rm d}x = \frac{1}{\lambda} \ln \frac{1}{1 - \lambda} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.4615570000000004em;vertical-align:-1.4807785000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9807785000000002em;"><span style="top:-3.9807785000000004em;"><span class="pstrut" style="height:3.8011130000000004em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">i</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.360444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4807785000000002em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul></li></ul><h5 id="线性试探">线性试探</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mtext>hash</mtext><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>i</mi><mo stretchy="false">)</mo><mtext> </mtext><mtext>mod</mtext><mtext> </mtext><mi mathvariant="script">M</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">r_i(key) = (\text{hash}(key) + i) \, \text{mod} \, \mathcal{M}, \quad i = 0, 1, 2, 3, \dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">hash</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span class="mord">mod</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathcal">M</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span></span></span></span></li><li>只要还有空桶，试探链就不会循环，查找也能终止</li><li>试探链会相互重叠，非同义词会彼此堆积<ul><li>控制好装填因子，冲突和堆积都不致太严重：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>e</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">E(probes) = \frac{1}{1 - \lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>数据局部性极佳，系统缓存的作用发挥极致</li></ul><blockquote><p>对于一个装填因子为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mfrac><mi>n</mi><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">\lambda = \frac{n}{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的采用线性试探的散列表，平均成功探查次数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi></mrow></msub><mo>∼</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>λ</mi></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ASL_{succ}\sim \frac{1}{2}(1 + \frac{1}{1 - \lambda})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span> ，平均失败探查次数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><msub><mi>L</mi><mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>l</mi></mrow></msub><mo>∼</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ASL_{fail}\sim \frac{1}{2}(1 + \frac{1}{(1 - \lambda)^2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">λ</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></p><p>对于一组固定的键，它们的总探查次数是一个固定值，与插入顺序无关</p></blockquote><h4 id="懒惰删除">懒惰删除</h4><ul><li>仅做标记，不对试探链做更多调整<ul><li><code>Bitmap *removed;</code></li><li>查找时，被视为“<strong>必不匹配的非空桶</strong>”，使得试探链可以在此 <strong>延续</strong></li><li>插入时，被视作“<strong>总是匹配的空闲桶</strong>”，以存放新词条</li><li>装填因子的计算口径有变</li></ul></li><li>试探链因此可能彼此有所重叠<ul><li>任何一个带有懒惰删除标记的桶，都可能同时属于多个试探链</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; Rank Hashtable&lt;K, V&gt;::<span class="built_in">probe4Hit</span>(<span class="type">const</span> K &amp;k) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Rank r = <span class="built_in">hashCode</span>(k) % M; ; r = (r + <span class="number">1</span>) % M)</span><br><span class="line">        <span class="keyword">if</span> (ht[r] &amp;&amp; (k == ht[r]-&gt;key) ||</span><br><span class="line">           !ht[r] &amp;&amp; !removed-&gt;<span class="built_in">test</span>(r)) &#123; <span class="comment">// 跳过被删除的桶</span></span><br><span class="line">            <span class="keyword">return</span> r;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; Rank Hashtable&lt;K, V&gt;::<span class="built_in">probe4Free</span>(<span class="type">const</span> K &amp;k) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Rank r = <span class="built_in">hashCode</span>(k) % M; ; r = (r + <span class="number">1</span>) % M)</span><br><span class="line">        <span class="keyword">if</span> (!ht[r]) <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="重散列">重散列</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="type">bool</span> Hashtable&lt;K, V&gt;::<span class="built_in">remove</span>(K k) &#123;</span><br><span class="line">    Rank r = <span class="built_in">prob4Hit</span>(k);</span><br><span class="line">    <span class="keyword">if</span> (!ht[r]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">delete</span> ht[r]; ht[r] = <span class="literal">NULL</span>; --N;</span><br><span class="line">    removed-&gt;<span class="built_in">set</span>(r);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="type">bool</span> Hashtable&lt;K, V&gt;::<span class="built_in">put</span>(K k, V v) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ht[<span class="built_in">probe4Hit</span>(k)]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Rank r = <span class="built_in">probe4Free</span>(k);</span><br><span class="line">    ht[r] = <span class="keyword">new</span> <span class="built_in">Entry</span>&lt;K, V&gt;(k, v); ++N;</span><br><span class="line">    removed-&gt;<span class="built_in">clear</span>(r); <span class="comment">// 清除懒惰标记</span></span><br><span class="line">    <span class="keyword">if</span> ((N + removed-&gt;<span class="built_in">size</span>()) * <span class="number">2</span> &gt; M)</span><br><span class="line">        <span class="built_in">rehash</span>(); <span class="comment">// 装填因子计入懒惰标记位, 且达到阈值进行重散列</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Rehashing：随着装填因子攀升，冲突激增；超过阈值后，便需要扩容</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="type">void</span> Hashtable&lt;K, V&gt;::<span class="built_in">rehash</span>() &#123;</span><br><span class="line">    Rank oldM = M; Entry&lt;K, V&gt; **oldHt = ht;</span><br><span class="line">    ht = <span class="keyword">new</span> Entry&lt;K, V&gt; *[M = <span class="built_in">primeNLT</span>(<span class="number">4</span> * N)]; N = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(ht, <span class="number">0</span>, <span class="built_in">sizeof</span>(Entry&lt;K,V&gt;*) * M);</span><br><span class="line">    <span class="comment">// 新表扩容并初始化各桶</span></span><br><span class="line">    <span class="keyword">delete</span> removed; removed = <span class="keyword">new</span> <span class="built_in">Bitmap</span>(M);</span><br><span class="line">    <span class="keyword">for</span> (Rank i = <span class="number">0</span>; i &lt; oldM; i++)</span><br><span class="line">        <span class="keyword">if</span> (oldHt[i]) <span class="comment">// 不能直接复制, 逐个转入新表</span></span><br><span class="line">            <span class="built_in">put</span>(oldHt[i]-&gt;key, oldHt[i]-&gt;value);</span><br><span class="line">    <span class="keyword">delete</span>[] oldHt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="平方试探">平方试探</h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>i</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>M</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">r_i(key) = ({\rm hash}(key) + i^2) \, {\rm mod} \, M, \quad i = 0, 1, 2, 3, \dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">h</span><span class="mord mathrm">a</span><span class="mord mathrm">s</span><span class="mord mathrm">h</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span></span></span></span><ul><li>沿着试探链，各桶的间距线性递增</li></ul></li><li>数据堆积现象改善，cache 利用率下降但依旧够用</li><li>表长为 <strong>素数</strong> （不仅限于）时，只要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&lt;</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\lambda &lt; 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span> 就一定可以找到空桶<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 为素数，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mtext> </mtext><mi mathvariant="normal">%</mi><mtext> </mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">n^2 \, \% \,M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8696679999999999em;vertical-align:-0.05556em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">%</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> <strong>恰有</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil M / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 种取值，且由试探链的 <strong>前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil M / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 项取遍</strong><ul><li>反证，假设存在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>a</mi><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">0 \le a &lt; b &lt; \lceil M / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> ，使得第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> 项冲突</li><li>则有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>≡</mo><msup><mi>b</mi><mn>2</mn></msup><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^2 \equiv b^2 \quad({\rm mod} \, M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span> ，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>b</mi><mo>+</mo><mi>a</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mo>≡</mo><mn>0</mn><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(b + a) \cdot (b - a) \equiv 0 \quad ({\rm mod} \, M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></li><li>然而，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo>≤</mo><mi>b</mi><mo>+</mo><mi>a</mi><mo>&lt;</mo><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>+</mo><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><mo>+</mo><mo stretchy="false">⌊</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌋</mo><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">0 &lt; b - a \le b + a &lt; \lceil M / 2 \rceil + (\lceil M / 2 \rceil - 1) \le \lceil M / 2 \rceil + \lfloor M / 2 \rfloor = M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li><li>无论 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">b - a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> 还是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>+</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">b + a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> 都不可能整除 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li></ul></li></ul></li></ul><h4 id="双向平方试探">双向平方试探</h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">h</mi></mrow><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mo stretchy="false">(</mo><mo stretchy="false">⌈</mo><mi>i</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo><mtext> </mtext><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>M</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">r_i(key) = ({\rm hash}(key) + (-1)^{i + 1} \cdot (\lceil i / 2 \rceil)^2) \, {\rm mod} \, M, \quad i = 0, 1, 2, 3, \dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">h</span><span class="mord mathrm">a</span><span class="mord mathrm">s</span><span class="mord mathrm">h</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">⌈</span><span class="mord mathdefault">i</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span></span></span></span></li><li>正向和反向的子试探链，各自包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil M / 2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌈</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌉</span></span></span></span> 个互异的桶<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mo stretchy="false">⌊</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌋</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">⌊</mo><mi>M</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">-\lfloor M / 2 \rfloor, \dots, -2, -1, 0, 1, 2, \dots, \lfloor M / 2 \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">⌊</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌋</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">⌊</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">⌋</span></span></span></span></li><li>表长取 <strong>素数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mo>=</mo><mn>4</mn><mo>⋅</mo><mi>k</mi><mo>+</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\mathcal{M} = 4 \cdot k + 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">M</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></strong>（但不仅限于这些数），则 <strong>必然</strong> 可以保证试探链的前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 项互异<ul><li>原理：素数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 不能表示为一对整数的平方和，当且仅当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≡</mo><mn>3</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p \equiv 3 ({\rm mod} \, 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><h4 id="双散列">双散列</h4><ul><li><p>预先约定第二散列函数：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hash_2(key, i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></p><ul><li><p>冲突时，由其确定偏移增量，确定下一试探位置</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo stretchy="false">(</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi>h</mi><mi>a</mi><mi>s</mi><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">%</mi><mtext> </mtext><mi>M</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}(hash(key) + \sum_{i = 1}^k hash_2(key, i)) \, \% \, M\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.4137820000000003em;vertical-align:-1.4568910000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9568910000000002em;"><span style="top:-3.9568909999999997em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">%</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4568910000000002em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul></li><li><p>线性试探：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo>≡</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">hash_2(key, i) \equiv 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p></li><li><p>平方试探：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">hash_2(key, i) = 2i - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p></li></ul><h3 id="桶排序">桶排序</h3><h4 id="算法">算法</h4><ul><li>简单情况<ul><li>对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> 内的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">&lt;m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>）个互异整数，借助散列表 <code>H[]</code> 进行排序</li><li>空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> ，时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul></li><li>复杂情况<ul><li>允许相等的元素（可能 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≪</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \ll n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>）</li><li>依然使用散列表，每一组同义词各成一个链表<ul><li>可稳定</li></ul></li><li>空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> ，时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="max-gap">Max Gap</h4><ul><li>任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个互异点均将实轴分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 段有界区间，其中的哪一段最长？<ul><li>排序再计算—— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>采用分桶策略，可改进至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>线性算法<ul><li>一趟扫描找到最左、最右点</li><li>将有效范围 <strong>均等</strong> 划分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 段（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个桶）</li><li>通过散列，将各点归入对应的桶<ul><li>各桶动态更新最左点、最右点</li></ul></li><li>计算相邻 <strong>非空</strong> 桶之间的“距离”</li><li>最大距离即 Max Gap</li></ul></li><li>正确性：由于有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个数、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个桶，Max Gap <strong>至少跨越两个桶</strong></li><li>对称的 Mini Gap 问题 <strong>不能</strong> 沿用该法突破 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h3 id="基数排序">基数排序</h3><ul><li>有时，关键码由多个域（字段）组合而成：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_t, k_{t - 1}, \dots, k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 。并采用字典序的确定大小次序</li><li>可以采用 <strong>低位优先的多趟桶排序</strong> ——基数排序<ul><li>自 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">k_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>（低位优先），依次以各域为序做一趟桶排序<ul><li>正确性得益于桶排序的稳定性</li></ul></li><li>总时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><msub><mi>M</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><msub><mi>M</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>t</mi><mo>×</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + M_1) + O(n + M_2) + \dots + O(n + M_t) = O(t \times (n + M))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="常对数密度整数集">常对数密度整数集</h4><ul><li>考查取自 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>n</mi><mi>d</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, n^d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 内的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个整数，对数密度 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow><mrow><mi>ln</mi><mo>⁡</mo><msup><mi>n</mi><mi>d</mi></msup></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>d</mi></mfrac><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\ln n}{\ln n^d} = \frac{1}{d} = O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2375279999999997em;vertical-align:-0.3574199999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.64258em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7820285714285713em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3574199999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><ul><li>这类整数集的对数密度不超过常数</li></ul></li><li>此时可将所有元素预处理为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 进制形式<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>d</mi></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = (x_d, \dots, x_3, x_2, x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>每个元素均转化为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 个域，然后套用基数排序</li><li>排序时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>o</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d \cdot (n + n) = O(n) = o(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h3 id="计数排序">计数排序</h3><ul><li>原理<ul><li>统计每个数出现次数</li><li>自前向后扫描各桶，依次累加<ul><li>如此可确定各元素所处的 <strong>秩区间</strong></li></ul></li><li><strong>自后向前</strong> 计算每个数的排名<ul><li>对应桶的计数减一，即是其在最终有序序列中对应的秩</li><li>不可改为从前向后扫描，否则稳定性无法保证</li></ul></li></ul></li><li>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> ，空间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> ，稳定</li></ul><h3 id="跳转表">跳转表</h3><ul><li>基于朴素的 <code>List</code> 结构，采取随机策略<ul><li>从 <strong>数学期望</strong> 的角度控制查找长度</li></ul></li></ul><h4 id="结构">结构</h4><ul><li>逐层 <strong>折半稀疏</strong> 的列表：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>S</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">S_0, S_1, \dots, S_h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><ul><li>依次叠放耦合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">S_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> / <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">S_h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 称作底/顶层</li></ul></li><li>横向为层 <code>level</code> ：<code>prev()</code> 、<code>next()</code> 、哨兵</li><li>纵向成塔 <code>tower</code> ：<code>above()</code> 、<code>below()</code></li><li>四联节点</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250927204908210.png" alt="image-20250927204908210"></p><ul><li>空间性能 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow><annotation encoding="application/x-tex">{\rm expected}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">p</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">t</span><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span></span></span></span></span>-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">S_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中任一关键码在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">S_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中依然出现的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">p^{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></li><li>第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 层节点数的期望值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mrow><mo fence="true">∣</mo><msub><mi>S</mi><mi>k</mi></msub><mo fence="true">∣</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo>⋅</mo><msup><mi>p</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">E(\left\vert S_k \right\vert) = n \cdot p^{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></li><li>所有节点期望总数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><msub><mo>∑</mo><mi>k</mi></msub><mrow><mo fence="true">∣</mo><msub><mi>S</mi><mi>k</mi></msub><mo fence="true">∣</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo>×</mo><msub><mo>∑</mo><mi>k</mi></msub><msup><mi>p</mi><mi>k</mi></msup><mo>=</mo><mfrac><mi>n</mi><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow></mfrac><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(\sum_k \left\vert S_k \right\vert) = n \times \sum_k p^{k} = \frac{n}{1 - p} = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.148818em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1764999999999999em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="查找-插入和删除">查找、插入和删除</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="comment">// 关键码不大于 k 的最后一个词条(所对应塔的基座)</span></span><br><span class="line">QNodePosi&lt;Entry&lt;K, V&gt;&gt; Skiplist&lt;K, V&gt;::<span class="built_in">search</span>(K k) &#123;</span><br><span class="line">    <span class="keyword">for</span> (QNodePosi&lt;Entry&lt;K, V&gt;&gt; p = <span class="built_in">first</span>()-&gt;data-&gt;head; ; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;succ-&gt;succ &amp;&amp; (p-&gt;succ-&gt;entry.key &lt;= k)) p = p-&gt;succ; <span class="comment">// 尽可能右移</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p-&gt;below) p = p-&gt;below; <span class="comment">// 水平越界时, 下移</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="type">bool</span> Skiplist&lt;K, V&gt;::<span class="built_in">put</span>(K k, V v) &#123;</span><br><span class="line">    Entry&lt;K, V&gt; e = <span class="built_in">Entry</span>&lt;K, V&gt;(k, v);</span><br><span class="line">    QNodePosi&lt;Entry&lt;K, V&gt;&gt; p = <span class="built_in">search</span>(k);</span><br><span class="line">    ListNodePosi&lt;Quadlist&lt;Entry&lt;K, V&gt;&gt;* &gt; qlist = <span class="built_in">last</span>(); <span class="comment">// 从底层开始</span></span><br><span class="line">    QNodePosi&lt;Entry&lt;K, V&gt;&gt; b = qlist-&gt;data-&gt;<span class="built_in">insert</span>(e, p); <span class="comment">// 创建新塔的基座</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">rand</span>() &amp; <span class="number">1</span>) &#123; <span class="comment">// 建塔</span></span><br><span class="line">        <span class="keyword">while</span> (p-&gt;pred &amp;&amp; !p-&gt;above) p = p-&gt;pred; <span class="comment">// 找出不低于此时高度的最近前驱</span></span><br><span class="line">        <span class="keyword">if</span> (!p-&gt;pred &amp;&amp; !p-&gt;above) &#123; <span class="comment">// 需创建新的一层</span></span><br><span class="line">            <span class="built_in">insertFirst</span>(<span class="keyword">new</span> Quadlist&lt;Entry&lt;K, V&gt;&gt;);</span><br><span class="line">            <span class="built_in">first</span>()-&gt;data-&gt;<span class="built_in">head</span>()-&gt;below = qlist-&gt;data-&gt;head;</span><br><span class="line">            qlist-&gt;data-&gt;head-&gt;above = <span class="built_in">first</span>()=&gt;data-&gt;head;</span><br><span class="line">        &#125;</span><br><span class="line">        p = p-&gt;above; qlist = qlist-&gt;pred;</span><br><span class="line">        b = qlist-&gt;data-&gt;<span class="built_in">insert</span>(e, p, b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> V&gt; <span class="type">bool</span> Skiplist&lt;K, V&gt;::<span class="built_in">remove</span>(K k) &#123;</span><br><span class="line">    QNodePosi&lt;Entry&lt;K, V&gt;&gt; p = <span class="built_in">search</span>(k);</span><br><span class="line">    <span class="keyword">if</span> (!p-&gt;pred || (k != p-&gt;entry.key)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    ListNodePosi&lt;Quadlist&lt;Entry&lt;K, V&gt;&gt; *&gt; qlist = <span class="built_in">last</span>();</span><br><span class="line">    <span class="keyword">while</span> (p-&gt;above) &#123; qlist = qlist-&gt;pred; p = p-&gt;above; &#125; <span class="comment">// 先升至塔顶</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        QNodePosi&lt;Entry&lt;K, V&gt;&gt; lower = p-&gt;below;</span><br><span class="line">        qlist-&gt;data-&gt;<span class="built_in">remove</span>(p);</span><br><span class="line">        p = lower; qlist = qlist-&gt;succ;</span><br><span class="line">    &#125; <span class="keyword">while</span> (qlist-&gt;succ); <span class="comment">// 拆塔</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">height</span>() &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">first</span>()-&gt;data-&gt;_size &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        List::<span class="built_in">remove</span>(<span class="built_in">first</span>());</span><br><span class="line">        <span class="built_in">first</span>()-&gt;data-&gt;head-&gt;above = <span class="literal">NULL</span>;</span><br><span class="line">    &#125; <span class="comment">// 删除已不含词条的 Quadlist</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="总览">总览</h4><ul><li>纵向跳转 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 层高<ul><li>一座塔的高度不低于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">p^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mo fence="true">∣</mo><msub><mi>S</mi><mi>k</mi></msub><mo fence="true">∣</mo></mrow><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>p</mi><mi>k</mi></msup><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo>≥</mo><mn>1</mn><mo>−</mo><mi>n</mi><mo>⋅</mo><msup><mi>p</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\Pr(\left\vert S_k \right\vert = 0) = (1 - p^k)^n \ge 1 - n \cdot p^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></li><li>跳转表高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h = \log_{1/p}(n) = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.16914em;vertical-align:-0.41913999999999996em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 的概率极大</li></ul></li><li>查找过程中，<strong>纵向</strong> 跳转的次数，累计不过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow><annotation encoding="application/x-tex">{\rm expected}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">p</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">t</span><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span></span></span></span></span>-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>单个塔高为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow><annotation encoding="application/x-tex">{\rm expected}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">p</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">t</span><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span></span></span></span></span>-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li>横向跳转 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 紧邻塔顶<ul><li>在同一水平列表中，横向跳转所经节点必然依次紧邻，而且每次抵达都是 <strong>塔顶</strong></li><li>将沿同一层列表跳转的次数记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> ，则它符合 <strong>几何分布</strong>（简化模型，最后一个也可能是塔顶）<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>⋅</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\Pr(Y=k) = (1 - p)^k \cdot p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">E(Y) = (1 - p) / p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault">p</span></span></span></span></li></ul></li><li>因此，对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">p = 1/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span></span></span></span>，在同一层列表中连续跳转的期望时间成本 = 1 次跳转 + 1 次驻足 = 2</li></ul></li><li>跳转表的每次查找，都可在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mo>−</mo><mo stretchy="false">(</mo><mn>2</mn><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi><mo>−</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\le expected-(2h) = expected-O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间内完成</li><li>通过维护每一个前向指针的长度，还可以将跳表的随机访问优化至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h2 id="图">图</h2><h3 id="概述">概述</h3><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">;</mo><mtext> </mtext><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G = (V; \, E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>V</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">n = \left\vert V \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>E</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">e = \left\vert E \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></li><li>同一条边的两个顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mtext>、</mtext><mi>v</mi></mrow><annotation encoding="application/x-tex">u、v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mord cjk_fallback">、</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 彼此邻接，若顶点次序无所谓，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 为无向边<ul><li>所有边均为方向的图为无向图</li><li>有向图中均为有向边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>→</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">u \rightarrow v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mtext>、</mtext><mi>v</mi></mrow><annotation encoding="application/x-tex">u、v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mord cjk_fallback">、</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 分别称作边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 的 <strong>尾</strong> 、 <strong>头</strong></li></ul></li></ul></li><li>路径 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mrow><mo fence="true">⟨</mo><msub><mi>v</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>v</mi><mi>k</mi></msub><mo fence="true">⟩</mo></mrow></mrow><annotation encoding="application/x-tex">\pi = \left\langle v_0, v_1, \dots, v_k \right\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> ，长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><mi>π</mi><mo fence="true">∣</mo></mrow><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\left\vert \pi \right\vert = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><ul><li>简单路径：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal">≠</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">v_i \ne v_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 除非 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i = j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span></li><li>环路：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>0</mn></msub><mo>=</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_0 = v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>欧拉环路：各边恰好出现一次</li><li>哈密尔顿环路：各点恰好出现一次</li><li>有向无环图：<code>Directed Acyclic Graph</code>，DAG</li></ul></li><li>图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">;</mo><mtext> </mtext><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G = (V; \, E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> 的子图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">;</mo><mtext> </mtext><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T=(V; \, F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span> 若是树，则称其为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> 的 <strong>支撑树</strong><ul><li>各边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 均有对应的权值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\rm wt}(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mord mathrm">t</span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> ，则为带权网络</li><li>同一网络的支撑树中，总权重最小者为最小支撑树（MST）</li></ul></li></ul><h3 id="图的存储">图的存储</h3><h4 id="模板类">模板类</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="keyword">class</span> <span class="title class_">Graph</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Rank v = <span class="number">0</span>; v &lt; n; v++) &#123;</span><br><span class="line">            <span class="built_in">status</span>(v) = UNDISCOVERD; <span class="built_in">dTime</span>(v) = <span class="built_in">fTime</span>(v) = <span class="number">-1</span>;</span><br><span class="line">            <span class="built_in">parent</span>(v) = <span class="number">-1</span>; <span class="built_in">priority</span>(v) = INT_MAX;</span><br><span class="line">            <span class="keyword">for</span> (Rank u = <span class="number">0</span>; u &lt; n; u++)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">exists</span>(v, u)) <span class="built_in">type</span>(v, u) = UNDETERMINED;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Rank n, e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> VStatus = <span class="keyword">enum</span> &#123; UNDISCOVERED, DISCOVERED, VISITED &#125;;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv&gt; <span class="keyword">struct</span> <span class="title class_">Vertex</span> &#123;</span><br><span class="line">    Tv data; <span class="type">int</span> inDegree, outDegree;</span><br><span class="line">    VStatus status; <span class="type">int</span> dTime, fTime;</span><br><span class="line">    Rank parent; <span class="type">int</span> priority;</span><br><span class="line">    <span class="built_in">Vertex</span>(Tv <span class="type">const</span> &amp;d) :</span><br><span class="line">    <span class="built_in">data</span>(d), <span class="built_in">inDegree</span>(<span class="number">0</span>), <span class="built_in">outDegree</span>(<span class="number">0</span>), <span class="built_in">status</span>(UNDISCOVERED),</span><br><span class="line">    <span class="built_in">dTime</span>(<span class="number">-1</span>), <span class="built_in">fTime</span>(<span class="number">-1</span>), <span class="built_in">parent</span>(<span class="number">-1</span>), <span class="built_in">priority</span>(INT_MAX) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> EType = <span class="keyword">enum</span> &#123; UNDETERMINED, TREE, CROSS, BACKWARD &#125;;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Te&gt; <span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    Te data; <span class="type">int</span> weight;</span><br><span class="line">    Etype type;</span><br><span class="line">    <span class="built_in">Edge</span>(Te <span class="type">const</span> &amp;d, <span class="type">int</span> w) : </span><br><span class="line">    <span class="built_in">data</span>(d), <span class="built_in">weight</span>(w), <span class="built_in">type</span>(UNDETERMINED) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="邻接矩阵">邻接矩阵</h4><ul><li>Adjacency Matrix：记录顶点之间的 <strong>邻接</strong> 关系<ul><li>矩阵元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo></mrow><annotation encoding="application/x-tex">\Leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">⇔</span></span></span></span> 图中可能存在的边<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mtext>、</mtext><mi>u</mi></mrow><annotation encoding="application/x-tex">v、u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord cjk_fallback">、</span><span class="mord mathdefault">u</span></span></span></span> 之间存在一条边，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A(v, u) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul></li><li>空间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，与实际边数无关</li></ul></li><li>优点<ul><li>直观，易于理解实现</li><li>尤其适用于稠密图</li><li>一些操作只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><ul><li>包括：判断两点之间是否联边、获取/维护顶点度数等</li></ul></li></ul></li><li>缺点<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 空间，与边数无关<ul><li>对于平面图 <code>planar graph</code> ：可 <strong>嵌入</strong> 于平面的图</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>−</mo><mi>e</mi><mo>+</mo><mi>f</mi><mo>−</mo><mi>c</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mspace width="1em"/><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">y</mi><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">g</mi></mrow></mrow><annotation encoding="application/x-tex">v - e + f - c = 1, \quad {\rm for \,\, any \,\, pg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">a</span><span class="mord mathrm">n</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">p</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span></span></span></span></span></span><ul><li>分别代表点数、边数、将平面分割成的区域数、联通分量</li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>≤</mo><mn>3</mn><mi>n</mi><mo>−</mo><mn>6</mn><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≪</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">e \le 3n - 6 =O(n) \ll n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li></ul></li></ul></li><li>Incidence Matrix：记录顶点与边之间的关联关系<ul><li>空间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n \cdot e) = O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，利用率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>2</mn><mi>e</mi></mrow><mrow><mi>n</mi><mi>e</mi></mrow></mfrac><mo>=</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{2e}{ne} = \frac{2}{n} \rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li></ul></li></ul><h4 id="邻接表">邻接表</h4><ul><li>将邻接矩阵的 <strong>各行</strong> 组织为列表，只记录存在的边<ul><li>等效于，每一顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 对应于列表：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>v</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>u</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mrow><mo fence="true">⟨</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo fence="true">⟩</mo></mrow><mtext> </mtext><mo>∈</mo><mi>E</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">L_v = \{u\, | \,\left\langle v, u \right\rangle \, \in E\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">}</span></span></span></span></li><li>有向图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> ，无向图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></li><li>适用于稀疏图</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 链式前向星, 最新的边插入表头</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    nxt[++cnt] = head[u]; <span class="comment">// 当前边的后继</span></span><br><span class="line">    to[cnt] = v; <span class="comment">// 当前边的终点</span></span><br><span class="line">    head[u] = cnt; <span class="comment">// 起点 u 的第一条边</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = nxt[i]) &#123;</span><br><span class="line">    <span class="type">int</span> v = to[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="图的遍历">图的遍历</h3><h4 id="广度优先搜索">广度优先搜索</h4><ul><li><code>Breadth-First Search</code><ul><li>依次访问当前节点，再依次访问它们所有尚未访问的邻接顶点，如此反复</li><li>以上策略和过程等同于树的 <strong>层次遍历</strong></li><li>BFS 会构造出原图的一棵支撑树</li></ul></li></ul><h5 id="实现">实现</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">BFS</span>(Rank v, Rank &amp;dClock) &#123;</span><br><span class="line">    Queue&lt;Rank&gt; Q; <span class="built_in">status</span>(v) = DISCOVERED;</span><br><span class="line">    Q.<span class="built_in">enqueue</span>(v); <span class="built_in">dTime</span>(v) = dClock++;</span><br><span class="line">    <span class="keyword">for</span> (Rank fClock = <span class="number">0</span>; !Q.<span class="built_in">empty</span>(); ) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">dTime</span>(v) &lt; <span class="built_in">dTime</span>(Q.<span class="built_in">front</span>()))</span><br><span class="line">            dClock++, fClock = <span class="number">0</span>; <span class="comment">// 开启新的一代</span></span><br><span class="line">        v = Q.<span class="built_in">dequeue</span>();</span><br><span class="line">        <span class="keyword">for</span> (Rank u = <span class="built_in">firstNbr</span>(v); u != <span class="number">-1</span>; u = <span class="built_in">nextNbr</span>(v, u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">status</span>(u) == UNDISCOVERED) &#123;</span><br><span class="line">                <span class="built_in">status</span>(u) = DISCOVERED;</span><br><span class="line">                Q.<span class="built_in">enqueue</span>(u); <span class="built_in">dTime</span>(u) = dClock;</span><br><span class="line">                <span class="comment">// 引入树边, 拓展 BFS 树</span></span><br><span class="line">                <span class="built_in">type</span>(v, u) = TREE; <span class="built_in">parent</span>(u) = v;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">type</span>(v, u) = CROSS;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">status</span>(v) = VISITED; <span class="built_in">fTime</span>(v) = fClock++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>推广：若图中包含多个连通/可达分量，则一次检查所有顶点，遇到未发现者则启动一次 BFS</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">bfs</span>(Rank s) &#123;</span><br><span class="line">    <span class="built_in">reset</span>(); Rank dClock = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Rank v = s; v &lt; s + n; v++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">status</span>(v) == UNDISCOVERED)</span><br><span class="line">            <span class="built_in">BFS</span>(v % n, dClock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>时间复杂度</p><ul><li><p>初始化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> ，遍历 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msub><mo>∑</mo><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>2</mn><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\sum_{v \in V}(1 + deg(v))) = O(n + 2e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p></li><li><p>总计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p></li></ul></li></ul><h5 id="性质及规律">性质及规律</h5><ul><li>经 BFS 后，所有边将确定方向，且被分为两类<ul><li>树边 TREE，跨边 CROSS</li></ul></li><li><code>BFS(v)</code> 以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 为根，生成一棵 BFS 树</li><li><code>bfs(s)</code> 生成一个 BFS 森林，包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 棵树、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">n - c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 条树边、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>−</mo><mi>n</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">e - n + c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 条跨边</li><li>无向图中，顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 的（最近）距离记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>BFS 过程中，队列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span> 犹如一条贪吃蛇<ul><li>其中的顶点按 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> 单调排列</li><li>相邻顶点的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> 相差不超过 1</li><li>首、末顶点的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> 相差不超过 1</li><li>由树边联接的顶点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> 恰好相差 1</li><li>由跨边联接的顶点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> <strong>至多</strong> 相差 1</li></ul></li><li>BFS 树中从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的路径，即是二者在原图中的最短通路</li></ul></li></ul><h4 id="深度优先搜索">深度优先搜索</h4><ul><li><code>Depth-First Search</code><ul><li><code>DFS(s)</code><ul><li>访问顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span></li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> 尚有未被访问的邻居，则任取其一 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> ，递归执行 <code>DFS(u)</code></li><li>否则，返回</li></ul></li><li>对树而言，等效于 <strong>先序遍历</strong></li><li>DFS 会构造出原图的一棵支撑树</li></ul></li></ul><h5 id="实现">实现</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">DFS</span>(Rank v, Rank &amp;clock) &#123;</span><br><span class="line">    <span class="built_in">dTime</span>(v) = ++clock; <span class="built_in">status</span>(v) = DISCOVERED;</span><br><span class="line">    <span class="keyword">for</span> (Rank u = <span class="built_in">firstNbr</span>(v); u != <span class="number">-1</span>; u = <span class="built_in">nextNbr</span>(v, u)) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">status</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">case</span> UNDISCOVERED:</span><br><span class="line">                <span class="built_in">type</span>(v, u) = TREE; <span class="built_in">parent</span>(u) = v;</span><br><span class="line">                <span class="built_in">DFS</span>(u, clock); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> DISCOVERED: <span class="comment">// u 已被发现但未访问完毕, 应为被后代指向的祖先</span></span><br><span class="line">                <span class="built_in">type</span>(v, u) = BACKWARD; <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>: <span class="comment">// u 已访问完毕, 则视承袭关系分为前向边或跨边</span></span><br><span class="line">                <span class="built_in">type</span>(v, u) = <span class="built_in">dTime</span>(v) &lt; <span class="built_in">dTime</span>(u) ? FORWARD : CROSS; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">status</span>(v) = VISITED; <span class="built_in">fTime</span>(v) = ++clock;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>与 <code>bfs(s)</code> 类似，<code>dfs(s)</code> 也可在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> 时间内<ul><li>对于每一连通/可达分量，从其起始顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 进入 <code>DFS（v）</code> 恰好 1 次</li><li>最终生成一个 DFS 森林（包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 棵树、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">n - c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 条树边）</li></ul></li></ul><h5 id="性质">性质</h5><ul><li>活跃期 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><mi>d</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">active[u] = (dTime[u], fTime[u])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span><ul><li>括号引理：给定有向图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G = (V, E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> 及其任一 DFS 森林，则<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的后代 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>⊆</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\iff active[u] \subseteq active[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的祖先 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>⊇</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\iff active[u] \supseteq active[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊇</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> “无关” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>∩</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\iff active[u] \cap active[v] = \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord amsrm">∅</span></span></span></span></li></ul></li></ul></li><li>边分类<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>R</mi><mi>E</mi><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">TREE(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>可以从当前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 进入处于 <code>UNDISCOVERED</code> 状态的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>A</mi><mi>C</mi><mi>K</mi><mi>W</mi><mi>A</mi><mi>R</mi><mi>D</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">BACKWARD(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>试图从当前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 进入处于 <code>DISCOVERED</code> 状态的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span></li><li>DFS 发现后向边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\iff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span></span></span> 存在回路<ul><li>后向边数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩽</mo></mrow><annotation encoding="application/x-tex">\leqslant</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733399999999999em;vertical-align:-0.13667em;"></span><span class="mrel amsrm">⩽</span></span></span></span> 回路数</li></ul></li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>O</mi><mi>R</mi><mi>W</mi><mi>A</mi><mi>R</mi><mi>D</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">FORWARD(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>试图从当前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 进入处于 <code>VISITED</code> 状态的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> ，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> <strong>更早</strong> 被发现</li></ul></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>R</mi><mi>O</mi><mi>S</mi><mi>S</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">CROSS(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>试图从当前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 进入处于 <code>VISITED</code> 状态的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> ，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> <strong>更早</strong> 被发现</li></ul></li></ul></li></ul><h3 id="拓扑排序">拓扑排序</h3><ul><li><p>任给有向图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> ，尝试将所有顶点排成一个线性序列，使其次序与原图 <strong>相容</strong></p><p>（每一顶点都不会通过边指向前驱顶点）</p><ul><li>每个 DAG 对应一个 <strong>偏序集</strong> ，而拓扑排序对应一个全序集<ul><li>有限偏序集必有极值元素，任意 DAG 必有入度为零的顶点</li></ul></li><li>可以拓扑排序的有向图，必定无环</li><li>任何 DAG，都存在至少一种拓扑排序</li></ul></li><li><p>策略</p><ul><li><p>顺序输出 <strong>零入度</strong> 顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">将所有入度为零的顶点存入栈S, 取空队列Q</span><br><span class="line">while (!S.empty()) &#123;</span><br><span class="line">Q.enqueue( v = S.pop() )</span><br><span class="line">for each edge(v, u)</span><br><span class="line">if (u.inDegree &lt; 2) S.push(u)</span><br><span class="line">G = G \ &#123; v &#125; // 删除v及其关联边(邻接顶点入度减1)</span><br><span class="line">&#125;</span><br><span class="line">return |G| ? &quot;NOT_A_DAG&quot; : Q</span><br></pre></td></tr></table></figure></li><li><p><strong>逆序</strong> 输出零 <strong>出度</strong> 顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p><ul><li>对图 G 做 DFS，其间<ul><li>每当有顶点被标记为 <code>VISITED</code>，则将其压入栈 S</li><li>一旦发现有后向边，则报告“NOT_A_DAG”并退出</li></ul></li><li>DFS 结束后，顺序弹出 S 中的各个顶点<ul><li>各节点按 <code>fTime</code> 逆序排列，即是拓扑排序</li></ul></li></ul></li></ul></li></ul><h3 id="双连通分量">双连通分量</h3><ul><li><strong>无向图</strong> 的关节点：其删除之后，原图连通分量增多<ul><li>无关节点的图，称作双连通图</li><li>极大的双连通子图，称作双连通分量</li><li>DFS 树中的叶节点，不可能是关节点</li></ul></li><li>Highest Connected Ancestor，<code>hca(v)</code> 表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">subtree(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 经 <strong>后向边</strong> 能抵达的最高祖先<ul><li>由括号引理，<code>dTime</code> 越小的祖先，辈份越高</li><li>DFS 过程中，一旦发现后向边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span><ul><li>即取 <code>hca(v) = min(hca(v), dTime(u))</code></li></ul></li><li>DFS(u) 完成并返回 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 时<ul><li>若有 <code>hca(u) &lt; dTime(v)</code> ，则取 <code>hca(v) = min(hca(u), hca(v))</code></li><li>否则可以断定，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 是关节点，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>v</mi><mo stretchy="false">}</mo><mo>+</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\{v\} + subtree(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span> 是一个 BCC</li></ul></li></ul></li></ul><h4 id="实现">实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">BCC</span>(Rank v, <span class="type">int</span> &amp;clock, Stack&lt;Rank&gt; &amp;S) &#123;</span><br><span class="line">    <span class="built_in">hca</span>(v) = <span class="built_in">dTime</span>(v) = ++clock; <span class="built_in">status</span>(v) = DISCOVERED; S.<span class="built_in">push</span>(v);</span><br><span class="line">    <span class="keyword">for</span> (Rank u = <span class="built_in">firstNbr</span>(v); u != <span class="number">-1</span>; u = <span class="built_in">nextNbr</span>(v, u)) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">status</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">case</span> UNDISCOVERED:</span><br><span class="line">                <span class="built_in">parent</span>(u) = v; <span class="built_in">type</span>(v, u) = TREE;</span><br><span class="line">                <span class="built_in">BCC</span>(u, clock, S);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">hca</span>(u) &lt; <span class="built_in">dTime</span>(v)) &#123;</span><br><span class="line">                    <span class="built_in">hca</span>(v) = <span class="built_in">min</span>(<span class="built_in">hca</span>(v), <span class="built_in">hca</span>(u));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; <span class="comment">// 否则 v 是关节点</span></span><br><span class="line">                    <span class="comment">// 此时弹出当前 BCC 中除 v 外的所有节点</span></span><br><span class="line">                    <span class="keyword">while</span> (u != S.<span class="built_in">pop</span>());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> DISCOVERED:</span><br><span class="line">                <span class="built_in">type</span>(v, u) = BACKWARD;</span><br><span class="line">                <span class="keyword">if</span> (u != <span class="built_in">parent</span>(v))</span><br><span class="line">                    <span class="built_in">hca</span>(v) = <span class="built_in">min</span>(<span class="built_in">hca</span>(v), <span class="built_in">dTime</span>(u));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>; <span class="comment">// digraphs only</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">status</span>(v) = VISITED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="强联通分量">强联通分量</h3><ul><li><strong>有向图</strong> 的强连通性：图中任意两个节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span>，都存在从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的路径，也存在从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 的路径<ul><li>满足这种性质的图，称作强连通图</li><li>极大的强连通子图，称作强连通分量（SCC）</li></ul></li><li>Lowest Reachable Ancestor，<code>low(v)</code> 表示从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">subtree(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">b</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 出发，通过 <strong>最多一条非树边</strong> 能抵达的、<strong>仍在栈中</strong> 的最早被发现的祖先<ul><li>DFS 过程中，一旦发现一条非树边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span>，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 仍在栈中<ul><li>即取 <code>low(v) = min(low(v), dTime(u))</code></li></ul></li><li>DFS(u) 完成并返回 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 时<ul><li>取 <code>low(v) = min(low(v), low(u))</code>（子节点能到达的最低点，父节点也能到）</li><li>若返回后发现 <code>low(v) == dTime(v)</code>，则可以断定，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 是当前发现的一个 SCC 的根<ul><li>此时，从栈顶到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的所有节点，构成一个完整的 SCC</li></ul></li></ul></li></ul></li></ul><h4 id="实现">实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">SCC</span>(Rank v, <span class="type">int</span> &amp;clock, Stack&lt;Rank&gt; &amp;S) &#123;</span><br><span class="line">    <span class="built_in">low</span>(v) = <span class="built_in">dTime</span>(v) = ++clock; <span class="built_in">status</span>(v) = DISCOVERED; S.<span class="built_in">push</span>(v);</span><br><span class="line">    <span class="keyword">for</span> (Rank u = <span class="built_in">firstNbr</span>(v); u != <span class="number">-1</span>; u = <span class="built_in">nextNbr</span>(v, u)) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="built_in">status</span>(u)) &#123;</span><br><span class="line">            <span class="keyword">case</span> UNDISCOVERED:</span><br><span class="line">                <span class="built_in">parent</span>(u) = v; <span class="comment">// 树边</span></span><br><span class="line">                <span class="built_in">SCC</span>(u, clock, S);</span><br><span class="line">                <span class="built_in">low</span>(v) = <span class="built_in">min</span>(<span class="built_in">low</span>(v), <span class="built_in">low</span>(u));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> DISCOVERED:</span><br><span class="line">                <span class="built_in">low</span>(v) = <span class="built_in">min</span>(<span class="built_in">low</span>(v), <span class="built_in">dTime</span>(u));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="comment">// (v, u) 是前向边 或 指向已完成 SCC 的跨边</span></span><br><span class="line">                <span class="comment">// 对 low(v) 的计算没有贡献, 忽略</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">low</span>(v) == <span class="built_in">dTime</span>(v)) &#123;</span><br><span class="line">        <span class="keyword">while</span> (v != S.<span class="built_in">pop</span>()); <span class="comment">// 弹出当前 SCC 中所有点</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">status</span>(v) = VISITED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="优先级搜索">优先级搜索</h3><ul><li>不同的遍历算法，取决于顶点的 <strong>访问策略</strong></li><li>可以为每个顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 维护一个优先级数 <code>priority(v)</code><ul><li>每个顶点都有初始优先级数；并可能随算法的推进而调整</li><li>优先级数越大/小，优先级越低/高</li></ul></li></ul><h4 id="统一框架">统一框架</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> PU&gt; <span class="comment">// 优先级更新策略</span></span><br><span class="line"><span class="type">void</span> Graph&lt;Tv, Te&gt;::<span class="built_in">PFS</span>(Rank v, PU prioUpdater) &#123;</span><br><span class="line">    <span class="built_in">priority</span>(v) = <span class="number">0</span>; <span class="built_in">status</span>(v) = VISITED;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123; <span class="comment">// 将下一顶点和边加至 PFS 树中</span></span><br><span class="line">        <span class="keyword">for</span> (Rank k = <span class="number">1</span>; k &lt; n; k++) &#123; <span class="comment">// 逐步引入 n-1 个顶点</span></span><br><span class="line">            <span class="keyword">for</span> (Rank u = <span class="built_in">firstNbr</span>(v); u != - <span class="number">1</span>; u = <span class="built_in">nextNbr</span>(v, u)) &#123;</span><br><span class="line">                <span class="built_in">prioUpdater</span>(<span class="keyword">this</span>, v, u); <span class="comment">// 更新顶点及其父亲优先级</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> shortest = INT_MAX;</span><br><span class="line">            <span class="keyword">for</span> (Rank u = <span class="number">0</span>; u &lt; n; u++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">status</span>(u) == UNDISCOVERED &amp;&amp; shortest &gt; <span class="built_in">priority</span>(u)) &#123;</span><br><span class="line">                    shortest = <span class="built_in">priority</span>(u); v = u;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">status</span>(v) = VISITED; <span class="built_in">type</span>(<span class="built_in">parent</span>(v), v) = TREE; <span class="comment">// 将最高优先级顶点加入遍历树</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="复杂度">复杂度</h4><ul><li>考查内循环<ul><li>更新，邻接矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，临界表 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></li><li>择优，每次 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，累计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>合计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li>采用优先级队列，可分别改至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>e</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(e \cdot \log e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \cdot \log e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span><ul><li>合计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O((n + e) \cdot \log e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></li><li>对于 <strong>稠密图</strong> 而言，反而是倒退</li></ul></li></ul><h3 id="dijkstra-算法">Dijkstra 算法</h3><ul><li>问题分类<ul><li>SSSP：Single Source Shortest Path<ul><li>给定顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span> ，计算其到其余各点的最短路径及长度</li></ul></li><li>APSP：All Pairs Shortest Path<ul><li>找出每对顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的最短路径及长度</li></ul></li></ul></li></ul><h4 id="最短路径树">最短路径树</h4><ul><li>任一最短路径的前缀，也是一条最短路径<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><mi>π</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mspace width="1em"/><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">y</mi><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mi>π</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>⊆</mo><mi>π</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u \in \pi(v) \quad {\rm only\,\,if} \,\,\,  \pi(u) \subseteq \pi(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">o</span><span class="mord mathrm">n</span><span class="mord mathrm">l</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></li></ul></li><li>消除歧义：各边权重均为正，否则<ul><li>有可能出现总权重非正的环路，最短路径无法定义</li></ul></li><li>Shortest Path Tree<ul><li>所有最短路径的并，既 <strong>连通</strong> 也 <strong>无环</strong></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo>=</mo><msub><mi>T</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><munder><mo>⋃</mo><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>n</mi></mrow></munder><mi>π</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}T = T_{n - 1} = \bigcup_{0 \le i &lt; n} \pi(u_i)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.722853em;vertical-align:-1.1114265em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6114265em;"><span style="top:-3.6114265000000003em;"><span class="pstrut" style="height:3.050005em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mrel mtight">≤</span><span class="mord mathdefault mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">⋃</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.372848em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1114265em;"><span></span></span></span></span></span></span></span></span></span></span> 构成一棵树</li></ul></li></ul><h4 id="算法与实现">算法与实现</h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>v</mi><mo>∉</mo><msub><mi>V</mi><mi>k</mi></msub><mo separator="true">,</mo><mtext> </mtext><mtext> </mtext><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi></mrow><mtext> </mtext><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∥</mo><mi>s</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">∥</mo><mo>≤</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\forall v \not\in V_k, \,\, {\rm let} \, priority(v) = \lVert s, v \rVert \le \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">l</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span></li><li>套用 PFS 框架，为将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">T_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 扩充至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_{k + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> ，只需<ul><li>选出优先级最高的跨边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">e_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 及其对应顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，将其 <strong>加入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">T_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></li><li>随后更新 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>∖</mo><msub><mi>V</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">V \setminus V_{k + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 中所有顶点的优先级<ul><li>只需枚举 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的邻接顶点</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">∥</mo><msub><mi>v</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">∥</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\rm priority}(u) = \min({\rm priority}(u), {\rm priority}(v_k) + \lVert v_k, u \rVert)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">∥</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">g-&gt;<span class="built_in">pfs</span>(<span class="number">0</span>, <span class="built_in">DijkPU</span>&lt;<span class="type">char</span>, Rank&gt;()); <span class="comment">// 从顶点 0 开始</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="keyword">struct</span> <span class="title class_">DijkPU</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(Graph&lt;Tv, Te&gt;* g, Rank v, Rank u)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (g-&gt;<span class="built_in">status</span>(u) != UNDISCOVERED) <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// 尚未被发现的邻居 u, 按 Dijkstra 策略做松弛</span></span><br><span class="line">        <span class="keyword">if</span> (g-&gt;<span class="built_in">priority</span>(u) &gt; g-&gt;<span class="built_in">priority</span>(v) + g-&gt;<span class="built_in">weight</span>(v, u)) &#123;</span><br><span class="line">            g-&gt;<span class="built_in">priority</span>(u) = g-&gt;<span class="built_in">priority</span>(v) + g-&gt;<span class="built_in">weight</span>(v, u);</span><br><span class="line">            g-&gt;<span class="built_in">parent</span>(u) = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="prim-算法">Prim 算法</h3><ul><li>最小支撑树<ul><li>总权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>e</mi><mo>∈</mo><mi>F</mi></mrow></msub><mi mathvariant="normal">w</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\rm w}(T) = \sum_{e \in F} {\rm w}(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">w</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">w</span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> 最小的支撑树</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>T</mi><mo mathvariant="normal">≠</mo><mi>S</mi><mi>P</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">MST \ne SPT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></li><li>允许权值为负<ul><li>支撑树所含边数相等，故可统一调整 <code>increase(1 - findMin())</code></li></ul></li></ul></li><li>Cayley 公式：完全图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">K</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{K}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.01445em;">K</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n^{n - 2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> 棵支撑树</li></ul><h4 id="割与极短跨边">割与极短跨边</h4><ul><li><p>任何环路 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> 上的最长边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> ，都不会被 MST 采用</p><ul><li>否则在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span> 上必然有另一更优跨边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 可以替换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></li></ul></li><li><p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>U</mi><mo separator="true">;</mo><mi>V</mi><mo>∖</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(U;V \setminus U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> 是图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 的一个割</p><ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 是该割的一条极短跨边，则必然 <strong>存在一棵包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 的 MST</strong><ul><li>可反证，任取一棵 MST，将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 加入，其中出现唯一的回路<ul><li>该回路必经过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 以及割的至少另一跨边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></li><li>摘除 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span> 后恢复为一棵支撑树，且总权重不致增加</li></ul></li></ul></li><li>反之，任一 MST 都必 <strong>经由极短跨边联接每一割</strong></li></ul></li><li><p>Prim</p><ul><li><p>递增式构造</p><ul><li>首先，仍选 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>v</mi><mn>1</mn></msub><mo stretchy="false">}</mo><mo separator="true">;</mo><mi mathvariant="normal">∅</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_1 = (\{v_1\}; \varnothing)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord amsrm">∅</span><span class="mclose">)</span></span></span></span></li><li>不断进行扩张，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>V</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><msub><mi>E</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>V</mi><mi>k</mi></msub><mo>∪</mo><mo stretchy="false">{</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo><mo separator="true">;</mo><msub><mi>E</mi><mi>k</mi></msub><mo>∪</mo><mo stretchy="false">{</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>u</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_{k + 1} = (V_{k + 1};E_{k + 1}) = (V_k \cup \{v_{k + 1}\}; E_k \cup \{v_{k + 1} u\})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord mathdefault">u</span><span class="mclose">}</span><span class="mclose">)</span></span></span></span></li><li>只需将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>V</mi><mi>k</mi></msub><mo separator="true">;</mo><mi>V</mi><mo>∖</mo><msub><mi>V</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(V_k; V \setminus V_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 视作原图的一个割<ul><li>该割所有跨边中极短者即是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>u</mi></mrow><annotation encoding="application/x-tex">v_{k + 1}u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord mathdefault">u</span></span></span></span></li></ul></li></ul></li><li><p>正确性证明</p><ul><li>只需归纳证明：每一步迭代时，都存在一棵 MST 包含已选边集<ul><li>假设某时刻边集为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span> ，令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> 为包含其的一棵 MST ，考虑下一条加入的边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span></li><li>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">e \in T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> ，那么成立</li><li>否则，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">T + e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 一定存在一个环，且该环中至少有一条边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>∉</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">f \not\in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li><li>首先，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 的权值一定不会比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 小，否则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 会在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 之前被选取</li><li>然后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 的权值一定不会比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 大，不然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>−</mo><mi>f</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">T - f + e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 就是一棵更优的支撑树</li><li>所以，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>⊂</mo><mi>T</mi><mo>+</mo><mi>e</mi><mo>−</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">F \subset T + e - f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> ，并且这也是一棵 MST</li></ul></li></ul></li><li><p>但是，由极短跨边构成的支撑树，<strong>未必</strong> 就是一棵 MST</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250928210437674.png" alt="image-20250928210437674"></p></li></ul></li></ul><h4 id="算法实现">算法实现</h4><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>v</mi><mo>∉</mo><msub><mi>V</mi><mi>k</mi></msub><mo separator="true">,</mo><mtext> </mtext><mtext> </mtext><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi></mrow><mtext> </mtext><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">∥</mo><msub><mi>V</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">∥</mo><mo>≤</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\forall v \not\in V_k, \,\, {\rm let} \, priority(v) = \lVert V_k, v \rVert \le \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">l</span><span class="mord mathrm">e</span><span class="mord mathrm">t</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span></li><li>枚举 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的邻接顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> ，取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">y</mi></mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">∥</mo><msub><mi>v</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">∥</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">{\rm priority}(u) = \min({\rm priority}(u), \lVert v_k, u \rVert)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">∥</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">∥</span><span class="mclose">)</span></span></span></span></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">g-&gt;<span class="built_in">pfs</span>(<span class="number">0</span>, <span class="built_in">PrimPU</span>&lt;<span class="type">char</span>, Rank&gt;()); <span class="comment">// 从顶点 0 开始</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tv, <span class="keyword">typename</span> Te&gt; <span class="keyword">struct</span> <span class="title class_">PrimPU</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(Graph&lt;Tv, Te&gt;* g, Rank v, Rank u)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (g-&gt;<span class="built_in">status</span>(u) != UNDISCOVERED) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (g-&gt;<span class="built_in">priority</span>(u) &gt; g-&gt;<span class="built_in">weight</span>(v, u)) &#123;</span><br><span class="line">            g-&gt;<span class="built_in">priority</span>(u) = g-&gt;<span class="built_in">weight</span>(v, u);</span><br><span class="line">            g-&gt;<span class="built_in">parent</span>(u) = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="kruskal-算法">Kruskal 算法</h3><ul><li>贪心<ul><li>根据代价，从小到大依次尝试各边</li><li>只要“安全”（不会形成环），就加入该边</li></ul></li><li>正确性<ul><li>Kruskal 引入的每条边都属于某棵 MST</li><li>也可归纳证明：任何时刻，算法选择的边集总是某棵 MST 的子图</li></ul></li></ul><h4 id="并查集">并查集</h4><ul><li>给定一组互不相交的 <strong>等价类</strong>，各由其中一个成员作为代表<ul><li><code>Find(x)</code> ：找到元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 所属的等价类</li><li><code>Union(x, y)</code> ：合并 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> 所属等价类</li></ul></li><li>优化：路径压缩，启发式合并</li></ul><h3 id="floyd-算法">Floyd 算法</h3><ul><li>给定带权网络 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span> ，计算其中所有点对之间的最短距离<ul><li>Floyd-Warshall<ul><li>最短路径矩阵</li><li>时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，实现简单，允许负权边</li></ul></li><li>定义 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mi>k</mi></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d^k(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 为中途只经过前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 个顶点中转，从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 的最短路径长度<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mn>0</mn></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d^0(u, v) = w(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mi>k</mi></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><msup><mi>d</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>d</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>d</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">d^k(u, v) = \min\{d^{k - 1}(u, v), d^{k - 1}(u, x) + d^{k - 1}(x, v) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; u++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt; n; v++)</span><br><span class="line">            A[u][v] = <span class="built_in">min</span>(A[u][v], A[u][k] + A[k][v]);</span><br></pre></td></tr></table></figure><h2 id="优先级队列">优先级队列</h2><h3 id="概述">概述</h3><ul><li>循 <strong>优先级</strong> 访问<ul><li>极值元素：须反复、快速定位</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">struct</span> <span class="title class_">PQ</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">insert</span><span class="params">(T)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> T <span class="title">delMax</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> T &amp;<span class="title">getMax</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>只需查找极值元，则不必维护所有元素之间的全序关系，<strong>偏序</strong> 足矣</li></ul><h3 id="完全二叉堆">完全二叉堆</h3><ul><li><p>结构性：逻辑上完全等同于完全二叉树，可直接借助向量实现</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> Parent(i) (((i) - 1) &gt;&gt; 1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LChild(i) (1 + ((i) &lt;&lt; 1))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RChild(i) ((1 + (i)) &lt;&lt; 1)</span></span><br></pre></td></tr></table></figure><ul><li>内部节点最大秩为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><mfrac><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor \frac{n - 2}{2} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span></li></ul></li><li><p>堆序性：处处满足 <code>H[i] &lt;= H[Parent(i)]</code></p><ul><li><code>H[0]</code> 即是全局最大者</li></ul>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T &amp; <span class="title">PQ_ComlHeap::getMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _elem[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="插入删除">插入删除</h4><ul><li>逐层上滤和逐层下滤</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> PQ_ComplHeap&lt;T&gt;::<span class="built_in">insert</span>(T e) &#123;</span><br><span class="line">    Vector&lt;T&gt;::<span class="built_in">insert</span>(e);</span><br><span class="line">    <span class="built_in">percolateUp</span>(_elem, size - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">typename</span>&lt;<span class="keyword">typename</span> T&gt; Rank <span class="title">percolateUp</span><span class="params">(T *A, Rank i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        Rank j = <span class="built_in">Parent</span>(i);</span><br><span class="line">        <span class="keyword">if</span> (A[j] &gt;= A[i]) <span class="keyword">break</span>;</span><br><span class="line">        <span class="built_in">swap</span>(A[i], A[j]); i = j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T PQ_ComlHeap&lt;T&gt;::<span class="built_in">delMax</span>() &#123;</span><br><span class="line">    T maxElem = _elem[<span class="number">0</span>]; _elem[<span class="number">0</span>] = _elem[--_size];</span><br><span class="line">    <span class="built_in">percolateDown</span>(_elem, _size, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> maxElem;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank <span class="title">percolateDown</span><span class="params">(T *A, Rank n, Rank i)</span> </span>&#123;</span><br><span class="line">    Rank j;</span><br><span class="line">    <span class="keyword">while</span> (i != (j = <span class="built_in">ProperParent</span>(A, n, i)))</span><br><span class="line">        <span class="built_in">swap</span>(A[i], A[j]), i = j;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 在每一高度至多交换一次，而完全树必平衡，故插入/删除只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间<ul><li>平均情况为，插入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> / 删除 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="建堆">建堆</h4><ul><li><p>自上而下（或自下而上）的上滤</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Rank i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    <span class="built_in">percolateUp</span>(i);</span><br></pre></td></tr></table></figure><ul><li>最坏情况每个节点所需成本线性正比于其深度，总计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>自下而上的下滤</p>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Rank i = n / <span class="number">2</span> - <span class="number">1</span>; i != <span class="number">-1</span>; i--)</span><br><span class="line">    <span class="built_in">percolateDown</span>(i);</span><br></pre></td></tr></table></figure><ul><li><p>可理解为子堆的 <strong>逐层合并</strong> ，堆序性最终必全局恢复</p></li><li><p>每个内部节点所需成本正比于其 <strong>高度</strong> ，总计 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p><ul><li><p>所有节点高度总和为</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><mi>k</mi><mo>⋅</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>−</mo><mi>k</mi></mrow></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mn>2</mn><mrow><mi>h</mi><mo>−</mo><mi>k</mi></mrow></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mi>i</mi></mrow><mi>h</mi></munderover><msup><mn>2</mn><mrow><mi>h</mi><mo>−</mo><mi>k</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>h</mi><mo>−</mo><mi>i</mi></mrow></munderover><msup><mn>2</mn><mi>k</mi></msup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>h</mi></munderover><msup><mn>2</mn><mrow><mi>h</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>2</mn><mo>−</mo><mi>h</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}S(n) &amp;= \sum_{k = 1}^h k \cdot 2^{h - k} = \sum_{k = 1}^h \sum_{i = 1}^k 2^{h - k} = \sum_{i = 1}^h \sum_{k = i}^h 2^{h - k} \\ &amp;=\sum_{i = 1}^h \sum_{k = 0}^{h - i} 2^k = \sum_{i = 1}^h 2^{h - i + 1} - h \\ &amp;= 2^{h + 1} - 2 - h = O(n) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.43556em;vertical-align:-3.9677800000000003em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.46778em;"><span style="top:-6.46778em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.029554em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span><span style="top:-0.5283329999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9677800000000003em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.46778em;"><span style="top:-6.46778em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.029554em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span></span></span><span style="top:-0.5283329999999999em;"><span class="pstrut" style="height:3.836113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.9677800000000003em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul></li><li><p>不适用在线场合</p></li></ul></li></ul><h4 id="一些应用">一些应用</h4><h5 id="min-max-heap">Min-Max Heap</h5><ul><li>最小-最大堆是一个完全二叉堆，具有最小堆和最大堆的特征<ul><li>树中偶数层级的节点都不大于其后代，奇数层级的节点都不小于其后代</li><li>因此根为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow><annotation encoding="application/x-tex">{\rm Min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">M</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span></span> ，根的左右孩子中的较大者为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow><annotation encoding="application/x-tex">{\rm Max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">M</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span></span></span></li></ul></li><li>可以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间内同时维护最大值和最小值</li></ul><h5 id="对顶堆">对顶堆</h5><ul><li>由一个大根堆与一个小根堆组成<ul><li><strong>小根堆维护大值</strong> 即前 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 大的值，大根堆维护小值即比第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 大数小的其他数</li></ul></li><li>查询第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 大元素的时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> ，且可在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间内进行以下操作<ul><li>维护（核心思想是保持小根堆的元素数量）、插入元素、删除第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 大元素、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 值+1/-1</li></ul></li></ul><h3 id="堆排序">堆排序</h3><ul><li>相当于用堆优化 <strong>选择排序</strong><ul><li>首先建堆，然后不断迭代<ul><li>取最大值交换至无序部分尾部，删除当前最大值</li></ul></li><li>总时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>n</mi><mo>⋅</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n) + n \cdot O(\log n) = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>最好情况为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>（所有元素均相等）</li></ul></li></ul></li><li>就地算法，但不稳定</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">heapSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    T *A = _elem + lo; Rank n = hi - lo;</span><br><span class="line">    <span class="built_in">heapify</span>(A, n);</span><br><span class="line">    <span class="keyword">while</span> (--n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(A[<span class="number">0</span>], A[n]); <span class="built_in">percolateDown</span>(A, n, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="锦标赛树">锦标赛树</h3><h4 id="胜者树">胜者树</h4><ul><li>是完全二叉树，叶节点为各个元素，内部节点为孩子比较后的胜者<ul><li>树根总是全局冠军：类似于堆顶</li></ul></li></ul><h5 id="锦标赛排序">锦标赛排序</h5><ul><li>流程<ul><li>构造胜者树</li><li>选取树根元素</li><li>沿根向下找到对应叶子，将其无效化（置为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\pm \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">±</span><span class="mord">∞</span></span></span></span>）</li><li>从叶子处向上重新进行比较，直至根</li><li>不断重复</li></ul></li><li>空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + n \cdot \log n) = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，不稳定<ul><li>通过记录更新叶子节点的秩，可以稳定</li></ul></li></ul><h5 id="不完全选取">不完全选取</h5><ul><li>借助锦标赛树，从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个元素中找出最小的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 个，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≪</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k \ll n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≪</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span><ul><li>初始化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，共 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 次比较</li><li>迭代 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(k \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，每步 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span> 次比较</li><li>常系数相较小顶堆更优</li></ul></li></ul><h4 id="败者树">败者树</h4><ul><li>在胜者树的重赛过程中，须 <strong>交替</strong> 访问沿途节点及其兄弟</li><li>败者树也是完全二叉树，但其存储内容和胜者树不同<ul><li>内部节点，记录对应比赛的败者</li><li>增设根的“父节点”，记录冠军</li></ul></li><li>初始化<ul><li>将比赛的 <strong>败者</strong> 存入其父节点，<strong>胜者</strong> 则继续向上一层</li><li>根节点的父节点即是全局的冠军<ul><li>根节点并非亚军</li></ul></li></ul></li><li>更新迭代<ul><li>返回叶子进行重赛，元素只需与其 <strong>父节点中存储的败者</strong> 进行比赛<ul><li>胜者：继续向上，和更上层节点的败者进行比赛</li><li>败者：留在父节点中，替换原来的败者</li></ul></li></ul></li><li>更新效率更高，用额外的空间使每次信息查找的成本降至最低<ul><li>应用场景：外部排序中的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>-路归并（<strong>归并</strong> 多个有序段）</li></ul></li></ul><h3 id="多叉堆">多叉堆</h3><ul><li>PFS 中各节点可组织为优先级队列，总体运行时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>e</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + (n + e) \cdot \log n) = (n + e \cdot \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>但对于稠密图，不如常规实现</li></ul></li><li>将二叉堆改为多叉堆，堆高降低至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>d</mi></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_d n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span><ul><li>上滤成本 <strong>降</strong> 至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>d</mi></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_d n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li><li>下滤成本 <strong>增</strong> （<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&gt;</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">d &gt; 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span>）至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>d</mi></msub><mi>n</mi><mo>=</mo><mfrac><mi>d</mi><mrow><mi>ln</mi><mo>⁡</mo><mi>d</mi></mrow></mfrac><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">d \cdot \log_d n = \frac{d}{\ln d} \cdot \ln n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">l</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">d</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li></ul></li><li>如此，PFS 运行时间将为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>⋅</mo><mi>d</mi><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>d</mi></msub><mi>n</mi><mo>+</mo><mi>e</mi><mo>⋅</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>d</mi></msub><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>d</mi><mo>+</mo><mi>e</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>d</mi></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">n \cdot d \cdot \log_d n + e \cdot log_d n = (n \cdot d + e) \cdot \log_d n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.24196799999999993em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span><ul><li>取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≈</mo><mi>e</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d \approx e / n + 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord">/</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> ，达到最优 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>e</mi><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mrow><mi>e</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(e \cdot \log_{e / n + 2} n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.16914em;vertical-align:-0.41913999999999996em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28086em;"><span style="top:-2.45586em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mtight">/</span><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.41913999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>稀疏图保持高效，稠密图改进极大</li></ul></li></ul><h3 id="左式堆">左式堆</h3><h4 id="堆合并">堆合并</h4><ul><li>方法一：<code>A.insert(B.delMax())</code> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \log (n + m))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>方法二：<code>union(A, B).heapify(n + m)</code> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul><p>两堆合并 = 二路归并</p><ul><li>统一沿右侧藤，则所需时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∝</mo></mrow><annotation encoding="application/x-tex">\propto</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mrel">∝</span></span></span></span> 右侧藤总长</li><li>若能控制藤长，则可 <strong>持续</strong> 高效合并</li></ul><h4 id="控制藤长">控制藤长</h4><ul><li><p>保持 <strong>堆序性</strong> ，在堆合并过程中，只涉及少量节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p><ul><li>新条件 = <strong>单侧倾斜</strong><ul><li>节点分布偏向于左侧，合并只涉及右侧</li></ul></li><li>不能保证结构性，但这并非堆结构本质要求</li></ul></li><li><p><code>Null Path Length</code>，空节点路径长度</p><ul><li>引入外部节点，转为真二叉树</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">U</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">L</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">npl({\rm NULL}) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">N</span><span class="mord mathrm">U</span><span class="mord mathrm">L</span><span class="mord mathrm">L</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">npl(x) = 1 + \min\{npl({\rm lc}(x)), npl({\rm rc}(x))\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">l</span><span class="mord mathrm">c</span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">r</span><span class="mord mathrm">c</span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></li><li>$npl(x) = $ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 到外部节点的 <strong>最近</strong> 距离 = 以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 为根的最大 <strong>满子树</strong> 的高度</li></ul></li><li><p>左式堆 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo></mrow><annotation encoding="application/x-tex">\Leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">⇔</span></span></span></span> 处处左倾</p><ul><li>对任何内部节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≥</mo><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">npl({\rm lc}(x)) \ge npl({\rm rc}(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">l</span><span class="mord mathrm">c</span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">r</span><span class="mord mathrm">c</span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">npl(x) = 1 + npl({\rm rc}(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">r</span><span class="mord mathrm">c</span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>并不意味着左孩子高度不小于右孩子</li></ul></li><li>左倾性不会影响堆序性</li><li>倾向于将更多节点分布于左侧分支</li></ul></li><li><p>右侧链 <code>rChain(x)</code> ：从节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 出发，一直沿右分支前进</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>p</mi><mi>l</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>≡</mo><mrow><mo fence="true">∣</mo><mi>r</mi><mi>C</mi><mi>h</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">npl(r) \equiv \left\vert rChain(r) \right\vert = d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span></li><li>右侧链长为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 的左式堆，至少包含<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>d</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^d - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个内部节点</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{d + 1} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个节点</li></ul></li><li>包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 个节点的左式堆，右侧链长度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≤</mo><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d \le \lfloor \log_2 (n + 1) \rfloor + 1 = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h4 id="合并算法">合并算法</h4><ul><li>递归：前处理+后处理<ul><li>合并之前，比较 <code>priority</code> 判断是否要交换节点</li><li>回溯之后，比较 <code>NPL</code> 比较是否要交换子堆</li></ul></li></ul><h5 id="递归实现">递归实现</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; <span class="title">merge</span><span class="params">(BinNodePosi&lt;T&gt; a, BinNodePosi&lt;T&gt; b)</span> </span>&#123; <span class="comment">// 线性递归</span></span><br><span class="line">    <span class="keyword">if</span> (!a) <span class="keyword">return</span> b; <span class="keyword">if</span> (!b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">if</span> (*a &lt; *b) <span class="built_in">swap</span>(a, b);</span><br><span class="line">    (a-&gt;rc = <span class="built_in">merge</span>(a-&gt;rc, b))-&gt;parent = a; <span class="comment">// 将 a 的右子堆与 b 合并</span></span><br><span class="line">    <span class="keyword">if</span> (!a-&gt;lc || (a-&gt;lc-&gt;npl &lt; a-&gt;rc-&gt;npl))</span><br><span class="line">        <span class="built_in">swap</span>(a-&gt;lc, a-&gt;rc); <span class="comment">// 确保左子堆 npl 不小</span></span><br><span class="line">    a-&gt;npl = a-&gt;rc ? <span class="number">1</span> + a-&gt;rc-&gt;npl : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125; <span class="comment">// 返回合并后的堆顶</span></span><br></pre></td></tr></table></figure><h5 id="迭代实现">迭代实现</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; BinNodePosi&lt;T&gt; <span class="title">merge</span><span class="params">(BinNodePosi&lt;T&gt; a, BinNodePosi&lt;T&gt; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!a) <span class="keyword">return</span> b; <span class="keyword">if</span> (!b) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">if</span> (*a &lt; *b) <span class="built_in">swap</span>(a, b);</span><br><span class="line">    <span class="keyword">for</span> (; a-&gt;rc; a = a-&gt;rc) <span class="comment">// 沿右侧链做二路归并, 直至 a-&gt; rc 先于 b 变空</span></span><br><span class="line">        <span class="keyword">if</span> (*(a-&gt;rc) &lt; *b)</span><br><span class="line">            b-&gt;parent = a; <span class="built_in">swap</span>(a-&gt;rc, b);</span><br><span class="line">    (a-&gt;rc = b)-&gt;parent = a;</span><br><span class="line">    <span class="keyword">for</span> (; a; b = a, a = a-&gt;parent) &#123; <span class="comment">// 从 a 出发沿右侧链逐层回溯</span></span><br><span class="line">        <span class="keyword">if</span> (!a-&gt;lc || (a-&gt;lc-&gt;npl &lt; a-&gt;rc-&gt;npl))</span><br><span class="line">            <span class="built_in">swap</span>(a-&gt;lc, a-&gt;rc);</span><br><span class="line">        a-&gt;npl = a-&gt;rc ? a-&gt;rc-&gt;npl + <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="插入和删除">插入和删除</h4><ul><li>利用核心操作 <code>merge()</code></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// merge 是 O(logn)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> PQ_LeftHeap&lt;T&gt;::<span class="built_in">insert</span>(T e) &#123;</span><br><span class="line">    _root = <span class="built_in">merge</span>(_root, <span class="keyword">new</span> <span class="built_in">BinNode</span>&lt;T&gt;(e, <span class="literal">NULL</span>));</span><br><span class="line">    _size++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T PQ_LeftHeap&lt;T&gt;::<span class="built_in">delMax</span>() &#123;</span><br><span class="line">    BinNodePosi&lt;T&gt; lHeap = _root-&gt;lc;</span><br><span class="line">    <span class="keyword">if</span> (lHeap) lHeap-&gt;parent = null;</span><br><span class="line">    BinNodePosi&lt;T&gt; rHeap = _root-&gt;rc;</span><br><span class="line">    <span class="keyword">if</span> (rHeap) rHeap-&gt;parent = null;</span><br><span class="line">    T e = _root-&gt;data;</span><br><span class="line">    <span class="keyword">delete</span> _root; _size--;</span><br><span class="line">    _root = <span class="built_in">merge</span>(lHeap, rHeap);</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="串">串</h2><h3 id="模式匹配">模式匹配</h3><ul><li><p>循模式访问</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">d</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow><mtext> </mtext><mtext> </mtext><mi>T</mi><mtext> </mtext><mo>+</mo><mtext> </mtext><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi></mrow><mtext> </mtext><mtext> </mtext><mi>P</mi></mrow><annotation encoding="application/x-tex">{\rm random}\,\, T \, + \, {\rm subtring} \,\, P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">r</span><span class="mord mathrm">a</span><span class="mord mathrm">n</span><span class="mord mathrm">d</span><span class="mord mathrm">o</span><span class="mord mathrm">m</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">s</span><span class="mord mathrm">u</span><span class="mord mathrm">b</span><span class="mord mathrm">t</span><span class="mord mathrm">r</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>T</mi><mo fence="true">∣</mo></mrow><mspace width="1em"/><mi>m</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mi>P</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">n = \left\vert T \right\vert \quad m = \left\vert P \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span></li><li>$ 2 \ll m \ll n$</li></ul></li><li><p>蛮力策略</p><ul><li>（最差情况下）最好复杂度：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> （<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P = {\rm suffix}(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">s</span><span class="mord mathrm">u</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">i</span><span class="mord mathrm">x</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span>）</li><li>平均：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>最差：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \cdot m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">match</span><span class="params">(<span class="type">char</span> *P, <span class="type">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(T), i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; m &amp;&amp; i &lt; n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (T[i] == P[j]) &#123; i++; j++; &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123; i -= j - <span class="number">1</span>; j = <span class="number">0</span>; &#125; <span class="comment">// T 回退, P 复位</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i - j; <span class="comment">// 最终对齐位置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="kmp-算法">KMP 算法</h3><ul><li>在任一时刻，都有 <code>T[i - j, i) == P[0, j)</code><ul><li>亦即已掌握了 <code>T[i - j, i)</code> 的所有信息，一旦失败，就应已知哪些位置 <strong>值得/不必</strong> 对齐</li><li><code>T[i - j', i)</code> 可径直接受，则不必再做比对</li><li>如此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 将 <strong>不必回退</strong><ul><li>比对成功，则与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> 同步前进</li><li>否则，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> 更新为某更小的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>j</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">j&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，并 <strong>继续比对</strong></li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">match</span><span class="params">(<span class="type">char</span> *P, <span class="type">char</span> *T)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> *next = <span class="built_in">buildNext</span>(P);</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(T), i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; m &amp;&amp; i &lt; n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">0</span> || T[i] == P[j]) &#123; i++; j++; &#125;</span><br><span class="line">        <span class="keyword">else</span> j = next[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span>[] next;</span><br><span class="line">    <span class="keyword">return</span> i - j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="next-表">next [] 表</h4><ul><li><p>最长自匹配：快速右移 + 绝不回退</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>≥</mo><mn>1</mn><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">N</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo>≤</mo><mi>t</mi><mo>&lt;</mo><mi>j</mi><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>P</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mi>t</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\forall j \ge 1, \, {\rm N}(P, j) = \{0 \le t &lt; j \,\, | \,\, P[0,t) = P[j - t, j)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">N</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>N</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">{\rm next}[j] = \max\{N(P, j)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo></mrow><annotation encoding="application/x-tex">\Leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">⇔</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P[0, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 的最长公共 <strong>真前后缀</strong> 的长度</li></ul></li><li><p>传递链</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mi>k</mi></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{\rm next}^{k + 1}[j] = {\rm next}[{\rm next}^k[j]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104088em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8540879999999998em;"><span style="top:-3.06798em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104088em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.854088em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mclose">]</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>j</mi><mo>≥</mo><mn>1</mn><mo separator="true">,</mo><mtext> </mtext><mi mathvariant="normal">N</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mn>2</mn></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mn>1</mn></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\forall j \ge 1, \, {\rm N}(P, j) = \{ 0, \dots, {\rm next}^2[j], {\rm next}^1[j] \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">N</span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0690879999999998em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8190879999999999em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8190879999999999em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mclose">}</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn><mo>←</mo><mn>0</mn><mo>⋯</mo><mo>←</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mn>2</mn></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mn>1</mn></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><msup><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mn>0</mn></msup><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">-1 \leftarrow 0 \dots \leftarrow {\rm next}^2[j] \leftarrow {\rm next}^1[j] \leftarrow {\rm next}^0[j] = j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0690879999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8190879999999999em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0690879999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8190879999999999em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0690879999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8190879999999999em;"><span style="top:-3.0679800000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span></li></ul></li><li><p>减而治之</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 处的自匹配，至多比在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> 处的自匹配多出 <strong>一个</strong> 字符</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mi>P</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">{\rm next}[j + 1] = {\rm next}[j] + 1 \iff P[j] = P[{\rm next}[j]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66844em;vertical-align:-0.024em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mclose">]</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mtext> </mtext><mtext> </mtext><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi><mi mathvariant="normal">t</mi></mrow><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\rm next}[0] = -1, \,\, {\rm next}[1] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm">x</span><span class="mord mathrm">t</span></span></span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250929221006366.png" alt="image-20250929221006366"></p></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *<span class="title">buildNext</span><span class="params">(<span class="type">char</span> *P)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> *next = <span class="keyword">new</span> <span class="type">int</span>[m];</span><br><span class="line">    <span class="type">int</span> t = next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; m - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (t &lt; <span class="number">0</span> || P[t] == P[j]) &#123;</span><br><span class="line">            ++t; ++j;</span><br><span class="line">            next[j] = t;</span><br><span class="line">        &#125; <span class="keyword">else</span> t = next[j]; <span class="comment">// 尝试下一值得尝试的位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="分析">分析</h4><ul><li><p>摊还分析</p><ul><li>令 <code>k = 2 * i - j</code></li></ul>  <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (j &lt; m &amp;&amp; i &lt; n)</span><br><span class="line">    <span class="keyword">if</span> (j &lt; <span class="number">0</span> || T[i] == P[j])</span><br><span class="line">        i++, j++; <span class="comment">// k 恰好加 1</span></span><br><span class="line"><span class="keyword">else</span> j = next[j]; <span class="comment">// k 至少加 1</span></span><br></pre></td></tr></table></figure><ul><li>计步器 <code>k</code> 随着迭代单调递增，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≤</mo><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k \le 2n - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li><li>故 <code>build</code> 和 <code>match</code> 总时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>每一个 P 串，相当于一台 <strong>自动机</strong></p></li><li><p>适用于顺序存储介质</p></li><li><p>单次匹配概率越大，优势越明显</p></li></ul><h4 id="再改进">再改进</h4><ul><li>经验 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 以往成功的比对：<code>T[i - j, i)</code> 是什么</li><li>教训 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 以往失败的比对：<code>T[i]</code> 不是什么</li></ul>- 进一步避免 **注定错误** 的比较    - $\forall j \ge 1, \, {\rm N}(P, j) = \{0 \le t < j \,\, | \,\, P[0,t) = P[j - t, j) \cap {\color{Red}{P[t] \ne P[j]}}\} \cup \{{\color{Red}{-1}}\}$    - ${\color{Red}{-1}} \in {\rm N}(P, j) \ne \varnothing$, ${\rm next}[j] = \max\{{\rm N}(P, j)\}$<p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251007150912373.png" alt="image-20251007150912373"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *<span class="title">buildNext</span><span class="params">(<span class="type">char</span> *P)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> *next = <span class="keyword">new</span> <span class="type">int</span>[m]; <span class="type">int</span> t = next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; m - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (t &gt;= <span class="number">0</span> &amp;&amp; P[t] != P[j]) &#123;</span><br><span class="line">            t = next[t];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (P[++t] != P[++j]) &#123; <span class="comment">// 此时有扩展匹配段的机会</span></span><br><span class="line">            next[j] = t;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 此时有 P [next[t]] != P [t] == P [j]</span></span><br><span class="line">            next[j] = next[t];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="bm-算法">BM 算法</h3><blockquote><p>通过 <strong>后缀匹配</strong> 获得比前缀匹配更多的信息来实现更快的字符跳转</p></blockquote><ul><li>迭代： <strong>自右向左</strong> 依次比对，找到极大的匹配后缀<ul><li>若完全匹配，则可返回</li><li>否则查表（类似于 <code>next[]</code> 的作用）确定 P <strong>右移</strong> 的适当位置，<strong>重新</strong> 自右向左比对</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">match</span><span class="params">(<span class="type">char</span> *T, <span class="type">char</span> *P)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> *bc = <span class="built_in">buildBC</span>(P);</span><br><span class="line">    <span class="type">int</span> *gs = <span class="built_in">buildGS</span>(P);</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">strlen</span>(T), i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i + m &lt; n; i += <span class="built_in">max</span>(gs[j]<span class="comment">/* or 1 */</span>, j - bc[T[i + j]])) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = m - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; P[j] == T[i + j]); j--);</span><br><span class="line">        <span class="keyword">if</span> (j &lt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span>[] bc; <span class="keyword">return</span> i; <span class="comment">// 最终对齐位置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="bc-策略">BC 策略</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930154627945.png" alt="image-20250930154627945"></p><h5 id="bc-表">bc [] 表</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *<span class="title">buildBC</span><span class="params">(<span class="type">char</span> *P)</span> </span>&#123; <span class="comment">// 时间复杂度为 O(m+s), s 为字符集规模</span></span><br><span class="line">    <span class="type">int</span> *bc = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) bc[j] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> m = <span class="built_in">strlen</span>(P), j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">        bc[P[j]] = j; <span class="comment">// 画家算法, 最靠右位置</span></span><br><span class="line">    <span class="keyword">return</span> bc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>不倾向于使用二维的 <code>bc[][]</code> 表<ul><li>若其能发挥作用，则此时的好后缀必然很长——同时使用的 <code>gs[]</code> 表完全可以替代</li></ul></li></ul><h5 id="分析">分析</h5><ul><li>最好情况：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n / m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span><ul><li>只要 P 不含 <code>T[i + j]</code> ，则可直接移动 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 个字符</li><li>单次匹配概率越小，性能优势越明显</li></ul></li><li>最差情况：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>×</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \times m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span><ul><li>每轮迭代，都要在扫过整个 P 之后，方能确定右移 <strong>一个</strong> 字符</li><li>单次匹配概率越大的场合，性能越接近于蛮力算法</li></ul></li><li><code>bc[]</code> 表仅仅利用了 <strong>失配</strong> 比对提供的信息（教训）</li></ul><h4 id="gs-策略">GS 策略</h4><ul><li><strong>经验</strong> = 匹配的后缀</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930162437999.png" alt="image-20250930162437999"></p><ul><li><code>Good-Suffix Shift</code>，扫描比对中断于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>X</mi><mo mathvariant="normal">≠</mo><mi>O</mi><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[i + j] = X \ne O = P[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>j</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">U = P(j, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> 即为好后缀<ul><li><strong>下一对齐位置</strong> 必须使得<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span> 重新与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>k</mi><mo>+</mo><mi>m</mi><mo>−</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V(k) = P(k, k + m - j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> 匹配</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo mathvariant="normal">≠</mo><mi>O</mi><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">P[k] \ne O = P[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></li></ul></li><li>完全匹配<ul><li>若存在这样的子串 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> ，则选取 <strong>靠后者</strong> ，通过右移使之与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span> 对齐（以免错过可能的成功比对）</li></ul></li><li>部分匹配<ul><li>若不存在，则所有的前缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P[0, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span> 中，选取与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span> 的 <strong>后缀</strong> 匹配的最长者（以免错过可能的成功比对）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> 为 0 则是完全不匹配的情况，可以直接移动整个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>+</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">m + i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 处</li></ul></li></ul></li></ul><h5 id="gs-表">gs [] 表</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mtext> </mtext><mn>0</mn><mo>≤</mo><mi>j</mi><mo>&lt;</mo><mi>m</mi><mo separator="true">,</mo><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mn>0</mn><mo>≤</mo><mi>s</mi><mo>≤</mo><mi>j</mi><mo>+</mo><mn>1</mn><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>P</mi><mo stretchy="false">(</mo><mi>j</mi><mo>−</mo><mi>s</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>P</mi><mo stretchy="false">[</mo><mi>m</mi><mo>−</mo><mi>s</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\forall \, 0 \le j &lt; m, ss[j] = \max\{ 0 \le s \le j + 1 \,\, | \,\, P(j - s, j] = P[m - s, m) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord">∀</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>j</mi><mo>−</mo><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">MS[j] = P(j - ss[j], j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 即为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">P[0, j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 的所有后缀中，与 P 的某一后缀匹配的 <strong>最长者</strong></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930165040821.png" alt="image-20250930165040821"></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo>⇒</mo><mi>g</mi><mi>s</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ss[] \Rightarrow gs[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span><ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ss[j] = j + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，则对任何 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&lt;</mo><mi>m</mi><mo>−</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i &lt; m - j - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m - j - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 必是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">gs[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span> 的一个候选（对应部分匹配）</li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>≤</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">ss[j] \le j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> ，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m - j - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 必是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>s</mi><mo stretchy="false">[</mo><mi>m</mi><mo>−</mo><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">gs[m - ss[j] - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 的一个候选（完全匹配）</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251007152023084.png" alt="image-20251007152023084"></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ss[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> 的构造：<ul><li>自后向前逆向扫描，使用双指针维护一个 <strong>“已知匹配框”</strong><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">P(lo, hi]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span> 是当前已知的、匹配 P 后缀的最长子串</li></ul></li><li>由于 <code>j</code> 严格单调递减、<code>lo</code> 严格单调非增，且每次迭代两者之一会减少，故总时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li><li>本质上是 Z-Algorithm（求解最长公共前缀 LCP）在模式串 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 的逆序字符串上的应用</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *<span class="title">buildSS</span><span class="params">(<span class="type">char</span> *P)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P); <span class="type">int</span> *ss = <span class="keyword">new</span> <span class="type">int</span>[m];</span><br><span class="line">    ss[m - <span class="number">1</span>] = m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> lo = m - <span class="number">1</span>, hi = m - <span class="number">1</span>, j = lo - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; j &amp;&amp; ss[m - <span class="number">1</span> - (hi - j)] &lt; j - lo) <span class="comment">// j 落在匹配框中, 可直接利用之前算出的 ss []</span></span><br><span class="line">            ss[j] = ss[m - <span class="number">1</span> - (hi - j)];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            hi = j; lo = <span class="built_in">min</span>(lo, hi);</span><br><span class="line">            <span class="keyword">while</span> (lo &gt;= <span class="number">0</span> &amp;&amp; P[lo] == P[m - <span class="number">1</span> - (hi - lo)])</span><br><span class="line">                lo--;</span><br><span class="line">            ss[j] = hi - lo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>s</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">gs[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span> 的构造：<ul><li>核心是画家算法，按优先级低高先后处理 <code>gs[]</code> 的不同规则</li><li>其中的“双层循环”同样由于 <code>i, j</code> 两个指针单调变化，故总体是线性的，于是整个算法复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *<span class="title">buildGS</span><span class="params">(<span class="type">char</span> *P)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> *ss = <span class="built_in">buildSS</span>(P);</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">strlen</span>(P); <span class="type">int</span> *gs = <span class="keyword">new</span> <span class="type">int</span>[m];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++) gs[j] = m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = m - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        <span class="keyword">if</span> (j + <span class="number">1</span> == ss[j])</span><br><span class="line">            <span class="keyword">while</span> (i &lt; m - j - <span class="number">1</span>)</span><br><span class="line">                gs[i++] = m - j - <span class="number">1</span>; <span class="comment">// 对于多个备选, 取最短移动距离</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m - <span class="number">1</span>; j++) <span class="comment">// 画家算法, 最短移动距离优先</span></span><br><span class="line">        gs[m - ss[j] - <span class="number">1</span>] = m - j - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] ss; <span class="keyword">return</span> gs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="性能分析">性能分析</h5><ul><li>空间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><mi>b</mi><mi>c</mi><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><mi>g</mi><mi>s</mi><mo fence="true">∣</mo></mrow><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Σ</mi><mo fence="true">∣</mo></mrow><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\left\vert bc \right\vert + \left\vert gs \right\vert = O(\left\vert \Sigma \right\vert + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">s</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Σ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li><li>预处理：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Σ</mi><mo fence="true">∣</mo></mrow><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\left\vert \Sigma \right\vert + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Σ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li><li>查找效率<ul><li>最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n / m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li><li>最差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></li></ul></li><li>影响因素：单词比对成功的概率<ul><li>通常，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\Pr = 1 / s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mop">Pr</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault">s</span></span></span></span></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930181048302.png" alt="image-20250930181048302"></p><h3 id="karp-rabin-算法">Karp-Rabin 算法</h3><ul><li><p>凡物皆数</p><ul><li><code>Gödel Numbering</code><ul><li>逻辑系统的符号、表达式、公式、命题、定理、公理等，均可表示为 <strong>自然数</strong></li><li>每个 <strong>有限</strong> 维的自然数向量（包括字符串），都唯一对应于某个 <strong>自然数</strong><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">⟨</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo fence="true">⟩</mo></mrow><mtext> </mtext><mtext> </mtext><mo>⇔</mo><mi>p</mi><mo stretchy="false">(</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mn>1</mn><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub></mrow></msup><mo>×</mo><mi>p</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn></mrow></msup><mo>×</mo><mo>⋯</mo><mo>×</mo><mi>p</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\left\langle a_1, a_2, \dots, a_n \right\rangle \,\, \Leftrightarrow p(1)^{1 + a_1} \times p(2)^{a_2 + 1} \times \cdots \times p(n)^{a_n + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> 为第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 个素数）</li></ul></li></ul></li><li><code>Cantor Numbering</code><ul><li>长度 <strong>有限</strong> 的字符串，都可视作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Σ</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">d = 1 + \left\vert \Sigma \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Σ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> 进制的自然数</li><li>长度 <strong>无限</strong> 的字符串，都可视作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 内的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 进制小数</li></ul></li></ul></li><li><p>串亦为数</p><ul><li>每个字符串对应一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> 进制自然数（指纹）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> 中出现 <strong>仅当</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> 中某一子串的指纹与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 的指纹相等</li><li>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∣</mo><mi mathvariant="normal">Σ</mi><mo fence="true">∣</mo></mrow><annotation encoding="application/x-tex">\left\vert \Sigma \right\vert</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord">Σ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> 很大，指纹的计算与比对，将不能在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内完成</li></ul></li><li><p>散列压缩</p><ul><li><p>通过散列，将指纹压缩至存储器支持的范围</p></li><li><p>但 <code>hash()</code> 相等时，还须进一步严格比对</p><ul><li>不过，只要散列函数选取得当，便可将冲突的概率控制在 <strong>可以接受</strong> 的范围</li></ul></li><li><p>可以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内，由上一指纹得到下一指纹</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930202717341.png" alt="image-20250930202717341"></p></li></ul></li><li><p>字宽</p><ul><li>可以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>r</mi><mo>=</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(r = \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 时间内计算出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">w</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">{\rm power}(n) = a^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm" style="margin-right:0.01389em;">w</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">a^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 的二进制展开宽度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>常数代价准则、对数代价准则</li></ul></li></ul><h2 id="排序">排序</h2><h3 id="快速排序">快速排序</h3><h4 id="分而治之">分而治之</h4><ul><li><code>pivot</code>，轴点：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>m</mi><mi>i</mi><mo stretchy="false">)</mo><mo>≤</mo><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mo stretchy="false">]</mo><mo>≤</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max[lo, mi) \le [mi] \le \min(mi, hi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></li><li>前缀、后缀各自（递归）排序之后，原序列自然有序</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">quickSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hi - lo &lt; <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    Rank mi = <span class="built_in">partition</span>(lo, hi); <span class="comment">// 尽可能高效</span></span><br><span class="line">    <span class="built_in">quickSort</span>(lo, mi);</span><br><span class="line">    <span class="built_in">quickSort</span>(mi + <span class="number">1</span>, hi);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>划分后，轴点必然已经 <strong>就位</strong><ul><li>一个序列有序， <strong>当且仅当</strong> 所有元素皆为轴点</li><li>快速排序，即为 <strong>将所有元素转化为轴点</strong> 的过程</li></ul></li></ul><h4 id="快速划分：lug">快速划分：LUG</h4><ul><li>任取一个候选者<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>+</mo><mi>U</mi><mo>+</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">L + U + G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span></li></ul></li><li>交替向内移动 <code>lo</code> 和 <code>hi</code> ，并逐个检查当前元素<ul><li>若更小/大，则转移归入 L/G</li></ul></li><li><code>lo == hi</code> 时，将候选者嵌入 L、G 之中，即成轴点</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20250930221123750.png" alt="image-20250930221123750"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank Vector&lt;T&gt;::<span class="built_in">partition</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="built_in">swap</span>(_elem[lo], _elem[lo + <span class="built_in">rand</span>() % (hi - lo)]);</span><br><span class="line">    T pivot = _elem[lo];</span><br><span class="line">    <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123; hi--; &#125; <span class="keyword">while</span> (lo &lt; hi &amp;&amp; pivot &lt;= _elem[hi]);</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) _elem[lo] = _elem[hi];</span><br><span class="line">        <span class="keyword">do</span> &#123; lo++; &#125; <span class="keyword">while</span> (lo &lt; hi &amp;&amp; _elem[lo] &lt;= pivot);</span><br><span class="line">        <span class="keyword">if</span> (lo &lt; hi) _elem[hi] = _elem[lo];</span><br><span class="line">    &#125;</span><br><span class="line">    _elem[hi] = pivot; <span class="keyword">return</span> hi; <span class="comment">// 候选轴点归位, 返回其秩</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>线性时间：<code>lo</code> 、<code>hi</code> 累计移动距离不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>就地：只需 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 附加空间</li><li>不稳定</li></ul><h4 id="空间复杂度">空间复杂度</h4><ul><li>空间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">\sim</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">∼</span></span></span></span> 递归深度<ul><li>最好 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，最坏 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，平均 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h5 id="迭代化-贪心">迭代化+贪心</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> Put(K, s, t) &#123; <span class="keyword">if</span> (1 &lt; (t) - (s)) &#123; K.push(s); K.push(t); &#125; &#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Get(K, s, t) &#123; t = K.pop(); s = K.pop(); &#125;</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">quickSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    Stack&lt;Rank&gt; Task; <span class="built_in">Put</span>(Task, lo, hi);</span><br><span class="line">    <span class="keyword">while</span> (!Task.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="built_in">Get</span>(Task, lo, hi); Rank mi = <span class="built_in">partition</span>(lo, hi);</span><br><span class="line">        <span class="keyword">if</span> (mi - lo &lt; hi - mi) &#123;</span><br><span class="line">            <span class="built_in">Put</span>(Task, mi + <span class="number">1</span>, hi);</span><br><span class="line">            <span class="built_in">Put</span>(Task, lo, mi);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">Put</span>(Task, lo, mi);</span><br><span class="line">            <span class="built_in">Puts</span>(Task, mi + <span class="number">1</span>, hi);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// 大/小任务优先入/出栈, 可保证(辅助栈)空间不过 O(logn)</span></span><br></pre></td></tr></table></figure><ul><li>可归纳假设证得，所需空间不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li>如果采用 <strong>递归</strong> 方式对顺序表进行快速排序，递归次数和递归深度与每次划分后得到的分区的处理顺序 <strong>无关</strong> （即每次先处理 <strong>较长或较短</strong> 的分区）</li></ul></li></ul><h4 id="时间性能">时间性能</h4><ul><li>最好：每次划分都（接近）平均<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = 2 \cdot T((n - 1) / 2) + O(n) = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>最坏：每次划分都极不均衡<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>T</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = T(n - 1) + T(0) + O(n) = O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li>采用随机选取、三者取中之类的策略，只能降低最坏情况的概率</li></ul><h4 id="递归深度">递归深度</h4><ul><li>好轴点：落在宽度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>⋅</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\lambda \cdot n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的居中区间</li><li>递归深度（常规随机）：<ul><li>最坏情况 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，概率极低</li><li>平均情况递归 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 层，概率极高</li><li>实际上，除非轴点过于侧偏，否则都会有效地缩短递归深度</li></ul></li><li>断言<ul><li>在任何一条递归路径上，好轴点不会多于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mfrac><mn>2</mn><mrow><mn>1</mn><mo>+</mo><mi>λ</mi></mrow></mfrac></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">d(n, \lambda) = \log_{\frac{2}{1 + \lambda}}n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.223125em;vertical-align:-0.528685em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.75378em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.40352142857142853em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.528685em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li><li>抵达 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>λ</mi></mfrac><mo>⋅</mo><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{1}{\lambda} \cdot d(n, \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span> 层时，即可 <strong>期望</strong> 地出现 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(n, \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">λ</span><span class="mclose">)</span></span></span></span> 个好轴点——从而在此 <strong>之前</strong> 终止递归</li><li>以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span> 估计，任何一条递归路径的长度，只有 <strong>极小</strong> 的概率超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>2</mn><mi>λ</mi></mfrac><mo>⋅</mo><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>9.64</mn><mo>⋅</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">D(n, \frac{1}{2}) = \frac{2}{\lambda} \cdot d(n, \frac{1}{2}) \approx 9.64 \cdot \log_2 n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">.</span><span class="mord">6</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li></ul></li></ul><h4 id="比较次数">比较次数</h4><h5 id="递推分析">递推分析</h5><ul><li>记期望比较次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">T(1) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo stretchy="false">[</mo><mi>T</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>T</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} T(n) &amp;= (n - 1) + \frac{1}{n} \cdot \sum_{k = 0}^{n - 1} [T(k) + T(n - k - 1)] \\ &amp;= (n - 1) + \frac{2}{n} \cdot \sum_{k = 0}^{n - 1}T(k)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.806452em;vertical-align:-3.153226em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.653226em;"><span style="top:-5.653226em;"><span class="pstrut" style="height:3.801113em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.801113em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.153226em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.653226em;"><span style="top:-5.653226em;"><span class="pstrut" style="height:3.801113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.801113em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.153226em;"><span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n \cdot T(n) - (n + 1) \cdot T(n - 1) = 2 \cdot (n - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>4</mn><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>−</mo><mn>2</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>−</mo><mn>2</mn><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mi>k</mi></mfrac><mo>=</mo><mn>2</mn><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></munderover><mfrac><mn>1</mn><mi>k</mi></mfrac><mo>+</mo><mfrac><mn>2</mn><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>−</mo><mn>4</mn><mo>≈</mo><mn>2</mn><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \frac{T(n)}{n + 1} = 4 \cdot \sum_{k - 2}^n \frac{1}{k + 1} - 2 \cdot \sum_{k = 2}^n \frac{1}{k} = 2 \cdot \sum_{k = 1}^{n + 1} \frac{1}{k} + \frac{2}{n + 1} - 4 \approx 2 \ln n\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.461557em;vertical-align:-1.4807785000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9807784999999998em;"><span style="top:-3.9807784999999996em;"><span class="pstrut" style="height:3.801113em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.360444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4807785000000002em;"><span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≈</mo><mn>2</mn><mo>⋅</mo><mi>n</mi><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mi>n</mi><mo>≈</mo><mn>1.386</mn><mo>⋅</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">T(n) \approx 2 \cdot n \cdot \ln n \approx 1.386 \cdot n \log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">3</span><span class="mord">8</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li></ul></li></ul><h5 id="后向分析">后向分析</h5><ul><li>设 <strong>排序后</strong> 的序列为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{a_0, a_1, \dots, a_i, \dots, a_j, \dots, a_{n - 1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>则期望的比较次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}T(n) = \sum_{i = 0}^{n - 2}\sum_{j = i + 1}^{n - 1} \Pr(i, j) = \sum_{j = 1}^{n - 1}\sum_{i = 0}^{j - 1} \Pr(i, j) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.5725540000000002em;vertical-align:-1.5362770000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.036277em;"><span style="top:-4.036277em;"><span class="pstrut" style="height:3.8587770000000003em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">Pr</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8587770000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">Pr</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5362770000000001em;"><span></span></span></span></span></span></span></span></span></span></span><ul><li>即每一对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle a_i, a_j \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span> 在排序中会做比较之概率总和</li></ul></li><li><code>quickSort</code> 的过程可以理解为：将所有元素转化为 <code>pivot</code><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">⟨</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo fence="true">⟩</mo></mrow><annotation encoding="application/x-tex">\left\langle a_i, a_j \right\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">⟨</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">⟩</span></span></span></span></span> 会做比较，<strong>当且仅当</strong> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{a_i, a_{i + 1}, \dots, a_{j - 1}, a_j\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 率先被转化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">⇒</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>2</mn><mrow><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\Pr(i, j) = \frac{2}{j - i + 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><mi>j</mi></munderover><mfrac><mn>2</mn><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mn>2</mn><mo>⋅</mo><mo stretchy="false">(</mo><mi>ln</mi><mo>⁡</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mn>2</mn><mo>⋅</mo><mi>n</mi><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}T(n) = \sum_{j = 1}^{n - 1}\sum_{d = 1}^{j} \frac{2}{d + 1} \approx \sum_{j = 1}^{n - 1} 2 \cdot (\ln j - 1) \le 2 \cdot n \cdot \ln n \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.5725540000000002em;vertical-align:-1.536277em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.036277em;"><span style="top:-4.036277em;"><span class="pstrut" style="height:3.858777em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8587770000000001em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.536277em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251001161137030.png" alt="image-20251001161137030"></p><h4 id="快速划分：dup">快速划分：DUP</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        hi--; <span class="comment">// 凡不大于轴点者, 皆归入 L</span></span><br><span class="line">    &#125; <span class="keyword">while</span> (lo &lt; hi &amp;&amp; pivot &lt; _elem[hi]);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        lo++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (lo &lt; hi &amp;&amp; _elem[lo] &lt; pivot);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><ul><li>遇到连续的相等元素时<ul><li><code>lo</code> 和 <code>hi</code> 会交替移动</li><li>使得切分点接近于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>l</mi><mi>o</mi><mo>+</mo><mi>h</mi><mi>i</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{lo + hi}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul></li><li>交换操作有所增加，更不稳定</li></ul><h4 id="快速划分：lgu">快速划分：LGU</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20251001162304770.png" alt="image-20251001162304770"></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mo separator="true">,</mo><mi>m</mi><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">[</mo><mi>k</mi><mo separator="true">,</mo><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>i</mi><mi>v</mi><mi>o</mi><mi>t</mi><mo>+</mo><mi>L</mi><mo>+</mo><mi>G</mi><mo>+</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">S = [lo, hi) = [lo] + (lo, mi] + (mi, k) + [k, hi) = pivot + L + G + U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank Vector&lt;T&gt;::<span class="built_in">partition</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="built_in">swap</span>(_elem[lo], _elem[lo + <span class="built_in">rand</span>() % (hi - lo)]);</span><br><span class="line">    T pivot = _elem[lo]; Rank mi = lo;</span><br><span class="line">    <span class="keyword">for</span> (Rank k = lo + <span class="number">1</span>; k &lt; hi; k++)</span><br><span class="line">        <span class="keyword">if</span> (_elem[k] &lt; pivot)</span><br><span class="line">            <span class="built_in">swap</span>(_elem[++mi], _elem[k]);</span><br><span class="line">    <span class="built_in">swap</span>(_elem[mi], _elem[lo]); <span class="comment">// 轴点归位</span></span><br><span class="line">    <span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="选取">选取</h3><ul><li><code>k-selection</code> ：在任意一组可比较大小的元素中，找出其对应非降排序序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> 中的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">S[k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span></li></ul><h4 id="众数">众数</h4><ul><li>无序向量中，若有 <strong>一半以上</strong> 元素同为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ，则称之为众数</li><li>必要性：众数若存在，则其必是中位数<ul><li>若能找出中位数，则不难验证是否为众数</li></ul></li><li>时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 、附加空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 的算法：减而治之<ul><li>若在向量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 的前缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 出现的次数 <strong>恰</strong> 占半数，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 有众数，仅当对应的后缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">A - P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 有众数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 的众数<ul><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">x = m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ，则在排除前缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 与其他元素在数量上的差距 <strong>保持不变</strong></li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo mathvariant="normal">≠</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">x \ne m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ，则在排除前缀 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 后，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 与其他元素在数量上的差距 <strong>不致缩小</strong></li></ul></li><li>若将众数的标准从“一半以上”改作“至少一半”<ul><li>则可以按照以上思路循环两次，以避免算法最后返回了一个错误的候选</li><li>或一开始选择一个数验证、若不是则剪除该元素再执行算法（控制元素总数为奇数）</li></ul></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; T <span class="title">majCandidate</span><span class="params">(Vector&lt;T&gt; A)</span> </span>&#123;</span><br><span class="line">    T maj;</span><br><span class="line">    <span class="keyword">for</span> (Rank c = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; A.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="number">0</span>) &#123; <span class="comment">// 意味着前缀可以剪除</span></span><br><span class="line">            maj = A[i]; c = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            maj == A[i] ? c++ : c--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="中位数">中位数</h4><ul><li>蛮力<ul><li>排序+遍历，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n) + O(k) = O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>堆<ul><li>将所有元素组织为小顶堆，连续调用 <code>delMin()</code><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n) + O(k \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li>任选 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个元素组织成大顶堆，遍历剩下的元素，依次 <code>insert</code> 并 <code>delMax()</code><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(k) + O(n \log k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li></ul></li><li>将输入任意划分组织为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n -k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 规模的大、小顶堆，交换堆顶元素直至……<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n) + O(\min(k, n - k) \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li>下界：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h5 id="quickselect">QuickSelect</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; Rank <span class="title">quickSelect</span><span class="params">(T <span class="type">const</span> *A, Rank n, Rank k)</span> </span>&#123;</span><br><span class="line">    <span class="function">Vector&lt;Rank&gt; <span class="title">R</span><span class="params">(n)</span></span>; <span class="comment">// 索引向量</span></span><br><span class="line">    <span class="keyword">for</span> (Rank k = <span class="number">0</span>; k &lt; n; k++) R.<span class="built_in">insert</span>(k);</span><br><span class="line">    <span class="keyword">for</span> (Rank lo = <span class="number">0</span>, hi = n; ; ) &#123; <span class="comment">// 反复做 quickPartition</span></span><br><span class="line">        <span class="built_in">swap</span>(R[lo], R[lo + <span class="built_in">rand</span>() % (hi - lo)]);</span><br><span class="line">        T pivot = A[R[lo]]; Rank mi = lo;</span><br><span class="line">        <span class="keyword">for</span> (Rank i = lo + <span class="number">1</span>; i &lt; hi; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[R[i]] &lt; pivot)</span><br><span class="line">                <span class="built_in">swap</span>(R[++mi], R[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">swap</span>(R[lo], R[mi]);</span><br><span class="line">        <span class="keyword">if</span> (mi &lt; k) lo = mi + <span class="number">1</span>; <span class="comment">// 猜小了, 剪除前缀</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (k &lt; mi) hi = mi;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> R[mi];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>记期望比较次数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">T(1) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>T</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≤</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi>T</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} T(n) &amp;= (n - 1) + \frac{1}{n} \cdot \sum_{k = 0}^{n - 1} \max\{T(k), T(n - k - 1)\} \\ &amp;\le (n - 1) + \frac{2}{n} \cdot \sum_{k = n / 2}^{n - 1}T(k)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.020344000000001em;vertical-align:-3.2601720000000007em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.760172em;"><span style="top:-5.760172000000001em;"><span class="pstrut" style="height:3.801113000000001em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-2.3569459999999998em;"><span class="pstrut" style="height:3.801113000000001em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2601720000000007em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.760172em;"><span style="top:-5.760172000000001em;"><span class="pstrut" style="height:3.801113000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">}</span></span></span><span style="top:-2.3569459999999998em;"><span class="pstrut" style="height:3.801113000000001em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.8089950000000001em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">n</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5160049999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.2601720000000007em;"><span></span></span></span></span></span></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>4</mn><mo>⋅</mo><mi>n</mi><mo>→</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) &lt; 4 \cdot n \rightarrow T(n) = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≤</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mo>⋅</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mn>4</mn><mi>k</mi><mo>≤</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>3</mn><mi>n</mi><mo>&lt;</mo><mn>4</mn><mi>n</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} T(n) \le (n - 1) + \frac{2}{n} \cdot \sum_{k = n / 2}^{n - 1} 4k \le (n - 1) + 3n &lt; 4n\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6171180000000005em;vertical-align:-1.5585590000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0585590000000002em;"><span style="top:-4.058559000000001em;"><span class="pstrut" style="height:3.801113000000001em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.8089950000000001em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">n</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5160049999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5585590000000002em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul></li></ul></li></ul><h5 id="linearselect">LinearSelect</h5><ul><li><p><code>linearSelect(A, n, k)</code></p><ul><li><p>对于小数组（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><mi>A</mi><mo fence="true">∣</mo></mrow><mo>&lt;</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">\left\vert A \right\vert &lt; Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathdefault">A</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>），直接排序解决</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>Q</mi></mrow><annotation encoding="application/x-tex">n / Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">Q</span></span></span></span> 组，每组排序、找中位数</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>调用 <code>linearSelect()</code> 找出这 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mi>Q</mi></mrow><annotation encoding="application/x-tex">n / Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">Q</span></span></span></span> 个中位数的中位数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n / Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">Q</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 为枢轴，将原数组 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 分为三组：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">L, E, G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><p>根据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的位置，决定在哪一组里继续递归查找</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (k &lt; |L|) return linearSelect(A, |L|, k);</span><br><span class="line">if (k &lt; |L| + |E|) return M</span><br><span class="line">return linearSelect(A + |L| + |E|, |G|, k - |L| - |E|)</span><br></pre></td></tr></table></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mn>3</mn><mi>n</mi><mi mathvariant="normal">/</mi><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(3n / 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></li><li><p>复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mo>⋅</mo><mi>n</mi><mo>+</mo><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mi>Q</mi><mo stretchy="false">)</mo><mo>+</mo><mi>T</mi><mo stretchy="false">(</mo><mn>3</mn><mi>n</mi><mi mathvariant="normal">/</mi><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = c \cdot n + T(n / Q) + T(3n / 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">3</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></p><ul><li>取 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">Q = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>Q</mi><mo>+</mo><mn>3</mn><mi mathvariant="normal">/</mi><mn>4</mn><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 / Q + 3 / 4 &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord">/</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n) = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>线性，但常数较大</li></ul></li></ul><h3 id="希尔排序">希尔排序</h3><h4 id="框架">框架</h4><ul><li><code>ShellSort</code>：将整个序列视作一个矩阵，逐列各自排序<ul><li>递减增量<ul><li>由粗到细，重排矩阵，使其更窄，再次逐列排序 <code>h-sorting</code></li><li>如此往复，直至矩阵变为一列 <code>1-sorting</code></li></ul></li><li>步长序列：由各矩阵宽度 <strong>逆向</strong> 排列而成的序列<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>h</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>h</mi><mi>k</mi></msub><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{H} = \{h_1 = 1, h_2, \dots, h_k, \dots\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">}</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>=</mo><mi>B</mi><mo stretchy="false">[</mo><mi>k</mi><mi mathvariant="normal">/</mi><mi>h</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mi mathvariant="normal">%</mi><mi>h</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[k] = B[k / h][k \% h]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord">/</span><span class="mord mathdefault">h</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord">%</span><span class="mord mathdefault">h</span><span class="mclose">]</span></span></span></span></li></ul></li><li>正确性：最后一次迭代，等同于全排序</li><li>一个 <code>g-ordered</code> 序列在 <code>h-sorted</code> 之后仍保持 <code>g-ordered</code></li><li>一个序列同时保持 <code>g-ordered</code> 和 <code>h-ordered</code> 称为 <code>(g, h)-ordered</code> ，此时对任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo>∈</mo><msub><mi>N</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">m, n \in N_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 也必然满足 <code>(mg + nh)-ordered</code></li><li>对任意互素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo>∈</mo><msub><mi>N</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">p, q \in N_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> ，<code>(p, q)-ordered</code> 序列中逆序对的间距不大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p - 1) \times (q - 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> Vector&lt;T&gt;::<span class="built_in">shellSort</span>(Rank lo, Rank hi) &#123;</span><br><span class="line">    <span class="keyword">for</span> (Rank d = <span class="number">0x7FFFFFF</span>; d &gt; <span class="number">0</span>; d &gt;&gt;= <span class="number">1</span>) <span class="comment">// PS Sequence</span></span><br><span class="line">        <span class="keyword">for</span> (Rank j = lo + d; j &lt; hi; j++) &#123;</span><br><span class="line">            T x = _elem[j]; Rank i = j;</span><br><span class="line">            <span class="keyword">while</span> (lo + d &lt;= i &amp;&amp; x &lt; _elem[i - d])</span><br><span class="line">                _elem[i] = _elem[i - d], i -= d;</span><br><span class="line">            _elem[i] = x; <span class="comment">// 找到 [j] 插入位置</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>最好情况 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ，就地，不稳定</li></ul><h4 id="shell-序列">Shell 序列</h4><h5 id="shell-s-sequence">Shell’s Sequence</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>s</mi><mi>h</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></msub><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mn>2</mn><mi>k</mi></msup><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{H}_{shell} = \{1, 2, 4, 8, \dots, 2^k, \dots\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">}</span></span></span></span></li><li>最坏情况下 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><ul><li>考查子序列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">[</mo><msup><mn>2</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mn>2</mn><mi>N</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A = {\rm unsorted}[2^{N - 1}, 2^N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">u</span><span class="mord mathrm">n</span><span class="mord mathrm">s</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">t</span><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span></span><span class="mopen">[</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><msup><mn>2</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B = {\rm unsorted}[0, 2^{N - 1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">u</span><span class="mord mathrm">n</span><span class="mord mathrm">s</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">t</span><span class="mord mathrm">e</span><span class="mord mathrm">d</span></span></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 交错而成的序列</li><li>进行 <code>1-sorting</code> 时仍有很多逆序对</li></ul></li><li>根源在于，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>s</mi><mi>h</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{H}_{shell}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中各项并不互素，相邻项也非互素</li></ul><h5 id="ps-s-sequence">PS’s Sequence</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>P</mi><mi>S</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="script">H</mi><mrow><mi>s</mi><mi>h</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></msub><mo>−</mo><mn>1</mn><mo>=</mo><mo stretchy="false">{</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>k</mi><mo>∈</mo><mi>N</mi><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>15</mn><mo separator="true">,</mo><mn>31</mn><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{H}_{PS} = \mathcal{H}_{shell} - 1 = \{2^k - 1 \,\,|\,\, k \in N\} = \{1, 3, 7, 15, 31, \dots\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">}</span></span></span></span><ul><li>相邻项互素</li></ul></li><li>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{3 / 2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><ul><li>平均为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mn>5</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{5 / 4})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>（通过模拟得出）</li></ul></li></ul><h5 id="pratt-s-sequence">Pratt’s Sequence</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>p</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">{</mo><msup><mn>2</mn><mi>p</mi></msup><mo>⋅</mo><msup><mn>3</mn><mi>q</mi></msup><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo>∈</mo><mi>N</mi><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>12</mn><mo separator="true">,</mo><mn>16</mn><mo separator="true">,</mo><mn>18</mn><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{H}_{pratt} = \{2^p \cdot 3^q \,\, | \,\, p, q \in N\} = \{1, 2, 3, 4, 6, 8, 9, 12, 16, 18, \dots\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose">}</span></span></span></span></li><li>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log^2 n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.148448em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8984479999999999em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h5 id="sedgewick-s-sequence">Sedgewick’s Sequence</h5><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>S</mi><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>w</mi><mi>i</mi><mi>c</mi><mi>k</mi></mrow></msub><mo>=</mo><mo stretchy="false">{</mo><mn>9</mn><mo>×</mo><msup><mn>4</mn><mi>k</mi></msup><mo>−</mo><mn>9</mn><mo>×</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>k</mi><mo>≥</mo><mn>0</mn><mo stretchy="false">}</mo><mo>∪</mo><mo stretchy="false">{</mo><msup><mn>4</mn><mi>k</mi></msup><mo>−</mo><mn>3</mn><mo>×</mo><msup><mn>2</mn><mi>k</mi></msup><mo>+</mo><mn>1</mn><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mtext> </mtext><mi>k</mi><mo>≥</mo><mn>2</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{H}_{Sedgewick} = \{9 \times 4 ^k - 9 \times 2^k + 1 \,\, | \,\, k \ge 0\} \cup \{4^k - 3 \times 2^k + 1 \,\, | \,\, k \ge 2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">}</span></span></span></span><ul><li>PS 和 Pratt 的结合</li></ul></li><li>最坏复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mn>4</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{4 / 3})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，平均 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mn>7</mn><mi mathvariant="normal">/</mi><mn>6</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{7 / 6})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">/</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><ul><li>实践性能最佳</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DSA </tag>
            
            <tag> 826考研 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OS-2024-Shell-Challenge</title>
      <link href="/9801daf5.html"/>
      <url>/9801daf5.html</url>
      
        <content type="html"><![CDATA[<h1 id="shell挑战性任务">Shell挑战性任务</h1><h2 id="任务要求">任务要求</h2><p>本次挑战性任务是在 lab6 实现的 MOS Shell 基础上继续实现新的功能。</p><h3 id="实现功能">实现功能</h3><p>具体内容参考<a href="https://github.com/EinNiemand28/EinNiemand28.github.io/blob/main/file/Shell%20%E6%8C%91%E6%88%98%E6%80%A7%E4%BB%BB%E5%8A%A1%20-%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E4%B9%A6.pdf">任务说明</a>。（各测试点间无依赖关系）</p><h3 id="关于shell">关于shell</h3><p>在 MOS 中，进程是一个很重要的概念，我们需要清楚 MOS 在运行的过程中存在哪些进程、这些进程之间的关系是什么，这有助于我们完成 shell 的相关任务。</p><p>比如，当我们启动 shell 时，它的 main 函数构成了一个新的进程。这个主进程主要负责完成命令的读取（<code>readline</code>）等工作（这个进程从 mosh 被打开到结束也都是不会被 free 的），不断有新的进程被 fork 出来通过调用<code>runcmd</code>去执行命令。在<code>runcmd</code>中，则首先调用<code>parsecmd</code>解析命令的参数。</p><p><code>parsecmd</code>通过返回<code>argc</code>表明完成对命令和参数的解析，或者递归调用<code>parsecmd</code>进行更复杂的解析工作。在这个过程中，主要通过<code>gettoken</code>和<code>_gettoken</code>对字符串命令进行拆解。</p><p>解析完成后，又会调用<code>spawn</code>函数加载对应的可执行文件、fork 新的进程并设置跳转入口，以执行对应的命令。<code>spawn</code>会返回这个进程的 id ，使父进程得以<strong>等待</strong>（或根据要实现的功能进程不同的处理）子进程完成可执行文件的运行（所有会结束的进程最后会调用<code>exit()</code>），然后父进程也就将结束它的使命。</p><p>以上是 mosh 运行的大致逻辑，对这些有了基本的了解后，让我们着手开始增强 mosh 的功能吧。</p><h2 id="具体实现">具体实现</h2><h3 id="不带-b后缀指令">不带<code>.b</code>后缀指令</h3><p>只需在<code>spawn</code>加载可执行文件时进行额外判断即可，若可执行文件不存在，则添加<code>.b</code>后缀再次尝试</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> fd;</span><br><span class="line"><span class="type">char</span> cmd[<span class="number">1024</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> ((fd = open(prog, O_RDONLY)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(cmd, prog);</span><br><span class="line">    <span class="built_in">strcat</span>(cmd, <span class="string">&quot;.b\0&quot;</span>); <span class="comment">// lib/string.c 中实现</span></span><br><span class="line">    <span class="comment">//debugf(&quot;cmd: %s\n&quot;, cmd);</span></span><br><span class="line">    <span class="keyword">if</span> ((fd = open(cmd, O_RDONLY)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> fd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="指令条件执行">指令条件执行</h3><p>显然，这首先需要我们修改 MOS 中对用户进程<code>exit</code>的实现，使其能够返回值。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">exit</span><span class="params">(<span class="type">int</span> r)</span> &#123;</span><br><span class="line">    <span class="comment">// After fs is ready (lab5), all our open files should be closed before dying.</span></span><br><span class="line">    <span class="meta">#<span class="keyword">if</span> !defined(LAB) || LAB &gt;= 5</span></span><br><span class="line">    close_all();</span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    env = &amp;envs[ENVX(syscall_getenvid())];</span><br><span class="line">    <span class="keyword">if</span> (envs[ENVX(env-&gt;env_parent_id)].env_ipc_recving != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//debugf(&quot;%d should send: %d\n&quot;, env-&gt;env_id, r);</span></span><br><span class="line">        ipc_send(env-&gt;env_parent_id, r, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    syscall_env_destroy(<span class="number">0</span>);</span><br><span class="line">    user_panic(<span class="string">&quot;unreachable code&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我采用了 <code>ipc</code> 来实现返回值的传递，当父进程需要返回值时，让子进程调用<code>ipc_send</code></p><p>以条件<code>||</code>为例</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">-2</span>: <span class="comment">// Or</span></span><br><span class="line">    <span class="keyword">if</span> ((*rightpipe = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> argc; <span class="comment">// 子进程执行左指令</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        u_int who;</span><br><span class="line">        r = ipc_recv(&amp;who, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">//debugf(&quot;%d %d %d\n&quot;, *rightpipe, who, r);</span></span><br><span class="line">        <span class="keyword">if</span> (r == <span class="number">0</span>) &#123; <span class="comment">// 若左为真，则跳过之后的指令，直到遇到注释&#x27;#&#x27;，或者遇到条件&#x27;&amp;&amp;&#x27;能让它停下来</span></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                c = gettoken(<span class="number">0</span>, &amp;t);</span><br><span class="line">            &#125; <span class="keyword">while</span> (c != <span class="number">-1</span> &amp;&amp; c != <span class="string">&#x27;#&#x27;</span> &amp;&amp; c);</span><br><span class="line">            <span class="keyword">if</span> (c != <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parsecmd(argv, rightpipe, background); <span class="comment">// 可以继续解析</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>另外由于可执行文件执行之后的返回值不能直接传给上述父进程，所以可以修改<code>wait</code>函数，让其将值先返回给子进程，子进程再将此值返回</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wait.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">wait</span><span class="params">(u_int envid)</span> &#123;</span><br><span class="line">    <span class="comment">// 注意我们这里再 wait 中使用了 ipc，之后在其他地方再想使用这个 wait 时需要注意 ipc 是否会产生影响</span></span><br><span class="line">    <span class="type">const</span> <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> <span class="title">Env</span> *<span class="title">e</span>;</span></span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    u_int who;</span><br><span class="line">    e = &amp;envs[ENVX(envid)];</span><br><span class="line">    <span class="comment">// debugf(&quot;%08x waiting %08x\n&quot;, syscall_getenvid(), envid);</span></span><br><span class="line">    <span class="keyword">while</span> (e-&gt;env_id == envid &amp;&amp; e-&gt;env_status != ENV_FREE) &#123;</span><br><span class="line">        r = ipc_recv(&amp;who, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        syscall_yield();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sh.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">runcmd</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="type">int</span> child = spawn(argv[<span class="number">0</span>], argv);</span><br><span class="line">    <span class="keyword">if</span> (child &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        r = wait(child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">exit</span>(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="更多指令">更多指令</h3><blockquote><p>需要实现<code>touch</code>、<code>mkdir</code>、<code>rm</code>，并需要考虑给出的情形</p></blockquote><p>首先我们需要实现 MOS 的创建文件的用户接口（文件系统的接口已给出），新增以下内容</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fsreq.h</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fsreq_create</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> req_path[MAXPATHLEN];</span><br><span class="line">    u_int f_type;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lib.h</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fsipc_create</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *, <span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">create</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *path, u_int f_type)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// serv.h</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">file_create</span><span class="params">(<span class="type">char</span> *path, <span class="keyword">struct</span> File **file)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// file.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">create</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *path, u_int f_type)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fsipc_create(path, f_type);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// fsipc.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fsipc_create</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *path, <span class="type">int</span> f_type)</span> &#123;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(path);</span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">0</span> || len &gt; MAXPATHLEN) &#123;</span><br><span class="line">        <span class="keyword">return</span> -E_BAD_PATH;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Fsreq_create</span> *<span class="title">req</span> =</span> (<span class="keyword">struct</span> Fsreq_create *) fsipcbuf;</span><br><span class="line">    req-&gt;f_type = f_type;</span><br><span class="line">    <span class="built_in">strcpy</span>((<span class="type">char</span> *) req-&gt;req_path, path);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fsipc(FSREQ_CREATE, req, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// serv.c</span></span><br><span class="line"><span class="type">void</span> *serve_table[MAX_FSREQNO] = &#123;</span><br><span class="line">    ..., [FSREQ_CREATE] = serve_create,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">serve_create</span><span class="params">(u_int envid, <span class="keyword">struct</span> Fsreq_create *rq)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">f</span>;</span></span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((r = file_create(rq-&gt;req_path, &amp;f)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        ipc_send(envid, r, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    f-&gt;f_type = rq-&gt;f_type;</span><br><span class="line">    ipc_send(envid, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后，对于普通的<code>touch</code>和<code>mkdir</code>命令，我们只需要在对应<code>*.c</code>文件中进行以下操作即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> r = create(argv[<span class="number">1</span>], FTYPE_REG); <span class="comment">// 或修改类型为 FTYPE_DIR 以创建文件目录</span></span><br></pre></td></tr></table></figure><hr><p>对于<code>mkdir</code>，我们需要额外实现<code>-p</code>参数：当使用 <code>-p</code> 选项时忽略错误，若目录已存在则直接退出，若创建目录的父目录不存在则递归创建目录。</p><p>首先我们可以借助 ARG 宏来解析参数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ARGBEGIN &#123;</span><br><span class="line">    <span class="comment">// 以此类推</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">        pmod = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        usage();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125; ARGEND</span><br><span class="line"><span class="comment">// 要注意解析完成后从 argv[0] 开始就是命令的执行参数</span></span><br></pre></td></tr></table></figure><p>对于<code>-p</code>参数，我的处理办法为，对路径进行解析，忽视错误对路径中每一个子目录进行创建</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *path = argv[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span> (*path == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">    path++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> len = <span class="built_in">strlen</span>(path);</span><br><span class="line">*(path + len) = <span class="string">&#x27;/&#x27;</span>; <span class="comment">// 方便创建最后一个目录</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= len; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (*(path + i) == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">        *(path + i) = <span class="number">0</span>;</span><br><span class="line">        create(path, FTYPE_DIR);</span><br><span class="line">        *(path + i) = <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>对于<code>rm</code>指令，用户接口<code>remove</code>已给出，直接使用即可</p><p>不过我们需要处理不同的情况</p><blockquote><ul><li><code>rm &lt;file&gt;</code>：若文件存在则删除 <code>&lt;file&gt;</code>，否则输出错误信息。</li><li><code>rm &lt;dir&gt;</code>：输出错误信息。</li><li><code>rm -r &lt;dir&gt;|&lt;file&gt;</code>：若文件或文件夹存在则删除，否则输出错误信息。</li><li><code>rm -rf &lt;dir&gt;|&lt;file&gt;</code>：如果对应文件或文件夹存在则删除，否则直接退出。</li></ul></blockquote><p>因此我们需要先获取路径对应的文件描述符，然后针对不同情况进行不同的处理</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> fd = open(argv[<span class="number">0</span>], O_RDONLY); <span class="comment">// 只读</span></span><br><span class="line"><span class="keyword">if</span> (rmod &amp;&amp; <span class="built_in">fmod</span>) &#123;</span><br><span class="line">    remove(argv[<span class="number">0</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;rm: cannot remove \&#x27;%s\&#x27;: No such file or directory\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">struct</span> Filefd *filefd = (<span class="keyword">struct</span> Filefd *) INDEX2FD(fd);</span><br><span class="line">        <span class="comment">// 获取文件描述符</span></span><br><span class="line">        <span class="keyword">if</span> (!rmod &amp;&amp; filefd-&gt;f_file.f_type == FTYPE_DIR) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;rm: cannot remove \&#x27;%s\&#x27;: Is a directory\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            remove(argv[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="反引号">反引号</h3><blockquote><p>本次任务只需考虑<code>echo</code>进行的输出且数据较弱，故忽略<code>echo</code>指令和反引号，直接执行反引号中的指令貌似也能过。不过这里还是对反引号原有的要求进行了实现。</p></blockquote><p>首先我们在<code>SYMBOLS</code>里面添加反引号以完成识别</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SYMBOLS <span class="string">&quot;&lt;|&gt;&amp;;()`#&quot;</span></span></span><br></pre></td></tr></table></figure><p>这里我采用了如下的方式区分前后的反引号</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> backquote;</span><br><span class="line"><span class="type">int</span> _gettoken(<span class="type">char</span> *s, <span class="type">char</span> **p1, <span class="type">char</span> **p2) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strchr</span>(SYMBOLS, *s)) &#123;</span><br><span class="line">        <span class="type">int</span> t = *s;</span><br><span class="line">        *p1 = s;</span><br><span class="line">        *s++ = <span class="number">0</span>;</span><br><span class="line">        *p2 = s;</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="string">&#x27;`&#x27;</span>) &#123;</span><br><span class="line">            backquote ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后使用管道将反引号中指令的所有输出传给父进程，对其解析以作为使用反引号的指令的参数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&#x27;`&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> (backquote) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((r = pipe(p)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            debugf(<span class="string">&quot;failed to allocate a pipe: %d\n&quot;</span>, r);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((*rightpipe = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// fork 子进程指令解析反引号中内容</span></span><br><span class="line">            <span class="comment">// 并将标准输入端与管道写端相连</span></span><br><span class="line">            dup(p[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">            close(p[<span class="number">1</span>]);</span><br><span class="line">            close(p[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">return</span> parsecmd(argv, rightpipe, background);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 将标准输入端与管道读端相连，使用 read 读取信息</span></span><br><span class="line">            dup(p[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">            close(p[<span class="number">0</span>]);</span><br><span class="line">            close(p[<span class="number">1</span>]);</span><br><span class="line">            <span class="type">char</span> *tmp = (<span class="type">char</span> *) bf;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, count = <span class="number">0</span>; i &lt; MAXLEN; i++) &#123;</span><br><span class="line">                count += read(<span class="number">0</span>, bf + i, <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (count == i) <span class="keyword">break</span>;</span><br><span class="line">                syscall_yield();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (<span class="built_in">strchr</span>(<span class="string">&quot;\t\r\n&quot;</span>, *tmp)) &#123;</span><br><span class="line">                *tmp++ = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 以换行符进行分割</span></span><br><span class="line">            <span class="keyword">while</span> (*tmp) &#123;</span><br><span class="line">                <span class="type">char</span> *s1 = tmp;</span><br><span class="line">                <span class="keyword">while</span> (!<span class="built_in">strchr</span>(<span class="string">&quot;\t\r\n&quot;</span>, *tmp) &amp;&amp; *tmp) &#123;</span><br><span class="line">                    tmp++;</span><br><span class="line">                &#125;</span><br><span class="line">                *tmp++ = <span class="number">0</span>;</span><br><span class="line">                argv[argc++] = s1;</span><br><span class="line">                <span class="keyword">while</span> (<span class="built_in">strchr</span>(<span class="string">&quot;\t\r\n&quot;</span>, *tmp) &amp;&amp; *tmp) &#123;</span><br><span class="line">                    tmp++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                c = gettoken(<span class="number">0</span>, &amp;t);</span><br><span class="line">                <span class="comment">// 这里父进程需要跳过直到右引号的所有内容</span></span><br><span class="line">            &#125; <span class="keyword">while</span> (c != <span class="string">&#x27;`&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> argc;</span><br><span class="line">        <span class="comment">// 子进程完成了对反引号中内容的解析，返回执行</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>这里最开始我使用原始的<code>wait</code>但是没有成功，因此使用了类似于轮询的方式完成了对数据的读取</p><p>不过后来我需要在<code>wait.c</code>中添加新的功能，所以上面比较丑陋的轮询方式可以简化为下面的函数调用</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wait.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">check2</span><span class="params">(u_int envid)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> <span class="title">Env</span> *<span class="title">e</span>;</span></span><br><span class="line">    e = &amp;envs[ENVX(envid)];</span><br><span class="line">    <span class="keyword">while</span> (e-&gt;env_id == envid &amp;&amp; e-&gt;env_status != ENV_FREE) &#123;</span><br><span class="line">        syscall_yield();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="注释功能">注释功能</h3><p>这个比较简单，完成对<code>#</code>的识别后进行如下处理即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">    <span class="keyword">return</span> argc;</span><br></pre></td></tr></table></figure><h3 id="一行多指令">一行多指令</h3><p>常规的进程 fork</p><p>需要注意的点是可能之前会有重定向，将输出指向了其他地方，这里需要将其重新指回控制台</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> ((*rightpipe = fork()) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> argc;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        wait(*rightpipe);</span><br><span class="line">        <span class="keyword">if</span> (redirect) &#123;</span><br><span class="line">            close(<span class="number">0</span>);</span><br><span class="line">            close(<span class="number">1</span>);</span><br><span class="line">            dup(opencons(), <span class="number">1</span>);</span><br><span class="line">            dup(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            redirect = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parsecmd(argv, rightpipe, background);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><h3 id="追加重定向">追加重定向</h3><p>首先我们需要实现文件操作的<code>O_APPEND</code>模式，即追加写功能</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> O_APPEND 0x1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// serv.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">serve_open</span><span class="params">(u_int envid, <span class="keyword">struct</span> Fsreq_open *rq)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    o-&gt;o_mode = rq-&gt;req_omode;</span><br><span class="line">    ff-&gt;f_fd.fd_omode = o-&gt;o_mode;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (ff-&gt;f_fd.fd_omode &amp; O_APPEND) &#123;</span><br><span class="line">        ff-&gt;f_fd.fd_offset = f-&gt;f_size;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在<code>parsecmd</code>中进行相应的修改</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:; <span class="comment">// 这个分号是因为 C 语言不允许在 case 后面直接定义变量</span></span><br><span class="line">    <span class="type">int</span> cc = gettoken(<span class="number">0</span>, &amp;t);</span><br><span class="line">    <span class="type">int</span> mode = O_WRONLY | O_CREAT; <span class="comment">// 没有则创建</span></span><br><span class="line">    <span class="keyword">if</span> (cc == <span class="string">&#x27;&gt;&#x27;</span>) &#123; <span class="comment">// 判断是否是追加重定向</span></span><br><span class="line">        mode |= O_APPEND;</span><br><span class="line">        <span class="keyword">if</span> ((cc = gettoken(<span class="number">0</span>, &amp;t)) != <span class="string">&#x27;w&#x27;</span>) &#123;</span><br><span class="line">            debugf(<span class="string">&quot;syntax error: &gt; not followed by word\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cc == <span class="string">&#x27;w&#x27;</span>) &#123;</span><br><span class="line">        mode |= O_TRUNC; <span class="comment">// 普通重定向需先清空文件内容</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        debugf(<span class="string">&quot;syntax error: &gt; not followed by word\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((r = open(t, mode)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        debugf(<span class="string">&quot;failed to open \&#x27;%s\&#x27;: %d\n&quot;</span>, t, r);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fd = r;</span><br><span class="line">    dup(fd, <span class="number">1</span>); <span class="comment">// 标准输出端与对应文件符相连</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><h3 id="引号支持">引号支持</h3><p>由于不用考虑引号和反引号的嵌套处理，所以也就相对简单，只需在<code>_gettoken</code>时将引号内所用内容标记为一个<code>word</code>（<code>w</code>）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> _gettoken(<span class="type">char</span> *s, <span class="type">char</span> **p1, <span class="type">char</span> **p2) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (*s == <span class="string">&#x27;\&quot;&#x27;</span>) &#123; <span class="comment">// 这个判断需要在其他所有情况的前面</span></span><br><span class="line">        *p1 = ++s;</span><br><span class="line">        <span class="keyword">while</span> (*s != <span class="string">&#x27;\&quot;&#x27;</span> &amp;&amp; *s++);</span><br><span class="line">        *s++ = <span class="number">0</span>;</span><br><span class="line">        *p2 = s;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;w&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="历史指令">历史指令</h3><p><s>重量级</s></p><p>首先本着要做就要做好的原则，我先实现了对键入命令任意位置的修改的支持（使用<kbd>←</kbd>,<kbd>→</kbd>,<kbd>Backspace</kbd>,<kbd>Del</kbd>），这样不仅看起来更加顺眼，还可以实现对历史指令的修改</p><p>查阅资料可知，我们需要判断的 ascii 为</p><table><thead><tr><th>键</th><th>编码</th></tr></thead><tbody><tr><td>←</td><td>\033[D</td></tr><tr><td>→</td><td>\033[C</td></tr><tr><td>↑</td><td>\033[A</td></tr><tr><td>↓</td><td>\033[B</td></tr><tr><td>Backspace</td><td>\b or 0x7f</td></tr><tr><td>Del</td><td>~</td></tr></tbody></table><p>通过以下宏我们可以实现光标的移动，从而能够通过输出新的内容覆盖指定位置的原有内容</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MoveLeft(x) debugf(<span class="string">&quot;\033[%dD&quot;</span>, x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MoveRight(x) debugf(<span class="string">&quot;\033[%dC&quot;</span>, x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MoveUp(x) debugf(<span class="string">&quot;\033[%dA&quot;</span>, x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Movedown(x) debugf(<span class="string">&quot;\033[%dB&quot;</span>, x)</span></span><br></pre></td></tr></table></figure><p>然后修改<code>readline</code>的逻辑，维护当前指令的长度<code>len</code>和光标位置<code>i</code>（表示在第i个字符前），以及历史指令的读取</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">readline</span><span class="params">(<span class="type">char</span> *buf, u_int n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> r, len = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; n) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((r = read(<span class="number">0</span>, &amp;tmp, <span class="number">1</span>)) != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                debugf(<span class="string">&quot;read error: %d\n&quot;</span>, r);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (删除字符) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (方向键) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp == <span class="string">&#x27;\r&#x27;</span> || tmp == <span class="string">&#x27;\n&#x27;</span>) &#123; <span class="comment">// 结束</span></span><br><span class="line">            buf[len] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 普通字符</span></span><br><span class="line">            <span class="keyword">if</span> (i == len) &#123;</span><br><span class="line">                buf[i++] = tmp;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = len; j &gt; i; j--) &#123;</span><br><span class="line">                    buf[j] = buf[j - <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                buf[i] = tmp;</span><br><span class="line">                buf[len + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">                MoveLeft(++i); <span class="comment">// 光标移动至开头</span></span><br><span class="line">                debugf(<span class="string">&quot;%s&quot;</span>, buf); <span class="comment">// 显示新的内容</span></span><br><span class="line">                MoveLeft(len - i + <span class="number">1</span>); <span class="comment">// 将光标移动至原来的位置</span></span><br><span class="line">            &#125;</span><br><span class="line">            len += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进一步，对于退格键<kbd>Backspace</kbd>和删除键<kbd>Del</kbd>的处理，主要思路是用空格覆盖想要删除的字符（以实现删除效果），对于光标位置的计算没什么好说的，细心即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (tmp == <span class="string">&#x27;\b&#x27;</span> || tmp == <span class="number">0x7f</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == len) &#123;</span><br><span class="line">            buf[--i] = <span class="number">0</span>;</span><br><span class="line">            MoveLeft(<span class="number">1</span>);</span><br><span class="line">            debugf(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            MoveLeft(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i - <span class="number">1</span>; j &lt; len - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">                buf[j] = buf[j + <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            buf[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            MoveLeft(i--);</span><br><span class="line">            debugf(<span class="string">&quot;%s &quot;</span>, buf);</span><br><span class="line">            MoveLeft(len - i);</span><br><span class="line">        &#125;</span><br><span class="line">        len -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp == <span class="string">&#x27;~&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; len) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt; len; ++j) &#123;</span><br><span class="line">            buf[j] = buf[j + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        buf[--len] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (i != <span class="number">0</span>) &#123;</span><br><span class="line">            MoveLeft(i);</span><br><span class="line">        &#125;</span><br><span class="line">        debugf(<span class="string">&quot;%s &quot;</span>, buf);</span><br><span class="line">        MoveLeft(len - i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于方向键的处理，左移右移比较直接，只需要注意不要移出范围</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp == <span class="string">&#x27;\033&#x27;</span>) &#123;</span><br><span class="line">    read(<span class="number">0</span>, &amp;tmp, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (tmp == <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">        read(<span class="number">0</span>, &amp;tmp, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">switch</span> (tmp) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (i &lt; len) &#123;</span><br><span class="line">                    i += <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    MoveLeft(<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    i -= <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    MoveRight(<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于上下键的处理，我们先不考虑历史指令如何保存和读取，而是关注如何实现上下键的逻辑功能<br>这里我采用了一个全局变量<code>hislen</code>来记录历史指令的数量、一个局部变量<code>hisline</code>来记录当前是哪条指令（<code>[0,hislen - 1]</code>表示历史指令），<code>histmp</code>用来保存当前输入的指令（因为可能会上键选取历史指令、最后又下键回到当前指令）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">deleteLine</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> len)</span> &#123; <span class="comment">// 光标位置和buf长度</span></span><br><span class="line">    <span class="keyword">if</span> (pos != <span class="number">0</span>) &#123;</span><br><span class="line">        MoveLeft(pos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; ++k) &#123;</span><br><span class="line">        debugf(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (len != <span class="number">0</span>) &#123;</span><br><span class="line">        MoveLeft(len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">readline</span><span class="params">(<span class="type">char</span> *buf, u_int n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> hisline = hislen;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; n) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp == <span class="string">&#x27;\033&#x27;</span>) &#123;</span><br><span class="line">        read(<span class="number">0</span>, &amp;tmp, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tmp == <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">            read(<span class="number">0</span>, &amp;tmp, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">switch</span> (tmp) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">                    Movedown(<span class="number">1</span>); <span class="comment">// 将光标移回来</span></span><br><span class="line">                    <span class="keyword">if</span> (hisline == hislen) &#123;</span><br><span class="line">                        <span class="comment">// 保存一下当前输入的指令</span></span><br><span class="line">                        <span class="built_in">strcpy</span>(histmp, buf);</span><br><span class="line">                        *(histmp + len) = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hisline &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        hisline--;</span><br><span class="line">                        readHistory(hisline, buf);</span><br><span class="line">                        <span class="comment">// 读取第 hisline 条历史指令</span></span><br><span class="line">                        deleteLine(i, len);</span><br><span class="line">                        <span class="comment">// 清除当前行的所有内容</span></span><br><span class="line">                        debugf(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">                        len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">                        i = len;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                    <span class="comment">//MoveUp(1); 往下则不用移动</span></span><br><span class="line">                    <span class="keyword">if</span> (hisline &lt; hislen - <span class="number">1</span>) &#123;</span><br><span class="line">                        hisline++;</span><br><span class="line">                        readHistory(hisline, buf);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hisline + <span class="number">1</span> == hislen) &#123;</span><br><span class="line">                        hisline++;</span><br><span class="line">                        <span class="built_in">strcpy</span>(buf, histmp);</span><br><span class="line">                        <span class="comment">// 回到当前指令</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    deleteLine(i, len);</span><br><span class="line">                    debugf(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">                    len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">                    i = len;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>现在我们可以开始尝试实现历史指令的功能了<br>首先是初始化创建<code>/.mosh_history</code>文件</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((r = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_RDONLY)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (create(<span class="string">&quot;/.mosh_history&quot;</span>, FTYPE_REG) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        user_panic(<span class="string">&quot;create failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    close(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于如何从文件中读取历史指令，我采用了一个数组<code>hisoffset</code>来记录每条指令的偏移，这样我们就可以通过<code>seek</code>和<code>read</code>来读取指令</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> hislen, hisoffset[HISTFILESIZE + <span class="number">5</span>];</span><br><span class="line"><span class="comment">// hisoffset[i] -&gt; 前 (i+1) 条指令的长度之和 + (i+1) 个换行符</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">readHistory</span><span class="params">(<span class="type">int</span> line, <span class="type">char</span> *buf)</span> &#123;</span><br><span class="line">    <span class="type">int</span> r, fd;</span><br><span class="line">    <span class="keyword">if</span> ((fd = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_RDONLY)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        user_panic(<span class="string">&quot;open failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (line &gt;= hislen) &#123;</span><br><span class="line">        *buf = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> offset = (line &gt; <span class="number">0</span> ? hisoffset[line - <span class="number">1</span>] : <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> len = (line &gt; <span class="number">0</span> ? hisoffset[line] - hisoffset[line - <span class="number">1</span>] : hisoffset[line]);</span><br><span class="line">    <span class="keyword">if</span> ((r = seek(fd, offset)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        user_panic(<span class="string">&quot;seek failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((r = read(fd, buf, len)) != len) &#123;</span><br><span class="line">        user_panic(<span class="string">&quot;read failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    close(fd);</span><br><span class="line">    buf[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>读取指令需要注意的是最大指令条数为<code>HISTFILESIZE=20</code>，当超过时需要将最早的指令删除。这里我采用的是将后19条指令读出，清空文件，再和新指令一起写入的简单粗暴的方式。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">saveHistory</span><span class="params">(<span class="type">char</span> *buf)</span> &#123;</span><br><span class="line">    <span class="type">int</span> r, fd;</span><br><span class="line">    <span class="keyword">if</span> (hislen &lt; HISTFILESIZE) &#123; <span class="comment">// 未达上限</span></span><br><span class="line">        <span class="keyword">if</span> ((fd = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_WRONLY | O_APPEND)) &lt; <span class="number">0</span>) &#123; <span class="comment">// 追加写</span></span><br><span class="line">            user_panic(<span class="string">&quot;open failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        *(buf + len) = <span class="string">&#x27;\n&#x27;</span>; <span class="comment">// 加换行符</span></span><br><span class="line">        len += <span class="number">1</span>;</span><br><span class="line">        *(buf + len) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ((r = write(fd, buf, len)) != len) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;write error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        hisoffset[hislen++] = len + (hislen &gt; <span class="number">0</span> ? hisoffset[hislen - <span class="number">1</span>] : <span class="number">0</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// 已满</span></span><br><span class="line">        <span class="keyword">if</span> ((fd = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_RDONLY)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;open failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((r = seek(fd, hisoffset[<span class="number">0</span>])) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;seek failed&quot;</span>); <span class="comment">// 从第 1 条指令开始读</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> len = hisoffset[HISTFILESIZE - <span class="number">1</span>] - hisoffset[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// 读出除第 0 条指令外的所有指令</span></span><br><span class="line">        <span class="keyword">if</span> ((r = read(fd, buftmp, len)) != len) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;read error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((fd = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_TRUNC | O_WRONLY)) &lt; <span class="number">0</span>) &#123; <span class="comment">// 清空</span></span><br><span class="line">            user_panic(<span class="string">&quot;trunc failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((r = write(fd, buftmp, len)) != len) &#123;</span><br><span class="line">            debugf(<span class="string">&quot;%s\n&quot;</span>, buftmp);</span><br><span class="line">            debugf(<span class="string">&quot;%d %d\n&quot;</span>, len, r);</span><br><span class="line">            user_panic(<span class="string">&quot;rewrite error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((fd = open(<span class="string">&quot;/.mosh_history&quot;</span>, O_WRONLY | O_APPEND)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;rewrite not correctly&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">        *(buf + len) = <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        len += <span class="number">1</span>;</span><br><span class="line">        *(buf + len) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ((r = write(fd, buf, len)) != len) &#123;</span><br><span class="line">            user_panic(<span class="string">&quot;write error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ttmp = hisoffset[<span class="number">0</span>]; <span class="comment">// 重新计算所有偏移</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; HISTFILESIZE; i++) &#123;</span><br><span class="line">            hisoffset[i] = hisoffset[i + <span class="number">1</span>] - ttmp;</span><br><span class="line">        &#125;</span><br><span class="line">        hisoffset[hislen - <span class="number">1</span>] = hisoffset[hislen - <span class="number">2</span>] + len;</span><br><span class="line">        close(fd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>history</code>指令，直接将其变为<code>cat /.mosh_history</code>即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">runcmd</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(argv[<span class="number">0</span>], <span class="string">&quot;history&quot;</span>) || !<span class="built_in">strcmp</span>(argv[<span class="number">0</span>], <span class="string">&quot;history.b&quot;</span>)) &#123;</span><br><span class="line">        argv[<span class="number">0</span>] = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">        argv[<span class="number">1</span>] = <span class="string">&quot;.mosh_history&quot;</span>;</span><br><span class="line">        argc = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="前后台任务管理">前后台任务管理</h3><blockquote><ul><li>当命令的末尾添加上 &amp; 符号时，该命令应该在后台执行</li><li>实现 jobs 指令列出当前 shell 中所有后台任务的状态。需要为任务创建 ID（每次启动 mosh 时，任务从 1 开始编号，每个新增任务编号应加 1），并且通过 jobs 指令输出包括：任务 ID（job_id）、任务的运行状态（status：可能的取值为 Running，Done）、任务的进程 ID（env_id）与运行任务时输入的指令（cmd）。</li><li>实现 fg 将后台任务带回前台继续运行，用户通过 fg &lt;job_id&gt; 的方式将对应任务带回前台。</li><li>实现 kill 指令，用户通过 kill &lt;job_id&gt; 来实现结束后台任务。</li><li>以上指令均需要设计为内置指令（与<code>history</code>一样）</li></ul></blockquote><p>坑点很多，相比于历史指令，这部分更是在 bug 里找 bug</p><p>总之这里收回前文对进程之间关系的强调伏笔，需要注意的是一定要在<code>mosh</code>的<strong>主进程</strong>中读写 jobs 的相关信息（子进程被 free 信息就没了），然后对于 ipc 的使用也要多加考虑，以防产生错误行为</p><hr><p>首先我们在每次读取到指令后就根据是否有<code>&amp;</code>符号来判断是否为后台任务，然后将其状态和指令保存在一个结构体数组中</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> cmd[<span class="number">1024</span>];</span><br><span class="line"><span class="type">int</span> jobscount;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Job</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> status;</span><br><span class="line">    <span class="type">int</span> env_id;</span><br><span class="line">    <span class="type">char</span> cmd[<span class="number">1024</span>];</span><br><span class="line">&#125; jobs[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">savetask</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(cmd, s);</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">while</span> (s[len - <span class="number">1</span>] != <span class="string">&#x27;&amp;&#x27;</span> &amp;&amp; len &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        len--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s[len - <span class="number">1</span>] == <span class="string">&#x27;&amp;&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(jobs[++jobscount].cmd, cmd);</span><br><span class="line">        jobs[jobscount].status = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        readline(buf, <span class="keyword">sizeof</span> buf);</span><br><span class="line">        <span class="type">int</span> rr = savetask(buf);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着需要使用 ipc 去拿到对应的进程 id<br>先将<code>runcmd</code>改为有返回值，其中与 jobs 相关的操作返回非 0 值，否则返回 0，然后通过类似之前处理条件操作的方法将值传回 mosh 主进程</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (r == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">exit</span>(runcmd(buf));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ret = wait(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>parsecmd</code>中解析命令时需要检测是否有<code>&amp;</code>符号，如果有则将参数<code>*background</code>置为 1，并在<code>runcmd</code>中返回执行该命令的进程 id ，然后记录</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">parsecmd</span><span class="params">(<span class="type">char</span> **argv, <span class="type">int</span> *rightpipe, <span class="type">int</span> *background)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">        *background = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">runcmd</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="type">int</span> child = spawn(argv[<span class="number">0</span>], argv);</span><br><span class="line">    close_all();</span><br><span class="line">    <span class="keyword">if</span> (child &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (background) &#123;</span><br><span class="line">            r = <span class="number">0</span>; <span class="comment">// 不等待，即意味着在后台挂起</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r = wait(child);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        debugf(<span class="string">&quot;spawn %s: %d\n&quot;</span>, argv[<span class="number">0</span>], child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (background) &#123;</span><br><span class="line">        <span class="keyword">return</span> child;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (ret) &#123;</span><br><span class="line">        <span class="keyword">if</span> (rr) &#123;</span><br><span class="line">            jobs[jobscount].env_id = ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>fg</code>指令，为了避免使用 ipc 时出现的各种玄学错误，最后选择了轮询等待对应的子进程执行完毕，然后<code>return 0</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">atoi</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (*s) &#123;</span><br><span class="line">        ret = ret * <span class="number">10</span> + (*s++ - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">runcmd</span><span class="params">(<span class="type">char</span> *s)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(argv[<span class="number">0</span>], <span class="string">&quot;fg&quot;</span>)) &#123;</span><br><span class="line">        <span class="type">int</span> jobid = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (jobid &lt;= jobscount) &#123;</span><br><span class="line">            debugf(<span class="string">&quot;fg: job (%d) do not exist\n&quot;</span>, jobid);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (jobs[jobid].status == <span class="number">0</span>) &#123;</span><br><span class="line">            debugf(<span class="string">&quot;fg: (0x%08x) not running\n&quot;</span>, jobs[jobid].env_id);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        check2(jobs[jobid].env_id); <span class="comment">// 等待这个进程执行完</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// wait.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">check2</span><span class="params">(u_int envid)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> <span class="title">Env</span> *<span class="title">e</span>;</span></span><br><span class="line">    e = &amp;envs[ENVX(envid)];</span><br><span class="line">    <span class="keyword">while</span> (e-&gt;env_id == envid &amp;&amp; e-&gt;env_status != ENV_FREE) &#123;</span><br><span class="line">        syscall_yield();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>kill</code>命令，直接返回任务 id ，然后再主进程中将这个进程设置为<code>ENV_NOT_RUNNABLE</code>即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ret &lt;= jobscount) &#123;</span><br><span class="line">    <span class="keyword">if</span> (jobs[ret].status) &#123;</span><br><span class="line">        syscall_set_env_status(jobs[ret].env_id, ENV_NOT_RUNNABLE);</span><br><span class="line">        jobs[ret].status = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        debugf(<span class="string">&quot;fg: (0x%08x) not running\n&quot;</span>, jobs[ret].env_id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>jobs</code>指令，使用返回值<code>-1</code>来表示，然后在主进程输出对应的信息</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ret == <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= jobscount; i++) &#123;</span><br><span class="line">        debugf(<span class="string">&quot;[%d] %-10s 0x%08x %s\n&quot;</span>, i, jobs[i].status ? <span class="string">&quot;Running&quot;</span> : <span class="string">&quot;Done&quot;</span>, jobs[i].env_id, jobs[i].cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外值得注意的是，任务挂起以后会自己执行完毕，所以方便起见我们需要每次查询对应进程是否结束（状态是否为<code>ENV_FREE</code>），并更新对应状态信息</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= jobscount; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (jobs[i].status) &#123;</span><br><span class="line">        <span class="keyword">if</span> (check(jobs[i].env_id)) &#123;</span><br><span class="line">            jobs[i].status = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// wait.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">check</span><span class="params">(u_int envid)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="keyword">volatile</span> <span class="class"><span class="keyword">struct</span> <span class="title">Env</span> *<span class="title">e</span>;</span></span><br><span class="line">    e = &amp;envs[ENVX(envid)];</span><br><span class="line">    <span class="keyword">if</span> (e-&gt;env_status == ENV_FREE) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> BUAA操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OS-2024-Lab6</title>
      <link href="/ac93ecd3.html"/>
      <url>/ac93ecd3.html</url>
      
        <content type="html"><![CDATA[<h1 id="lab6实验报告">lab6实验报告</h1><h2 id="思考题">思考题</h2><h3 id="thinking-6-1">Thinking 6.1</h3><blockquote><p>示例代码中，父进程操作管道的写端，子进程操作管道的读端。如果现在想让父进程作为“读者”，代码应当如何修改？</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fildes[<span class="number">2</span>];</span><br><span class="line"><span class="comment">// fildes[0]读端 fildes[1]写端</span></span><br><span class="line"><span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> status;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    status = pipe(fildes);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (status == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error in pipe!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span>(fork()) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* 子进程 - 作为管道的写者 */</span></span><br><span class="line">            close(fildes[<span class="number">0</span>]);</span><br><span class="line">            write(fildes[<span class="number">1</span>], <span class="string">&quot;Hello world\n&quot;</span>, <span class="number">12</span>);</span><br><span class="line">            close(fildes[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">        <span class="keyword">default</span>: <span class="comment">/* 父进程 - 作为管道的读者 */</span></span><br><span class="line">            close(fildes[<span class="number">1</span>]);</span><br><span class="line">            read(fildes[<span class="number">0</span>], buf, <span class="number">100</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;father-process read:%s&quot;</span>, buf);</span><br><span class="line">            close(fildes[<span class="number">0</span>]);</span><br><span class="line">            <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="thinking-6-2">Thinking 6.2</h3><blockquote><p>上面这种不同步修改 pp_ref 而导致的进程竞争问题在 user/lib/fd.c 中的 dup 函数中也存在。请结合代码模仿上述情景，分析一下我们的 dup 函数中为什么会出现预想之外的情况？</p></blockquote><p>阅读代码可以知道，dup 函数的流程为：</p><ol><li>将<code>newfd</code>对应的页映射到<code>oldfd</code>对应的物理页面</li><li>将<code>newfd</code>的数据所在页映射到<code>oldfd</code>的数据所在物理页面</li></ol><p>如果某个进程在执行 dup 时，已经完成了 1，但还未完成 2，此时发生中断，与之通信的进程会根据<code>ref(fd)==ref(pipe)</code>认为写者进程已关闭，从而执行读操作，但实际上写者还未完成写操作，导致读者读到了错误的数据。</p><p>所以应该先执行 2，再执行 1，这样就不会出现上述问题。</p><h3 id="thinking-6-3">Thinking 6.3</h3><blockquote><p>阅读上述材料并思考：为什么系统调用一定是原子操作呢？如果你觉得不是所有的系统调用都是原子操作，请给出反例。希望能结合相关代码进行分析说明。</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;asm/asm.h&gt;</span><br><span class="line">#include &lt;stackframe.h&gt;</span><br><span class="line"></span><br><span class="line">.section .text.tlb_miss_entry</span><br><span class="line">tlb_miss_entry:</span><br><span class="line">j       exc_gen_entry</span><br><span class="line"></span><br><span class="line">.section .text.exc_gen_entry</span><br><span class="line">exc_gen_entry:</span><br><span class="line">SAVE_ALL</span><br><span class="line">/*</span><br><span class="line">* Note: When EXL is set or UM is unset, the processor is in kernel mode.</span><br><span class="line">* When EXL is set, the value of EPC is not updated when a new exception occurs.</span><br><span class="line">* To keep the processor in kernel mode and enable exception reentrancy,</span><br><span class="line">* we unset UM and EXL, and unset IE to globally disable interrupts.</span><br><span class="line">*/</span><br><span class="line">mfc0    t0, CP0_STATUS</span><br><span class="line">and     t0, t0, ~(STATUS_UM | STATUS_EXL | STATUS_IE)</span><br><span class="line">mtc0    t0, CP0_STATUS</span><br><span class="line">/* Exercise 3.9: Your code here. */</span><br><span class="line">mfc0t0, CP0_CAUSE</span><br><span class="line">andit0, 0x7c</span><br><span class="line">lwt0, exception_handlers(t0)</span><br><span class="line">jrt0</span><br></pre></td></tr></table></figure><p>通过阅读指导书和注释可知，我们使用的 MIPS 4Kc 中的 CP0_Status 寄存器的 EXL 位和 UM 位表示了处理器当前的运行状态（当且仅当 EXL 被设置为 0 且 UM 被设置为 1 时，处理器处于用户模式），IE 位表示中断是否开启。而我们在处理系统调用时，将 EXL 、 UM 和 IE 位都设置为 0，使系统处于内核模式且不响应中断，故系统调用一定是原子操作。</p><h3 id="thinking-6-4">Thinking 6.4</h3><blockquote><p>仔细阅读上面这段话，并思考下列问题</p><ul><li>按照上述说法控制 pipe_close 中 fd 和 pipe unmap 的顺序，是否可以解决上述场景的进程竞争问题？给出你的分析过程。</li><li>我们只分析了 close 时的情形，在 fd.c 中有一个 dup 函数，用于复制文件描述符。试想，如果要复制的文件描述符指向一个管道，那么是否会出现与 close 类似的问题？请模仿上述材料写写你的理解。</li></ul></blockquote><ul><li>可以解决。因为在任何时刻都有<code>ref(fd) &lt;= ref(pipe)</code>，所以在<code>pipe_close</code>中先执行 unmap fd，就不会出现上述进程竞争的问题。</li><li>会出现类似的问题。因为在执行 dup 时，若先 map fd 再 map pipe ，就会使得<code>ref(fd)</code>的 +1 先于 pipe ，导致在两个 unmap 的间隙，会出现<code>ref(pipe) == ref(fd)</code>的情况。</li></ul><h3 id="thinking-6-5">Thinking 6.5</h3><blockquote><p>思考以下三个问题。</p><ul><li>认真回看 Lab5 文件系统相关代码，弄清打开文件的过程。</li><li>回顾 Lab1 与 Lab3，思考如何读取并加载 ELF 文件。</li><li>在 Lab1 中我们介绍了 data text bss 段及它们的含义，data 段存放初始化过的全局变量，bss 段存放未初始化的全局变量。关于 memsize 和 filesize ，我们在 Note 1.3.4中也解释了它们的含义与特点。关于 Note 1.3.4，注意其中关于“bss 段并不在文件中占数据”表述的含义。回顾 Lab3 并思考：elf_load_seg() 和 load_icode_mapper() 函数是如何确保加载 ELF 文件时，bss 段数据被正确加载进虚拟内存空间。bss 段在 ELF 中并不占空间，但 ELF 加载进内存后，bss 段的数据占据了空间，并且初始值都是 0。请回顾 elf_load_seg() 和 load_icode_mapper() 的实现，思考这一点是如何实现的？</li></ul><p>下面给出一些对于上述问题的提示，以便大家更好地把握加载内核进程和加载用户进程的区别与联系，类比完成 spawn 函数。</p><p>​关于第一个问题，在 Lab3 中我们创建进程，并且通过 ENV_CREATE(…) 在内核态加载了初始进程，而我们的 spawn 函数则是通过和文件系统交互，取得文件描述块，进而找到 ELF 在“硬盘”中的位置，进而读取。</p><p>​关于第二个问题，各位已经在 Lab3 中填写了 load_icode 函数，实现了 ELF 可执行文件中读取数据并加载到内存空间，其中通过调用 elf_load_seg 函数来加载各个程序段。在 Lab3 中我们要填写 load_icode_mapper 回调函数，在内核态下加载 ELF 数据到内存空间；相应地，在 Lab6 中 spawn 函数也需要在用户态下使用系统调用为 ELF 数据分配空间。</p></blockquote><ul><li>打开文件的过程为：<ol><li>调用<code>file.c</code>中的<code>open</code>函数指定文件路径<code>path</code>和读取模式<code>mode</code></li><li>调用<code>fd_alloc</code>分配文件描述符，再调用<code>fsipc_open</code>向文件服务系统发送打开文件的请求</li><li>调用<code>fsipc</code>向文件服务系统进程发送 IPC 请求，并等待返回</li><li>文件服务系统进程收到请求后调用<code>serve_open</code>处理请求，并调用<code>file_open</code>打开文件，返回文件描述符</li></ol></li><li>读取并加载 ELF 文件的过程为：<ol><li>调用<code>load_icode</code>函数将可执行文件（文件头地址为 binary ）加载到进程 e 的内存空间</li><li>调用<code>elf_load_seg</code>函数加载各个程序段，对于其中需要加载的页面，使用回调函数<code>load_icode_mapper</code>完成单个页面的加载</li></ol></li><li>在分配页面时，将text 段和 data 段占据的页面中没有占满的空间置为 0 给 bss 段，且另外再给 bss 分配时，仅使用<code>syscall_mem_alloc</code>而不映射任何内容</li></ul><h3 id="thinking-6-6">Thinking 6.6</h3><blockquote><p>通过阅读代码空白段的注释我们知道，将标准输入或输出定向到文件，需要我们将其 dup 到 0 或 1 号文件描述符（fd）。那么问题来了：在哪步，0 和 1 被“安排”为标准输入和标准输出？请分析代码执行流程，给出答案。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user/init.c</span></span><br><span class="line"><span class="comment">// stdin should be 0, because no file descriptors are open yet</span></span><br><span class="line"><span class="keyword">if</span> ((r = opencons()) != <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;opencons: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// stdout</span></span><br><span class="line"><span class="keyword">if</span> ((r = dup(<span class="number">0</span>, <span class="number">1</span>)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;dup: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="thinking-6-7">Thinking 6.7</h3><blockquote><p>在 shell 中执行的命令分为内置命令和外部命令。在执行内置命令时 shell 不需要 fork 一个子 shell，如 Linux 系统中的 cd 命令。在执行外部命令时 shell 需要 fork 一个子 shell，然后子 shell 去执行这条命令。</p><p>据此判断，在 MOS 中我们用到的 shell 命令是内置命令还是外部命令？请思考为什么 Linux 的 cd 命令是内部命令而不是外部命令？</p></blockquote><p>是外部命令。</p><p>cd 命令使用频繁，若设置为外部指令则每次使用时都会多次 fork。故设置为内部指令可以提高系统运行效率。</p><h3 id="thinking-6-8">Thinking 6.8</h3><blockquote><p>在你的 shell 中输入命令 ls.b | cat.b &gt; motd。</p><ul><li>请问你可以在你的 shell 中观察到几次 spawn ？分别对应哪个进程？</li><li>请问你可以在你的 shell 中观察到几次进程销毁？分别对应哪个进程？</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">ls.b | cat.b &gt; motd</span></span><br><span class="line">[00002803] pipecreate </span><br><span class="line">spawn: 14341</span><br><span class="line">spawn: 16390</span><br><span class="line">[00003805] destroying 00003805</span><br><span class="line">[00003805] free env 00003805</span><br><span class="line">i am killed ... </span><br><span class="line">[00004006] destroying 00004006</span><br><span class="line">[00004006] free env 00004006</span><br><span class="line">i am killed ... </span><br><span class="line">[00003004] destroying 00003004</span><br><span class="line">[00003004] free env 00003004</span><br><span class="line">i am killed ... </span><br><span class="line">[00002803] destroying 00002803</span><br><span class="line">[00002803] free env 00002803</span><br><span class="line">i am killed ... </span><br></pre></td></tr></table></figure><ul><li>共有 2 次 spawn，分别打开了 ls.b， cat.b 进程</li><li>共有 4 次进程销毁，分别销毁了：执行管道左边命令的进程、执行管道右边命令的进程、解析并执行管道右边命令的进程、解析并执行当前命令的进程</li></ul><h2 id="难点分析">难点分析</h2><h3 id="管道">管道</h3><h4 id="管道的原理">管道的原理</h4><p>管道是一种进程间通信的方式，分为有名管道和匿名管道，其中匿名管道只能在具有公共祖先的进程之间使用，且通常使用在父子进程之间（ MOS 实验中仅要求实现匿名管道）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Overview:</span></span><br><span class="line"><span class="comment"> *   Create a pipe.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Post-Condition:</span></span><br><span class="line"><span class="comment"> *   Return 0 and set &#x27;pfd[0]&#x27; to the read end and &#x27;pfd[1]&#x27; to the</span></span><br><span class="line"><span class="comment"> *   write end of the pipe on success.</span></span><br><span class="line"><span class="comment"> *   Return an corresponding error code on error.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pipe</span><span class="params">(<span class="type">int</span> pfd[<span class="number">2</span>])</span>;</span><br></pre></td></tr></table></figure><p>在 UNIX 以及 MOS 中，父进程调用 pipe 函数后，会打开两个新的文件描述符（<strong>设置 PTE_LIBRARY 权限位</strong>），它们被映射到同一内存空间（其中 fd[0] 表示读端、 fd[1] 表示写端）。在 fork 函数的配合下，子进程复制父进程的两个文件描述符，从而在父子进程间形成了四个（父子各拥有一读一写）指向同一片内存区域的文件描述符，父子进程可根据需 要关掉自己不用的一个，从而实现父子进程间的单向通信管道。</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240611223809577.png" alt=""></p><h4 id="管道的使用">管道的使用</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// user/lib/pipe.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIPE_SIZE 32 <span class="comment">// small to provoke races</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pipe</span> &#123;</span></span><br><span class="line">u_int p_rpos; <span class="comment">// read position</span></span><br><span class="line">u_int p_wpos; <span class="comment">// write position</span></span><br><span class="line">u_char p_buf[PIPE_SIZE]; <span class="comment">// data buffer</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>一个管道有 PIPE_SIZE(32 Byte) 大小的<strong>环形</strong>缓冲区，读写的位置 i 实际上是 i%PIPE_SIZE 。</p><ul><li>写者可写条件：<code>p_wpos - p_rpos &lt; PIPE_SIZE</code>（这里有个坑点，要注意这些变量均为<strong>无符号数</strong>，相减会“溢出”）</li><li>读者可读条件：<code> p_rpos &lt; p_wpos</code></li></ul><p>判断管道是否关闭的等式：<code>pageref(rfd) + pageref(wfd) = pageref(pipe)</code></p><blockquote><p>每个匿名管道分配了三页空间：一页是读数据的文件描述符 rfd，一页是写数据的文件描述符 wfd，剩下一页是被两个文件描述符共享的管道数据缓冲区 pipe</p><p>故在有 1 个读者、1 个写者的前提下，管道将被引用两次</p></blockquote><p>这里进程竞争问题对判断的影响和对应处理可见上文 Thinking 。</p><h3 id="shell">Shell</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240611225349797.png" alt=""></p><h4 id="加载可执行文件">加载可执行文件</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">spawn</span><span class="params">(<span class="type">char</span> *prog, <span class="type">char</span> **argv)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">spawnl</span><span class="params">(<span class="type">char</span> *prog, <span class="type">char</span> *args, ...)</span> &#123;</span><br><span class="line"><span class="comment">// Thanks to MIPS calling convention, the layout of arguments on the stack</span></span><br><span class="line"><span class="comment">// are straightforward.</span></span><br><span class="line"><span class="keyword">return</span> spawn(prog, &amp;args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>从文件系统读取指定的文件（二进制 ELF 文件，在 MOS 中为 *.b ）</li><li>调用<code>syscall_exofork</code>申请新的进程控制块</li><li>调用<code>init_stack</code>为子进程初始化地址空间。对于栈空间，由于 spawn 需要将命令行参数传递给用户程序，所以要将参数也写入用户栈中</li><li>将目标程序对应的 ELF 加载到子进程的地址空间中</li><li>调用<code>syscall_set_trapframe</code>设置子进程的寄存器</li><li>调用<code>syscall_mem_map</code>将父进程的共享页面映射到子进程的地址空间中</li><li>调用<code>syscall_set_env_status</code>设置子进程为可执行状态</li></ul><h4 id="shell命令的执行">Shell命令的执行</h4><ul><li>使用 readline 函数循环读入 buf 并进行特殊字符的处理</li><li>fork 子进程执行 runcmd</li><li>使用 gettoken 和 parsecmd 来解析指令，并使用 spawn 加载运行对应的程序</li></ul><h2 id="实验体会">实验体会</h2><p>本次实验要求我们使用管道实现一个简单的 Shell ，总体来说没什么难点；不过对于 Shell 的具体实现指导书没有过多的讲解，如果想丰富 Shell 的功能，还需要多读源码、对整个 MOS 的运行过程有一个非常清晰的认识。</p>]]></content>
      
      
      <categories>
          
          <category> BUAA操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OS-2024-Lab5</title>
      <link href="/359abd69.html"/>
      <url>/359abd69.html</url>
      
        <content type="html"><![CDATA[<h1 id="lab5实验报告">lab5实验报告</h1><h2 id="思考题">思考题</h2><h3 id="thinking-5-1">Thinking 5.1</h3><blockquote><p>如果通过 kseg0 读写设备，那么对于设备的写入会缓存到 Cache 中。这是一种<strong>错误</strong>的行为，在实际编写代码的时候这么做会引发不可预知的问题。请思考：这么做这会引发什么问题？对于不同种类的设备（如我们提到的串口设备和 IDE 磁盘）的操作会有差异吗？可以从缓存的性质和缓存更新的策略来考虑。</p></blockquote><p>当程序需要读取设备的数据时，若数据已经被写入了Cache，则会从Cache中直接读取，而此时若外部设备的数据发生变化，则会产生错误的行为。</p><h3 id="thinking-5-2">Thinking 5.2</h3><blockquote><p>查找代码中的相关定义，试回答一个磁盘块中最多能存储多少个文件控制块？一个目录下最多能有多少个文件？我们的文件系统支持的单个文件最大为多大？</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Bytes per file system block - same as page size</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLOCK_SIZE PAGE_SIZE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_STRUCT_SIZE 256</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> &#123;</span></span><br><span class="line"><span class="type">char</span> f_name[MAXNAMELEN]; <span class="comment">// filename</span></span><br><span class="line"><span class="type">uint32_t</span> f_size; <span class="comment">// file size in bytes</span></span><br><span class="line"><span class="type">uint32_t</span> f_type; <span class="comment">// file type</span></span><br><span class="line"><span class="type">uint32_t</span> f_direct[NDIRECT];</span><br><span class="line"><span class="type">uint32_t</span> f_indirect;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">f_dir</span>;</span> <span class="comment">// the pointer to the dir where this file is in, valid only in memory.</span></span><br><span class="line"><span class="type">char</span> f_pad[FILE_STRUCT_SIZE - MAXNAMELEN - (<span class="number">3</span> + NDIRECT) * <span class="number">4</span> - <span class="keyword">sizeof</span>(<span class="type">void</span> *)];</span><br><span class="line">&#125; __attribute__((aligned(<span class="number">4</span>), packed));</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE2BLK (BLOCK_SIZE / sizeof(struct File))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// File types</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FTYPE_REG 0 <span class="comment">// Regular file</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FTYPE_DIR 1 <span class="comment">// Directory</span></span></span><br></pre></td></tr></table></figure><p>由代码可知，一个磁盘块最多能存储<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>4096</mn><mi>B</mi></mrow><mrow><mn>256</mn><mi>B</mi></mrow></mfrac><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">\frac{4096B}{256B}=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">0</span><span class="mord mtight">9</span><span class="mord mtight">6</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span>个文件控制块。</p><p>若<code>f_type == FTYPE_DIR</code>，其中的指针最多可以记录<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1024</mn></mrow><annotation encoding="application/x-tex">1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span></span></span></span>个磁盘块，故一个目录下最多有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1024</mn><mo>×</mo><mn>16</mn><mo>=</mo><mn>16384</mn></mrow><annotation encoding="application/x-tex">1024 \times 16 = 16384</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">3</span><span class="mord">8</span><span class="mord">4</span></span></span></span>个文件。</p><p>若<code>f_type == FTYPE_REG</code>，则同理可知单个文件最大为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1024</mn><mo>×</mo><mn>4</mn><mi>K</mi><mi>B</mi><mo>=</mo><mn>4</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">1024 \times 4KB = 4MB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>。</p><h3 id="thinking-5-3">Thinking 5.3</h3><blockquote><p>请思考，在满足磁盘块缓存的设计的前提下，我们实验使用的内核支持的最大磁盘大小是多少？</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Disk block n, when in memory, is mapped into the file system</span></span><br><span class="line"><span class="comment"> * server&#x27;s address space at DISKMAP+(n*BLOCK_SIZE). */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DISKMAP 0x10000000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Maximum disk size we can handle (1GB) */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DISKMAX 0x40000000</span></span><br></pre></td></tr></table></figure><p>显然，支持的最大磁盘大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi mathvariant="normal">x</mi><mn>4000</mn><mi mathvariant="normal">_</mi><mn>0000</mn><mi>B</mi><mo>=</mo><mn>1</mn><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">0{\rm x}4000\_0000B=1GB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.99333em;vertical-align:-0.31em;"></span><span class="mord">0</span><span class="mord"><span class="mord"><span class="mord mathrm">x</span></span></span><span class="mord">4</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></p><h3 id="thinking-5-4">Thinking 5.4</h3><blockquote><p>在本实验中，fs/serv.h、user/include/fs.h 等文件中出现了许多宏定义，试列举你认为较为重要的宏定义，同时进行解释，并描述其主要应用之处。</p></blockquote><p>代码中的注释写得很详细，这些宏大部分指代不同数据结构的大小，如</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> FILE2BLK (BLOCK_SIZE / sizeof(struct File))</span></span><br><span class="line"><span class="comment">//指一个磁盘块最大文件块数，可用来遍历目录项</span></span><br><span class="line"></span><br><span class="line">u_int nblock;</span><br><span class="line">nblock = ROUND(dir-&gt;f_size, BLOCK_SIZE) / BLOCK_SIZE;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nblock; i++) &#123;</span><br><span class="line">    <span class="type">void</span> *blk;</span><br><span class="line">    try(file_get_block(dir, i, &amp;blk));</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">files</span> =</span> (<span class="keyword">struct</span> File *)blk;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">struct</span> File *f = files; f &lt; files + FILE2BLK; ++f) &#123;</span><br><span class="line">        <span class="comment">//do something...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="thinking-5-5">Thinking 5.5</h3><blockquote><p>在 Lab4“系统调用与 fork”的实验中我们实现了极为重要的 fork 函数。那么 fork 前后的父子进程是否会共享文件描述符和定位指针呢？请在完成上述练习的基础上编写一个程序进行验证。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//serv_check.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;lib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> *msg = <span class="string">&quot;This is the NEW message of the day!\n&quot;</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">char</span> *diff_msg = <span class="string">&quot;This is a different message of the day!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> r;</span><br><span class="line"><span class="type">int</span> fdnum;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">512</span>];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((r = open(<span class="string">&quot;/newmotd&quot;</span>, O_RDWR)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">user_panic(<span class="string">&quot;cannot open /newmotd: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br><span class="line">fdnum = r;</span><br><span class="line">debugf(<span class="string">&quot;open is good\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (r = fork()) &#123;</span><br><span class="line">n = read(fdnum, buf, <span class="number">10</span>);</span><br><span class="line">debugf(<span class="string">&quot;father: \&#x27;%s\&#x27;\n&quot;</span>, buf);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">n = read(fdnum, buf, <span class="number">10</span>);</span><br><span class="line">debugf(<span class="string">&quot;child: \&#x27;%s\&#x27;\n&quot;</span>, buf);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240530213141501.png" alt=""></p><h3 id="thinking-5-6">Thinking 5.6</h3><blockquote><p>请解释 File, Fd, Filefd 结构体及其各个域的作用。比如各个结构体会在哪些过程中被使用，是否对应磁盘上的物理实体还是单纯的内存数据等。说明形式自定，要求简洁明了，可大致勾勒出文件系统数据结构与物理实体的对应关系与设计框架。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXNAMELEN 128</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NDIRECT 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_STRUCT_SIZE 256</span></span><br><span class="line"><span class="comment">// file control block</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> &#123;</span></span><br><span class="line"><span class="type">char</span> f_name[MAXNAMELEN]; <span class="comment">// filename</span></span><br><span class="line"><span class="type">uint32_t</span> f_size; <span class="comment">// file size in bytes</span></span><br><span class="line"><span class="type">uint32_t</span> f_type; <span class="comment">// file type</span></span><br><span class="line"><span class="type">uint32_t</span> f_direct[NDIRECT];</span><br><span class="line"><span class="type">uint32_t</span> f_indirect;</span><br><span class="line">    <span class="comment">// 指向存放文件数据的对应磁盘块，不使用指向间接磁盘块（(uint32_t *) f_indirect）的前十个指针</span></span><br><span class="line">    <span class="comment">/* 使用示范</span></span><br><span class="line"><span class="comment">    int bno; // the block number</span></span><br><span class="line"><span class="comment">    if (i &lt; NDIRECT) &#123;</span></span><br><span class="line"><span class="comment">    bno = dirf-&gt;f_direct[i];</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">    bno = ((uint32_t *) disk[dirf-&gt;f_indirect].data)[i];</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">f_dir</span>;</span> <span class="comment">// the pointer to the dir where this file is in, valid only in memory.</span></span><br><span class="line"><span class="type">char</span> f_pad[FILE_STRUCT_SIZE - MAXNAMELEN - (<span class="number">3</span> + NDIRECT) * <span class="number">4</span> - <span class="keyword">sizeof</span>(<span class="type">void</span> *)]; <span class="comment">// 占位</span></span><br><span class="line">&#125; __attribute__((aligned(<span class="number">4</span>), packed));</span><br><span class="line"></span><br><span class="line"><span class="comment">// file descriptor</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fd</span> &#123;</span></span><br><span class="line">u_int fd_dev_id; <span class="comment">// 该文件对应的设备</span></span><br><span class="line">u_int fd_offset; <span class="comment">// 读写的偏移量</span></span><br><span class="line">u_int fd_omode; <span class="comment">// 读写方式，包括只读、只写、读写等</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入文件操作符，是为了给用户程序提供操作文件的同一接口，使用户进程能知晓文件的信息和状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// file descriptor + file</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Filefd</span> &#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fd</span> <span class="title">f_fd</span>;</span> <span class="comment">// 文件描述符</span></span><br><span class="line">u_int f_fileid; <span class="comment">// 文件id</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> <span class="title">f_file</span>;</span> <span class="comment">// 对应的文件控制块</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="thinking-5-7">Thinking 5.7</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240528225331405.png" alt=""></p><blockquote><p>图 5.9 中有多种不同形式的箭头，请解释这些不同箭头的差别，并思考我们的操作系统是如何实现对应类型的进程间通信的。</p></blockquote><p>图中实线箭头表示调用另一个程序中的对应函数，虚线箭头表示使用IPC获取调用结果。</p><ul><li>文件系统服务进程在完成初始化（<code>serv_init,fs_init</code>）后，调用<code>serve</code>函数（一个死循环），然后反复调用<code>ipc_recv</code>等待用户进程发出操作请求，并根据请求的不同类型执行相应的文件操作，完成服务后使用<code>ipc_send</code>返回结果。</li><li>用户进程针对不同的请求类型，通过<code>ipc_send</code>发送必要的参数（将请求的内容放在结构体中），然后等待被文件系统反馈的结果（<code>ipc_send</code>）唤醒。</li></ul><h2 id="难点分析">难点分析</h2><h3 id="外设控制">外设控制</h3><p>CPU 通过读写设备控制器上的寄存器实现对设备的控制和通信。而在MIPS体系结构下，我们使用 MMIO机制访问设备寄存器。</p><p><strong>MMIO</strong>（内存映射IO）：使用不同的物理内存地址 为设备寄存器编址，将一部分对物理内存的访问 “重定向” 到设备地址空间中。</p><table><thead><tr><th>偏移</th><th style="text-align:left">寄存器功能</th><th>数据位宽</th></tr></thead><tbody><tr><td>0x0</td><td style="text-align:left">读/写：向磁盘中读/写数据，从 0 字节开始逐个读出/写入</td><td>4B</td></tr><tr><td>0x1</td><td style="text-align:left">读：设备错误信息；写：设置 IDE 命令的特定参数</td><td>1B</td></tr><tr><td>0x2</td><td style="text-align:left">写：设置一次需要操作的扇区数量</td><td>1B</td></tr><tr><td>0x3</td><td style="text-align:left">写：设置目标扇区号的 [7:0] 位（LBAL）</td><td>1B</td></tr><tr><td>0x4</td><td style="text-align:left">写：设置目标扇区号的 [15:8] 位（LBAM）</td><td>1B</td></tr><tr><td>0x5</td><td style="text-align:left">写：设置目标扇区号的 [23:16] 位（LBAH）</td><td>1B</td></tr><tr><td>0x6</td><td style="text-align:left">写：设置目标扇区号的 [27:24] 位，配置扇区寻址模式 （CHS/LBA），设置要操作的磁盘编号</td><td>1B</td></tr><tr><td>0x7</td><td style="text-align:left">读：获取设备状态；写：配置设备工作状态</td><td>1 字节</td></tr></tbody></table><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240530222324917.png" alt=""></p><p>使用系统调用<code>sys_write_dev</code>和<code>sys_read_dev</code>读写<code>kseg1</code>段内核数据，来实现设备读写操作。</p><h3 id="文件系统结构">文件系统结构</h3><h4 id="磁盘结构">磁盘结构</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Block</span> &#123;</span></span><br><span class="line"><span class="type">uint8_t</span> data[BLOCK_SIZE];</span><br><span class="line"><span class="type">uint32_t</span> type;</span><br><span class="line">&#125; disk[NBLOCK];</span><br><span class="line"><span class="comment">// 操作系统与磁盘交互的最小逻辑单元</span></span><br><span class="line"><span class="comment">// Block0作为引导扇区和分区表使用</span></span><br><span class="line"><span class="comment">// Block1作为超级块（Super Block），文件系统的基本信息</span></span><br><span class="line"><span class="comment">// Block2作为位图块，用来管理空闲的磁盘资源</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Super</span> &#123;</span></span><br><span class="line"><span class="type">uint32_t</span> s_magic;   <span class="comment">// Magic number: FS_MAGIC</span></span><br><span class="line"><span class="type">uint32_t</span> s_nblocks; <span class="comment">// Total number of blocks on disk （1024）</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> <span class="title">s_root</span>;</span> <span class="comment">// Root directory node（f_type: FTYPE_DIR, f_name: &quot;/&quot;）</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*---------------------------------------*/</span></span><br><span class="line"><span class="comment">// Initial the disk. Do some work with bitmap and super block.</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_disk</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> i, diff;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 1: Mark boot sector block.</span></span><br><span class="line">disk[<span class="number">0</span>].type = BLOCK_BOOT;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 2: Initialize boundary.</span></span><br><span class="line">nbitblock = (NBLOCK + BLOCK_SIZE_BIT - <span class="number">1</span>) / BLOCK_SIZE_BIT;</span><br><span class="line">    <span class="comment">// 为了使用Bitmap标识整个磁盘上所有块的使用情况所需要的磁盘块的数量</span></span><br><span class="line">nextbno = <span class="number">2</span> + nbitblock;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 2: Initialize bitmap blocks.</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nbitblock; ++i) &#123;</span><br><span class="line">disk[<span class="number">2</span> + i].type = BLOCK_BMAP;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nbitblock; ++i) &#123;</span><br><span class="line"><span class="built_in">memset</span>(disk[<span class="number">2</span> + i].data, <span class="number">0xff</span>, BLOCK_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (NBLOCK != nbitblock * BLOCK_SIZE_BIT) &#123;</span><br><span class="line">        <span class="comment">// 不存在的部分置为0</span></span><br><span class="line">diff = NBLOCK % BLOCK_SIZE_BIT / <span class="number">8</span>;</span><br><span class="line"><span class="built_in">memset</span>(disk[<span class="number">2</span> + (nbitblock - <span class="number">1</span>)].data + diff, <span class="number">0x00</span>, BLOCK_SIZE - diff);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Step 3: Initialize super block.</span></span><br><span class="line">disk[<span class="number">1</span>].type = BLOCK_SUPER;</span><br><span class="line">super.s_magic = FS_MAGIC;</span><br><span class="line">super.s_nblocks = NBLOCK;</span><br><span class="line">super.s_root.f_type = FTYPE_DIR;</span><br><span class="line"><span class="built_in">strcpy</span>(super.s_root.f_name, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="文件系统">文件系统</h4><p>见<code>Thinking 5.6</code></p><h4 id="用户接口">用户接口</h4><p>引入文件描述符（file descriptor）作为用户程序管理、操作文件的基础，隔离底层的文件系统实现，抽象地表示对一个文件进行的操作。</p><p>关于<code>Fd</code>和<code>Filefd</code>可看<code>Thinking 5.6</code></p><p>我们将一个进程所有的文件描述符存储在<code>[FDTABLE, FILEBASE)</code>这一地址空间中（使用<code>fd_alloc</code>分配），在<code>FILEBASE</code>之上存储对应的<code>Filefd</code>。</p><ul><li><p>Filefd 结构体的第一个成员就是 Fd，因此指向 Filefd 的指针同样指向这个 Fd 的起始位置，故可以进行强制转换。</p></li><li><p>可使用<code>fa2data</code>获取文件描述符对应的文件的数据，使用<code>fd2num</code>返回描述符编号</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *<span class="title function_">fd2data</span><span class="params">(<span class="keyword">struct</span> Fd *fd)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="type">void</span> *)INDEX2DATA(fd2num(fd));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">fd2num</span><span class="params">(<span class="keyword">struct</span> Fd *fd)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> ((u_int)fd - FDTABLE) / PTMAP;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="文件操作如何进行">文件操作如何进行</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240530231846036.png" alt=""></p><p>随后在函数<code>fsipc</code>中使用IPC向文件服务系统发送请求，在<code>serve_*</code>中调用相应的<code>fs_*</code>对文件和磁盘数据进行操作</p><h2 id="实验体会">实验体会</h2><p>lab5总体看虽然代码量大很吓人，但实际上通过阅读指导书了解了MOS文件系统的精巧设计思路，仿照lab4的思路去理解各个函数之间的调用关系，还是可以比较轻松地完成任务的。只不过确实这次课下没有付出相应的充足时间，导致课上很不熟练、bug频出，最后也没时间做extra了。</p><p>然后关于课上debug，一点惨痛教训：指针的类型强制转换，是改变了该指针对一段内存的解释方式，一定要搞清楚要用这个指针去读取什么类型的数据！</p>]]></content>
      
      
      <categories>
          
          <category> BUAA操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OS-2024-Lab4</title>
      <link href="/429d8dff.html"/>
      <url>/429d8dff.html</url>
      
        <content type="html"><![CDATA[<h1 id="lab4实验报告">lab4实验报告</h1><h2 id="思考题">思考题</h2><h3 id="thinking-4-1">Thinking 4.1</h3><blockquote><p>思考并回答下面的问题：</p><ul><li>内核在保存现场的时候是如何避免破坏通用寄存器的？</li><li>系统陷入内核调用后可以直接从当时的 $a0-$a3 参数寄存器中得到用户调用 msyscall 留下的信息吗？</li><li>我们是怎么做到让 sys 开头的函数“认为”我们提供了和用户调用 msyscall 时同样的参数的？</li><li>内核处理系统调用的过程对 Trapframe 做了哪些更改？这种修改对应的用户态的变化是什么？</li></ul></blockquote><ol><li><p>通过<code>include/stackframe.h</code>中的<code>SAVE_ALL</code>宏，用<code>$k0,$k1</code>寄存器将其他通用寄存器保存到内核栈上。</p></li><li><p>可以，不过在陷入内核态时已经将<code>$a0-$a3</code>寄存器中的值保存到了内核栈中，一般来说直接从内核栈中获取这些参数的值。</p></li><li><p>根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mi mathvariant="script">I</mi><mi mathvariant="script">P</mi><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{MIPS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">M</span><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span>调用规范，调用<code>msyscall</code>时，<code>syscall_*</code>已经将调用参数存入了<code>$a0-$a3</code>寄存器和用户栈中；进一步，陷入内核调用后，将用户进程上下文环境保存进内核栈中。因此，函数<code>sys_*</code>可以使用到所需要的参数。</p></li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">do_syscall</span><span class="params">(<span class="keyword">struct</span> Trapframe *tf)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    tf-&gt;cp0_epc = tf-&gt;cp0_epc + <span class="number">4</span>;</span><br><span class="line">    <span class="comment">//完成系统调用后直接返回下一条指令（规定了syscall不会在延迟槽中被使用）</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    tf-&gt;regs[<span class="number">2</span>] = (*func) (arg1, arg2, arg3, arg4, arg5);</span><br><span class="line">    <span class="comment">//将系统调用返回值传回用户态</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="thinking-4-2">Thinking 4.2</h3><blockquote><p>思考 envid2env 函数: 为什么 envid2env 中需要判断 e-&gt;env_id != envid 的情况？如果没有这步判断会发生什么情况？</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LOG2NENV 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NENV (1 &lt;&lt; LOG2NENV)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ENVX(envid) ((envid) &amp; (NENV - 1))</span></span><br></pre></td></tr></table></figure><p>当<code>envid!=0</code>时，通过宏<code>ENVX</code>获取当前进程<code>e</code>，可以看到，该宏取envid的<strong>低10位</strong>。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">u_int <span class="title function_">mkenvid</span><span class="params">(<span class="keyword">struct</span> Env *e)</span> &#123;</span><br><span class="line">    <span class="type">static</span> u_int i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> ((++i) &lt;&lt; (<span class="number">1</span> + LOG2NENV)) | (e - envs);</span><br><span class="line">    <span class="comment">//高位不全为0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果传入的是无效（没被分配）的envid，则不判断<code>e-&gt;env_id!=envid</code>就会产生错误。</p><h3 id="thinking-4-3">Thinking 4.3</h3><blockquote><p>思考下面的问题，并对这个问题谈谈你的理解：请回顾 kern/env.c 文件中 mkenvid() 函数的实现，该函数不会返回 0，请结合系统调用和 IPC 部分的实现与 envid2env() 函数的行为进行解释。</p></blockquote><p>由上可知，envid不会为0。故将0作为保留值，可以很方便地获取当前<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mi mathvariant="script">C</mi><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">\mathcal{PCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span></span>的指针。</p><h3 id="thinking-4-4">Thinking 4.4</h3><blockquote><p>关于 fork 函数的两个返回值，下面说法正确的是：</p><p>A、fork 在父进程中被调用两次，产生两个返回值</p><p>B、fork 在两个进程中分别被调用一次，产生两个不同的返回值</p><p>C、fork 只在父进程中被调用了一次，在两个进程中各产生一个返回值</p><p>D、fork 只在子进程中被调用了一次，在两个进程中各产生一个返回值</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fork</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">child = syscall_exofork();</span><br><span class="line"><span class="keyword">if</span> (child == <span class="number">0</span>) &#123;</span><br><span class="line">env = envs + ENVX(syscall_getenvid());</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">return</span> child;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">C</mi></mrow><annotation encoding="application/x-tex">\mathcal{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span></span></span></span></span>，<code>fork</code>只在当前进程（父进程）中被调用了一次，通过进一步调用<code>sys_exofork</code>创建了新的进程，复制了此时的现场并将子进程上下文环境中的<code>e-&gt;env_tf.regs[2]($v0)</code>设为<strong>0</strong>，而父进程则在最后返回子进程id。</p><h3 id="thinking-4-5">Thinking 4.5</h3><blockquote><p>我们并不应该对所有的用户空间页都使用 duppage 进行映射。那么究竟哪些用户空间页应该映射，哪些不应该呢？请结合 kern/env.c 中 env_init 函数进行的页面映射、include/mmu.h 里的内存布局图以及本章的后续描述进行思考。</p></blockquote><p>首先<code>ULIM</code>和<code>UTOP</code>之间的内容为内核的页表数据，也是所有进程共享的只读空间，同时在<code>env_alloc</code>已从<code>base_pgdir</code>中拷贝至进程页表，故不需要映射。</p><p>然后<code>UTOP</code>和<code>USTACKTOP</code>之间的内容是用来处理用户异常的，也不需要进行映射。</p><p>故最终需要映射的内容为<code>USTACKTOP</code>之下所有的有效页（<code>PTE_V</code>）。</p><h3 id="thinking-4-6">Thinking 4.6</h3><blockquote><p>在遍历地址空间存取页表项时你需要使用到 vpd 和 vpt 这两个指针，请参考 user/include/lib.h 中的相关定义，思考并回答这几个问题：</p><ul><li>vpt 和 vpd 的作用是什么？怎样使用它们？</li><li>从实现的角度谈一下为什么进程能够通过这种方式来存取自身的页表？</li><li>它们是如何体现自映射设计的？</li><li>进程能够通过这种方式来修改自己的页表项吗？</li></ul></blockquote><ol><li><code>vpt</code>和<code>vpd</code>分别是指向用户页表和页目录的指针，以<code>vpt</code>为基地址，加上页表偏移量即可得到指向<code>va</code>对应的页表项的指针，即<code>vpt[va &gt;&gt; 12]</code>；以<code>vpd</code>为基地址，加上页目录偏移量即可得到指向<code>va</code>对应的页目录项的指针。</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> vpt ((const volatile Pte *)UVPT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> vpd ((const volatile Pde *)(UVPT + (PDX(UVPT) &lt;&lt; PGSHIFT)))</span></span><br><span class="line"><span class="comment">//这两个值分别为用户地址空间中页表的首地址和页目录的首地址</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">env_setup_vm</span><span class="params">(<span class="keyword">struct</span> Env *e)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    e-&gt;env_pgdir[PDX(UVPT)] = PADDR(e-&gt;env_pgdir) | PTE_V;</span><br><span class="line">    <span class="comment">//将进程页目录表中 UVPT 对应的页目录项设为了进程页目录表对应的地址</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>不能，页表由内核维护，用户只能进行访问。</li></ol><h3 id="thinking-4-7">Thinking 4.7</h3><blockquote><p>在 do_tlb_mod 函数中，你可能注意到了一个向异常处理栈复制 Trapframe 运行现场的过程，请思考并回答这几个问题：</p><ul><li>这里实现了一个支持类似于“异常重入”的机制，而在什么时候会出现这种“异常重 入”？</li><li>内核为什么需要将异常的现场 Trapframe 复制到用户空间？</li></ul></blockquote><ol><li>异常重入是指在处理异常的过程中，又触发了新的异常。如在处理写时复制的页写入异常时，又发生了缺页等异常。</li><li>因为页写入异常的处理是在用户态进行的，所以需要保存现场到用户空间用以恢复现场。</li></ol><h3 id="thinking-4-8">Thinking 4.8</h3><blockquote><p>在用户态处理页写入异常，相比于在内核态处理有什么优势？</p></blockquote><p>提高系统的稳定性，即使处理异常时进程崩溃，也不会影响到整个系统。</p><h3 id="thinking-4-9">Thinking 4.9</h3><blockquote><p>请思考并回答以下几个问题：</p><ul><li>为什么需要将 syscall_set_tlb_mod_entry 的调用放置在 syscall_exofork 之前？</li><li>如果放置在写时复制保护机制完成之后会有怎样的效果？</li></ul></blockquote><ol><li>只需要在写时复制保护机制完成之前调用<code>syscall_set_tlb_mod_entry</code>即可。</li><li>无法正常处理页写入相关异常。</li></ol><h2 id="难点分析">难点分析</h2><h3 id="系统调用完整过程">系统调用完整过程</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240522161536474.png" alt="syscall"></p><ol><li><p>用户程序调用<code>syscall_*</code>函数（定义在<code>user/lib/syscall_lib.h</code>中）。</p></li><li><p><code>syscall_*</code>函数将系统调用号和系统调用参数存入寄存器（<code>$a0-$a3</code>）和用户栈中（这一过程由编译器自动编译），然后调用<code>msyscall。</code></p></li><li><p>在<code>msyscall</code>函数中执行<code>syscall</code>指令使CPU陷入内核态。</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LEAF(msyscall)</span><br><span class="line">syscall</span><br><span class="line">jrra</span><br><span class="line">//记得返回syscall_*</span><br><span class="line">END(msyscall)</span><br></pre></td></tr></table></figure></li><li><p>陷入内核态后，跳转到<code>.exc_gen_entry</code>处执行指令。</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.section .text.exc_gen_entry</span><br><span class="line">exc_gen_entry:</span><br><span class="line">SAVE_ALL</span><br><span class="line">//将用户进程上下文环境保存在内核栈中</span><br><span class="line">mfc0    t0, CP0_STATUS</span><br><span class="line">and     t0, t0, ~(STATUS_UM | STATUS_EXL | STATUS_IE)</span><br><span class="line">mtc0   t0, CP0_STATUS</span><br><span class="line">mfc0t0, CP0_CAUSE</span><br><span class="line">andit0, 0x7c</span><br><span class="line">lwt0, exception_handlers(t0)</span><br><span class="line">//跳转到对应的异常处理函数</span><br><span class="line">jrt0</span><br></pre></td></tr></table></figure></li><li><p><code>kern/traps.c</code>中定义了异常处理函数，系统调用对应的异常码为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span>。</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> (*exception_handlers[<span class="number">32</span>])(<span class="type">void</span>) = &#123;</span><br><span class="line">    [<span class="number">0</span> ... <span class="number">31</span>] = handle_reserved,</span><br><span class="line">    [<span class="number">0</span>] = handle_int,</span><br><span class="line">    [<span class="number">2</span> ... <span class="number">3</span>] = handle_tlb,</span><br><span class="line">    [<span class="number">1</span>] = handle_mod,</span><br><span class="line">    [<span class="number">8</span>] = handle_sys,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>kern/genex.S</code>中使用<code>BUILD_HANDLER</code>宏对<code>handle_*</code>函数进行了封装。</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.macro BUILD_HANDLER exception handler</span><br><span class="line">NESTED(handle_\exception, TF_SIZE + 8, zero)</span><br><span class="line">move    a0, sp</span><br><span class="line">addiu   sp, sp, -8</span><br><span class="line">jal     \handler</span><br><span class="line">addiu   sp, sp, 8</span><br><span class="line">j       ret_from_exception</span><br><span class="line">END(handle_\exception)</span><br><span class="line">.endm</span><br><span class="line">BUILD_HANDLER mod do_tlb_mod</span><br><span class="line">BUILD_HANDLER sys do_syscall</span><br></pre></td></tr></table></figure></li><li><p><code>do_syscall</code>根据系统调用号调用对应的函数，并将返回值存入内核栈中保存的用户进程（<code>tf.reg[2]</code>）、修改epc使得能够返回到<code>msyscall</code>函数中的<code>jr ra</code>指令。</p></li><li><p>调用<code>ret_from_exception</code>，执行<code>RESTORE_ALL</code>宏还原现场并返回用户程序，系统调用结束。</p></li></ol><h3 id="ipc">ipc</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240522164558501.png" alt="ipc"></p><h3 id="fork的实现">fork的实现</h3><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240522165234868.png" alt="fork"></p><h4 id="写时复制机制">写时复制机制</h4><p>使用<code>fork</code>创建子进程时，让父子进程暂时共享内存，当页面需要写入数据时才将内存分离，以避免同时消耗大量物理内存。</p><p>具体实现为，将虚拟页权限位设置为<code>PTE_D = 0 &amp;&amp; PTE_COW = 1</code>，当需要写入时触发<code>TLB_Mod</code>异常。</p><h4 id="页写入异常处理机制">页写入异常处理机制</h4><p>当用户程序写入一个在TLB中<code>PTE_D</code>位为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>的页面时，系统会陷入<code>TLB Mod</code>异常，之后会跳转到<code>kern/tlbex.c</code>中的<code>do_tlb_mod</code>函数。</p><p>该函数会将进程上下文保存在<strong>用户态的异常处理栈</strong>中，并设置<code>$a0</code>和<code>$epc</code>的值，使得异常恢复后能跳转到<code>env_user_tlb_mod_entry</code>所设置的用户异常处理函数的地址。也就是说，<code>TLB Mod</code>异常的主要处理过程是在用户态中。</p><hr><p>对于写时复制机制，我们将父子进程的<code>TLB Mod</code>异常处理函数设为<code>cow_entry</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> __attribute__((<span class="keyword">noreturn</span>)) cow_entry(<span class="keyword">struct</span> Trapframe *tf) &#123;</span><br><span class="line">    <span class="comment">//获取发生写入异常的地址</span></span><br><span class="line">u_int va = tf-&gt;cp0_badvaddr;</span><br><span class="line">u_int perm;</span><br><span class="line">perm = vpt[VPN(va)] &amp; <span class="number">0xfff</span>;</span><br><span class="line">    <span class="comment">//检查标志位</span></span><br><span class="line"><span class="keyword">if</span> (!(perm &amp; PTE_COW)) &#123;</span><br><span class="line">user_panic(<span class="string">&quot;doesn&#x27;t have PTE_COW&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//分配一个新的物理页面到临时地址UCOW，修改权限</span></span><br><span class="line">perm = (perm &amp; (~PTE_COW)) | PTE_D;</span><br><span class="line">syscall_mem_alloc(<span class="number">0</span>, (<span class="type">void</span> *) UCOW, perm);</span><br><span class="line">    <span class="comment">//复制页面内容至新页面</span></span><br><span class="line"><span class="built_in">memcpy</span>((<span class="type">void</span> *) UCOW, (<span class="type">void</span> *) ROUNDDOWN(va, PAGE_SIZE), PAGE_SIZE);</span><br><span class="line"><span class="comment">//映射写入异常的地址到新页面上</span></span><br><span class="line">syscall_mem_map(<span class="number">0</span>, (<span class="type">void</span> *) UCOW, <span class="number">0</span>, (<span class="type">void</span> *) va, perm);</span><br><span class="line">    <span class="comment">//解除临时地址UCOW的内存映射</span></span><br><span class="line">syscall_mem_unmap(<span class="number">0</span>, (<span class="type">void</span> *) UCOW);</span><br><span class="line">    <span class="comment">//设置返回地址</span></span><br><span class="line"><span class="type">int</span> r = syscall_set_trapframe(<span class="number">0</span>, tf);</span><br><span class="line">user_panic(<span class="string">&quot;syscall_set_trapframe returned %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>值得一提的是，如何在用户异常处理函数中返回呢？通过上面的内容可以看到，采用的方法是陷入一个新的异常，替换内核栈的内容，从而在返回时根据替换的<code>Trapframe</code>恢复现场。这就是系统调用<code>sys_set_trapframe</code>的基本原理。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sys_set_trapframe</span><span class="params">(u_int envid, <span class="keyword">struct</span> Trapframe *tf)</span> &#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">if</span> (env == curenv) &#123;</span><br><span class="line">*((<span class="keyword">struct</span> Trapframe *)KSTACKTOP - <span class="number">1</span>) = *tf;</span><br><span class="line"><span class="comment">//注意返回值</span></span><br><span class="line"><span class="keyword">return</span> tf-&gt;regs[<span class="number">2</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="页面映射">页面映射</h4><p>由于写时复制机制，我们只需调用<code>syscall_mem_map</code>将父进程的页面映射到子进程中。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fork()</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; VPN(USTACKTOP); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((vpd[i &gt;&gt; <span class="number">10</span>] &amp; PTE_V) &amp;&amp; (vpt[i] &amp; PTE_V)) &#123;</span><br><span class="line">        <span class="comment">//vpd和vpt的使用见思考题4.6</span></span><br><span class="line">        duppage(child, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>权限设置规则如下：</p><ul><li>原本便不可写、共享或就是写时复制的页面不需要更改其权限</li><li>对可写、非共享且不是写时复制的页面，需要取消其可写位，设置写时复制位。然后将其映射给子进程， 并更新父进程这一页的权限</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//duppage()</span></span><br><span class="line"><span class="keyword">if</span> ((perm &amp; PTE_D) &amp;&amp; !(perm &amp; PTE_LIBRARY) &amp;&amp; !(perm &amp; PTE_COW)) &#123;</span><br><span class="line">    perm = (perm &amp; (~PTE_D)) | PTE_COW;</span><br><span class="line">    syscall_mem_map(<span class="number">0</span>, (<span class="type">void</span> *) addr, envid, (<span class="type">void</span> *) addr, perm);</span><br><span class="line">    syscall_mem_map(<span class="number">0</span>, (<span class="type">void</span> *) addr, <span class="number">0</span>, (<span class="type">void</span> *) addr, perm);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    syscall_mem_map(<span class="number">0</span>, (<span class="type">void</span> *) addr, envid, (<span class="type">void</span> *) addr, perm);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实验体会">实验体会</h2><p>这一章内容还是比较多的，不过通过仔细阅读指导书和相关流程图，以及实验代码，最终还是能大致搞明白系统调用以及ipc、fork的具体过程，两次exam也都顺利通过了。不过感觉debug能力和灵活运用知识的能力还是不够，归根结底还是对MOS的整体结构和内存管理那一块的东西没有搞得很清楚，不能做到对各个函数运用自如。总之，还得继续努力。</p>]]></content>
      
      
      <categories>
          
          <category> BUAA操作系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OO-2024-Unit4</title>
      <link href="/1e5b8c04.html"/>
      <url>/1e5b8c04.html</url>
      
        <content type="html"><![CDATA[<h2 id="正向建模与开发">正向建模与开发</h2><p>正向建模与开发是指从需求分析开始，通过逐步细化需求，创建模型，并最终开发出软件的过程。这种方法强调从抽象到具体、从概念到实现的系统性过程。</p><p>而本单元正式所使用 UML（<code>Unified Modeling Language</code>）建模语言则是贯彻上述理念的一个很好的工具。在之前几个单元的设计中，我们虽然已经开始对 UML 有一些接触，但只是局限于用它来对每单元最后的迭代结果进行总结分析。既然有没有 UML 我们都<s>或好或坏</s>地完成了架构设计任务，那为什么还要花时间来接触这样一门建模语言呢？</p><p>面向对象本质上定义了一个抽象语言系统</p><ul><li>词汇：对象、属性、操作、活动、流程、状态……</li><li>语法：对象间连接、对象与数据间连接、对象与操作间连接、属性与操作间连接、属性与活动间连接、操作与状态间连接……</li></ul><p>我们作为面向对象的初学者，通过 oopre + oo 算是品尝了一番迭代开发的滋味，也许不必在意用这样的语言组成的话语会向别人传达什么信息，只要自己代码写得痛快并且能够理解就行。但也许未来我们可能会面对越来越复杂、迭代不止的软件开发任务，或者与他人进行合作开发；这个时候若还是看了眼需求埋头就写、边想边写，就有点不太现实了。</p><p>UML 作为一种建模语言，它提供了一种标准的、统一的、可视化的建模方法，使得我们可以用一种统一的语言来描述软件系统的各个方面，从而使得我们能够更好地理解、分析、设计、实现、测试、维护软件系统。正向建模与开发就是一种系统化的软件开发方法，通过需求分析、系统建模、架构设计、详细设计、编码实现、集成测试和部署维护等步骤，确保软件开发过程的规范性和可控性。这种方法有助于提高软件开发的效率和质量，降低项目风险。</p><p>不过，很多时候在一开始就通过建模语言设计好所有的架构是不现实的，因为需求总是会变化的。所以在实际开发中，我们可以采用增量式开发的方法，先设计好一个基本的架构，然后根据需求的变化逐步迭代，逐步完善。这样可以在保证软件质量的同时，也能够更好地适应需求的变化。而在这单元的实践中，我主要采用的是先用语言文字进行简单建模，然后再上手进行对应代码的具体实现。</p><h2 id="unit4架构设计">Unit4架构设计</h2><p>本单元的主要任务是模拟一个读书馆的管理系统，我们需要设计一个系统，能够管理读者、图书、借阅记录等信息。</p><h3 id="最终架构">最终架构</h3><h4 id="类图">类图</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240616225501640.png" alt="Model"></p><h4 id="状态图-书籍">状态图（书籍）</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240616230019026.png" alt="StatechartDiagram"></p><h4 id="顺序图-预约">顺序图（预约）</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240616230118188.png" alt="SequenceDiagram"></p><h3 id="迭代过程">迭代过程</h3><blockquote><p>三次简易文字建模如下</p></blockquote><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">##</span> hw13</span><br><span class="line"></span><br><span class="line">1. close后整理</span><br><span class="line">    - 借还处的书全部放回书架</span><br><span class="line">    - 预约处的过期（对预约的所有人）的书放回书架，删除预约表中记录</span><br><span class="line"></span><br><span class="line">2. open后整理</span><br><span class="line"></span><br><span class="line">    - 根据预约表和书架的情况取书到预约台，为指定用户保留五天并删除预约表中记录</span><br><span class="line"></span><br><span class="line">3. 开馆</span><br><span class="line"></span><br><span class="line">    - 借阅</span><br><span class="line">        - 先判断是否可从书架中取出</span><br><span class="line">        - 再根据用户持书情况判断此书的归属</span><br><span class="line">    - 还书</span><br><span class="line">        - 本次作业还书立即成功，书由用户<span class="built_in">$</span><span class="keyword">\to</span><span class="built_in">$</span>借还处</span><br><span class="line">    - 预约</span><br><span class="line">        - 根据持书情况判断是否允许该预约，若预约表中已有则拒绝这次预约</span><br><span class="line">        - 若预约成功，预约请求加入预约表</span><br><span class="line"></span><br><span class="line">    - 取书</span><br><span class="line">        - 预约处查询，若为其保存且是要取的书，则取书成功，删除预约表对应记录</span><br><span class="line">        - 否则失败</span><br><span class="line">    - 查询</span><br><span class="line">        - 直接查询书架情况即可</span><br><span class="line"></span><br><span class="line"><span class="params">##</span> hw14</span><br><span class="line"></span><br><span class="line">0. - 正式书籍：书架、预约处、借还处、用户</span><br><span class="line">    - 非正式书籍：借还处、漂流角、用户</span><br><span class="line">        - 不可预约、续借</span><br><span class="line">        - 由用户捐献，序列号与书架不同，且书号不重复（最多一本）</span><br><span class="line">1. close后整理</span><br><span class="line">    - 借还处的书根据不同情况全部送回（书架、漂流角）</span><br><span class="line">    - 预约处的过期（对预约的所有人）的书放回书架，删除预约表中记录</span><br><span class="line">2. open后整理</span><br><span class="line">    - 预约处的过期的书放回书架</span><br><span class="line">    - 根据预约表和书架的情况取书到预约处，为指定用户保留五天并删除预约表中记录</span><br><span class="line">3. 开馆</span><br><span class="line">    - 查询</span><br><span class="line">        - 根据`Type`查询书架或漂流角</span><br><span class="line">    - 借书</span><br><span class="line">        - 先判断是否可从书架中取出</span><br><span class="line">        - 再根据用户持书情况判断此书的归属，借书成功时设定还书期限</span><br><span class="line">    - 预约</span><br><span class="line">        - 非正式书籍不可预约</span><br><span class="line">        - 根据持书情况判断是否允许该预约，预约成功则预约请求加入预约表</span><br><span class="line">    - 还书</span><br><span class="line">        - 还书立即成功，需要判断是否逾期</span><br><span class="line">    - 取书</span><br><span class="line">        - 预约处查询，若为其保存且是要取的书，则取书成功，删除预约表对应记录，确定还书期限</span><br><span class="line">        - 否则失败</span><br><span class="line">    - 续借</span><br><span class="line">        - 还书期限前5天内才可续借，若有对该书的预约且书架上无书则失败</span><br><span class="line">        - 续借成功则还书期限延长30天</span><br><span class="line">    - 捐献</span><br><span class="line">        - 一定成功，直接放入漂流角</span><br><span class="line"></span><br><span class="line"><span class="params">##</span> hw15</span><br><span class="line"></span><br><span class="line">0. - 新增用户信用分（信用分可查询）</span><br><span class="line">    - 初始为10，上限20</span><br><span class="line">    - 信用分为负，不允许借书（扣在借还处）、预约、续借</span><br><span class="line">    - 按时还书+1，逾期后**立刻**-2</span><br><span class="line">    - 未按时取书-3</span><br><span class="line">    - 捐赠图书+2，变为正式书籍再+2</span><br></pre></td></tr></table></figure><p>第一次设计时就采用了将管理操作分为开馆、闭馆、日常操作三个部分，并且使用单例模式来实现对于图书馆的管理。图书馆中包括书架、借还处、预约处以及用户数据等信息。设置<code>Appointment</code>类记录单次预约信息。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Library</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Library library;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">BookShelf</span> <span class="variable">bs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookShelf</span>(LibrarySystem.SCANNER.getInventory());</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">BorrowAndReturnOffice</span> <span class="variable">bro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BorrowAndReturnOffice</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AppointmentOffice</span> <span class="variable">ao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AppointmentOffice</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Library</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Library <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (library == <span class="literal">null</span>) &#123;</span><br><span class="line">            library = <span class="keyword">new</span> <span class="title class_">Library</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> library;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            LibraryCommand&lt;?&gt; command = LibrarySystem.SCANNER.nextCommand();</span><br><span class="line">            <span class="keyword">if</span> (command == <span class="literal">null</span>) &#123; <span class="keyword">break</span>; &#125;</span><br><span class="line">            <span class="keyword">if</span> (command.getCmd().equals(<span class="string">&quot;OPEN&quot;</span>)) &#123;</span><br><span class="line">                open();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.getCmd().equals(<span class="string">&quot;CLOSE&quot;</span>)) &#123;</span><br><span class="line">                close();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                process((LibraryRequest) command.getCmd());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(LibraryRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>其实从文字版建模可以看出，我对预约请求的处理由“不许重复预约”（此时题目要求没有对管理策略进行限制）变化为“只要条件满足就允许”，也算是根据需求的变化而不断调整架构设计的:一个写照了。</p><p>其他的内容就是不断添加新的功能，比如捐赠、图书升级、续借、信用分等，然后在原有的基础上新增漂流角、进行修改。</p><p>比如对<code>User</code>类的属性进行了适当的修改：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> String id;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;LibraryBookId, Integer&gt; books; <span class="comment">// value值为还书期限</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> bookB; <span class="comment">// 是否持有B类书籍 </span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> bookBU; <span class="comment">// 是否持有BU类书籍</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> credit;</span><br></pre></td></tr></table></figure><p>并增加续借、信用分等的处理：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">renew</span><span class="params">(LibraryBookId bookId, <span class="type">int</span> day)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">returnDue</span> <span class="operator">=</span> books.get(bookId);</span><br><span class="line">    books.put(bookId, returnDue + day);</span><br><span class="line">    <span class="keyword">return</span> returnDue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeCredit</span><span class="params">(<span class="type">int</span> change)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (credit + change &gt; <span class="number">20</span>) &#123; credit = <span class="number">20</span>; &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; credit += change; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><hr><p>给预约请求类<code>Appointment</code>增加<code>order</code>属性以决定分配书籍顺序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Appointment</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> order;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> User user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LibraryBookId bookId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Appointment</span><span class="params">(User user, LibraryBookId bookId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.order = count++;</span><br><span class="line">        <span class="built_in">this</span>.user = user;</span><br><span class="line">        <span class="built_in">this</span>.bookId = bookId;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在开馆前整理时，对预约请求进行处理：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Appointment&gt; tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(requestSet);</span><br><span class="line">tmp.sort((o1, o2) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (o1.equals(o2) || o1.getOrder() == o2.getOrder()) &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">return</span> Long.compare(o1.getOrder(), o2.getOrder());</span><br><span class="line">&#125;);</span><br><span class="line">tmp.removeIf(...);</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><hr><p>新增属性<code>returnForm</code>来判断每天闭馆时哪些图书逾期，以修改对应用户信用分：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> List&lt;Map&lt;String, Integer&gt;&gt; returnForm = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(<span class="number">500</span>);</span><br><span class="line"><span class="comment">// key为用户id，value为应还书籍数量</span></span><br><span class="line"><span class="comment">// 输入事件在 [2024-01-01] 至 [2024-12-31] 之间发生</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Library</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">500</span>; ++i) &#123; returnForm.add(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;()); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(LocalDate date)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">day</span> <span class="operator">=</span> <span class="built_in">this</span>.date + <span class="number">1</span>; day &lt; date.getDayOfYear(); ++day) &#123;</span><br><span class="line">        returnForm.get(day).forEach((key, value) -&gt; users.get(key).changeCredit(-<span class="number">2</span> * value));</span><br><span class="line">    &#125; <span class="comment">// 日期不连续，开馆时也要检查</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(LocalDate date)</span> &#123;</span><br><span class="line">    <span class="comment">// 闭馆时检查今天应该收回哪些书籍</span></span><br><span class="line">returnForm.get(<span class="built_in">this</span>.date).forEach((key, value) -&gt; users.get(key).changeCredit(-<span class="number">2</span> * value));</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">然后进行以下操作时记得更新 returnForm</span></span><br><span class="line"><span class="comment">borrowBook, returnBook, pickBook, renewBook</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="思维演进">思维演进</h2><h3 id="架构设计">架构设计</h3><p>从先导课到如今 oo 正课迎来尾声，从开始时对 Java 编程的学习，到体会和学习面向对象的设计思想，我的确收获颇深，也算是和课程的名字（面向对象设计与构造）相符了吧。</p><p>在 Unit1 中，我接触到了层次化设计的思想，学习了递归下降这样的实践方法。除了重新捡起先导课 Java 语法的知识，抽象问题的能力和架构设计的感觉也逐渐从无到有地发展起来。本学期的唯一一次大重构也发生在这个单元。总的来说，这单元的学习给我打开了面向对象设计的大门，让我了解和学习了许多结构和层次的思想。</p><p>在 Unit2 中，接触到了多线程设计的问题。同时这一时期，操作系统课也了解了些许相关的知识。不过由于是第一次建立起对多线程运行机制的认识，这单元的迭代作业可谓是至暗时刻。在无数次 debug 以及动手实现影子电梯之后，终于在这个单元快要结束的时候，我才对各个线程和类之间如何交互、如何保证安全性有了很清晰的认知，只是可惜两次作业中的影子电梯没能检查出所有的线程安全问题、没能安全通过这个单元，也算是一个遗憾了。</p><p>在 Unit3 中，接触到了契约式设计，感觉这个思想还是挺好的，然后也学到了 JML 对于 JUnit 测试的帮助。</p><p>在 Unit4 中，则是接触了正向建模开发这一思想。在这单元的迭代作业中，使用的文字版建模让我很快完成了每次任务。在写代码之前进行总体的架构设计、并在实现过程中不断改进，确实是提高效率、减缓代码屎山化的不二选择。</p><h3 id="测试">测试</h3><p>很惭愧，这个学期没有搭建一个自己的评测机，大部分时候是白嫖其他同学的评测机，然后自己再手搓数据进行压力测试、反复阅读指导书和代码测试 Corner Case 。</p><p>学习 oo 之前对测试的认识就是简答地查看测试用例的结果是否正确，但之后发现测试是很丰富的，包括主要接触到的黑箱测试、白箱测试，以及单元测试、集成测试、系统测试等等。感触最深的还是 Unit3 对于 JML 规格的学习，这种测试方法在契约式设计时对于代码的正确性检查应该是很有帮助的。</p><h2 id="课程收获">课程收获</h2><p>不管怎么说，还是顺利结束了这门声名远扬的课程的学习。虽然感觉最后没有实现幻想中的完全胜利，也没有像一些同学收获那么多，但还是学到了一些或感兴趣或有用的知识和思想——层次化设计、多线程、契约式设计等等。虽然熬夜重构第二次作业时因拙劣的架构和不熟悉的语法特性而破防，虽然费了很多心思写的影子电梯还是被测出了 bug ……但更能抗压了，<s>更能 debug 了</s>。如果重新来过可能结局会好那么一点，不过过程总是这样的。失败总是贯穿始终，遗憾才是常态，就这样吧。</p>]]></content>
      
      
      <categories>
          
          <category> BUAA面向对象设计与构造 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OO-2024-Unit3</title>
      <link href="/803f19a7.html"/>
      <url>/803f19a7.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言-唉-jml">前言——唉，JML</h2><p>本单元的主题为<strong>基于规格</strong>的层次化设计，相较于前两个单元的问题抽象与分解、并发程序设计，这单元的难度算是降低了不少吧——所有的方法与接口都由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>规格给出，只需要根据约定、将功能一一实现即可（暂不考虑程序性能的前提下）。</p><p>在我看来，其实不用太纠结于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>这里有什么毛病，那里有什么毛病，<s>虽然有时看起来确实很滑稽</s>（比如由于其形式化的描述，费了老半天劲写出来的东西自然语言一句话就讲明白了），最主要的一点还是去感受<strong>契约式设计</strong>的魅力（<s>见仁见智把</s>）。</p><p>规格设计者（架构师）基于规格和需要实现的业务，定义一个类所需管理的数据及其需要满足的约束和实现不同作用的方法；而程序员则遵循对每个对象和方法的要求，只需聚焦于具体方法的实现。当然在保证没有二义性的前提下，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>大篇大篇的数理逻辑表述确实又臭又长（所以这学期助教们对用于教学的JML的简化工作确实挺好的）。不过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>这样的形式化的表述，在另一方面确实有利于对代码进行各种验证和测试：</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">p</mi><mi mathvariant="monospace">r</mi><mi mathvariant="monospace">e</mi><mtext>-</mtext><mi mathvariant="monospace">c</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">n</mi><mo>→</mo><mi mathvariant="monospace">p</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">s</mi><mi mathvariant="monospace">t</mi><mtext>-</mtext><mi mathvariant="monospace">c</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">n</mi><mtext> </mtext><mtext> </mtext><mo>&amp;</mo><mo>&amp;</mo><mtext> </mtext><mtext> </mtext><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">o</mi><mtext> </mtext><mi mathvariant="monospace">s</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">e</mi><mtext>-</mtext><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">f</mi><mi mathvariant="monospace">f</mi><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">c</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">s</mi></mrow><annotation encoding="application/x-tex">\tt pre\text{-}condition \to post\text{-}condition \, \, \And\And \, \, no \, side\text{-}effects</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9166599999999999em;vertical-align:-0.22222em;"></span><span class="mord"><span class="mord mathtt">p</span><span class="mord mathtt">r</span><span class="mord mathtt">e</span><span class="mord text"><span class="mord">-</span></span><span class="mord mathtt">c</span><span class="mord mathtt">o</span><span class="mord mathtt">n</span><span class="mord mathtt">d</span><span class="mord mathtt">i</span><span class="mord mathtt">t</span><span class="mord mathtt">i</span><span class="mord mathtt">o</span><span class="mord mathtt">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathtt">p</span><span class="mord mathtt">o</span><span class="mord mathtt">s</span><span class="mord mathtt">t</span><span class="mord text"><span class="mord">-</span></span><span class="mord mathtt">c</span><span class="mord mathtt">o</span><span class="mord mathtt">n</span><span class="mord mathtt">d</span><span class="mord mathtt">i</span><span class="mord mathtt">t</span><span class="mord mathtt">i</span><span class="mord mathtt">o</span><span class="mord mathtt">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mbin">&amp;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">&amp;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathtt">n</span><span class="mord mathtt">o</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathtt">s</span><span class="mord mathtt">i</span><span class="mord mathtt">d</span><span class="mord mathtt">e</span><span class="mord text"><span class="mord">-</span></span><span class="mord mathtt">e</span><span class="mord mathtt">f</span><span class="mord mathtt">f</span><span class="mord mathtt">e</span><span class="mord mathtt">c</span><span class="mord mathtt">t</span><span class="mord mathtt">s</span></span></span></span></span></span></p><p>所以在实际项目开发过程中，感觉自然语言和规格语言并不应该是相斥的，不是只能有一个存在。<s>（教学中只给JML并要求能看懂，倒也能理解）</s></p><p>还有一点要说的是，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>描述的规格是我们希望我们管理的数据会产生什么样的行为/变化，在实际实现的过程中我们不应逐字逐句翻译<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>（一些时候无法满足性能要求甚至<s>难以翻译</s>），而应采用合适的算法、数据结构，以及将方法的逻辑拆解成小的功能模块；另外，如果我们要写出一个已实现的方法对应的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>（虽然感觉这个行为很难评），也不能一句一句翻译，比如这个方法用了某种算法，那使用的算法的细节并不是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>或者说规格关心的，关注的是数据或者对象状态的变化。比如下面这个求解字符串莱文斯坦距离的例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Levenshtein</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] dp;</span><br><span class="line">    <span class="comment">/*@ requires str1 != null &amp;&amp; str2 != null;</span></span><br><span class="line"><span class="comment">      @ ensures \result ==</span></span><br><span class="line"><span class="comment">      @     ((str1.length() == str2.length() &amp;&amp; (\forall int i; 0 &lt;= i &amp;&amp; i &lt; str1.length(); str1.charAt(i) == str2.charAt(i))) ||</span></span><br><span class="line"><span class="comment">      @      (str1.length() == str2.length() - 1 &amp;&amp; (\forall int i; 0 &lt;= i &amp;&amp; i &lt; str1.length(); str1.charAt(i) == str2.charAt(i))) ||</span></span><br><span class="line"><span class="comment">      @      (str1.length() - 1 == str2.length() &amp;&amp; (\forall int i; 0 &lt;= i &amp;&amp; i &lt; str2.length(); str1.charAt(i) == str2.charAt(i))));</span></span><br><span class="line"><span class="comment">      @*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String str1, String str2)</span> &#123;<span class="comment">//使用某些方法帮助简化JML</span></span><br><span class="line">        <span class="keyword">if</span> (str1 == <span class="literal">null</span> || str2 == <span class="literal">null</span>) &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">        <span class="keyword">if</span> (str1.equals(str2)) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tmp</span> <span class="operator">=</span> str1.substring(<span class="number">0</span>, str1.length() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (tmp.equals(str2)) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line">        tmp = str2.substring(<span class="number">0</span>, str2.length() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> str1.equals(tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*@ public normal_behavior</span></span><br><span class="line"><span class="comment">      @ requires src != null &amp;&amp; dst != null &amp;&amp; !src.equals(dst);</span></span><br><span class="line"><span class="comment">      @ ensures (\exist String[] PathM;</span></span><br><span class="line"><span class="comment">                pathM.length &gt;= 2 &amp;&amp; pathM[0].equals(src) &amp;&amp; pathM[pathM.length - 1].equals(dst) &amp;&amp;</span></span><br><span class="line"><span class="comment">                (\forall int i; 1 &lt;= i &amp;&amp; i &lt; pathM.length; check(pathM[i - 1], pathM[i]));</span></span><br><span class="line"><span class="comment">                (\forall String[] Path; Path.length &gt;= 2 &amp;&amp; path[0].equals(src) &amp;&amp; path[path.length - 1].equals(dst) &amp;&amp;</span></span><br><span class="line"><span class="comment">                 (\forall int i; 1 &lt;= i &amp;&amp; i &lt; path.length; check(path[i - 1], path[i]));</span></span><br><span class="line"><span class="comment">                 (\sum int i; 0 &lt;= i &amp;&amp; i &lt; path.length; 1) &gt;= (\sum int i; 0 &lt;= i &amp;&amp; i &lt; pathM.length; 1) &amp;&amp;</span></span><br><span class="line"><span class="comment">                 \result == (\sum int i; 1 &lt;= i &amp;&amp; i &lt; pathM.length; 1)));</span></span><br><span class="line"><span class="comment">      @ also</span></span><br><span class="line"><span class="comment">      @ public normal_behavior</span></span><br><span class="line"><span class="comment">      @ requires src != null &amp;&amp; dst != null &amp;&amp; src.equals(dst);</span></span><br><span class="line"><span class="comment">      @ ensures \result == 0</span></span><br><span class="line"><span class="comment">      @*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">solve</span><span class="params">(String src, String dst)</span> &#123;</span><br><span class="line">        dp = <span class="keyword">new</span> <span class="title class_">int</span>[src.length() + <span class="number">1</span>][dst.length() + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; src.length(); ++i) &#123;</span><br><span class="line">            dp[i + <span class="number">1</span>][<span class="number">0</span>] = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; dst.length(); ++i) &#123;</span><br><span class="line">            dp[<span class="number">0</span>][i + <span class="number">1</span>] = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; src.length(); ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; dst.length(); ++j) &#123;</span><br><span class="line">                dp[i + <span class="number">1</span>][j + <span class="number">1</span>] = Math.min(dp[i][j + <span class="number">1</span>], dp[i + <span class="number">1</span>][j]) + <span class="number">1</span>;</span><br><span class="line">                dp[i + <span class="number">1</span>][j + <span class="number">1</span>] = Math.min(dp[i][j] + <span class="number">1</span>, dp[i + <span class="number">1</span>][j + <span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">if</span> (src.charAt(i) == dst.charAt(j)) &#123;</span><br><span class="line">                    dp[i + <span class="number">1</span>][j + <span class="number">1</span>] = Math.min(dp[i + <span class="number">1</span>][j + <span class="number">1</span>], dp[i][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[src.length()][dst.length()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="关于测试">关于测试</h2><h3 id="黑盒测试与白盒测试">黑盒测试与白盒测试</h3><p>黑盒测试：</p><ul><li>基于代码的规格说明和功能需求进行的测试</li><li>作为测试人员，我们不需要了解代码的内部结构或实现细节，而是将其视为一个黑盒子，只关注其输入和输出之间的关系，检验对错（设置各种<code>Corner Cases</code>以及压力测试等）</li><li>这类测试主要是用于验证代码的行为是否符合预期</li><li>这单元我们根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>规格进行的测试就属于黑盒测试</li></ul><p>白盒测试：</p><ul><li>基于代码的内部结构和实现细节进行的测试</li><li>我们需要了代码内部逻辑和使用的算法，并针对地设计测试用例</li><li>通常需要关注代码覆盖率、分支覆盖率等各种覆盖率，比如上学期<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mi mathvariant="script">O</mi><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{OOP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></span>要求的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">U</mi><mi mathvariant="script">n</mi><mi mathvariant="script">i</mi><mi mathvariant="script">t</mi></mrow><annotation encoding="application/x-tex">\mathcal{JUnit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span></span></li></ul><h3 id="其他多种测试">其他多种测试</h3><ol><li>单元测试<ul><li>单元测试是针对软件中的最小可测试单元进行的测试，通常是代码中的一个函数、方法或类。</li><li>单元测试的目标是验证每个单元的功能是否符合预期，以确保代码的每个部分都能正常工作。</li><li>例如，本单元对社交网络的单元测试可以包括对各种增加/删除元素、查询、发送信息等功能进行测试，每个功能被视为一个单元。</li></ul></li><li>功能测试<ul><li>功能测试是测试软件的功能是否按照规格说明和用户需求的预期工作。</li><li>在功能测试中，我们需要模拟用户操作，验证软件的各项功能是否符合预期，包括输入验证、功能流程、界面交互等。</li><li>例如，对于一个电子商务网站，功能测试可以包括用户注册、浏览商品、下订单、支付等功能的测试。</li></ul></li><li>集成测试<ul><li>集成测试是测试软件中不同模块或组件之间的交互和集成是否正常。</li><li>在集成测试中，我们需要将各个模块组合起来，并测试它们之间的接口和交互是否符合设计要求。</li><li>例如，对于一个社交网络应用，集成测试可以包括用户登录、发布动态、评论、点赞等功能的整体测试。</li></ul></li><li>压力测试<ul><li>压力测试是测试软件在负载过高或资源不足的情况下是否能够正常工作。</li><li>在压力测试中，我们可以模拟大量用户同时访问系统或者增加系统负载，以测试软件的性能、稳定性和可靠性。</li><li>例如，对于一个在线游戏服务器，压力测试可以模拟大量玩家同时在线、进行游戏，以测试服务器是否能够承受住这样的负载。或者对于我们<s>喜闻乐见</s>的互测来说，生成各种极限数据。</li></ul></li><li>回归测试<ul><li>回归测试是在软件发生变更后重新执行之前的测试用例，以确保变更不会对软件的其他部分造成影响。</li><li>在回归测试中，我们需要针对变更的部分以及相关联的功能重新执行测试用例，并验证软件的整体功能是否受到影响。</li><li>例如，当我们每次修复bug或者进行迭代后，也要使用之前已经通过的数据对代码进行测试，以确保bug修复没有引入新的问题😃</li></ul></li></ol><p>总之，这些测试类型在软件或项目开发过程中起着不同的作用，我们可以通过综合运用有效地提高软件的质量、可靠性、可维护性。</p><h3 id="数据构造策略">数据构造策略</h3><p>除了使用大佬们提供的评测机，我构造数据的主要策略是，针对一些需要优化的指令进行压力测试。</p><p>比如第二次互测时，对于指令<code>queryTagValueSum</code>，我构造数据的具体策略如下：</p><ol><li><code>load_network</code>（100人）</li><li><code>at 1 1</code>（给<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>o</mi><mi>n</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">person1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord">1</span></span></span></span>加上Tag）</li><li>增加<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>个人并与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>o</mi><mi>n</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">person1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord">1</span></span></span></span>连边，然后连同前面的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>99</mn></mrow><annotation encoding="application/x-tex">99</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">9</span></span></span></span>个人，一块加入上述Tag中</li><li>最后剩下的操作全部执行<code>qtvs</code></li></ol><p>简单计算可知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>取约<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>725</mn></mrow><annotation encoding="application/x-tex">725</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mord">2</span><span class="mord">5</span></span></span></span>时压力最大（针对双重循环来说）。</p><h2 id="架构设计">架构设计</h2><p>本单元的主要任务是实现一个简单的社交网络。</p><p>具体的<code>UML</code>类图如下</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/hw11.png" alt="hw11"></p><p>虽然基本上规格都由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>给出了，但它只是定义了方法或者接口的外部可感知行为及其约束，以及需要管理的数据所要满足的要求，实际编写代码时，我们需要灵活使用不同算法和数据结构，才能在保证性能的同时达成想要的效果。</p><p>在本单元作业实现中，我新建了<code>Graph</code>类，使用<strong>邻接表</strong>存储信息，将绝大部分维护信息的工作从<code>Network</code>类中分出来，<code>Network</code>只负责实现各种业务的接口。</p><p>其他的部分如<code>Tag</code>、<code>Person</code>、<code>Message</code>和异常类则由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>规定好了，总体结构没有什么特别的地方。</p><h3 id="时间复杂度分析">时间复杂度分析</h3><p>本单元要求维护一张关系图（初始为空），并支持修改和查询操作（指令数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>⩽</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">N \leqslant 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8200000000000001em;vertical-align:-0.13667em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>）。为了在时限内通过所有数据，我们需要保证每种操作的时间复杂度<strong>最多</strong>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，在保证正确性的基础上再尝试进行复杂度优化或常数优化。</p><p>首先是最基本的<code>add relation</code>和<code>modify relation</code>，其实可以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>实现，但是为了避免<code>queryTripleSum</code>、<code>queryTagValueSum</code>等操作的多重循环，需要在修改关系的时候对相关的信息进行维护，这样上述的查询操作就可以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>完成。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Graph.addRelation()</span></span><br><span class="line"><span class="comment">//维护三元环, deleteRelation时同理</span></span><br><span class="line"><span class="keyword">if</span> (acquaintance.get(id1).size() &gt; acquaintance.get(id2).size()) &#123;</span><br><span class="line"><span class="comment">//一点常数优化</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> o : acquaintance.get(id2)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (acquaintance.get(id1).contains(o)) &#123;</span><br><span class="line">            tripleNum++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> o : acquaintance.get(id1)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (acquaintance.get(id2).contains(o)) &#123;</span><br><span class="line">            tripleNum++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>TagValueSum</code>的维护，与其费劲心思在<code>Person</code>类中维护信息，我选择了比较简单的实现，直接在<code>Network</code>中记录所有出现的Tag，修改所有满足条件的Tag即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Tag.addPerson(), 删人同理</span></span><br><span class="line"><span class="keyword">for</span> (Person p : persons.values()) &#123; valueSum += <span class="number">2</span> * person.queryValue(p); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Network.addRelation(), modify同理</span></span><br><span class="line"><span class="keyword">for</span> (MyTag tag : tags) &#123;</span><br><span class="line">    <span class="keyword">if</span> (tag.hasPerson(persons.get(id1)) &amp;&amp; tag.hasPerson(persons.get(id2))) &#123;</span><br><span class="line">        tag.update(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Tag.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">    valueSum += <span class="number">2</span> * value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>queryTagAgeVar</code>，计算方差原本是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>的，不过可以在<code>addPersonToTag</code>、<code>delPersonFromTag</code>时<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>维护<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><mi>A</mi><mi>g</mi><mi>e</mi><mo separator="true">,</mo><mo>∑</mo><mi>A</mi><mi>g</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum Age,\sum Age^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064118em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>，然后就可以做到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>查询方差。</p><p>对于<code>queryShortestPath</code>，实际就是<strong>01最短路</strong>，直接<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">B</mi><mi mathvariant="script">F</mi><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{BFS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.03041em;">B</span><span class="mord mathcal" style="margin-right:0.09931em;">F</span><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span>即可（也可以双向，减小常数），复杂度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>为边数小于指令数）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findShortestPath</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (s == t) &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    HashMap&lt;Integer, Integer&gt; dis = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    dis.put(s, <span class="number">0</span>);</span><br><span class="line">    dis.put(t, <span class="number">0</span>);</span><br><span class="line">    HashMap&lt;Integer, Integer&gt; flag = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    flag.put(s, <span class="number">0</span>);</span><br><span class="line">    flag.put(t, <span class="number">1</span>);</span><br><span class="line">    Queue&lt;Integer&gt; q = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();<span class="comment">//distance小的先进先出</span></span><br><span class="line">    <span class="keyword">if</span> (acquaintance.get(s).size() &gt; acquaintance.get(t).size()) &#123;<span class="comment">//可能的常数优化（</span></span><br><span class="line">        q.add(t);</span><br><span class="line">        q.add(s);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        q.add(s);</span><br><span class="line">        q.add(t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!q.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> q.poll();</span><br><span class="line">        <span class="type">int</span> <span class="variable">f</span> <span class="operator">=</span> flag.get(u);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v : acquaintance.get(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis.containsKey(v)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (flag.get(v) != f) &#123;<span class="comment">//搜索交汇</span></span><br><span class="line">                    <span class="keyword">return</span> dis.get(u) + dis.get(v);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; <span class="keyword">continue</span>; &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            dis.put(v, dis.get(u) + <span class="number">1</span>);</span><br><span class="line">            flag.put(v, f);</span><br><span class="line">            q.add(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于<code>queryBestAcquaintance</code>，其实<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>查询也没问题，不过由于<code>queryCoupleSum</code>的存在，基本上要求必须在常数时间内实现<code>qba</code>。</p><p>当然我们还是可以再加人/删人的时候<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>维护最大值，不过我选择了用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi><mi mathvariant="script">r</mi><mi mathvariant="script">e</mi><mi mathvariant="script">e</mi><mi mathvariant="script">M</mi><mi mathvariant="script">a</mi><mi mathvariant="script">p</mi></mrow><annotation encoding="application/x-tex">\mathcal{TreeMap}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathcal">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span></span></span></span></span>去存<code>acquaintance</code>相关信息，这样就可以降低复杂度至<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(logN)/O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p><p>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi><mi mathvariant="script">r</mi><mi mathvariant="script">e</mi><mi mathvariant="script">e</mi><mi mathvariant="script">M</mi><mi mathvariant="script">a</mi><mi mathvariant="script">p</mi></mrow><annotation encoding="application/x-tex">\mathcal{TreeMap}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathcal">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">p</span></span></span></span></span>只能以键值进行排序，研究了一阵子不得以我只能以一种很不优雅的方式自定义了比较器😕</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Person.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, Acquaintance&gt; valueById;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> TreeMap&lt;Acquaintance, Integer&gt; value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getBestAcquaintance</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> value.firstEntry().getKey().getPersonId();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Acquaintance.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Acquaintance</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Acquaintance&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> personId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Acquaintance o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (value == o.value) &#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.compare(personId, o.personId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o.value, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其他指令基本上根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>来就好，除了维护整张图关系的并查集，基本没有使用算法和数据结构进行优化的必要了。</p><h3 id="并查集的延迟重建">并查集的延迟重建</h3><p>本来我们可以使用<strong>路径压缩+启发式合并</strong>的并查集，做到每个关系修改和查询（<code>isCircle</code>）操作的平均时间为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\alpha(N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>（可以认为是很小的常数），同时<code>queryBlockSum</code>也可以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>维护和查询。</p><p>不过有了<code>modifyRelation</code>删边操作，我们不得不在某些时候对并查集进行重建。</p><ol><li><p>如果是每次判断需要删边时无脑全部重建，则很大可能会被卡烂掉（常数+评测机波动）</p></li><li><p>每次删边时部分重建，常数小了很多，不过很多时候不太必要（因为只有查询的时候才需要准确的<code>BlockSum</code>和<code>isCircle</code>）</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Graph.deleteRelation()</span></span><br><span class="line">HashSet&lt;Integer&gt; visited = <span class="keyword">new</span> <span class="title class_">Hashset</span>&lt;&gt;();</span><br><span class="line">father.put(id1, id1);</span><br><span class="line">dfs(id1, id1, visited);</span><br><span class="line">rank.put(id1, visited.size());</span><br><span class="line"><span class="keyword">if</span> (!visited.contains(id2)) &#123;</span><br><span class="line">    father.put(id2, id2);</span><br><span class="line">    visited.clear();</span><br><span class="line">    dfs(id2, id2, visited);</span><br><span class="line">    rank.put(id2, visited.size());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//dfs</span></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> fa, <span class="type">int</span> u, Hashset&lt;Integer&gt; visited)</span> &#123;</span><br><span class="line">    visited.add(u);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : acquaintance.get(u)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visited.contains(v)) &#123;</span><br><span class="line">            father.put(v, fa);</span><br><span class="line">            rank.put(v, <span class="number">1</span>);</span><br><span class="line">            dfs(fa, v, visited);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>或者删边时设置脏位，需要查询时才重建并查集。不过这样的话，当修改和查询指令轮流到来时，这个方法会和<code>1</code>一样拉（因为会无脑全部重建）</p></li></ol><hr><p>结合以上思路我们可以设计一种带有<strong>精确</strong>脏位的并查集（思路来自讨论区<a href="http://oo.buaa.edu.cn/assignment/521/discussion/1562">jhz同学的分享</a>）</p><p>具体来说，我们可以将原来标记整个图的脏位扩展为<strong>对每个联通块</strong>进行脏位标记，设置<code>dirty</code>为所有被删边操作污染的父节点</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> HashSet&lt;Integer&gt; dirty;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Graph.deleteRelation()</span></span><br><span class="line"><span class="type">int</span> <span class="variable">f</span> <span class="operator">=</span> find(id1);</span><br><span class="line"><span class="keyword">if</span> (!dirty.contains(f)) &#123;<span class="comment">//不要重复了</span></span><br><span class="line">    dirty.add(f);</span><br><span class="line">    blockNum--;<span class="comment">//先不考虑这个联通块的贡献</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这个行为的意义是，进行了此次删边操作后，以f为父节点的联通块内的具体情况我们将不得而知，</span></span><br><span class="line"><span class="comment">这个联通块内所有点的关系信息是“不确定”的，需要查询时我们就对这些点进行关系的重建</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>重建的步骤为</p><ol><li>若<code>dirty</code>不为空，则所有的父节点在<code>dirty</code>中的点是我们需要重建的点</li><li>从需要重建的点的集合中开始<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mi mathvariant="script">F</mi><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{DFS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class="mord mathcal" style="margin-right:0.09931em;">F</span><span class="mord mathcal" style="margin-right:0.075em;">S</span></span></span></span></span>，重建这部分并查集</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">rebuild</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!dirty.isEmpty()) &#123;</span><br><span class="line">        HashSet&lt;Integer&gt; needToBuild = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> id : acquaintance.keySet()) &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            一定要先找出所有要重建的点，而不能边重建边判断哪些点需要重建，</span></span><br><span class="line"><span class="comment">            因为重建到一半的并查集的信息是“不稳定的”，</span></span><br><span class="line"><span class="comment">            重建的过程中再去判断点是否要重建，就可能会漏掉部分点</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span> (dirty.contains(find(id))) &#123;<span class="comment">//父节点被标记</span></span><br><span class="line">                needToBuild.add(id);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        HashSet&lt;Integer&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> id : needToBuild) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!visited.contains(id)) &#123;</span><br><span class="line">                father.put(id, id);</span><br><span class="line">                rank.put(id, dfs(id, id, visited));</span><br><span class="line">                blockNum++;<span class="comment">//有了一个联通块</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        dirty.clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> fa, <span class="type">int</span> u, HashSet&lt;Integer&gt; visited)</span> &#123;</span><br><span class="line">    visited.add(u);</span><br><span class="line">    <span class="type">int</span> <span class="variable">cnt</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : acquaintance.get(u)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visited.contains(v)) &#123;</span><br><span class="line">            father.put(v, fa);</span><br><span class="line">            rank.put(v, <span class="number">1</span>);</span><br><span class="line">            cnt += dfs(fa, v, visited);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;<span class="comment">//返回联通块的大小</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是对于查询操作，<code>queryBlockSum</code>我们需要调用<code>rebuild</code>。</p><p>而对于<code>isCircle</code>，需要分以下几种情况讨论：</p><ol><li>若<code>!dirty.contains(f1) &amp;&amp; !dirty.contains(f2)</code>，则这两个联通块都未被污染，正常判断即可</li><li>若<code>dirty.contains(f1) &amp;&amp; dirty.contains(f2)</code>，则此时对我们来说这两个联通块的状态是“薛定谔的”，需要重建</li><li>而若两个父亲只有一个脏位被标记，这是我们<strong>立即得出被查询的两个点是不联通</strong>的（因为显然这两个点父节点不一样）</li></ol><p>剩下的就是正常的并查集的相关操作，不过最后还有一点需要注意<s>血泪教训</s>：</p><p>就是并查集合并的时候，需要优先将没有脏位的父节点合并到有脏位的父节点，否则这个联通块的脏位信息是不准确的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">union</span><span class="params">(<span class="type">int</span> id1, <span class="type">int</span> id2)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">fa1</span> <span class="operator">=</span> find(id1);</span><br><span class="line">    <span class="type">int</span> <span class="variable">fa2</span> <span class="operator">=</span> find(id2);</span><br><span class="line">    <span class="keyword">if</span> (fa1 != fa2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dirty.contains(fa1) == dirty.contains(fa2)) &#123;</span><br><span class="line">            <span class="comment">//启发式合并</span></span><br><span class="line">            <span class="keyword">if</span> (rank.get(fa1) &gt; rank.get(fa2)) &#123;</span><br><span class="line">                father.put(fa2, fa1);</span><br><span class="line">                rank.put(fa1, rank.get(fa1) + rank.get(fa2));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                father.put(fa1, fa2);</span><br><span class="line">                rank.put(fa2, rank.get(fa2) + rank.get(fa1));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dirty.contains(fa1)) &#123;</span><br><span class="line">            father.put(fa2, fa1);</span><br><span class="line">            rank.put(fa1, rank.get(fa1) + rank.get(fa2));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            father.put(fa1, fa2);</span><br><span class="line">            rank.put(fa2, rank.get(fa2) + rank.get(fa1));</span><br><span class="line">        &#125;</span><br><span class="line">        blockNum--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于重建操作只在需要的时候进行，并且我们精确了重建的点的范围，无论对于什么数据，这种方法相较于前面几种都是只优不劣的。</p><h3 id="容器类的选择和轮子的使用">容器类的选择和轮子的使用</h3><p>由于本单元维护的是一个社交网络，每个对象的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mi mathvariant="script">d</mi></mrow><annotation encoding="application/x-tex">\mathcal{Id}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="mord mathdefault">d</span></span></span></span></span>是独一无二的，且取值范围是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mi mathvariant="script">n</mi><mi mathvariant="script">t</mi></mrow><annotation encoding="application/x-tex">\mathcal{Int}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span></span></span></span></span>，所以我们可以很自然地想到用使用<code>HashMap</code>，建立<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">I</mi><mi mathvariant="script">d</mi></mrow><annotation encoding="application/x-tex">\mathcal{Id}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.07382em;">I</span><span class="mord mathdefault">d</span></span></span></span></span>到各种属性/对象的映射。</p><p>而对于其他一些不需要这样的映射的对象的集合，则基本来说<code>HashSet</code>是较优的选择（因为对象不重复且可以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>使用<code>contains</code>）。</p><p>然后对于<code>getReceivedMessages</code>，要求返回前<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>个Message，所以不能内部无序的<code>HashMap</code>或<code>HashSet</code>。经过查阅资料和参考讨论区<a href="http://oo.buaa.edu.cn/assignment/527/discussion/1570">czx同学的思路分享</a>，最终选择了基于链表的<code>LinkedList</code>来存储Messages。</p><p>具体操作为：添加Message时使用<code>addFirst</code>方法，删除时使用<code>removeIf</code>方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Person.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addMessage</span><span class="params">(Message message)</span> &#123;</span><br><span class="line">    messages.addFirst(message);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteNotices</span><span class="params">()</span> &#123;</span><br><span class="line">    messages.removeIf(message -&gt; message <span class="keyword">instanceof</span> MyNoticeMessage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>对于删除上述容器中的特定元素操作，一般而言，我们都会采用迭代器的形式去遍历</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Iterator&lt;E&gt; it = collection.iterator();</span><br><span class="line"><span class="keyword">while</span> (it.hasNext) &#123;</span><br><span class="line">    <span class="type">E</span> <span class="variable">item</span> <span class="operator">=</span> it.next;</span><br><span class="line">    <span class="keyword">if</span> (check(item)) &#123;</span><br><span class="line">        it.remove();</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但其实<code>Collection</code>接口定义了方法<code>removeIf</code>，我们需要实现的删除操作正可以用这个现成的方法来实现，而且看起来十分优雅。下面是<code>removeIf</code>的相关用法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">removeIf</span><span class="params">(Predicate&lt;? <span class="built_in">super</span> E&gt; filter)</span>;</span><br></pre></td></tr></table></figure><p>其中，<code>Predicate</code>是函数式接口，用于表示一个断言，该函数接受一个参数并返回布尔值。在 <code>removeIf</code> 方法中，传入一个 <code>Predicate</code> 类型的参数，表示要移除的元素需要满足的条件。若删除成功则返回真。</p><ol><li><p>可以使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mi mathvariant="script">a</mi><mi mathvariant="script">m</mi><mi mathvariant="script">b</mi><mi mathvariant="script">d</mi><mi mathvariant="script">a</mi></mrow><annotation encoding="application/x-tex">\mathcal{Lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">b</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span></span></span></span></span>表达式（允许把函数作为一个方法的参数）定义过滤条件</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">(parameters) -&gt; expression</span></span><br><span class="line"><span class="comment">或</span></span><br><span class="line"><span class="comment">(parameters) -&gt; &#123; statement; &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//比如删除所有的NoticeMessage</span></span><br><span class="line">messages.removeIf(message -&gt; message <span class="keyword">instanceof</span> MyNoticeMessage);</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除emojiList中emojiHeatList不存在的key</span></span><br><span class="line">emojiList.removeIf(emoji -&gt; !emojiHeatList.containsKey(emoji));</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除emojiList中emojiHeatList存在的key（方法引用）</span></span><br><span class="line">emojiList.removeIf(emojiHeatList::containsKey);</span><br></pre></td></tr></table></figure></li><li><p>自定义一个实现<code>Predicate</code>接口的类来定义过滤条件</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Collection&lt;E&gt; collection = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">collection.removeIf(<span class="keyword">new</span> <span class="title class_">Predicate</span>&lt;E&gt;() &#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">test</span><span class="params">(...)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ol><h2 id="性能与bug修复">性能与bug修复</h2><p>本单元一个最大的优化就是实现了并查集的延迟重建功能。</p><p>其实<code>hw9</code>的时候我想着因为有删边，不管怎样处理都要<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>，所以直接无脑重建（想的是反正最多是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>E</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(E^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>而且时限<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">10s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord mathdefault">s</span></span></span></span>），但是由于<code>load_network</code>指令的存在，第一次作业数据范围给的就显得有点大了（虽然后面改小了，虽然强测<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>掉的点打赢复活赛了）。所以后面两次作业改成了延迟重建的并查集。</p><p>然后就是<code>hw10</code>强测和互测的bug，其实挺不应该的，<code>queryTagValueSum</code>直接写的双重循环计算。<s>但是我这么做也是有理由的，你听我慢慢狡辩</s>。首先是当时维护<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">ValueSum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span></span></span></span>的过程出了一点麻烦，一直没搞清楚哪里出了问题，并且由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">U</mi><mi mathvariant="script">n</mi><mi mathvariant="script">i</mi><mi mathvariant="script">t</mi></mrow><annotation encoding="application/x-tex">\mathcal{JUnit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span></span>中测也只有两次机会了；然后翻了翻<code>hw9</code>打赢复活赛的点，发现只给了一千条左右的指令，想着课程组还挺良心的嘛，数据确实有梯度😃。</p><p>总之最后还是懒了，没改原来的双重循环，结果强测（一万条指令）和互测人直接被卡晕掉了。<s>这波被课程组狠狠背刺了。</s></p><p><code>hw11</code>互测出了bug，就是上文提到的十分隐蔽的关于延迟重建的并查集的合并细节，收回伏笔了属于是。</p><hr><p>对于规格与实现分离的理解，其实已经体现在架构设计中了。</p><p>设计一些规格之外的方法，辅助业务代码的实现；而这其中又可以灵活采用合适的算法、数据结构等。</p><hr><p>总的来说，这单元做得不是很好吧，本来轻松可以避免的bug没有去做，感觉经历了上个单元电梯的拷打、两次作业费尽心思写影子电梯但最终都没有做到完美，和这单元又碰上<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>，整个人有点懒了。</p><p>但是不管怎么说，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mi mathvariant="script">O</mi></mrow><annotation encoding="application/x-tex">\mathcal{OO}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span></span></span></span>课程要进入最后一个单元了，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>b</mi><mi>u</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">debug</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span>能力（指狼狈地修复bug时）还是一如既往地在线。</p><h2 id="junit测试">JUnit测试</h2><p>上学期<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mi mathvariant="script">O</mi><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{OOP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></span>的时候已经品尝过了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">U</mi><mi mathvariant="script">n</mi><mi mathvariant="script">i</mi><mi mathvariant="script">t</mi></mrow><annotation encoding="application/x-tex">\mathcal{JUnit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span></span>，当时感觉是真的鸡肋，也不好写。</p><p>这单元学了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>和怎么对规格进行测试，（<s>虽然可能是装模作样地在测试规格</s>）感觉又还行了。</p><p>主要还是模仿实验课上的代码，使用<code>Parameters</code>生成数据搭建<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">U</mi><mi mathvariant="script">n</mi><mi mathvariant="script">i</mi><mi mathvariant="script">t</mi></mrow><annotation encoding="application/x-tex">\mathcal{JUnit}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span></span>测试框架，如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(Parameterized.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetworkTest</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MyNetwork myNetwork;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyNetworkTest</span><span class="params">(MyNetwork myNetwork)</span> &#123; <span class="built_in">this</span>.myNetwork = myNetwork; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Parameters</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Collection <span class="title function_">prepareData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">testNum</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        Object[][] objects = <span class="keyword">new</span> <span class="title class_">Object</span>[testNum][];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; testNum; ++k) &#123;</span><br><span class="line">            <span class="comment">//do something, such as generating network by implementation functions</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Arrays.asList(objects);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">oneFuction</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        测试对应方法是否满足规格要求</span></span><br><span class="line"><span class="comment">        如pure, ensures, signals等</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="心得体会">心得体会</h2><p>这单元的学习，算是让我了解到了“契约式编程”这一思想吧，其实这单元照着规格实现代码的时候，我还是感觉挺受用的（雾，然后还是挺期待以后大项目的实践中能够真正接触到它。</p><p>然后其他的体会，前文写了很多，这里就不再说了。</p><p>最后关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">J</mi><mi mathvariant="script">M</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{JML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.18472em;">J</span><span class="mord mathcal">M</span><span class="mord mathcal">L</span></span></span></span></span>，其实我没什么意见，助教们写的推送给我帮助很大，感谢十分用心的助教们。</p>]]></content>
      
      
      <categories>
          
          <category> BUAA面向对象设计与构造 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OO-2024-Unit2</title>
      <link href="/f7382931.html"/>
      <url>/f7382931.html</url>
      
        <content type="html"><![CDATA[<h2 id="同步块与锁">同步块与锁</h2><p>在本单元的设计中，考虑到对性能的影响不大（请求数量级为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">10^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>），以及为了更简单地保证共享资源时的线程安全，绝大部分情况下我是用<code>synchronized</code>给方法加锁（即锁住对应实例）。</p><p>其余部分为了实现其他的互斥操作或者线程同步操作，如将进行重置操作后的乘客“遣返”回主请求队列、进行影子电梯模拟、双轿厢离开交换楼层时通知另一个轿厢，则会使用<code>synchronized (...) &#123;&#125;</code>进行上锁。</p><p>需要注意的是，后者加锁方式必须仔细考虑获取锁的时候是否会造成死锁问题，也可以使用<code>ReentrantLock</code>的<code>tryLock()</code>方法避免这一问题，此处先按下不表。</p><p>总之，在进行多线程同步设计时，需要对线程间的协作和资源的共享情况有一个清醒的认知。</p><h2 id="架构设计迭代">架构设计迭代</h2><h3 id="hw5">hw5</h3><h4 id="基本思路">基本思路</h4><p>主要采用了<code>生产者-消费者</code>设计模式，一方面输入线程<code>InputThread</code>不断“生产”请求，另一方面将这些请求经由调度器<code>Dispatcher</code>分发给一个合适的电梯线程<code>Elevator</code>去处理。</p><p>由于这次作业指定了每个乘客乘坐的电梯，故最开始<s>没有单独设计</s><code>Dispatcher</code>，直接分给对应的电梯就好了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (mainRequestQueue.isEmpty() &amp;&amp; mainRequestQueue.isEnd()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">6</span>; ++i) &#123;</span><br><span class="line">            requestQueues.get(i - <span class="number">1</span>).setEndFlag(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> mainRequestQueue.getOneRequestAndRemove();</span><br><span class="line">    <span class="keyword">if</span> (person == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;<span class="comment">//跳过</span></span><br><span class="line">    &#125;</span><br><span class="line">    requestQueues.get(person.getElevatorId() - <span class="number">1</span>).addRequest(person);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>至于电梯的运行策略，采用了主流且效率高的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi><mi mathvariant="script">O</mi><mi mathvariant="script">O</mi><mi mathvariant="script">K</mi></mrow><annotation encoding="application/x-tex">\mathcal{LOOK}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mord mathcal" style="margin-right:0.01445em;">K</span></span></span></span></span>策略，具体流程和实现如下：</p><ul><li>首先规定电梯初始运行方向（由于所有电梯初始停在一楼，故方向设为向上<code>direction = true</code>），然后沿此方向移动</li><li>到达某楼层后，根据电梯内外乘客情况，判断是否需要进行开关门操作<ul><li>如果有人达到目的地（这里为了方便设置了一个以楼层为Key的HashMap来记录），则开门</li><li>如果该楼层有人，方向与电梯相同且不超载，则开门</li></ul></li><li>接着判断电梯中是否还有人，有则继续移动，没有则检查请求队列<ul><li>队列为空，若<code>endFlag</code>为真则电梯停止工作，否则等待请求输入和分配</li><li>不为空，且存在请求的出发地为此时电梯运行的前方，则继续移动；若所有请求都在相反的方向，则调头</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Advice <span class="title function_">getAdvice</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (canOpenForOut() || canOpenForIn()) &#123;</span><br><span class="line">        <span class="keyword">return</span> Advice.OPEN;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (curNumber != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Advice.MOVE;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.requestQueue.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.requestQueue.isEnd()) &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.END;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.WAIT;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (haveSameDirection()) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.MOVE;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.REVERSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hw6">hw6</h3><h4 id="基本思路">基本思路</h4><p>采用两级调度器进行调度，一级调度器即<code>dispatcher</code>，使用<strong>影子电梯</strong>模拟局部最优解，将请求分给最合适的电梯；二级调度器即电梯运行策略<code>strategy</code>，与之前基本保持不变。（新增<code>RESET</code>动作）</p><p>设置乘客请求达到的顺序<code>order</code>，按照先来后到的顺序进行分配和接送：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Integer.compare(<span class="built_in">this</span>.order, person.order);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestQueue</span> &#123;<span class="comment">//主请求队列</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PriorityQueue&lt;Person&gt; requests;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> PriorityQueue&lt;Person&gt; requestQueue;</span><br></pre></td></tr></table></figure><p>为每个电梯增加一个等待队列<code>waitingQueue</code>，用于暂存重置期间被分配的乘客，重置完成后再将其加入<code>requestQueue</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Person person : waitingQueue) &#123;</span><br><span class="line">    TimableOutput.println(String.format(<span class="string">&quot;RECEIVE-%d-%d&quot;</span>, person.getPersonId(), id));</span><br><span class="line">    requestQueue.add(person);</span><br><span class="line">&#125;</span><br><span class="line">waitingQueue.clear();</span><br></pre></td></tr></table></figure><p>主请求队列end条件变为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isEnd</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.endFlag &amp;&amp; resetCount == <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//新增resetCount确保所有reset都已完成</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="架构调整">架构调整</h4><p>另外，在进行hw6的bug修复时，借鉴讨论区大佬的思路，对架构进行了一些调整——将电梯的运行状态与线程分离开来，单独设计一个处理器类<code>ProcessingUnit</code>。</p><p>为了读取电梯的状态实现影子电梯的模拟，电梯的运行状态成了电梯和调度器的<strong>共享资源</strong>。所以为了整体架构和各部分职责看起来更清晰明了，选择将电梯的运行状态与线程分离开来。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Elevator</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ProcessingUnit processingUnit;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Elevator</span><span class="params">(ProcessingUnit processingUnit)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.processingUnit = processingUnit;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (processingUnit.execute() == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hw7">hw7</h3><h4 id="基本思路">基本思路</h4><p>主要是对于双轿厢进行的调整，不过规定了重置为双轿厢之后就不得再重置，倒是省去了不少麻烦。</p><p>然后是主请求队列end条件变为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isEnd</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.endFlag &amp;&amp; resetCount == <span class="number">0</span> &amp;&amp; peopleCount == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="双轿厢设计">双轿厢设计</h4><ul><li>开始时就创建12个电梯线程，1-6为A轿厢，7-12为B轿厢（未重置时处于<code>Advice.WAIT</code>状态）</li><li>A轿厢完成双轿厢重置后，再去唤醒B轿厢，使得重置完成<strong>同步</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isDoubleCar.equals(<span class="string">&quot;-B&quot;</span>) &amp;&amp; resetFlag) &#123;</span><br><span class="line">    startTime = System.currentTimeMillis();</span><br><span class="line">    checkResetFlag();<span class="comment">//等待唤醒</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//---------------</span></span><br><span class="line"><span class="keyword">if</span> (transferFloor != <span class="number">0</span>) &#123;</span><br><span class="line">    isDoubleCar = <span class="string">&quot;-A&quot;</span>;</span><br><span class="line">    curFloor = transferFloor - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">synchronized</span> (anotherCar) &#123;</span><br><span class="line">        anotherCar.notify();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>值得注意是，我设置了<code>isDoubleCar</code>这一属性来区分双轿厢和解决输出问题（初始为NULL），而A轿厢释放乘客时还未完成重置，此时还不能将这一属性改为<code>-A</code>。</p><p>同时，如果某次模拟的时候正在进行双轿厢重置，别忘了设置影子电梯的当前楼层为<code>transferFloor + 1</code>。</p><ul><li>在双轿厢中设置共享对象<code>Flag</code>，处理相撞问题</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!isDoubleCar.isEmpty() &amp;&amp; curFloor == transferFloor) &#123;</span><br><span class="line">    <span class="keyword">if</span> (flag.getState()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wait();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flag.setOccupied(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//进入前等待另一轿厢离开</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!isDoubleCar.isEmpty() &amp;&amp; tempFloor == transferFloor) &#123;</span><br><span class="line">    flag.setOccupied(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">if</span> (isDoubleCar.equals(<span class="string">&quot;-B&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wait(<span class="number">5</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">synchronized</span> (anotherCar) &#123;</span><br><span class="line">        anotherCar.notify();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//离开后通知另一轿厢</span></span><br></pre></td></tr></table></figure><h3 id="最终架构">最终架构</h3><h4 id="类图">类图</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/New_diagram.png" alt="New_diagram"></p><h4 id="时序图">时序图</h4><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/seq.png" alt="seq"></p><h4 id="复杂度">复杂度</h4><table><thead><tr><th style="text-align:left">method</th><th>CogC</th><th>ev(G)</th><th>iv(G)</th><th>v(G)</th></tr></thead><tbody><tr><td style="text-align:left">Dispatcher.dispatch</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Dispatcher.Dispatcher</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Dispatcher.doubleCarReset</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Dispatcher.getBestElevator(Person)</td><td><strong>16.0</strong></td><td><strong>6.0</strong></td><td>8.0</td><td><strong>11.0</strong></td></tr><tr><td style="text-align:left">Dispatcher.normalReset(int, int, int)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Dispatcher.run()</td><td>9.0</td><td><strong>4.0</strong></td><td>5.0</td><td>6.0</td></tr><tr><td style="text-align:left">Dispatcher.simulate(ProcessingUnit, Person)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Elevator.Elevator(ProcessingUnit)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0s</td></tr><tr><td style="text-align:left">Elevator.run()</td><td>3.0</td><td>3.0</td><td>2.0</td><td>3.0</td></tr><tr><td style="text-align:left">Flag.Flag()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Flag.getState()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Flag.setOccupied(boolean)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">InputThread.InputThread(RequestQueue, Dispatcher)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">InputThread.run()</td><td>9.0</td><td>3.0</td><td>5.0</td><td>6.0</td></tr><tr><td style="text-align:left">MainClass.init(RequestQueue)</td><td>4.0</td><td>1.0</td><td>3.0</td><td>4.0</td></tr><tr><td style="text-align:left">MainClass.main(String[])</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.compareTo(Person)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.deepClone()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.getDirection()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.getFromFloor()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.getPersonId()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.getToFloor()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.Person(int, int, int, int)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Person.setFromFloor(int)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.addRequest(Person)</td><td>4.0</td><td>1.0</td><td>3.0</td><td>3.0</td></tr><tr><td style="text-align:left">ProcessingUnit.canTake(int)</td><td>1.0</td><td>1.0</td><td>1.0</td><td>2.0</td></tr><tr><td style="text-align:left">ProcessingUnit.checkResetFlag()</td><td>2.0</td><td>1.0</td><td>2.0</td><td>3.0</td></tr><tr><td style="text-align:left">ProcessingUnit.clearTheElevator()</td><td>6.0</td><td>1.0</td><td>5.0</td><td>5.0</td></tr><tr><td style="text-align:left">ProcessingUnit.execute()</td><td>2.0</td><td>2.0</td><td>1.0</td><td>7.0</td></tr><tr><td style="text-align:left">ProcessingUnit.getAdvice()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.getRestTime()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.getTransferFloor()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.makeShadowElevator(ShadowElevator)</td><td>7.0</td><td>1.0</td><td>6.0</td><td>7.0</td></tr><tr><td style="text-align:left">ProcessingUnit.move()</td><td><strong>30.0</strong></td><td><strong>7.0</strong></td><td><strong>9.0</strong></td><td><strong>15.0</strong></td></tr><tr><td style="text-align:left">ProcessingUnit.openAndClose()</td><td><strong>30.0</strong></td><td><strong>6.0</strong></td><td><strong>12.0</strong></td><td><strong>16.0</strong></td></tr><tr><td style="text-align:left">ProcessingUnit.ProcessingUnit(int, RequestQueue, PriorityQueue, ArrayList)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.reset()</td><td>12.0</td><td><strong>4.0</strong></td><td>7.0</td><td>9.0</td></tr><tr><td style="text-align:left">ProcessingUnit.setDoubleCar(String, int, int, int, ProcessingUnit)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.setEndFlag(boolean)</td><td>1.0</td><td>1.0</td><td>2.0</td><td>2.0</td></tr><tr><td style="text-align:left">ProcessingUnit.setFlag(Flag)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ProcessingUnit.setResetFlag(boolean, int, int)</td><td>1.0</td><td>1.0</td><td>2.0</td><td>2.0</td></tr><tr><td style="text-align:left">ProcessingUnit.waitRequest()</td><td>6.0</td><td>2.0</td><td>5.0</td><td>6.0</td></tr><tr><td style="text-align:left">RequestQueue.addRequest(Person)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.addReset()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.finishOneRequest()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.finishOneReset()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.getOneRequestAndRemove()</td><td>6.0</td><td>3.0</td><td>3.0</td><td>7.0</td></tr><tr><td style="text-align:left">RequestQueue.isEmpty()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.isEnd()</td><td>1.0</td><td>1.0</td><td>1.0</td><td>3.0</td></tr><tr><td style="text-align:left">RequestQueue.RequestQueue()</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">RequestQueue.setEndFlag(boolean)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ShadowElevator.addPerson(Person)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ShadowElevator.canTake(int)</td><td>1.0</td><td>1.0</td><td>1.0</td><td>2.0</td></tr><tr><td style="text-align:left">ShadowElevator.move()</td><td>4.0</td><td>1.0</td><td>1.0</td><td>4.0</td></tr><tr><td style="text-align:left">ShadowElevator.openAndClose()</td><td>12.0</td><td><strong>4.0</strong></td><td>5.0</td><td>8.0</td></tr><tr><td style="text-align:left">ShadowElevator.reset()</td><td>1.0</td><td>1.0</td><td>2.0</td><td>2.0</td></tr><tr><td style="text-align:left">ShadowElevator.run(Person)</td><td>3.0</td><td>1.0</td><td>2.0</td><td>7.0</td></tr><tr><td style="text-align:left">ShadowElevator.setAttributes(int, int, int, int, int)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ShadowElevator.setAttributes(String, int, int, int, int, boolean)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">ShadowElevator.setQueue(int, PriorityQueue, ArrayList, HashMap&gt;, boolean)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Strategy.canOpenForIn(int, int, boolean, int)</td><td>5.0</td><td><strong>4.0</strong></td><td>3.0</td><td>5.0</td></tr><tr><td style="text-align:left">Strategy.canOpenForOut(int, HashMap&gt;)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr><tr><td style="text-align:left">Strategy.getAdvice(int, int, boolean, int, HashMap&gt;, boolean, boolean, …)</td><td>15.0</td><td><strong>7.0</strong></td><td>3.0</td><td>9.0</td></tr><tr><td style="text-align:left">Strategy.haveSameDirection(int, boolean)</td><td>3.0</td><td>3.0</td><td>2.0</td><td>3.0</td></tr><tr><td style="text-align:left">Strategy.Strategy(PriorityQueue)</td><td>0.0</td><td>1.0</td><td>1.0</td><td>1.0</td></tr></tbody></table><p>可以看到，为了保证性能、处理轿厢相撞问题，复杂度主要在电梯的<code>openAndClose</code>、<code>move</code>出现了超标，这也算是符合预期吧。不过总的来说，感觉最后的架构还是十分清晰的，各部分内容较好地做到了高内聚低耦合、职责分明。</p><h2 id="关于影子电梯">关于影子电梯</h2><h3 id="基本步骤">基本步骤</h3><ul><li>深克隆电梯状态</li><li>模拟电梯运行过程得到最优电梯</li><li>将请求分给对应电梯</li></ul><h3 id="需要注意的问题">需要注意的问题</h3><p>为了模拟结果的准确，我们必须获取到在进行分配的那一刻的所有电梯的状态，并且模拟过程中所有电梯都不能运行。</p><p>但是电梯是一刻不停地持锁在运作的，如果要等待每个电梯完成当前动作，那分配过程将会迟迟无法结束，这是完全不能接受的。所以选择将<code>sleep</code>改为<code>wait</code>，让电梯在模拟时间消耗时将锁释放出。这样调度器线程和电梯线程交替获取和释放锁，便可以在性能损失最小的情况下解决这一问题。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">curTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"><span class="keyword">while</span> (System.currentTimeMillis() &lt; curTime + <span class="number">400</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        wait(curTime + <span class="number">400</span> - System.currentTimeMillis());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不过这个时候又有新的问题产生，那就是电梯当前动作没有执行完，<strong>状态没有稳定下来</strong>，就可能导致模拟结果的不准确。为了解决这个问题，我在影子电梯中保留了当前的状态（如<code>resetFlag</code>等），让影子电梯将当前作业也完整地模拟一遍，同时记录电梯进行当前动作已经花费的时间（若需要花费），最后从总时间中减去，便可得到较为精确模拟的结果。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">long</span> <span class="title function_">getRestTime</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> System.currentTimeMillis() - <span class="built_in">this</span>.startTime;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//dispatcher</span></span><br><span class="line"><span class="keyword">if</span> (advice.equals(Advice.RESET) || advice.equals(Advice.MOVE) ||</span><br><span class="line">        advice.equals(Advice.OPEN)) &#123;</span><br><span class="line">    spendTime -= processingUnits.get(i - <span class="number">1</span>).getRestTime();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="bug分析">bug分析</h2><p>第一次作业强测和互测均未出现问题。</p><p>第二次作业深克隆的时候没有去获取所有电梯的锁，线程安全出了大问题，本地没有做好足够的测试掉以轻心了。结果强测错两个点，互测更是被刀烂了。后来bug修复了时候进行了一些小重构，也使得架构更加清晰。</p><p>第三次作业出现了死锁问题。具体来说，为了避免双轿厢电梯相撞，设置了共享对象Flag，当轿厢将进入交换层时，若Flag被占则<strong>wait</strong>；当轿厢离开时，取消占领并<strong>notify</strong>另一轿厢。</p><p>但是在影子电梯的实现过程中需要依次获取总计12个电梯的锁（1-6为下层轿厢，7-12位上层），若已经获取了<strong>i-A</strong>电梯的锁，而<strong>i-B</strong>尝试进行上文所述唤醒操作时，则不可避免地会产生死锁。</p><p>为解决这个问题而不进行大的调整（改用<code>ReentrantLock</code>），将影子电梯中获取锁的顺序改为同一电梯井的顺序而非电梯编号顺序；同时若<strong>i-B</strong>尝试唤醒，先令其<strong>wait(5)</strong>，将可能被需要的锁短暂地交出。</p><h2 id="心得体会">心得体会</h2><p>本单元无疑是巨大的失败，后两次强测均有bug，归根结底还是因为没有做<strong>充分的测试</strong>和对多线程协作理解不够深。不过在修复bug的过程中，我也开始对如何设置同步块和锁的获取顺序以防止死锁等问题，有了更多的思考与体会。</p><p>另外，影子电梯虽然给我带来了不少bug，但最后实现了以后还是挺赏心悦目的，然后<s>debug能力也更进一步了</s></p>]]></content>
      
      
      <categories>
          
          <category> BUAA面向对象设计与构造 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUAA-OO-2024-Unit1</title>
      <link href="/6e31788b.html"/>
      <url>/6e31788b.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言">前言</h2><div class="note success modern"><p>随着第三次作业的强测结果公布，这一单元的学习也接近了尾声。从开始的迷茫和手足无措，到最后可以拿出一份层次清晰、结构完整代码，我开始对作业所要求的层次化设计思想有了一定感觉，也体会到编写代码时各个类之间做到有效协同、职责分派之后带来的高效和美观。这些也离不开许多同学在讨论区的想法分享和往年学长学姐的经验总结。下面我将以我的学习总结和心得体会为第一单元的学习画上一个句号。</p></div><h2 id="程序架构分析">程序架构分析</h2><p>得益于课程组大力提倡的<emp>递归下降法</emp>和实验课提供的demo，以及同学在讨论区的各式各样的想法分享，我能够在开始时就采用一个比较优秀的架构，所以本单元迭代过程中基本没有大的重构。因此关于代码架构的分析就以hw3的代码为主了。</p><h3 id="整体架构">整体架构</h3><p>首先根据题目的形式化表述，可以很自然地建出<code>Expr -&gt; Term -&gt; Factor</code>这样一个结构，而其中<code>Factor</code>又可以根据不同情况建立不同子类。将读入经过预处理之后，在使用递归下降的方法就可以清晰地将表达式解析开来。</p><p>接下来对于表达式的展开主要借鉴了<a href="http://oo.buaa.edu.cn/assignment/503/discussion/1463">zyt同学的思路</a>，从由若干基本单元组成的多项式的输出结果出发，考虑将从原始表达式解析出来的东西化归为统一的形式——即<code>Poly</code>类，然后在此类中依据题目要求定义不同运算方法。同时，将<code>Factor</code>定义为包含<code>toPoly()</code>接口的抽象类，也就可以沿着上述的结构递归地返回展开结果。最后在<code>Poly</code>类中重写<code>toString</code>即可进行结果的输出。</p><p>另外，关于自定义函数的处理，我采用了字符串替换的形式，将使用<code>parseFactor</code>方法得到的实参代入形成新的表达式，然后调用<code>parseExpr</code>即可。不用额外去考虑函数的嵌套，因为这样的递归结构已经就可以处理这个问题（就如同处理嵌套的括号一样）。</p><p>而对于导数的处理，我没有递归地返回各类因子求导结果，而是直接把求导看成一种运算，最后通过<code>toPoly</code>得到标准形式后再调用一次<code>Poly</code>中的求导方法即可。</p><p>具体的<code>UML</code>图如下</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/Snipaste_2024-03-22_21-12-09.png" alt="UML图"></p><h3 id="代码规模分析">代码规模分析</h3><div class="note info flat"><p>采用插件<code>Statistic</code></p></div><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image-20240323154417186.png" alt=""></p><p>可以看到总体的规模并不大，除去用于优化输出结果的部分，整份代码的实际行数也就不到600行。</p><p>其中多项式<code>Poly</code>类和基础单元<code>Unit</code>类占据了主要的部分，这也符合上述代码架构的逻辑。</p><h3 id="代码复杂度分析">代码复杂度分析</h3><div class="note info flat"><p>采用插件<code>MetricsReloaded</code>分析，其中所用度量标准如下：</p></div><ul><li><code>CogC</code>: 方法的认知复杂度。</li><li><code>ev(G)</code>：方法的基本圈复杂度，衡量程序非结构化程度，表示真正增加程序路径数目的条件分支。</li><li><code>iv(G)</code>：方法的设计复杂度，设计复杂度高意味模块耦合度高，这将导致模块难于隔离、维护和复用。</li><li><code>v(G)</code>：方法的独立路径的条数。</li><li><code>OCavg</code>：类的平均操作复杂度</li><li><code>OCmax</code>：类的最大操作复杂度</li><li><code>WMC</code>：类的加权方法复杂度</li></ul><p>其中超标的部分用粗体标出。</p><table><thead><tr><th style="text-align:left">method</th><th>CogC</th><th>ev(G)</th><th>iv(G)</th><th>v(G)</th></tr></thead><tbody><tr><td style="text-align:left">ConFactor.ConFactor(BigInteger)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">ConFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Definer.addFunc(String)</td><td>3</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Definer.callFunc(String, ArrayList&lt;Factor&gt;)</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">DerFactor.DerFactor(Expr)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">DerFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">ExpFactor.ExpFactor(BigInteger, Expr)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">ExpFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Expr.Expr()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Expr.addTerm(Term)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Expr.toPoly()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">ExprFactor.ExprFactor(Expr, int)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">ExprFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">FuncFactor.FuncFactor(String, ArrayList&lt;Factor&gt;)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">FuncFactor.getExpr()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">FuncFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Lexer.Lexer(String)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Lexer.getNumber()</td><td>2</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Lexer.next()</td><td>3</td><td>2</td><td>2</td><td>3</td></tr><tr><td style="text-align:left">Lexer.peek()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">MainClass.main(String[])</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Parser.Parser(Lexer)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Parser.parseConFactor()</td><td>2</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Parser.parseDerFactor()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Parser.parseExpFactor()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Parser.parseExpr()</td><td>7</td><td>1</td><td>6</td><td>6</td></tr><tr><td style="text-align:left">Parser.parseExprFactor()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Parser.parseFactor()</td><td>7</td><td><strong>6</strong></td><td>8</td><td>8</td></tr><tr><td style="text-align:left">Parser.parseFuncFactor()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Parser.parseTerm(int)</td><td>3</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Parser.parseVarFactor()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Poly.Poly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.Poly(BigInteger)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.Poly(BigInteger, BigInteger)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.Poly(Poly, BigInteger)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.Poly(int)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.addPoly(Poly)</td><td>8</td><td>1</td><td>6</td><td>6</td></tr><tr><td style="text-align:left">Poly.derivation()</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Poly.equals(Object)</td><td>3</td><td>3</td><td>2</td><td>4</td></tr><tr><td style="text-align:left">Poly.getGcd()</td><td>4</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Poly.hashCode()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.isEmpty()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Poly.isMono(BigInteger)</td><td>2</td><td>3</td><td>2</td><td>3</td></tr><tr><td style="text-align:left">Poly.mulPoly(Poly)</td><td>9</td><td>1</td><td>6</td><td>6</td></tr><tr><td style="text-align:left">Poly.powPoly(int)</td><td>6</td><td>1</td><td>4</td><td>4</td></tr><tr><td style="text-align:left">Poly.toString(BigInteger)</td><td><strong>16</strong></td><td>3</td><td><strong>9</strong></td><td>9</td></tr><tr><td style="text-align:left">Processor.preprocess(String)</td><td>2</td><td>1</td><td>5</td><td>5</td></tr><tr><td style="text-align:left">Term.Term(int)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Term.addFactor(Factor)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Term.toPoly()</td><td>2</td><td>1</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Unit.Unit()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.Unit(BigInteger)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.Unit(BigInteger, Poly)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.Unit(Poly)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.derivation(BigInteger)</td><td>4</td><td>2</td><td>3</td><td>3</td></tr><tr><td style="text-align:left">Unit.equals(Object)</td><td>3</td><td>3</td><td>2</td><td>4</td></tr><tr><td style="text-align:left">Unit.expToString()</td><td>7</td><td>1</td><td>3</td><td>4</td></tr><tr><td style="text-align:left">Unit.hashCode()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.isMono(BigInteger, BigInteger)</td><td>6</td><td><strong>4</strong></td><td>4</td><td>7</td></tr><tr><td style="text-align:left">Unit.mulUnit(Unit)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">Unit.toString(BigInteger)</td><td><strong>24</strong></td><td>1</td><td><strong>13</strong></td><td><strong>13</strong></td></tr><tr><td style="text-align:left">VarFactor.VarFactor(int)</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left">VarFactor.toPoly()</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td style="text-align:left"><strong>Total</strong></td><td>131</td><td>81</td><td>143</td><td>153</td></tr><tr><td style="text-align:left">Average</td><td>2.08</td><td>1.29</td><td>2.27</td><td>2.43</td></tr></tbody></table><table><thead><tr><th style="text-align:left">class</th><th>OCavg</th><th>OCmax</th><th>WMC</th></tr></thead><tbody><tr><td style="text-align:left">ConFactor</td><td>1.00</td><td>1</td><td>2</td></tr><tr><td style="text-align:left">Definer</td><td>2.50</td><td>3</td><td>5</td></tr><tr><td style="text-align:left">DerFactor</td><td>1.00</td><td>1</td><td>2</td></tr><tr><td style="text-align:left">ExpFactor</td><td>1.00</td><td>1</td><td>2</td></tr><tr><td style="text-align:left">Expr</td><td>1.33</td><td>2</td><td>4</td></tr><tr><td style="text-align:left">ExprFactor</td><td>1.00</td><td>1</td><td>2</td></tr><tr><td style="text-align:left">FuncFactor</td><td>1.00</td><td>1</td><td>3</td></tr><tr><td style="text-align:left">Lexer</td><td>1.75</td><td>3</td><td>7</td></tr><tr><td style="text-align:left">MainClass</td><td>2.00</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Parser</td><td>2.70</td><td>6</td><td>27</td></tr><tr><td style="text-align:left">Poly</td><td>2.87</td><td>9</td><td><strong>43</strong></td></tr><tr><td style="text-align:left">Processor</td><td>2.00</td><td>2</td><td>2</td></tr><tr><td style="text-align:left">Term</td><td>1.67</td><td>3</td><td>5</td></tr><tr><td style="text-align:left">Unit</td><td>3.00</td><td>13</td><td><strong>33</strong></td></tr><tr><td style="text-align:left">VarFactor</td><td>1.00</td><td>1</td><td>2</td></tr><tr><td style="text-align:left"><strong>Total</strong></td><td></td><td></td><td>141</td></tr><tr><td style="text-align:left">Average</td><td>2.24</td><td>3.27</td><td>9.40</td></tr></tbody></table><p>可以看到，复杂度的情况基本符合预期。两个类中重写的<code>toString</code>方法加入了对优化的处理和判断，从而导致复杂度飙升；而<code>isMono</code>也是用作优化处理，判断某个多项式是否为基本单元。另外，由于<code>parseFactor</code>中对不同因子分别单独处理，使用了大量串行分支判断，此处的优化可以学习<a href="https://blog.csdn.net/alpha_1st/article/details/136880632">zpy同学的总结</a>。</p><h2 id="架构设计体验">架构设计体验</h2><h3 id="从0到1">从0到1</h3><p>俗话说，万事开头难。由于第一周刚经历了假期，上学期先导课学习的内容有不少遗忘，且对于第一份作业眼花缭乱的形式化表述有些迷糊，我经历了好几天的迷茫。虽然通过不断地去看训练项目、实验课的代码和<code>oolen</code>上对递归下降的讲解，大概明白了递归下降的思想，但我还是感觉下不了手。凭借递归下降在给的demo上修修改改固然就能完成比较简单的第一次作业，但我还是没构思好该用什么样的一个架构，怎样去处理解析后得到的不同形式的部分，害怕搞个大的等到以后迭代时不得不remake。</p><p>很快就到了周五，而我还没开始敲一行代码。很感谢讨论区同学的无私分享，在看完zyt同学发的<a href="http://oo.buaa.edu.cn/assignment/503/discussion/1463">帖</a>后，我才算是有了一点头绪和对层次化的理解，尝试去将他展现出来的思路实现出来。</p><p>当我写完各个类的属性方法，补完预处理和解析的部分，整份代码居然就可以“神奇”地跑出结果来了（虽然由于解析部分的bug没有全过样例）。恍惚间，我开始体会到各个类之间“有效协同，职责分派”的魔力，每个类通过其管理的对象提供的行为来完成任务，每个方法立足类的属性数据来规划行为，从而将原本复杂的任务目标拆解成逻辑清晰、结构清楚的形式。同时，我也开始逐渐接受递归处理在面向对象过程中实现的作用。</p><hr><p>不过，由于第一次作业的基本单元较为简单<code>a*x^n</code>， 所以最开始时我没有建立单独的类去管理，直接将<code>系数-指数</code>这一键值对存入<code>Poly</code>中的map中。</p><p>对于预处理，我采用了以下的方法并同时处理了前导零（互测过后我才发现这是多余的，同时预处理我也是直接写在<code>main</code>中的）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">input = input.replaceAll(<span class="string">&quot;[ \t]&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (input.contains(<span class="string">&quot;+-&quot;</span>) || input.contains(<span class="string">&quot;-+&quot;</span>) ||</span><br><span class="line">        input.contains(<span class="string">&quot;++&quot;</span>) || input.contains(<span class="string">&quot;--&quot;</span>)) &#123;</span><br><span class="line">    input = input.replaceAll(<span class="string">&quot;\\+-|-\\+&quot;</span>, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">    input = input.replaceAll(<span class="string">&quot;\\+\\+|--&quot;</span>, <span class="string">&quot;+&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">input = input.replaceAll(<span class="string">&quot;\\^\\+&quot;</span>, <span class="string">&quot;^&quot;</span>);</span><br><span class="line">input = input.replaceAll(<span class="string">&quot;\\*\\+&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure><p>此时字符串中没有连续的正负号了，只剩开头和<code>(</code>后的正负号以及<code>*</code>后的负号需要处理。于是在<code>parseExpr</code>和<code>parseTerm</code>中加入处理，并在<code>Term</code>中增加了属性<code>sign</code>表示正负号，若为负，递归生成多项式的时候乘一项<code>-1</code>,即可解决这一问题。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//parseExpr</span></span><br><span class="line"><span class="type">Expr</span> <span class="variable">expr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Expr</span>();</span><br><span class="line"><span class="type">int</span> <span class="variable">sign</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (lexer.peek().equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">    sign = -<span class="number">1</span>;</span><br><span class="line">    lexer.next();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (lexer.peek().equals(<span class="string">&quot;+&quot;</span>)) &#123;</span><br><span class="line">    lexer.next();</span><br><span class="line">&#125;</span><br><span class="line">expr.addTerm(parseTerm(sign));</span><br><span class="line"><span class="keyword">while</span> (lexer.peek().equals(<span class="string">&quot;+&quot;</span>) || lexer.peek().equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> expr;</span><br><span class="line"></span><br><span class="line"><span class="comment">//parseTerm</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">while</span> (lexer.peek().equals(<span class="string">&quot;*&quot;</span>)) &#123;</span><br><span class="line">    lexer.next();</span><br><span class="line">    <span class="keyword">if</span> (lexer.peek().equals(<span class="string">&quot;-&quot;</span>)) &#123;</span><br><span class="line">        term.addFactor(<span class="keyword">new</span> <span class="title class_">ConFactor</span>(BigInteger.valueOf(-<span class="number">1</span>)));</span><br><span class="line">        lexer.next();</span><br><span class="line">    &#125;</span><br><span class="line">    term.addFactor(parseFactor());</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">    </span><br><span class="line"><span class="comment">//Term.toPoly()</span></span><br><span class="line"><span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(BigInteger.valueOf(<span class="number">1</span>));</span><br><span class="line"><span class="keyword">for</span> (Factor factor : factors) &#123;</span><br><span class="line">    poly = poly.mulPoly(factor.toPoly());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (sign == -<span class="number">1</span>) &#123;</span><br><span class="line">    poly = poly.mulPoly(<span class="keyword">new</span> <span class="title class_">Poly</span>(BigInteger.valueOf(-<span class="number">1</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> poly;</span><br></pre></td></tr></table></figure><h3 id="从第一次作业到第二次作业">从第一次作业到第二次作业</h3><div class="note info flat"><p>这一次作业新增了指数函数、自定义函数和嵌套的括号</p></div><p>这次作业是很痛苦的一次迭代，斟酌了很久怎么调整架构，debug也de到了昏天黑地。</p><p>首先是新增的指数函数使得之前基础单元需要改动，于是对于怎样定义新增类<code>Unit</code>的属性和处理它和<code>Poly</code>的关系，我又陷入了反复否定自己的思考。最后将信将疑地还是使用了递归定义的形式，并在敲下一行行代码后逐渐肯定了这一结构。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Poly</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Unit, BigInteger&gt; units;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Unit</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BigInteger exponent;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Poly poly;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着，为了进行同类项的合并，对这两个类重写了<code>equals</code>和<code>hashcode</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Unit</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Unit)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Unit</span> <span class="variable">unit</span> <span class="operator">=</span> (Unit) o;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.exponent.equals(unit.exponent) &amp;&amp; <span class="built_in">this</span>.poly.equals(unit.poly);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Objects.hash(<span class="built_in">this</span>.exponent, <span class="built_in">this</span>.poly);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Poly</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> (Poly) o;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.units.entrySet().equals(poly.units.entrySet());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Objects.hash(<span class="built_in">this</span>.units.entrySet());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>值得一提的是<code>Poly</code>中需要用<code>units</code>的键值对<code>entrySet()</code>而不是<code>keySet()</code>或者<code>valueSet()</code>。在这个地方de了好久，当时还以为是深浅拷贝出了问题。</p><p>有了以上基础之后，接着顺便把<code>Poly</code>中的方法重新写了一遍（包括构造函数和运算方法（这应该不算大的重构把）），也特别注意了第一次没在意的深浅拷贝问题。</p><hr><p>然后是对自定义函数的处理。因为形式化表述中看到参数也是因子，所以仿照表达式因子的处理方法，于是采用了字符串替换的递归处理方式，将展开得到的参数因子带入，得到新的表达式，解析并返回结果。</p><p>函数定义式的拆解使用了正则表达式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(<span class="string">&quot;([A-Za-z]+)\\(([A-Za-z,]+)\\)=(.+)&quot;</span>);</span><br><span class="line"><span class="comment">//存储变量和函数式子</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HashMap&lt;String, String&gt; funcMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HashMap&lt;String, ArrayList&lt;String&gt;&gt; varsMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br></pre></td></tr></table></figure><p>另外有几个需要注意的点，1）将式子中的变量<code>x</code>换成<code>_x</code>的形式，避免后续替换时对<code>exp</code>造成影响。2）带入参数需要在左右添加括号。（血泪教训）</p><hr><p>最后将预处理的过程写成了一个静态类，保留了一个清清爽爽的<code>main</code>函数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> Integer.parseInt(scanner.nextLine());</span><br><span class="line">    String input;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        input = Processor.preprocess(scanner.nextLine());</span><br><span class="line">        Definer.addFunc(input);</span><br><span class="line">    &#125;</span><br><span class="line">    input = Processor.preprocess(scanner.nextLine());</span><br><span class="line">    <span class="type">Lexer</span> <span class="variable">lexer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lexer</span>(input);</span><br><span class="line">    <span class="type">Parser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Parser</span>(lexer);</span><br><span class="line">    <span class="type">Expr</span> <span class="variable">expr</span> <span class="operator">=</span> parser.parseExpr();</span><br><span class="line">    <span class="type">String</span> <span class="variable">ans</span> <span class="operator">=</span> expr.toPoly().toString();</span><br><span class="line">    <span class="keyword">if</span> (ans.isEmpty()) &#123;</span><br><span class="line">        ans = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总之，这次迭代让我对整个架构有了更深的理解和体会。</p><h3 id="从第二次作业到第三次作业">从第二次作业到第三次作业</h3><div class="note info flat"><p>这次作业新增了求导因子<code>dx()</code>，以及函数定义时可以调用其他函数。</p></div><p>经历了上次迭代的痛苦，这次作业就可以说是“轻舟已过万重山”了。之前的架构已经比较完善了，而字符串替换的方法可以轻松解决自定义函数的调用。同时如果采用最后才进行一次求导的方法，求导因子也可以在<code>Poly</code>和<code>Unit</code>中增加对应的运算方法，从而得到解决。</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo>∗</mo><msup><mi>x</mi><mi>n</mi></msup><mo>∗</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>l</mi><mi>y</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>∗</mo><mi>n</mi><mo>∗</mo><msup><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>a</mi><mo>∗</mo><msup><mi>x</mi><mi>n</mi></msup><mo>∗</mo><mi>p</mi><mi>o</mi><mi>l</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>∗</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>l</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[a*x^n*\exp(poly)]&#x27; = (a*n*x^{n-1}+a*x^n*poly&#x27;)*\exp(poly)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.947438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//递归求导</span></span><br><span class="line"><span class="comment">//Poly</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">derivation</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Poly</span> <span class="variable">retPoly</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">it</span> <span class="operator">=</span> <span class="built_in">this</span>.units.keySet().iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">        <span class="type">Unit</span> <span class="variable">unit</span> <span class="operator">=</span> (Unit) it.next();</span><br><span class="line">        retPoly = retPoly.addPoly(unit.derivation(<span class="built_in">this</span>.units.get(unit)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retPoly;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Unit</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">derivation</span><span class="params">(BigInteger coefficient)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.poly.isEmpty()) &#123;</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">newExp</span> <span class="operator">=</span> <span class="built_in">this</span>.exponent;</span><br><span class="line">        <span class="keyword">if</span> (!newExp.equals(BigInteger.valueOf(<span class="number">0</span>))) &#123;</span><br><span class="line">            newExp = newExp.add(BigInteger.valueOf(-<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">newCoe</span> <span class="operator">=</span> coefficient.multiply(<span class="built_in">this</span>.exponent);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(newCoe, newExp);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(coefficient, <span class="built_in">this</span>.exponent);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(<span class="built_in">this</span>.poly, BigInteger.valueOf(<span class="number">1</span>)).mulPoly(</span><br><span class="line">                poly.derivation().addPoly(poly.mulPoly(<span class="built_in">this</span>.poly.derivation())));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此外，这次迭代增加了对<code>exp()</code>提取最大公因数的优化。需要注意的是<emp>不能直接在toString()中</emp>直接对要输出的系数进行修改。</p><h2 id="bug分析">bug分析</h2><p>本单元三次作业在中测、强测、互测中均未出现bug，算是安全过关了。这也要感谢大佬们搭建的评测机，尤其是第二次作业我好不容易终于写完了所有代码以后，帮我找到了解析过程中和处理自定义函数时的bug。</p><p>感觉自己的debug能力又提升了不少，大致谈一谈debug策略吧。</p><ul><li>首先是根据初始的数据（可能很大且复杂），尝试不断去除其中的部分，慢慢定位可以导致错误的部分</li><li>然后通过输出中间变量和各种调试语句去发现bug（<s>因为<code>IDEA</code>的调试我觉得实在是难用且费眼费脑</s>）</li><li>总之，定位了大概出错的区域，基本上就能将bug解决</li></ul><p>其实大部分还是写的过程中不细心导致的，除了集中注意力，也需要我们对自己的代码和架构了然于胸。</p><h2 id="hack分析">hack分析</h2><p>第一次作业由于比较基础简单，所以房内并未出现刀人情况。</p><p>第二次作业根据debug的经验和评测姬发现了房内同学的两个bug</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">f(x) = exp(x^+02)</span><br><span class="line">h(y , z , x) = ++exp(x)^+3</span><br><span class="line">++h(        ( f(x) ), ( f(x) ), f(x))</span><br><span class="line">//处理实参时没有注意因子定义，导致碰到括号时出错</span><br><span class="line">    </span><br><span class="line">1</span><br><span class="line">f(x,y)=-x^0-2*exp(x)*exp(y)</span><br><span class="line">f(exp(1),0)*exp(-1)</span><br><span class="line">//优化exp(0)出了问题</span><br></pre></td></tr></table></figure><p>第三次作业仍然是测出了以为同学不能处理好<code>exp(0)</code>的问题</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">g(z) = ++exp(0)+-1</span><br><span class="line">exp(g(x) )</span><br></pre></td></tr></table></figure><p>总之，如果想要成功出刀的话，需要对题目的要求有清楚的理解和一定的hack策略，比如：</p><ul><li>根据评测机数据构造能通过<code>cost</code>限制的同质bug数据</li><li>多进行<code>corner case</code>的测试</li><li>因为递归较多，可以进行合理范围内的压力测试</li></ul><p>在第三次作业时，因为没有利用好<code>cost</code>的限制，虽然有构造压力测试样例的想法，但最后因为不知道哪里触发了互测数据限制，浅尝辄止，浪费了出刀的好机会。这也是以后互测我需要注意改进的地方吧。</p><h2 id="优化分析">优化分析</h2><p>第一次作业基本没什么优化的空间，只有一个（基本的合并同类项就不提了）——尽量保证<code>Expr</code>的第一项系数为正（可以少一个符号）。</p><p>第二次作业引入指数函数后，事情便走向了不可控的境地。通过同学们的讨论发现基本没法做到最优，再加上那一周的迭代实在太过艰辛，于是放弃了这个方向的优化，只求能先保证正确性。于是只对<code>exp</code>的系数是否为<code>正负1</code>和指数是否为<code>0</code>，以及指数部分是否为不用添加括号的单项式（因子），进行了优化。</p><p>第三次作业虽然没有去搞各种复杂的拆分，但增加了提取最大公因数的优化，不过优得不是很化——没有把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>G</mi><mi>c</mi><mi>d</mi></mrow><mi>k</mi></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>⩽</mo><mi>k</mi><mo>⩽</mo><mn>9</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{Gcd}{k}(1 \leqslant k \leqslant 9)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83111em;vertical-align:-0.13667em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">9</span><span class="mclose">)</span></span></span></span>的情况都比较一遍，导致强测有一个点的性能分出现了一点点的负优化。</p><p>总之，虽然第三次做优化的时候很可惜为什么第二次不加上最大公约数的优化（那样就又可以多一点分了），但实际上做优化的时候又对优化带来的对正确性的bug de了好久，而且第二次作业de完bug感觉整个人的精神已经是强弩之末了，说不定反而会弄巧成拙。包括第三次作业做的优化，我自知肯定是卷不过那些优化仙人的（感觉也没必要），于是就对性价比最大的一部分进行了优化，这也算是一种<code>trade-off</code>吧。</p><h2 id="心得体会">心得体会</h2><p>对于我自身而言，第一单元的学习也带给了我很多关于面向对象构造的思考（其中一位同学发的帖也很令人深思 <a href="http://oo.buaa.edu.cn/assignment/505/discussion/1516">命令-查询分离原则</a>），对于如何将复杂问题进行层次分解和抽象，在之后的单元我还需要进行更多的学习和思考。</p><p>另外，我也需要注意对已有轮子的学习和使用，从而更多关注架构的设计。如本单元作业中，最开始对<code>BigInterger</code>不熟悉，合并同类项的<code>Merge</code>方法，优化时的处理有<code>compareTo</code>……</p><p>最后感谢上学期的<code>oopre</code>确实给我打下了一定的基础（否则不敢想我面对Unit 1的冲击会有多狼狈），也很感谢分享经验和搭建评测机的同学的帮助。</p><h2 id="未来方向">未来方向</h2><p>对于课程设计，我还是觉得对<code>exp</code>的拆分优化这些，这感觉已经不能算是化简了，而且以大量的运行时间换来了这样的长度的减少，感觉没有体现出性能二字意义何在。优化仙人们确实很厉害，但这部分的工作不是学好OO这门课必要的。</p>]]></content>
      
      
      <categories>
          
          <category> BUAA面向对象设计与构造 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023 BUAA CO review: P2</title>
      <link href="/5bad4d19.html"/>
      <url>/5bad4d19.html</url>
      
        <content type="html"><![CDATA[<!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=35&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=329&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=330&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=415&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=416&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=419&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=422&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=52&PieId=1109 --><!-- http://cscore.buaa.edu.cn/#/problem?ProblemId=53&PieId=1109 --><h2 id="mips汇编">MIPS汇编</h2><h3 id="一些常用宏">一些常用宏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">#  程序结束</span><br><span class="line">.macro end</span><br><span class="line">    li        $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">#--------------------------</span><br><span class="line"></span><br><span class="line"># 输入Integer</span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li        $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move    %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">#--------------------------</span><br><span class="line"></span><br><span class="line"># 输出Interger</span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li        $v0, 1</span><br><span class="line">    move    $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">#--------------------------</span><br><span class="line"></span><br><span class="line"># 输出字符串（包括换行和空格）</span><br><span class="line"># 值得一提的是，最好只使用&quot;.asciiz&quot;，因为它会字符串结尾添加一个结束符&#x27;\0&#x27;</span><br><span class="line">.data</span><br><span class="line">  StrName:  .asciiz &quot;……&quot;</span><br><span class="line">  # space:    .asciiz &quot; &quot;</span><br><span class="line">  # enter:    .asciiz &quot;\n&quot;</span><br><span class="line">.macro printStr()</span><br><span class="line">  li  $v0, 4</span><br><span class="line">  la  $a0, StrName    # 将输出字符串的地址赋给$a0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">#--------------------------</span><br><span class="line"></span><br><span class="line"># 保护和读取寄存器</span><br><span class="line"># 临时寄存器不够用 或 递归函数使用</span><br><span class="line">.macro push(%d)</span><br><span class="line">    sw        %d, 0($sp)</span><br><span class="line">    addi    $sp, $sp, -4</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro pop(%d)</span><br><span class="line">    addi    $sp, $sp, 4</span><br><span class="line">    lw        %d, 0($sp)</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">#--------------------------</span><br><span class="line"></span><br><span class="line"># 取二维数组下标地址</span><br><span class="line">.macro getIndex(%d, %m, %i, %j) # m为列</span><br><span class="line">    mul        %d, %m, %i</span><br><span class="line">    add        %d, %d, %j</span><br><span class="line">    sll        %d, %d, 2</span><br><span class="line">.end_macro</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="一些tips">一些tips</h3><ul><li>取用指令时，记得多查看指令集手册和<code>MARS</code>的帮助手册(快捷键<code>F1</code>)。</li></ul><div class="note info simple"><p>虽然<code>MARS</code>没有代码补全功能，但是书写指令的时候会有提示（格式和大概用法等等）<br>所以指令记个大概也没关系，比如利用<code>b-&gt;branch</code>,<code>g(t)-&gt;greater (than)</code>, <code>z-&gt;zero</code>等等可以很方便地写出多种多样的控制语句</p></div><ul><li>善用扩展指令 <code>li</code>,<code>la</code>,<code>move</code>等</li><li>灵活使用标签（并不一定要用来跳转）和缩进（，这样看起来能有一些层次感</li><li>函数的调用和递归函数<ul><li><code>jal</code>和<code>jr</code>配套</li><li>传参一般使用<code>$a0-$a3</code>，返回值<code>$v0-$v1</code></li><li>关于写递归函数的时候什么东西要入栈，什么不要，其实很简单，只需要把进行递归前后<strong>发生变化的</strong>、且<strong>寄存器中的值关系到后续（递归回来）使用</strong>的寄存器进行保存和恢复就好了</li><li>接上一条，进入函数的时候就先把要保存的进行入栈（包括<code>$ra</code>），然后在函数结束和<code>return</code>的地方进行出栈即可</li></ul></li><li>写一些必要的注释，标明寄存器保存的重要的变量和参数</li><li>可以将对应的C程序写出，再对着翻译</li></ul><h2 id="课下提交">课下提交</h2><h3 id="q1-p2-l0-matrix">Q1 P2_L0_matrix</h3><p>使用MIPS汇编语言编写一个具有矩阵相乘功能的汇编程序(不考虑延迟槽)。<br>具体要求：</p><ul><li>首先读取方形矩阵的阶数n，然后再依次读取第一个矩阵（n行n列）和第二个矩阵（n行n列）中的元素。</li><li>两个矩阵的阶数相同，我们提供的测试数据中0&lt;n≤8,每个矩阵元素是小于10的整数。</li><li>最终将计算出的结果输出，每行n个数据，每个数据间用空格分开。评测机会自动过滤掉行尾空格以及最后的回车。</li><li>使用<code>syscall</code>结束程序。</li></ul><hr><p>考察二维数组的使用</p><details class="folding-tag" cyan><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    arr1:    .space    256</span><br><span class="line">    arr2:    .space    256</span><br><span class="line">    arr3:    .space    256</span><br><span class="line">    space:    .asciiz    &quot; &quot;</span><br><span class="line">    enter:    .asciiz    &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">.macro end</span><br><span class="line">    li        $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li        $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move    %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro getIndex(%n, %d, %i, %j)</span><br><span class="line">    mul        %d, %i, %n</span><br><span class="line">    add        %d, %d, %j</span><br><span class="line">    sll        %d, %d, 2</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li        $v0, 1</span><br><span class="line">    move    $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printEnter()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, enter</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printSpace()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, space</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">main:</span><br><span class="line">    readInt($s0)</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_1:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_1</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_1:</span><br><span class="line">            beq        $t1, $s0, end_loop_j_1</span><br><span class="line">            getIndex($s0, $t2, $t0, $t1)</span><br><span class="line">            li        $v0, 5</span><br><span class="line">            syscall</span><br><span class="line">            sw        $v0, arr1($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_1</span><br><span class="line">        end_loop_j_1:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_1</span><br><span class="line">    end_loop_i_1:</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_2:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_2</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_2:</span><br><span class="line">            beq        $t1, $s0, end_loop_j_2</span><br><span class="line">            getIndex($s0, $t2, $t0, $t1)</span><br><span class="line">            li        $v0, 5</span><br><span class="line">            syscall</span><br><span class="line">            sw        $v0, arr2($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_2</span><br><span class="line">        end_loop_j_2:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_2</span><br><span class="line">    end_loop_i_2:</span><br><span class="line">    </span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_3:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_3</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_3:</span><br><span class="line">            beq        $t1, $s0, end_loop_j_3</span><br><span class="line">            getIndex($s0, $t5, $t0, $t1)</span><br><span class="line">            lw        $t5, arr3($t5)</span><br><span class="line">            li        $t2, 0</span><br><span class="line">            loop_k_1:</span><br><span class="line">                beq        $t2, $s0, end_loop_k_1</span><br><span class="line">                getIndex($s0, $t3, $t0, $t2)</span><br><span class="line">                getIndex($s0, $t4, $t2, $t1)</span><br><span class="line">                lw        $t3, arr1($t3)</span><br><span class="line">                lw        $t4, arr2($t4)</span><br><span class="line">                mult    $t3, $t4</span><br><span class="line">                mflo    $t3</span><br><span class="line">                add        $t5, $t5, $t3</span><br><span class="line">                addi    $t2, $t2, 1</span><br><span class="line">                j        loop_k_1</span><br><span class="line">            end_loop_k_1:</span><br><span class="line">            getIndex($s0, $t3, $t0, $t1)</span><br><span class="line">            sw        $t5, arr3($t3)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_3</span><br><span class="line">        end_loop_j_3:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_3            </span><br><span class="line">    end_loop_i_3:</span><br><span class="line">    </span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_4:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_4</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_4:</span><br><span class="line">            beq        $t1, $s0, end_loop_j_4</span><br><span class="line">            getIndex($s0, $t2, $t0, $t1)</span><br><span class="line">            lw        $t2, arr3($t2)</span><br><span class="line">            printInt($t2)</span><br><span class="line">            printSpace()</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_4</span><br><span class="line">        end_loop_j_4:</span><br><span class="line">        printEnter()</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_4</span><br><span class="line">    end_loop_i_4:</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="q2-p2-l0-judge">Q2 P2_L0_judge</h3><p>实现满足下面功能的汇编程序：</p><ol><li>判断输入的字符串是不是回文串。</li><li>输出一个字符，是回文串输出1，否则输出0</li><li>每组数据最多执行100,000条指令。</li><li>使用<code>syscall</code>结束程序</li></ol><hr><p>注意如果一次读取一个字符(<code>$v0 = 12</code>)，记得使用<code>lb</code>,<code>sb</code>进行存取使用</p><details class="folding-tag" green><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    array:    .space 20</span><br><span class="line"></span><br><span class="line">.macro end</span><br><span class="line">    li    $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li    $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readCh(%d)</span><br><span class="line">    li    $v0, 12</span><br><span class="line">    syscall</span><br><span class="line">    move %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">    readInt($s0)</span><br><span class="line">    li    $t0, 0</span><br><span class="line">    </span><br><span class="line">loop1:</span><br><span class="line">    beq    $t0, $s0, end_loop1</span><br><span class="line">    readCh($t1)</span><br><span class="line">    sb    $t1, array($t0)</span><br><span class="line">    addi $t0, $t0, 1</span><br><span class="line">    j    loop1</span><br><span class="line">    </span><br><span class="line">end_loop1:</span><br><span class="line">    li    $t0, 0</span><br><span class="line">    addi $t2, $s0, -1</span><br><span class="line">loop2:</span><br><span class="line">    beq $t0, $s0, end_loop2</span><br><span class="line">    lb    $t1, array($t0)</span><br><span class="line">    sub    $t3, $t2, $t0</span><br><span class="line">    lb    $t3, array($t3)</span><br><span class="line">    bne $t1, $t3, not_equal</span><br><span class="line">    addi $t0, $t0, 1</span><br><span class="line">    j    loop2</span><br><span class="line">    </span><br><span class="line">end_loop2:</span><br><span class="line">    li    $a0, 1</span><br><span class="line">    li    $v0, 1</span><br><span class="line">    syscall</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">not_equal:</span><br><span class="line">    li    $a0, 0</span><br><span class="line">    li    $v0, 1</span><br><span class="line">    syscall</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="q3-p2-l0-conv">Q3 P2_L0_conv</h3><p>使用MIPS汇编语言编写一个进行卷积运算的汇编程序(不考虑延迟槽)。<br>具体要求：</p><ul><li>首先读取待卷积矩阵的行数m1和列数n1，然后读取卷积核的行数m2和列数n2。</li><li>然后再依次读取待卷积矩阵(m1行n1列)和卷积核(m2行n2列)中的元素。</li><li>输出中，有m1-m2+1行，每行有n1-n2+1个数据，每个数据用空格分开。</li><li>卷积运算的定义:$$g(i, j) = \sum\limits_{k,l} f(i + k, j + l) \cdot h(k, l)$$其中f为待卷积矩阵，h为卷积核，g即为输出矩阵，k与l的终值分别为卷积核h的行大小、列大小。计算中不考虑边缘效应。</li><li>使用<code>syscall</code>结束程序</li></ul><hr><details class="folding-tag" yellow><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    arrf:        .space    400</span><br><span class="line">    arrh:        .space    400</span><br><span class="line">    arrg:        .space    400</span><br><span class="line">    space:        .asciiz    &quot; &quot;</span><br><span class="line">    enter:        .asciiz    &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">.macro end</span><br><span class="line">    li        $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li        $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move    %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li        $v0, 1</span><br><span class="line">    move    $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printEnter()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, enter</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printSpace()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, space</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro getIndex(%d, %n, %i, %j)</span><br><span class="line">    mul        %d, %n, %i</span><br><span class="line">    add        %d, %d, %j</span><br><span class="line">    sll        %d, %d, 2</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">main:</span><br><span class="line">    readInt($s0)</span><br><span class="line">    readInt($s1)</span><br><span class="line">    readInt($s2)</span><br><span class="line">    readInt($s3)</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_1:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_1</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_1:</span><br><span class="line">            beq        $t1, $s1, end_loop_j_1</span><br><span class="line">            getIndex($t2, $s1, $t0, $t1)</span><br><span class="line">            readInt($t3)</span><br><span class="line">            sw        $t3, arrf($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_1</span><br><span class="line">        end_loop_j_1:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_1</span><br><span class="line">    end_loop_i_1:</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_2:</span><br><span class="line">        beq        $t0, $s2, end_loop_i_2</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_2:</span><br><span class="line">            beq        $t1, $s3, end_loop_j_2</span><br><span class="line">            getIndex($t2, $s3, $t0, $t1)</span><br><span class="line">            readInt($t3)</span><br><span class="line">            sw        $t3, arrh($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_2</span><br><span class="line">        end_loop_j_2:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_2</span><br><span class="line">    end_loop_i_2:</span><br><span class="line">    move    $s6, $s1</span><br><span class="line">    sub        $s0, $s0, $s2</span><br><span class="line">    sub        $s1, $s1, $s3</span><br><span class="line">    addi    $s0, $s0, 1</span><br><span class="line">    addi    $s1, $s1, 1</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    </span><br><span class="line">    loop_i_3:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_3</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_3:</span><br><span class="line">            beq        $t1, $s1, end_loop_j_3</span><br><span class="line">            li        $t2, 0</span><br><span class="line">            getIndex($s4, $s1, $t0, $t1)</span><br><span class="line">            lw        $s5, arrg($s4)</span><br><span class="line">            loop_k_1:</span><br><span class="line">                beq        $t2, $s2, end_loop_k_1</span><br><span class="line">                li        $t3, 0</span><br><span class="line">                loop_l_1:</span><br><span class="line">                    beq        $t3, $s3, end_loop_l_1</span><br><span class="line">                    add        $t4, $t0, $t2</span><br><span class="line">                    add        $t5, $t1, $t3</span><br><span class="line">                    getIndex($t6, $s6, $t4, $t5)</span><br><span class="line">                    lw        $t6, arrf($t6)</span><br><span class="line">                    getIndex($t7, $s3, $t2, $t3)</span><br><span class="line">                    lw        $t7, arrh($t7)</span><br><span class="line">                    mult    $t6, $t7</span><br><span class="line">                    mflo    $t6</span><br><span class="line">                    add        $s5, $s5, $t6</span><br><span class="line">                    addi    $t3, $t3, 1</span><br><span class="line">                    j        loop_l_1</span><br><span class="line">                end_loop_l_1:</span><br><span class="line">                addi    $t2, $t2, 1</span><br><span class="line">                j        loop_k_1</span><br><span class="line">            end_loop_k_1:</span><br><span class="line">            sw        $s5, arrg($s4)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_3</span><br><span class="line">        end_loop_j_3:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_3</span><br><span class="line">    end_loop_i_3:</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_4:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_4</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_4:</span><br><span class="line">            beq        $t1, $s1, end_loop_j_4</span><br><span class="line">            getIndex($t2, $s1, $t0, $t1)</span><br><span class="line">            lw        $t2, arrg($t2)</span><br><span class="line">            printInt($t2)</span><br><span class="line">            printSpace()</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_4</span><br><span class="line">        end_loop_j_4:</span><br><span class="line">        printEnter()</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_4</span><br><span class="line">    end_loop_i_4:</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="q4-p2-l0-full-1">Q4 P2_L0_full_1</h3><p>实现满足下面功能的汇编程序：</p><ol><li>使用mips实现全排列生成算法。</li><li>以0x00000000为数据段起始地址。</li><li>输入一个小于等于6的正整数，求出n的全排列，并按照字典序输出。</li><li>每组数据最多执行500,000条指令。</li><li>使用<code>syscall</code>结束程序</li></ol><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/MARS_code_911.png" alt="C代码提示"></p><hr><p>一道递归题，注意<span class="bubble-content">递归返回的时候</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;"> 即代码 FullArray(index+1); 后</span></span>，除了保存恢复下标i，还要记得<span class="bubble-content">重新计算下标地址</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;"> 需要用来撤销symbol标记</span></span>( &lt;&lt;2 )</p><details class="folding-tag" red><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    array:    .space    28</span><br><span class="line">    symbol:    .space    28</span><br><span class="line">    space:    .asciiz    &quot; &quot;</span><br><span class="line">    enter:    .asciiz &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">.macro end</span><br><span class="line">    li    $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li    $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li    $v0, 1</span><br><span class="line">    move $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printEnter()</span><br><span class="line">    la    $a0, enter</span><br><span class="line">    li    $v0, 4</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printSpace()</span><br><span class="line">    la    $a0, space</span><br><span class="line">    li    $v0, 4</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro push(%d)</span><br><span class="line">    sw    %d, 0($sp)</span><br><span class="line">    addi $sp, $sp, -4</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro pop(%d)</span><br><span class="line">    addi $sp, $sp, 4</span><br><span class="line">    lw    %d, 0($sp)</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">main:</span><br><span class="line">    readInt($s0)</span><br><span class="line">    li    $t0, 0</span><br><span class="line">    li    $t1, 0</span><br><span class="line">    li    $a0, 0 # index</span><br><span class="line">    jal    FullArray</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">FullArray:</span><br><span class="line">    push($ra)</span><br><span class="line">    push($t0)</span><br><span class="line">    push($t1)</span><br><span class="line">    </span><br><span class="line">    move $t0, $a0 # index</span><br><span class="line">    li    $t1, 0 # i</span><br><span class="line">    blt    $t0, $s0, else1</span><br><span class="line">    if1:</span><br><span class="line">        loop1:</span><br><span class="line">            beq    $t1, $s0, end_loop1</span><br><span class="line">            sll    $t2, $t1, 2</span><br><span class="line">            lw    $t2, array($t2) # array[i]</span><br><span class="line">            printInt($t2)</span><br><span class="line">            printSpace()</span><br><span class="line">            addi $t1, $t1, 1</span><br><span class="line">            j    loop1</span><br><span class="line">        end_loop1:</span><br><span class="line">        printEnter()</span><br><span class="line">        pop($t1)</span><br><span class="line">        pop($t0)</span><br><span class="line">        pop($ra)</span><br><span class="line">        jr    $ra # return</span><br><span class="line">    else1:</span><br><span class="line">    li    $t1, 0</span><br><span class="line">    loop2:</span><br><span class="line">        beq $t1, $s0, end_loop2 # t1:i</span><br><span class="line">        sll    $t2, $t1, 2</span><br><span class="line">        lw    $t3, symbol($t2) # symbol[i]</span><br><span class="line">        bnez $t3, else2</span><br><span class="line">        if2:</span><br><span class="line">            sll    $t3, $t0, 2 # index</span><br><span class="line">            addi $t4, $t1, 1</span><br><span class="line">            sw    $t4, array($t3) # array[index] = i + 1</span><br><span class="line">            li    $t3,1 </span><br><span class="line">            sw    $t3, symbol($t2) # symbol[i] = 1</span><br><span class="line">            addi $a0, $t0, 1 # new index</span><br><span class="line">            jal    FullArray</span><br><span class="line">            li    $t3, 0</span><br><span class="line">            sll    $t2, $t1, 2 # remember to reset</span><br><span class="line">            sw    $t3, symbol($t2) # symbol[i] = 0</span><br><span class="line">        else2:</span><br><span class="line">        addi $t1, $t1, 1</span><br><span class="line">        j    loop2</span><br><span class="line">    end_loop2:</span><br><span class="line">    pop($t1)</span><br><span class="line">    pop($t0)</span><br><span class="line">    pop($ra)</span><br><span class="line">    jr    $ra</span><br><span class="line">    </span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="附加题q1-p2-l1-puzzle">附加题Q1 P2_L1_puzzle</h3><p>使用深度优先探索算法求解01迷宫的逃离路线个数。<br><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/P2-lab1-maze.png" alt="例"><br>如左图，以红色0作为起点，绿色0作为终点，每一次行进只能选择上下左右中值为0且未走过的位置，满足上述条件的路线，即为一条迷宫逃跑路线。如右图中，蓝色的路线即为一条逃跑路线。</p><p>输入一个n*m的01矩阵作为01迷宫，并给定他的起点与终点，求出他不同逃跑路线的数目（不同逃跑路线中可以有相同的部分，但是不能完全相同）。</p><hr><details class="folding-tag" blue open><summary> C代码 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> n,m,ans,target[<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> Map[<span class="number">7</span>][<span class="number">7</span>];</span><br><span class="line"><span class="type">int</span> flag[<span class="number">7</span>][<span class="number">7</span>];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    s 0 1 0 0</span></span><br><span class="line"><span class="comment">    1 0 0 0 1</span></span><br><span class="line"><span class="comment">    1 0 1 0 1</span></span><br><span class="line"><span class="comment">    1 0 0 0 t</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line"><span class="comment">//便于翻译就这么写了</span></span><br><span class="line">    <span class="keyword">if</span> (x == target[<span class="number">2</span>] &amp;&amp; y == target[<span class="number">3</span>]) &#123;</span><br><span class="line">        ++ans;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x + <span class="number">1</span> &lt; n &amp;&amp; Map[x + <span class="number">1</span>][y] == <span class="number">0</span> &amp;&amp; flag[x + <span class="number">1</span>][y] == <span class="number">0</span>) &#123;</span><br><span class="line">        flag[x + <span class="number">1</span>][y] = <span class="number">1</span>;</span><br><span class="line">        dfs(x + <span class="number">1</span>, y);</span><br><span class="line">        flag[x + <span class="number">1</span>][y] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">0</span> &amp;&amp; Map[x - <span class="number">1</span>][y] == <span class="number">0</span> &amp;&amp; flag[x - <span class="number">1</span>][y] == <span class="number">0</span>) &#123;</span><br><span class="line">        flag[x - <span class="number">1</span>][y] = <span class="number">1</span>;</span><br><span class="line">        dfs(x - <span class="number">1</span>, y);</span><br><span class="line">        flag[x - <span class="number">1</span>][y] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (y + <span class="number">1</span> &lt; m &amp;&amp; Map[x][y + <span class="number">1</span>] == <span class="number">0</span> &amp;&amp; flag[x][y + <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        flag[x][y + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        dfs(x, y + <span class="number">1</span>);</span><br><span class="line">        flag[x][y + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (y &gt; <span class="number">0</span> &amp;&amp; Map[x][y - <span class="number">1</span>] == <span class="number">0</span> &amp;&amp; flag[x][y - <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">        flag[x][y - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        dfs(x, y - <span class="number">1</span>);</span><br><span class="line">        flag[x][y - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;Map[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;target[i]);</span><br><span class="line">        target[i]--;</span><br><span class="line">    &#125;</span><br><span class="line">    flag[target[<span class="number">0</span>]][target[<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line">    dfs(target[<span class="number">0</span>],target[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    Map:    .space    196</span><br><span class="line">    flag:    .space    196</span><br><span class="line">    space:    .asciiz    &quot; &quot;</span><br><span class="line">    enter:    .asciiz    &quot;\n&quot;</span><br><span class="line"></span><br><span class="line">.macro end</span><br><span class="line">    li        $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li        $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move    %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li        $v0, 1</span><br><span class="line">    move    $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro getIndex(%d, %m, %i, %j)</span><br><span class="line">    mul        %d, %m, %i</span><br><span class="line">    add        %d, %d, %j</span><br><span class="line">    sll        %d, %d, 2</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro push(%d)</span><br><span class="line">    sw        %d, 0($sp)</span><br><span class="line">    addi    $sp, $sp, -4</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro pop(%d)</span><br><span class="line">    addi    $sp, $sp, 4</span><br><span class="line">    lw        %d, 0($sp)</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printSpace()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, space</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printEnter()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, enter</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro check()</span><br><span class="line">    push($a0)</span><br><span class="line">    li        $t6, 0</span><br><span class="line">    for_i:</span><br><span class="line">        beq        $t6, $s0, end_for_i</span><br><span class="line">        li        $t7, 0</span><br><span class="line">        for_j:</span><br><span class="line">            beq        $t7, $s1, end_for_j</span><br><span class="line">            getIndex($t5, $s1, $t6, $t7)</span><br><span class="line">            lw        $t5, flag($t5)</span><br><span class="line">            printInt($t5)</span><br><span class="line">            printSpace()</span><br><span class="line">            addi    $t7, $t7, 1</span><br><span class="line">            j        for_j</span><br><span class="line">        end_for_j:</span><br><span class="line">        printEnter()</span><br><span class="line">        addi    $t6, $t6, 1</span><br><span class="line">        j        for_i</span><br><span class="line">    end_for_i:</span><br><span class="line">    printEnter()</span><br><span class="line">    pop($a0)</span><br><span class="line">.end_macro</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">main:</span><br><span class="line">    readInt($s0)</span><br><span class="line">    readInt($s1)</span><br><span class="line">    li        $s2, 0</span><br><span class="line">    li        $t0, 0</span><br><span class="line">    loop_i_1:</span><br><span class="line">        beq        $t0, $s0, end_loop_i_1</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        loop_j_1:</span><br><span class="line">            beq        $t1, $s1, end_loop_j_1</span><br><span class="line">            getIndex($t2, $s1, $t0, $t1)</span><br><span class="line">            readInt($t3)</span><br><span class="line">            sw        $t3, Map($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_1</span><br><span class="line">        end_loop_j_1:</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_1</span><br><span class="line">    end_loop_i_1:</span><br><span class="line">    readInt($t0)</span><br><span class="line">    readInt($t1)</span><br><span class="line">    readInt($s3)</span><br><span class="line">    readInt($s4)</span><br><span class="line">    addi    $t0, $t0, -1</span><br><span class="line">    addi    $t1, $t1, -1</span><br><span class="line">    addi    $s3, $s3, -1    #target_x</span><br><span class="line">    addi    $s4, $s4, -1    #target_y</span><br><span class="line">    getIndex($t2, $s1, $t0, $t1)</span><br><span class="line">    move    $a0, $t0    # x</span><br><span class="line">    move    $a1, $t1    # y</span><br><span class="line">    li        $s5, 1        # const 1</span><br><span class="line">    sw        $s5, flag($t2)</span><br><span class="line">    jal        dfs</span><br><span class="line">    printInt($s2)</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">dfs:</span><br><span class="line">    push($ra)</span><br><span class="line">    push($t0)</span><br><span class="line">    push($t1)</span><br><span class="line">    move    $t0, $a0</span><br><span class="line">    move    $t1, $a1</span><br><span class="line">    bne        $t0, $s3, else_1</span><br><span class="line">    bne        $t1, $s4, else_1</span><br><span class="line">    if_1:</span><br><span class="line">        add        $s2, $s2, 1</span><br><span class="line">        pop($t1)</span><br><span class="line">        pop($t0)</span><br><span class="line">        pop($ra)</span><br><span class="line">        jr        $ra</span><br><span class="line">    else_1:</span><br><span class="line">    addi    $t2, $t0, 1</span><br><span class="line">    beq        $t2, $s0, else_2</span><br><span class="line">    getIndex($t3, $s1, $t2, $t1)</span><br><span class="line">    lw        $t4, Map($t3)</span><br><span class="line">    bnez    $t4, else_2</span><br><span class="line">    lw        $t4, flag($t3)</span><br><span class="line">    bnez    $t4, else_2</span><br><span class="line">    if_2:</span><br><span class="line">        sw        $s5, flag($t3)</span><br><span class="line">        move    $a0, $t2</span><br><span class="line">        move    $a1, $t1</span><br><span class="line">        jal        dfs</span><br><span class="line">        addi    $t2, $t0, 1</span><br><span class="line">        getIndex($t3, $s1, $t2, $t1)</span><br><span class="line">        sw        $0, flag($t3)</span><br><span class="line">    else_2:</span><br><span class="line">    beqz    $t0, else_3</span><br><span class="line">    addi    $t2, $t0, -1</span><br><span class="line">    getIndex($t3, $s1, $t2, $t1)</span><br><span class="line">    lw        $t4, Map($t3)</span><br><span class="line">    bnez    $t4, else_3</span><br><span class="line">    lw        $t4, flag($t3)</span><br><span class="line">    bnez    $t4, else_3</span><br><span class="line">    if_3:</span><br><span class="line">        sw        $s5, flag($t3)</span><br><span class="line">        move    $a0, $t2</span><br><span class="line">        move    $a1, $t1</span><br><span class="line">        jal        dfs</span><br><span class="line">        addi    $t2, $t0, -1</span><br><span class="line">        getIndex($t3, $s1, $t2, $t1)</span><br><span class="line">        sw        $0, flag($t3)</span><br><span class="line">    else_3:</span><br><span class="line">    addi    $t2, $t1, 1</span><br><span class="line">    beq        $t2, $s1, else_4</span><br><span class="line">    getIndex($t3, $s1, $t0, $t2)</span><br><span class="line">    lw        $t4, Map($t3)</span><br><span class="line">    bnez    $t4, else_4</span><br><span class="line">    lw        $t4, flag($t3)</span><br><span class="line">    bnez    $t4, else_4</span><br><span class="line">    if_4:</span><br><span class="line">        sw        $s5, flag($t3)</span><br><span class="line">        move    $a0, $t0</span><br><span class="line">        move    $a1, $t2</span><br><span class="line">        jal        dfs</span><br><span class="line">        addi    $t2, $t1, 1</span><br><span class="line">        getIndex($t3, $s1, $t0, $t2)</span><br><span class="line">        sw        $0, flag($t3)</span><br><span class="line">    else_4:</span><br><span class="line">    beqz    $t1, else_5</span><br><span class="line">    addi    $t2, $t1, -1</span><br><span class="line">    getIndex($t3, $s1, $t0, $t2)</span><br><span class="line">    lw        $t4, Map($t3)</span><br><span class="line">    bnez    $t4, else_5</span><br><span class="line">    lw        $t4, flag($t3)</span><br><span class="line">    bnez    $t4, else_5</span><br><span class="line">    if_5:</span><br><span class="line">        sw        $s5, flag($t3)</span><br><span class="line">        move    $a0, $t0</span><br><span class="line">        move    $a1, $t2</span><br><span class="line">        jal        dfs</span><br><span class="line">        addi    $t2, $t1, -1</span><br><span class="line">        getIndex($t3, $s1, $t0, $t2)</span><br><span class="line">        sw        $0, flag($t3)</span><br><span class="line">    else_5:</span><br><span class="line">    pop($t1)</span><br><span class="line">    pop($t0)</span><br><span class="line">    pop($ra)</span><br><span class="line">    jr        $ra</span><br><span class="line">        </span><br><span class="line">    </span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="附加题q2-p2-l1-factorial">附加题Q2 P2_L1_factorial</h3><p>使用MIPS汇编语言编写一个求n的阶乘的汇编程序(不考虑延迟槽)。<br>具体要求：</p><ul><li>第一行读取n</li><li>计算并输出n的阶乘，输出字符串长度小于等于1000</li><li>步数限制为200,000</li><li>使用<code>syscall</code>结束程序</li></ul><hr><details class="folding-tag" green open><summary> C代码 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> n,len;</span><br><span class="line"><span class="type">int</span> a[<span class="number">1000</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="type">int</span> i,j;</span><br><span class="line">    a[<span class="number">0</span>] = <span class="number">1</span>, len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span>; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; len; ++j) &#123;</span><br><span class="line">            a[j] *= i;</span><br><span class="line">        &#125;</span><br><span class="line">        j = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          对着翻译完才发现上面的for循环和while可以合成一个</span></span><br><span class="line"><span class="comment">          但是懒得改了，数据也弱（</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">while</span>(a[j] || j &lt; len) &#123;</span><br><span class="line">            a[j + <span class="number">1</span>] += a[j] / <span class="number">10</span>;</span><br><span class="line">            a[j] %= <span class="number">10</span>;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        len = j;</span><br><span class="line"><span class="comment">//        printf(&quot;%d %d\n&quot;, i, len);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, a[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> Code(仅供参考) </summary>              <div class='content'>              <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">.data</span><br><span class="line">    arr:    .space    4000</span><br><span class="line">    space:    .asciiz    &quot; &quot;</span><br><span class="line">    enter:    .asciiz    &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">.macro end</span><br><span class="line">    li        $v0, 10</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro readInt(%d)</span><br><span class="line">    li        $v0, 5</span><br><span class="line">    syscall</span><br><span class="line">    move    %d, $v0</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printInt(%d)</span><br><span class="line">    li        $v0, 1</span><br><span class="line">    move    $a0, %d</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printEnter()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, enter</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.macro printSpace()</span><br><span class="line">    li        $v0, 4</span><br><span class="line">    la        $a0, space</span><br><span class="line">    syscall</span><br><span class="line">.end_macro</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">main:</span><br><span class="line">    readInt($s0)</span><br><span class="line">    li        $s1, 1            # len = 1</span><br><span class="line">    sw        $s1, arr($0)    # arr[0] = 1</span><br><span class="line">    li        $t0, 2            # i</span><br><span class="line">    li        $s2, 10            # const 10</span><br><span class="line">    loop_i_1:</span><br><span class="line">        bgt        $t0, $s0, end_loop_i_1</span><br><span class="line">        li        $t1, 0        # j</span><br><span class="line">        li        $t2, 0        # index of arr[]</span><br><span class="line">        loop_j_1:</span><br><span class="line">            beq        $t1, $s1, end_loop_j_1</span><br><span class="line">            lw        $t3, arr($t2)</span><br><span class="line">            mul        $t3, $t3, $t0</span><br><span class="line">            sw        $t3, arr($t2)</span><br><span class="line">            addi    $t2, $t2, 4</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        loop_j_1</span><br><span class="line">        end_loop_j_1:</span><br><span class="line">        li        $t1, 0</span><br><span class="line">        li        $t2, 0</span><br><span class="line">        while:</span><br><span class="line">            if_1:</span><br><span class="line">                lw        $t3, arr($t2)</span><br><span class="line">                beqz    $t3, if_2</span><br><span class="line">                j    else</span><br><span class="line">            if_2:</span><br><span class="line">                bge        $t1, $s1, end_while</span><br><span class="line">            else:</span><br><span class="line">            div        $t3, $s2</span><br><span class="line">            mfhi    $t3</span><br><span class="line">            sw        $t3, arr($t2)</span><br><span class="line">            addi    $t2, $t2, 4</span><br><span class="line">            lw        $t3, arr($t2)</span><br><span class="line">            mflo    $t4</span><br><span class="line">            add        $t3, $t3, $t4</span><br><span class="line">            sw        $t3, arr($t2)</span><br><span class="line">            addi    $t1, $t1, 1</span><br><span class="line">            j        while</span><br><span class="line">        end_while:</span><br><span class="line">        move    $s1, $t1</span><br><span class="line">        addi    $t0, $t0, 1</span><br><span class="line">        j        loop_i_1</span><br><span class="line">    end_loop_i_1:</span><br><span class="line">    addi    $t0, $s1, -1</span><br><span class="line">    sll        $t0, $t0, 2</span><br><span class="line">    loop:</span><br><span class="line">        lw        $t1, arr($t0)</span><br><span class="line">        printInt($t1)</span><br><span class="line">        beqz    $t0, end_loop</span><br><span class="line">        addi    $t0, $t0, -4</span><br><span class="line">        j        loop</span><br><span class="line">    end_loop:</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="课上考试">课上考试</h2>]]></content>
      
      
      <categories>
          
          <category> BUAA计算机组成原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CO </tag>
            
            <tag> MIPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023 BUAA CO review: P1</title>
      <link href="/c2a41ca3.html"/>
      <url>/c2a41ca3.html</url>
      
        <content type="html"><![CDATA[<h2 id="课下提交">课下提交</h2><h3 id="q1-p1-l0-splitter">Q1 P1_L0_splitter</h3><div class="tabs" id="t1"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t1-1">题目要求</button><button type="button" class="tab " data-href="t1-2">思路</button><button type="button" class="tab " data-href="t1-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t1-1"><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span></span> 搭建一个32位 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">S</mi><mi mathvariant="bold">p</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\bf{Splitter}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">S</span><span class="mord mathbf">p</span><span class="mord mathbf">l</span><span class="mord mathbf">i</span><span class="mord mathbf">t</span><span class="mord mathbf">t</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span></span></span></span></span></span> , 给定一个32位的二进制数作为输入，将其划分为四个8位的二进制数作为输出。</p><p>模块名：splitter</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">A[31:0]</td><td style="text-align:center">I</td><td>输入的二进制数</td></tr><tr><td style="text-align:center">O1[7:0]</td><td style="text-align:center">O</td><td>A的[31:24]位</td></tr><tr><td style="text-align:center">O2[7:0]</td><td style="text-align:center">O</td><td>A的[23:16]位</td></tr><tr><td style="text-align:center">O3[7:0]</td><td style="text-align:center">O</td><td>A的[15:8]位</td></tr><tr><td style="text-align:center">O4[7:0]</td><td style="text-align:center">O</td><td>A的[7:0]位</td></tr></tbody></table></div><div class="tab-item-content" id="t1-2"><p>没什么好说的，直接<code>assign</code>即可</p></div><div class="tab-item-content" id="t1-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> splitter(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] A,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] O1,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] O2,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] O3,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] O4</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> O1 = A[<span class="number">31</span>:<span class="number">24</span>];</span><br><span class="line">    <span class="keyword">assign</span> O2 = A[<span class="number">23</span>:<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">assign</span> O3 = A[<span class="number">15</span>:<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">assign</span> O4 = A[<span class="number">7</span>:<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q2-p1-l0-alu">Q2 P1_L0_ALU</h3><div class="tabs" id="t2"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t2-1">题目要求</button><button type="button" class="tab " data-href="t2-2">思路</button><button type="button" class="tab " data-href="t2-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t2-1"><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span></span> 搭建一个 32 位六运算 ALU 并提交。具体模块端口定义如下：<br>模块名：alu</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">A[31:0]</td><td style="text-align:center">I</td><td>参与ALU计算的第一个值</td></tr><tr><td style="text-align:center">B[31:0]</td><td style="text-align:center">I</td><td>参与ALU计算的第二个值</td></tr><tr><td style="text-align:center">ALUOp[2:0]</td><td style="text-align:center">I</td><td>ALU功能的选择信号<br>000: ALU进行加法运算<br>001: ALU进行减法运算<br>010: ALU进行与运算<br>011: ALU进行或运算<br>100: ALU进行逻辑右移<br>101: ALU进行算数右移</td></tr><tr><td style="text-align:center">C[31:0]</td><td style="text-align:center">O</td><td>ALU的计算结果</td></tr></tbody></table><p>模块功能定义如下：</p><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:center">功能名称</th><th>功能描述</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">无符号加运算</td><td>C=A+B (A,B无符号)</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">无符号减运算</td><td>C=A-B (A,B无符号)</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">与运算</td><td>C=A&amp;B</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">或运算</td><td>C=A|B</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">逻辑右移</td><td>C=A&gt;&gt;B (A,B无符号)</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">算术右移</td><td>C=A&gt;&gt;&gt;B (A有符号,B无符号)</td></tr></tbody></table></div><div class="tab-item-content" id="t2-2"><div class="note primary flat"><p>需要注意的是算术右移的处理，<code>$signed()</code>的使用</p></div></div><div class="tab-item-content" id="t2-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> alu(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] A,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] B,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">2</span>:<span class="number">0</span>] ALUOp,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>] C</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] shift_right;</span><br><span class="line">    <span class="comment">//放在外面先计算好, 免得符号出错</span></span><br><span class="line">    <span class="keyword">assign</span> shift_right = <span class="built_in">$signed</span>(A) &gt;&gt;&gt; B;</span><br><span class="line">    <span class="keyword">assign</span> C = (ALUOp == <span class="number">3&#x27;b000</span>) ? (A + B) :</span><br><span class="line">               (ALUOp == <span class="number">3&#x27;b001</span>) ? (A - B) :</span><br><span class="line">               (ALUOp == <span class="number">3&#x27;b010</span>) ? (A &amp; B) :</span><br><span class="line">               (ALUOp == <span class="number">3&#x27;b011</span>) ? (A | B) :</span><br><span class="line">               (ALUOp == <span class="number">3&#x27;b100</span>) ? (A &gt;&gt; B) : shift_right;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q3-p1-l0-ext">Q3 P1_L0_EXT</h3><div class="tabs" id="t3"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t3-1">题目要求</button><button type="button" class="tab " data-href="t3-2">思路</button><button type="button" class="tab " data-href="t3-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t3-1"><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span></span> 实现 EXT 。EXT为扩展单元，其主要功能是完成将输入到其中的16位数据进行符号扩展、零扩展以及将输入的16位数加载到高位等操作。具体模块端口定义如下：<br>模块名：ext</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">imm[15:0]</td><td style="text-align:center">I</td><td>输入EXT内部需要被扩展的16位数据</td></tr><tr><td style="text-align:center">Eop[1:0]</td><td style="text-align:center">I</td><td>输入数据进行扩展的方式的选择信号<br>00: 将imm进<strong>行符号扩展</strong>到32位<br>01: 将imm进行<strong>高位零扩展</strong>到32位<br>10: 将imm加载到高位，低位补0<br>11: 将imm进行符号扩展后左移两格</td></tr><tr><td style="text-align:center">ext[31:0]</td><td style="text-align:center">O</td><td>进行扩展之后的输出数据</td></tr></tbody></table><p>模块功能定义如下：</p><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:center">功能名称</th><th>功能描述</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">符号扩展</td><td>将Input进行符号扩展到32位</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">零扩展</td><td>将Input进行高位补零扩展到32位</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">加载到高位</td><td>将Input加载到高位，低位补0</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">符号扩展后左移</td><td>将Input符号扩展后，左移两位</td></tr></tbody></table></div><div class="tab-item-content" id="t3-2"><ul><li>使用位拼接运算符处理即可</li><li>需要注意的是，<strong>常数必须指明位宽</strong>，否则默认为32位；同时，拼接可以嵌套，但需要用<code>{}</code>括起来</li></ul></div><div class="tab-item-content" id="t3-3"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">`timescale 1ns / 1ps</span><br><span class="line">module ext(</span><br><span class="line">    input [15:0] imm,</span><br><span class="line">    input [1:0] EOp,</span><br><span class="line">    output [31:0] ext</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    assign ext = (EOp == 2&#x27;b00) ? &#123;&#123;16&#123;imm[15]&#125;&#125;, imm&#125; :</span><br><span class="line">                 (EOp == 2&#x27;b01) ? &#123;16&#x27;b0, imm&#125; :</span><br><span class="line">                 (EOp == 2&#x27;b10) ? &#123;imm, &#123;16&#123;1&#x27;b0&#125;&#125;&#125; : (&#123;&#123;16&#123;imm[15]&#125;&#125;, imm&#125; &lt;&lt; 2);</span><br><span class="line">    end</span><br><span class="line">endmodule</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q4-p1-l0-gray">Q4 P1_L0_gray</h3><div class="tabs" id="t4"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t4-1">题目要求</button><button type="button" class="tab " data-href="t4-2">思路</button><button type="button" class="tab " data-href="t4-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t4-1"><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span></span> 设计一个格雷码计数器。模块端口定义如下：<br>模块名：gray</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">Clk</td><td style="text-align:center">I</td><td>时钟信号</td></tr><tr><td style="text-align:center">Reset</td><td style="text-align:center">I</td><td><strong>同步</strong>复位信号</td></tr><tr><td style="text-align:center">En</td><td style="text-align:center">I</td><td>使能信号</td></tr><tr><td style="text-align:center">Output[2:0]</td><td style="text-align:center">O</td><td>计数器当前值</td></tr><tr><td style="text-align:center">Overflow</td><td style="text-align:center">O</td><td>溢出标志位</td></tr></tbody></table><p>要求实现功能如下：</p><ol><li>在任意一个时钟上升沿到来的时候，如果复位信号有效，则将计数器清零</li><li>每个时钟上升沿到来的时候，如果使能信号有效，计数器的值+1</li><li>在满足1时，即使2的条件满足，也不必执行2</li><li>计数器初值为0</li><li>当计数器的值在+1后出现溢出的情况时，将会回到零，同时从发生溢出的这个时钟上升沿开始，溢出标志位将会持续输出1，直到计数器被清零为止（其余情况下溢出标志位必须为0）</li></ol><div class="note info flat"><p>关于<a href="https://oi-wiki.org/misc/gray-code/">格雷码</a></p></div></div><div class="tab-item-content" id="t4-2"><ul><li>对于格雷码，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo>⊕</mo><mrow><mo fence="true">⌊</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo fence="true">⌋</mo></mrow></mrow><annotation encoding="application/x-tex">G(n) = n \oplus \left \lfloor \frac{n}{2} \right \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">G</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">⌋</span></span></span></span></span></span></li><li>其余部分就是普通计数器</li></ul></div><div class="tab-item-content" id="t4-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> gray(</span><br><span class="line">    <span class="keyword">input</span> Clk,</span><br><span class="line">    <span class="keyword">input</span> Reset,</span><br><span class="line">    <span class="keyword">input</span> En,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">2</span>:<span class="number">0</span>] Output,</span><br><span class="line">    <span class="keyword">output</span> Overflow</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] st; </span><br><span class="line">    <span class="keyword">reg</span> flag;</span><br><span class="line">    <span class="keyword">assign</span> Output = st ^ (st &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">assign</span> Overflow = flag; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> Clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (Reset) <span class="keyword">begin</span></span><br><span class="line">            st &lt;= <span class="number">0</span>;</span><br><span class="line">            flag &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (En) <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (st == <span class="number">3&#x27;d7</span>) <span class="keyword">begin</span></span><br><span class="line">                    st &lt;= <span class="number">3&#x27;d0</span>;</span><br><span class="line">                    flag &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> st &lt;= st + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> st &lt;= st;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q5-p1-l0-表达式状态机">Q5 P1_L0_表达式状态机</h3><div class="tabs" id="t1"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t1-1">题目要求</button><button type="button" class="tab " data-href="t1-2">思路</button><button type="button" class="tab " data-href="t1-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t1-1"><p>现在，我们需要你用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi><mi mathvariant="script">H</mi><mi mathvariant="script">D</mi><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog HDL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class="mord mathcal">L</span></span></span></span></span> 语言设计一个有限状态机来识别这样一类表达式F：</p><ul><li>表达式F中只含有数字0-9，加号+，乘号*。</li><li>表达式F可以按如下的规则产生：<ul><li>单个数字[0-9]是F</li><li>如果X是F，Y是F，X+Y也是F</li><li>如果X是F，Y是F，X*Y也是F</li></ul></li></ul><p>模块规格：<br>模块名：expr</p><table><thead><tr><th style="text-align:center">端口名</th><th style="text-align:center">位宽</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">clk</td><td style="text-align:center">1</td><td>接收时钟信号</td></tr><tr><td style="text-align:center">clr</td><td style="text-align:center">1</td><td>接收<strong>异步</strong>清零信号</td></tr><tr><td style="text-align:center">in[7:0]</td><td style="text-align:center">8</td><td>接收逐个输入的字符，用 ASCII 编码</td></tr><tr><td style="text-align:center">out</td><td style="text-align:center">1</td><td>输出合法性信号</td></tr></tbody></table><ul><li>每个时钟上升沿，状态机从 in 中读入一个ASCII编码的字符。假设读入的第i个字符为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则第n个时钟上升沿时，可以拼出一个字符串: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">s=c_1c_2 \cdots c_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>此时若s符合F的定义，那么 out 应输出1，否则输出0</li><li>如果s当前是空串，out也应输出0。清零后，上面定义的字符串s也应从空串开始计算</li></ul></div><div class="tab-item-content" id="t1-2"><ul><li>考虑这几种状态：<ol><li>S0: 当前字符串为空</li><li>S1: 当前字符串为F（即合法）</li><li>S2：字符串为<code>F+</code> or <code>F*</code></li><li>S3：字符串非法，如<code>99</code>、<code>+9</code>、<code>++</code>等（此时只能等待清零信号）</li></ol></li><li>注意要异步清零</li></ul></div><div class="tab-item-content" id="t1-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> expr(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> clr,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="keyword">output</span> out</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] st;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] check = (in &gt;= <span class="string">&quot;0&quot;</span> &amp;&amp; in &lt;= <span class="string">&quot;9&quot;</span>) ? <span class="number">2&#x27;b01</span> :</span><br><span class="line">                       (in == <span class="string">&quot;+&quot;</span> || in == <span class="string">&quot;*&quot;</span>) ? <span class="number">2&#x27;b10</span> : <span class="number">2&#x27;b00</span>;</span><br><span class="line">    <span class="keyword">assign</span> out = (st == <span class="number">2&#x27;d1</span>) ? <span class="number">1&#x27;b1</span> : <span class="number">1&#x27;b0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> clr) <span class="keyword">begin</span></span><br><span class="line">    <span class="comment">//异步清零</span></span><br><span class="line">        <span class="keyword">if</span> (clr == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (st)</span><br><span class="line">            <span class="number">2&#x27;d0</span>: <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (check == <span class="number">2&#x27;b01</span>) st &lt;= <span class="number">2&#x27;d1</span>;</span><br><span class="line">                <span class="keyword">else</span> st &lt;= <span class="number">2&#x27;d3</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="number">2&#x27;d1</span>: <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (check == <span class="number">2&#x27;b10</span>) st &lt;= <span class="number">2&#x27;d2</span>;</span><br><span class="line">                <span class="keyword">else</span> st &lt;= <span class="number">2&#x27;d3</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="number">2&#x27;d2</span>: <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (check == <span class="number">2&#x27;b01</span>) st &lt;= <span class="number">2&#x27;d1</span>;</span><br><span class="line">                <span class="keyword">else</span> st &lt;= <span class="number">2&#x27;d3</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="number">2&#x27;d3</span>: st &lt;= st;</span><br><span class="line">            <span class="keyword">default</span>: st &lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="附加题q1-p1-l1-blockchecker">附加题Q1 P1_L1_BlockChecker</h3><div class="tabs" id="t6"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t6-1">题目要求</button><button type="button" class="tab " data-href="t6-2">思路</button><button type="button" class="tab " data-href="t6-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t6-1"><p>现在需要你用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi><mi mathvariant="script">e</mi><mi mathvariant="script">r</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">o</mi><mi mathvariant="script">g</mi></mrow><annotation encoding="application/x-tex">\mathcal{Verilog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span></span>语言编写一个模拟语句块检查的工具。<br>为了简化要求，输入由ASCII字母和空格组成。一个或多个连续出现的字母构成一个单词，单词不区分大小写，单词之间由一个或多个空格分隔开。检查工具检查自复位之后的输入中，begin和end是否能够匹配。</p><p>匹配规则类似括号匹配：一个begin只能匹配一个end，但是一个匹配的begin必须出现在对应的end之前；<strong>允许出现嵌套</strong>；最后若出现不能按上述规则匹配的begin或end，则匹配失败。<br>输入的读取在时钟上升沿进行。</p><p>匹配示例：Hello world，begin comPuTer orGANization End。</p><p>不匹配示例：eND，beGin study。</p><p>模块端口定义如下：<br>模块名：BlockChecker</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">clk</td><td style="text-align:center">I</td><td>时钟信号</td></tr><tr><td style="text-align:center">reset</td><td style="text-align:center">I</td><td>异步复位信号（高电平有效，复位时将输入记录清空）</td></tr><tr><td style="text-align:center">in[7:0]</td><td style="text-align:center">I</td><td>当前输入字符的ASCII码</td></tr><tr><td style="text-align:center">result</td><td style="text-align:center">O</td><td>当前输入是否能够完成begin和end的匹配</td></tr></tbody></table><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/example_blockchecker.png" alt="示例波形"></p></div><div class="tab-item-content" id="t6-2"><ul><li>显然，这题需要统计<code>begin</code>和<code>end</code>单词的数量差，<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="monospace">m</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">s</mi><mi mathvariant="monospace">m</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">c</mi><mi mathvariant="monospace">h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="monospace">m</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">c</mi><mi mathvariant="monospace">h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>&lt;</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">g</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">l</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">count\begin{cases} &gt;0 ,&amp;\tt{mismatch} \\ =0 ,&amp;\tt{match} \\ &lt;0 ,&amp;\tt{illegal}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35002em;"><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathtt">m</span><span class="mord mathtt">i</span><span class="mord mathtt">s</span><span class="mord mathtt">m</span><span class="mord mathtt">a</span><span class="mord mathtt">t</span><span class="mord mathtt">c</span><span class="mord mathtt">h</span></span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathtt">m</span><span class="mord mathtt">a</span><span class="mord mathtt">t</span><span class="mord mathtt">c</span><span class="mord mathtt">h</span></span></span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathtt">i</span><span class="mord mathtt">l</span><span class="mord mathtt">l</span><span class="mord mathtt">e</span><span class="mord mathtt">g</span><span class="mord mathtt">a</span><span class="mord mathtt">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li>同时，需要注意区分<code>begin</code>和<code>beginx</code>(<code>end</code>和<code>endx</code>)</li><li>处理组合逻辑和时序逻辑的时候，注意不要让同一个<code>reg</code>变量在多个<code>always</code>块中被赋值，否则会<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">C</mi><mi mathvariant="script">o</mi><mi mathvariant="script">m</mi><mi mathvariant="script">p</mi><mi mathvariant="script">i</mi><mi mathvariant="script">l</mi><mi mathvariant="script">e</mi><mi mathvariant="script">E</mi><mi mathvariant="script">r</mi><mi mathvariant="script">r</mi><mi mathvariant="script">o</mi><mi mathvariant="script">r</mi></mrow><annotation encoding="application/x-tex">\mathcal{Compile Error}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span></span></li><li>state：<ol><li>S0: 等待单词读入(此时为空或空格)</li><li>S1: 处理非<code>begin</code>和<code>end</code>的单词</li><li>S2-S5: 判断<code>begin</code></li><li>S6: 已读入一个<code>begin</code>, <code>读入空格-&gt;S7</code> <code>else -&gt;S1</code></li><li>S7: 一个<code>begin</code>单词</li><li>S8-S9: 判断<code>end</code></li><li>S10: 已读入一个<code>end</code>, <code>读入空格-&gt;S11</code> <code>else -&gt;S1</code></li><li>S11: 一个<code>end</code>单词</li><li><code>default</code></li></ol></li></ul></div><div class="tab-item-content" id="t6-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> BlockChecker(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> reset,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] in,</span><br><span class="line">    <span class="comment">// output reg [3:0] st, </span></span><br><span class="line">    <span class="keyword">output</span> result</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> letter = (in == <span class="string">&quot; &quot;</span>) ? <span class="number">1&#x27;b0</span> : <span class="number">1&#x27;b1</span>;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] cnt;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] st;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> result = (cnt == <span class="number">32&#x27;b0</span> &amp;&amp; st != <span class="number">4&#x27;d6</span> &amp;&amp; st != <span class="number">4&#x27;d10</span>) ? <span class="number">1&#x27;b1</span> :</span><br><span class="line">                    (cnt == <span class="number">32&#x27;b1</span> &amp;&amp; st == <span class="number">4&#x27;d10</span>) ? <span class="number">1&#x27;b1</span> : <span class="number">1&#x27;b0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @ (st, cnt, reset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset == <span class="number">1&#x27;b1</span>) cnt = <span class="number">32&#x27;b0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (cnt != <span class="number">32&#x27;hffff</span>) <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span> (st == <span class="number">4&#x27;d7</span>) <span class="keyword">begin</span></span><br><span class="line">                    cnt = cnt + <span class="number">32&#x27;b1</span>;<span class="comment">//begin</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (st == <span class="number">4&#x27;d11</span>) <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (cnt == <span class="number">32&#x27;b0</span>) cnt = <span class="number">32&#x27;hffff</span>;</span><br><span class="line">                    <span class="comment">//赋了一个很大的值</span></span><br><span class="line">                    <span class="keyword">else</span> cnt = cnt - <span class="number">32&#x27;b1</span>;<span class="comment">//end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span> cnt = cnt;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> cnt = cnt;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> reset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (reset == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">            st &lt;= <span class="number">4&#x27;d0</span>; </span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (st)</span><br><span class="line">                <span class="number">4&#x27;d0</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">if</span> (in == <span class="string">&quot;b&quot;</span> || in == <span class="string">&quot;B&quot;</span>) st &lt;= <span class="number">4&#x27;d2</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (in == <span class="string">&quot;e&quot;</span> || in == <span class="string">&quot;E&quot;</span>) st&lt;= <span class="number">4&#x27;d8</span>;</span><br><span class="line">                        <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d1</span>: <span class="keyword">begin</span><span class="comment">//其他单词</span></span><br><span class="line">                    <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d2</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;e&quot;</span> || in == <span class="string">&quot;E&quot;</span>) st &lt;= <span class="number">4&#x27;d3</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d3</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;g&quot;</span> || in == <span class="string">&quot;G&quot;</span>) st &lt;= <span class="number">4&#x27;d4</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d4</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;i&quot;</span> || in == <span class="string">&quot;I&quot;</span>) st &lt;= <span class="number">4&#x27;d5</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d5</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;n&quot;</span> || in == <span class="string">&quot;N&quot;</span>) st &lt;= <span class="number">4&#x27;d6</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d6</span>: <span class="keyword">begin</span><span class="comment">//出现begin字串</span></span><br><span class="line">                    <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d7</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">4&#x27;d7</span>: <span class="keyword">begin</span><span class="comment">//出现begin单词</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;b&quot;</span> || in == <span class="string">&quot;B&quot;</span>) st &lt;= <span class="number">4&#x27;d2</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (in == <span class="string">&quot;e&quot;</span> || in == <span class="string">&quot;E&quot;</span>) st &lt;= <span class="number">4&#x27;d8</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">&#x27;d8</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;n&quot;</span> || in == <span class="string">&quot;N&quot;</span>) st &lt;= <span class="number">4&#x27;d9</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">&#x27;d9</span>: <span class="keyword">begin</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;d&quot;</span> || in == <span class="string">&quot;D&quot;</span>) st &lt;= <span class="number">4&#x27;d10</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">&#x27;d10</span>: <span class="keyword">begin</span><span class="comment">//出现end字串</span></span><br><span class="line">                    <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d11</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">&#x27;d11</span>: <span class="keyword">begin</span><span class="comment">//出现end单词</span></span><br><span class="line">                    <span class="keyword">if</span> (in == <span class="string">&quot;b&quot;</span> || in == <span class="string">&quot;B&quot;</span>) st &lt;= <span class="number">4&#x27;d2</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (in == <span class="string">&quot;e&quot;</span> || in == <span class="string">&quot;E&quot;</span>) st &lt;= <span class="number">4&#x27;d8</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (letter == <span class="number">1&#x27;b1</span>) st &lt;= <span class="number">4&#x27;d1</span>;</span><br><span class="line">                    <span class="keyword">else</span> st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">default</span>: st &lt;= <span class="number">4&#x27;d0</span>;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="课上考试">课上考试</h2><h3 id="q1-p1-l1-dotproduct-2023">Q1 P1_L1_dotProduct_2023</h3><div class="tabs" id="t7"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t7-1">题目要求</button><button type="button" class="tab " data-href="t7-2">思路</button><button type="button" class="tab " data-href="t7-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t7-1"><p>请你设计一个向量点乘模块，实现向量的点乘操作。</p><p>为了简化题目，我们用两个位宽为 32 的 wire 型变量来表示两个需要点乘的 32 维向量，也就是说，向量任何一个维度的值只能为 0 或 1。你需要将两个向量同一位置相乘并将所有位置的乘积相加输出。</p><p>模块端口定义如下：<br>模块名：dotProduct</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">vector_a[31:0]</td><td style="text-align:center">input</td><td>需要点乘的向量a</td></tr><tr><td style="text-align:center">vector_b[31:0]</td><td style="text-align:center">input</td><td>需要点乘的向量b</td></tr><tr><td style="text-align:center">result[5:0]</td><td style="text-align:center">output</td><td>点乘结果</td></tr></tbody></table></div><div class="tab-item-content" id="t7-2"><ul><li>显然，1位二进制数的乘法和<code>&amp;</code>操作等价，故答案为<code>vector_a</code>和<code>vector_b</code>各位相与之和</li><li>故此题用<code>for</code>循环解决即可，或者<kbd>ctrl</kbd> + <kbd>c</kbd> <kbd>v</kbd>32次（</li></ul></div><div class="tab-item-content" id="t7-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> dotProduct(</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] vector_a, </span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] vector_b,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">5</span>:<span class="number">0</span>] result</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">integer</span> i;</span><br><span class="line">    <span class="keyword">always</span> @(vector_a, vector_b) <span class="keyword">begin</span></span><br><span class="line">        result = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//记得初始化，惨痛教训</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">6&#x27;d32</span>; i = i + <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> ((vector_a[i] &amp; vector_b[i]) == <span class="number">1&#x27;b1</span>) <span class="keyword">begin</span></span><br><span class="line">                result = result + <span class="number">6&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                result = result;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q2-p1-l4-coloring-2023">Q2 P1_L4_coloring_2023</h3><div class="tabs" id="t8"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t8-1">题目要求</button><button type="button" class="tab " data-href="t8-2">思路</button><button type="button" class="tab " data-href="t8-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t8-1"><p>小 B 同学准备对一列格子进行涂色，他想要使用红色，绿色，蓝色三种颜色，但是要求如下：同一颜色不得连续出现三次，红色不得与绿色相连。</p><p>我们将在每个周期通过 color 端口输入一个颜色代号：0（红色），1（绿色），2（蓝色），你需要设计 Moore 状态机来检测该涂色序列的合法性，并在检测到不合法的序列之后将输出端口 check 置为 1。</p><p>另外，在检测到不合法序列之后，小 B 同学会将最近的一次涂色擦除，重新涂色。</p><p>模块端口定义如下：<br>模块名：coloring</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">clk</td><td style="text-align:center">I</td><td>时钟信号</td></tr><tr><td style="text-align:center">rst_n</td><td style="text-align:center">I</td><td>异步复位信号（低电平有效）</td></tr><tr><td style="text-align:center">color[1:0]</td><td style="text-align:center">I</td><td>涂色信号</td></tr><tr><td style="text-align:center">check</td><td style="text-align:center">O</td><td>当前序列合法性</td></tr></tbody></table><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/wave.png" alt="实例波形"></p></div><div class="tab-item-content" id="t8-2"><div class="note success simple"><p>法一:<br>有限状态机直接设好状态做就行，这里就不给出状态表了<s>因为我没用这种做法</s></p></div><div class="note success simple"><p>法二:</p><ul><li>对于这道题，可以发现只需要判断，输入的序列连续两个或三个是什么颜色即可</li><li>于是可以用四位<code>state</code>表示最近两次成功涂色，<code>in</code>为即将涂上的颜色，这样就可以很简单地进行状态的判断和转移</li><li>需要注意的是，判断当前序列合法后，才能给<code>state</code>更新</li></ul></div><div class="note warning flat"><p>低电平有效的异步复位的正确写法：</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (rst_n == <span class="number">1&#x27;b0</span>) <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">//reset</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">        <span class="comment">//……</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-item-content" id="t8-3"><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> coloring(</span><br><span class="line">    <span class="keyword">input</span> clk,</span><br><span class="line">    <span class="keyword">input</span> rst_n,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] color,</span><br><span class="line">    <span class="keyword">output</span>  check</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">reg</span> flag;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] st;</span><br><span class="line">    <span class="keyword">assign</span> check = (flag == <span class="number">1&#x27;b1</span>) ? <span class="number">1&#x27;b1</span> : <span class="number">1&#x27;b0</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> rst_n) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (rst_n == <span class="number">1&#x27;b0</span>) <span class="keyword">begin</span></span><br><span class="line">            flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">            st &lt;= <span class="number">4&#x27;hf</span>;</span><br><span class="line">            <span class="comment">//避免st初始状态为0(错误表示成红色)的情况</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (st[<span class="number">3</span>:<span class="number">2</span>] == st[<span class="number">1</span>:<span class="number">0</span>] &amp;&amp; st[<span class="number">1</span>:<span class="number">0</span>] == color) <span class="keyword">begin</span></span><br><span class="line">                st &lt;= st;</span><br><span class="line">                flag &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((st[<span class="number">1</span>:<span class="number">0</span>] == <span class="number">2&#x27;b00</span> &amp;&amp; color == <span class="number">2&#x27;b01</span>) || (st[<span class="number">1</span>:<span class="number">0</span>] == <span class="number">2&#x27;b01</span> &amp;&amp; color == <span class="number">2&#x27;b00</span>)) <span class="keyword">begin</span></span><br><span class="line">                st &lt;= st;</span><br><span class="line">                flag &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                st &lt;= &#123;st[<span class="number">1</span>:<span class="number">0</span>], color&#125;;</span><br><span class="line">                flag &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q3-p1-l5-numbernest-2023">Q3 P1_L5_numberNest_2023</h3><p><s>题面忘了，先咕了</s></p>]]></content>
      
      
      <categories>
          
          <category> BUAA计算机组成原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CO </tag>
            
            <tag> Verilog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023 BUAA CO review: P0</title>
      <link href="/b5a32c35.html"/>
      <url>/b5a32c35.html</url>
      
        <content type="html"><![CDATA[<h2 id="课下提交">课下提交</h2><h3 id="q1-p0-l0-crc-题目编号1119-13">Q1 P0_L0_CRC(题目编号1119-13)</h3><div class="tabs" id="t1"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t1-1">提交要求</button><button type="button" class="tab " data-href="t1-2">思路</button><button type="button" class="tab " data-href="t1-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t1-1"><p>使用Logisim搭建一个除数为四位，原数据帧为8位的CRC校验码计算电路。具体模块端口定义如下：</p><table><thead><tr><th>信号名</th><th>方向</th><th>描述</th></tr></thead><tbody><tr><td>A[7:0]</td><td>I</td><td>8位原数据帧</td></tr><tr><td>B[3:0]</td><td>I</td><td>4位除数</td></tr><tr><td>C[10:0]</td><td>O</td><td>8位原数据帧 + 3位校验码</td></tr></tbody></table><ul><li>文件内模块名：<strong>CRC</strong></li><li>规定除数的最高位一定为1，不必考虑非1的情况</li></ul><div class="note info flat"><p>关于CRC校验码，可以看看这位大佬的<a href="http://cscore.buaa.edu.cn/#/discussion_area/959/1286/posts">总结</a></p></div></div><div class="tab-item-content" id="t1-2"><ul><li>由题意，需要进行8次四位模二除法，每次将上一次的余数输出，<br>拼接一位被除数作为下一次四位模二除法的被除数输入</li><li>对于四位模二除法，若被除数最高位为1，则商为1，余数为被除数与除数异或<br>若最高位为0，则商为0，余数直接等于被除数</li></ul></div><div class="tab-item-content" id="t1-3"><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/crc.png" alt="CRC"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/crc_4bit_div.png" alt="四位模二除法"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/crc_next.png" alt="拼接得到被除数"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q2-p0-l0-grf-1119-269">Q2 P0_L0_GRF(1119-269)</h3><div class="tabs" id="t2"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t2-1">提交要求</button><button type="button" class="tab " data-href="t2-2">思路</button><button type="button" class="tab " data-href="t2-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t2-1"><p>使用logisim搭建一个GRF。GRF中包含32个32位寄存器，分别对应0~31号寄存器，其中0号寄存器读取的结果恒为0。具体模块端口定义如下：</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">clk</td><td style="text-align:center">I</td><td>时钟信号</td></tr><tr><td style="text-align:center">reset</td><td style="text-align:center">I</td><td>复位信号，将32个寄存器中的值全部清零<br>1: 复位<br>0: 无效<br></td></tr><tr><td style="text-align:center">WE</td><td style="text-align:center">I</td><td>写使能信号<br>1: 可向GRF中写入数据<br>0: 不能向GRF中写入数据</td></tr><tr><td style="text-align:center">A1</td><td style="text-align:center">I</td><td>5位地址输入信号，指定32个寄存器中的一个，将其中储存的数据读出到RD1</td></tr><tr><td style="text-align:center">A2</td><td style="text-align:center">I</td><td>5位地址输入信号，指定32个寄存器中的一个，将其中储存的数据读出到RD2</td></tr><tr><td style="text-align:center">A3</td><td style="text-align:center">I</td><td>5位地址输入信号，指定32个寄存器中的一个，作为写入的目标寄存器</td></tr><tr><td style="text-align:center">WD</td><td style="text-align:center">I</td><td>32位数据输入信号</td></tr><tr><td style="text-align:center">RD1</td><td style="text-align:center">O</td><td>输出A1指定的寄存器中的32位数据</td></tr><tr><td style="text-align:center">RD2</td><td style="text-align:center">O</td><td>输出A2指定的寄存器中的32位数据</td></tr></tbody></table><p>模块功能定义如下：</p><table><thead><tr><th style="text-align:center">序号</th><th style="text-align:center">功能名称</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">复位</td><td>reset信号有效时，所有的寄存器储存的数值清零，其行为与logisim自带部件的reset接口完全相同</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">读数据</td><td>读出A1,A2地址对应寄存器中所储存的数据到RD1,RD2</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">写数据</td><td>当WE有效且时钟上升沿来临时，将WD写入A3对应的寄存器中</td></tr></tbody></table><ul><li>0号寄存器读出的数据在<mark class="hl-label red">任何时刻</mark> 都为0</li><li>文件内模块名：<strong>grf</strong></li></ul></div><div class="tab-item-content" id="t2-2"><ul><li>由题目的要求可知，在根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">A3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord">3</span></span></span></span>的值将数据写入对应寄存器的同时，还需要<strong>保持其他寄存器不变</strong></li></ul><div class="note success simple"><p>方法一：</p><ul><li>32个寄存器，每个输入端口接上对应的Tunnel，Tunnel到一个DMX上</li><li>将DMX的<code>Three-state</code>属性设置为<code>Yes</code>，<code>Disabled Output</code>属性设置为<code>Floating</code>。这样，DMX使能时，除选中的输出为输入值外，其余输出均为浮空值（高阻态x）；不使能时，所有输出都为x。而<strong>Register在输入端为x时不更新</strong>，故满足题目需求。</li></ul></div><div class="note success simple"><p>方法二：</p><ul><li>每个寄存器<code>Enable</code>端接上对应的Tunnel，Tunnel到一个Deco上</li><li>将Deco的<code>Three-state</code>属性设置为<code>Yes</code>，<code>Disabled Output</code>属性设置为<code>Zero</code>。（<strong>Register在<code>Enable</code>端为x时依然会使能</strong>）</li></ul></div><ul><li>最后注意0号寄存器，可以不设置输出，也可以设置<code>reset</code>为常量<code>1</code></li></ul></div><div class="tab-item-content" id="t2-3"><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/grf.png" alt="GRF"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q3-p0-l1-navigation-2020-1119-393">Q3 P0_L1_navigation_2020(1119-393)</h3><div class="tabs" id="t3"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t3-1">题目要求</button><button type="button" class="tab " data-href="t3-2">思路</button><button type="button" class="tab " data-href="t3-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t3-1"><p>用logisim搭建一个可以导航的<strong>Moore型有限状态机</strong>，通过输入序列判断是否到达B</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/393-1.png" alt=""></p><ul><li>题目要求：</li></ul><blockquote><ol><li>只能往东南西北四个方向行走，且若能行走，则每次<strong>只能行走一格</strong>。若下一步&gt;撞墙，则<strong>将hit置高一周期</strong>并保持原地不动，等待下一周期再进行运动。（若下一步不会撞墙，则继续行进，hit在此周期置0）</li><li>走到B机房后，<strong>“到达”信号需要置位，并保持一周期</strong>。到达B机房后计小组将会在下一周期回到原点，（下一周期的输入将被忽略掉）等待下下周期的输入，继续测试他的序列。</li><li>计小组在时钟上升沿的时候就已经知道自己下一步的方向并且瞬移过去，并且立即做出判断。</li></ol></blockquote><ul><li>端口定义：</li></ul><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">dir[1:0]</td><td style="text-align:center">I</td><td>表示行走的方向 00：向北走 01：向东走 10：向南走 11：向西走</td></tr><tr><td style="text-align:center">clk</td><td style="text-align:center">I</td><td>时钟信号</td></tr><tr><td style="text-align:center">reset</td><td style="text-align:center">I</td><td>异步复位信号</td></tr><tr><td style="text-align:center">arrive</td><td style="text-align:center">O</td><td>是否到达</td></tr><tr><td style="text-align:center">hit</td><td style="text-align:center">O</td><td>是否撞上墙壁</td></tr></tbody></table><ul><li>模块名：navigation</li></ul></div><div class="tab-item-content" id="t3-2"><p>画出状态转移图</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/nav_fsm.png" alt=""></p><p>然后根据转移表<code>Analyze Circuit</code>即可</p></div><div class="tab-item-content" id="t3-3"><p>只展示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">m</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">n</mi></mrow><annotation encoding="application/x-tex">\tt{main}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61111em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathtt">m</span><span class="mord mathtt">a</span><span class="mord mathtt">i</span><span class="mord mathtt">n</span></span></span></span></span></span>模块</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/navigation.png" alt="navigation"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q4-p0-l0-fsm-1119-9">Q4 P0_L0_FSM(1119-9)</h3><div class="tabs" id="t4"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t4-1">题目要求</button><button type="button" class="tab " data-href="t4-2">思路</button><button type="button" class="tab " data-href="t4-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t4-1"><p>使用Logisim搭建一个Mealy型有限状态机 检测串行输入字符串中的能匹配正则表达式<code>b{1,2}[ac]{2}</code>的子串并输出。具体模块端口定义如下：</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">In[1:0]</td><td style="text-align:center">I</td><td>串行方式输入字符串<br>规定 00 表示 ‘a’，01 表示 ‘b’，10 表示 ‘c’，11 表示其他字符</td></tr><tr><td style="text-align:center">CLR</td><td style="text-align:center">I</td><td>清除置位信号</td></tr><tr><td style="text-align:center">Z</td><td style="text-align:center">O</td><td>输出是否检测到了与表达式匹配的子串<br>1：检测到了 0：未检测到</td></tr></tbody></table><ul><li>文件内模块名：fsm</li><li><strong>注意：每当匹配到一个子串时，需要输出一次1。例如对字符串bacbacac,模块应当在第1个c输入和第2个c输入时输出1,而在其他时刻保持输出为0。</strong></li><li><strong>注意：有限状态机的设计是<mark class="hl-label red">Mealy</mark> 型有限状态机。</strong></li><li>要求<strong>同步复位</strong></li></ul></div><div class="tab-item-content" id="t4-2"><ul><li>定义4个状态：</li></ul><table><thead><tr><th style="text-align:center">S0</th><th style="text-align:center">S1</th><th style="text-align:center">S2</th><th style="text-align:center">S3</th></tr></thead><tbody><tr><td style="text-align:center">检测到null</td><td style="text-align:center">检测到b</td><td style="text-align:center">检测到bb</td><td style="text-align:center">检测到b{1,2}[ac]</td></tr></tbody></table><ul><li>转移图为：</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/fsm_fsm.png" alt=""></p><ul><li>同步复位方法：</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/%E5%90%8C%E6%AD%A5%E5%A4%8D%E4%BD%8D.png" alt="同步复位"></p></div><div class="tab-item-content" id="t4-3"><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/fsm.png" alt="fsm"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="附加题q1-p0-l1-ftoi-1119-319">附加题Q1 P0_L1_ftoi(1119-319)</h3><div class="tabs" id="t5"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t5-1">题目要求</button><button type="button" class="tab " data-href="t5-2">思路</button><button type="button" class="tab " data-href="t5-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t5-1"><p>使用Logisim进行组合逻辑设计，要求输入一个16位的单精度浮点数（符合IEEE-754标准），输出该浮点数的整数部分(包含符号)，用32位二进制符号数表示。<br>IEEE-754 标准中一个半精度16位浮点数的表示方法:</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mi>f</mi><mi>l</mi><mi>o</mi><mi>a</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>S</mi></msup><mo>×</mo><mi>M</mi><mo>×</mo><msup><mn>2</mn><mi>E</mi></msup></mrow><annotation encoding="application/x-tex">V_{float} = (-1)^S \times M \times 2^E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span></span></span></span></span></span></span></span></p><p>利用这种浮点数表示方法进行编码后的值可以分为4类，如下图所示<br><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/319-1.png" alt=""></p><ul><li>S代表最高位符号位，由sign[15]位编码，规定S=sign</li><li>E代表指数，由图中exponent[14:10]域编码，规定补码<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>−</mo><mn>0111</mn><msub><mn>1</mn><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E = exponent - 01111_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mord">1</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>M代表小数点后的二进制小数位，由图中frac[9:0]域编码，Normalized的情况M永远有一位前导1，因此不占位，相当于1 + frac；而Denormalized的情况frac前面是0，M默认就是frac，即规定</li></ul><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>+</mo><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mo separator="true">,</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo mathvariant="normal">≠</mo><mn>0</mn><mo stretchy="false">(</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>d</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mo separator="true">,</mo><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>=</mo><mn>0</mn><mo stretchy="false">(</mo><mi>D</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>d</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">M = \begin{cases}1 + frac, exponent \ne 0(Normalized) \\ frac, exponent = 0(Denormalized)\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/image.png" alt=""></p><p>模块端口定义如下：</p><table><thead><tr><th style="text-align:center">信号名</th><th style="text-align:center">方向</th><th>描述</th></tr></thead><tbody><tr><td style="text-align:center">float[15:0]</td><td style="text-align:center">I</td><td>16位半精度浮点数（IEEE-754标准）</td></tr><tr><td style="text-align:center">int[31:0]</td><td style="text-align:center">O</td><td>该浮点数的整数部分（带符号），用32位符号数的补码来表示，超出表示范围则取低32位。<strong>第3类Infinity和第4类NaN为了简化直接输出0即可</strong></td></tr></tbody></table><ul><li>文件内模块名: <strong>ftoi</strong></li></ul></div><div class="tab-item-content" id="t5-2"><ul><li>由题意，只需计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Normalized</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span></span></span></span>型的整数部分</li><li>先取出<code>sign</code>和<code>exponent</code>进行判断，然后根据<code>exponent</code>是否小于<code>0x0f</code>继续分类（可使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">N</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">g</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\bf{Negator}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">N</span><span class="mord mathbf">e</span><span class="mord mathbf" style="margin-right:0.01597em;">g</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">o</span><span class="mord mathbf">r</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi><mi mathvariant="bold">U</mi><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\bf{MUX}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">M</span><span class="mord mathbf">U</span><span class="mord mathbf">X</span></span></span></span></span></span>进行处理）</li><li>根据不同的情况对<code>fraction</code>进行移位即可</li></ul></div><div class="tab-item-content" id="t5-3"><p><del>建得有点乱</del></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/ftoi.png" alt="ftoi"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h2 id="课上考试">课上考试</h2><h3 id="q1-p0-l2-nonexist-2023-1120-1149">Q1 P0_L2_nonexist_2023(1120-1149)</h3><div class="tabs" id="t6"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t6-1">题目要求</button><button type="button" class="tab " data-href="t6-2">思路</button><button type="button" class="tab " data-href="t6-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t6-1"><p>使用 Logisim 搭建一个组合电路。给定输入的 5 个任意无符号二进制数。确定输入中未出现的最小正整数是多少。</p><p>模块端口定义如下：</p><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">功能</th><th style="text-align:center">位宽</th><th style="text-align:center">方向</th></tr></thead><tbody><tr><td style="text-align:center">input1</td><td style="text-align:center">数据输入</td><td style="text-align:center">8</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">input2</td><td style="text-align:center">数据输入</td><td style="text-align:center">8</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">input3</td><td style="text-align:center">数据输入</td><td style="text-align:center">8</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">input4</td><td style="text-align:center">数据输入</td><td style="text-align:center">8</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">input5</td><td style="text-align:center">数据输入</td><td style="text-align:center">8</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">输出</td><td style="text-align:center">结果</td><td style="text-align:center">8</td><td style="text-align:center">O</td></tr></tbody></table></div><div class="tab-item-content" id="t6-2"><ul><li>显然，本题的答案是<strong>1-6中未出现的最小正整数</strong></li><li>于是可以用独热码的方式记录这六个数有哪些出现过，再用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">B</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">F</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">n</mi><mi mathvariant="bold">d</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\bf{Bit Finder}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">B</span><span class="mord mathbf">i</span><span class="mord mathbf">t</span><span class="mord mathbf">F</span><span class="mord mathbf">i</span><span class="mord mathbf">n</span><span class="mord mathbf">d</span><span class="mord mathbf">e</span><span class="mord mathbf">r</span></span></span></span></span></span>找出<strong>最低位0</strong>即可</li><li>最后记得调整<code>appearance</code>（</li></ul></div><div class="tab-item-content" id="t6-3"><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/non.png" alt="main"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/non_one_hot.png" alt="one_hot"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q2-p0-l3-walker-2023-1120-1158">Q2 P0_L3_walker_2023(1120-1158)</h3><div class="tabs" id="t7"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="t7-1">题目要求</button><button type="button" class="tab " data-href="t7-2">思路</button><button type="button" class="tab " data-href="t7-3">实现</button></ul><div class="tab-contents"><div class="tab-item-content active" id="t7-1"><p>设计Mealy型状态机模拟在回型建筑中移动的学生。</p><p>某校有一栋回字型的建筑，可以分为八个单元，由右上角起顺时针编号为 1 至 8，结成一个环。现一名学生从编号 1（东北角）的单元开始移动。</p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/graph.svg" alt=""></p><ul><li>当学生恰好移动向相邻单元方向时，学生进入该相邻单元，输出其编号。</li><li>当学生的移动方向上没有单元，这次不移动，直接输出当前所在单元格编号。</li></ul><p>输入输出如下：</p><ul><li>输入<code>00</code>时，学生试图向上（北）移动。</li><li>输入<code>01</code>时，学生试图向下（南）移动。</li><li>输入<code>10</code>时，学生试图向左（西）移动。</li><li>输入<code>11</code>时，学生试图向右（东）移动。</li><li>输出学生试图移动到的建筑单元。</li></ul><p>模块端口定义如下：</p><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">功能</th><th style="text-align:center">位宽</th><th style="text-align:center">方向</th></tr></thead><tbody><tr><td style="text-align:center">input</td><td style="text-align:center">方向输入</td><td style="text-align:center">2</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">reset</td><td style="text-align:center">异步复位信号</td><td style="text-align:center">1</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">clk</td><td style="text-align:center">时钟信号</td><td style="text-align:center">1</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">output</td><td style="text-align:center">结果</td><td style="text-align:center">4</td><td style="text-align:center">O</td></tr></tbody></table></div><div class="tab-item-content" id="t7-2"><ul><li>可以用0-7来表示8个房间，这样只需用3位就可以存下状态，最后再加1即可</li><li>同时由于本体状态只会进行<code>-1</code>和<code>+1</code>两种变化，故可以用<code>S0</code>,<code>S1</code>,<code>S2</code>分别表示不动、进一步、退一步，这样又减去一位状态</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/walk.png" alt=""></p></div><div class="tab-item-content" id="t7-3"><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/walk_main.png" alt="main"></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/walk_next.png" alt="next_state_logic"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div><h3 id="q3-p0-l5-hexcode-2023">Q3 P0_L5_hexcode_2023</h3><h4 id="题意">题意</h4><p>使用 Logisim 搭建一个 Moore 状态机。该状态机每周期输入四位二进制数，作为一位十六进制输入。当此前三个周期的输入恰好为三个特定序列之一时，输出对应序列编号。</p><ul><li>对于输入与下列三者均不一致的情况，输出<code>0</code></li><li>对于输入依次为<code>EEE</code>的情况，输出<code>1</code></li><li>对于输入依次为<code>A0E</code>的情况，输出<code>2</code></li><li>对于输入依次为<code>0A0</code>的情况，输出<code>3</code></li></ul><p>模块端口定义如下：</p><table><thead><tr><th style="text-align:center">名称</th><th>功能</th><th style="text-align:center">位宽</th><th style="text-align:center">方向</th></tr></thead><tbody><tr><td style="text-align:center">input</td><td>十六进制输入</td><td style="text-align:center">4</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">reset</td><td>异步复位信号</td><td style="text-align:center">1</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">clk</td><td>时钟信号</td><td style="text-align:center">1</td><td style="text-align:center">I</td></tr><tr><td style="text-align:center">output</td><td>识别结果</td><td style="text-align:center">2</td><td style="text-align:center">O</td></tr></tbody></table><h4 id="题解">题解</h4><div class="note success simple"><p>法一：<br>用一个10个状态的自动机来描述字符之间的转换关系</p><p><del>组合逻辑分析点错直接rmk</del></p></div><div class="note success simple"><p>法二：</p><ul><li>可以用三个串联的寄存器，依次将三个周期的输出的存下来（类比移位寄存器）</li><li>然后判断答案就十分简单了，可以组合逻辑也可以直接用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">c</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">m</mi><mi mathvariant="bold">p</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\bf{comparator}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8293600000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">c</span><span class="mord mathbf">o</span><span class="mord mathbf">m</span><span class="mord mathbf">p</span><span class="mord mathbf">a</span><span class="mord mathbf">r</span><span class="mord mathbf">a</span><span class="mord mathbf">t</span><span class="mord mathbf">o</span><span class="mord mathbf">r</span></span></span></span></span></span></li><li>需要注意的是，寄存器初始值为0，所以为了避免误判<code>0A0</code>的情况，可以这样设计：</li></ul><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/98fbda373adc1cb1883ddfca8bcf55b.png" alt=""></p></div><h2 id="总结">总结</h2><p>考试之前不知道有<code>Analyze Circuit</code>这个功能，考场上直接手搓与或门，结果第二题我那个做法一直没查出来错，最后卡点搓了个这个东西出来极限通过<img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/emoji-6.png" style="height:1.5em"/></p><p><img src="https://cdn.jsdelivr.net/gh/EinNiemand28/my-img@master/images/walk2.png" alt="😅"></p>]]></content>
      
      
      <categories>
          
          <category> BUAA计算机组成原理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CO </tag>
            
            <tag> logisim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>备忘录</title>
      <link href="/27d394ca.html"/>
      <url>/27d394ca.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fcdb6ff90382f64a70a8aa7a714e0c87af4dfec4e4a21392f6d9f8fd3c6bd5a6">e02c7b5ffd1b81b2fc1acf24cdcd6ef53499145e54290a8b4a24d666e1865729492b8bc7994a78aa87371d36f05e705d7ccee859c26c624e09a72609903f2aceeefde696971abc1667c68594d26052a569126567c36a91dbaf636aee37eb52ab9ac204edfa2dfa05bbe7780edd485c48bbf8b4cfbaf7abc939156d2a53f5790c1594b8cf9910809517f1b781c9cff63b9eedff6c7b293c8d0ac7e8ccb1bde843f2650bcd80ecfee85c12675eff556e2c5f36af6fe34fcc886ca0502671d4b0fd9666905e9cc1e033fccfed862eb285e245f7bb6946551f0d45bdc463615346ed53667547e3da060b657231db9d36f3d9ece2d103d20da860b077f1e9012ff81c9146972751ca16289d2b129de800a81003e33dfc8d2c55587ea65c03d0da000a115acdab70388d55a5877f013576653132aa7d49ea4b9fa16808d2bb1712a183524c0eca26546aa254f2ed58e9e8ddce57fdc420349581d5caa9d6bc7668ab00d5d702619c740774aaae2b370d8059f35d53d43345048176ef2bd76836c7e11190e75ef117f1f10d472e12f2049a4b57f641d15650812c89219040bd24a9a7dd38accecba8e07e8e90e7a3fb1e8ac149a91db7656586a066f9d04e056a43b92e45bca2ece1af2d85063db50b5f713204b6256b8125daad27fbdfcfba60a8f24104f0df8af576b9c73dfc4eb18258085449c63e4c32b01529a7ec5e1561dcd2429037df363a6bd923ce5cc4daee83f4ed8b88c4ca3400673884e0d57653c3ca7ec5f708c6bf2e8b153f35eb5f3096bb891452755cb903f0d14f6762ec5d8f84b0e989032ef9bda9a36a9612ecde443ca97bad6bab660e81f75939fc1511da76e7523901ad33412b1c7c9028cc0d2d63d23dec8e95f0ddba453e2219bc3d3d2e73709c1a39e2cbf5558ae1e266ceab8fbbc7ed817a1dbb3d742dc1b15889488cc183dd2e5c80ae242e59de3ed959b508c44b7f2648401f219e8e3f66ac946b8df5f534705ba7784996de9f09809efd59d8fb7a98a0e805eed25ffa9a6d65957df9f634078773480d271f38cf7b9a0c6c440a8c88668a418da20f64ea5f25cd91711cc06163198b33f4f1c8483b6556077088a33a4f1e23c6d4d9cc574e0757468d9ed748f39589b4300e35f6db69929e50649adb8dc0393de45cf36e9cea172de1269d4d8b7151330e923d3451fb54d331ad1f9647464fa5eb65fb0e21bf47a73788dfb7321341c668696672fef2d1bf165964ca567e0067a65b72341cbd5fd5e9ef8a61b5fc8815726d05059cc4689494c4b7d178c8406b3a7ac1749f9e0b883f1eafdb917a89fbcb5b07028f6aed36e569041eddd14a11e66b5abff072c0cad1c93767502bc4a08ee4001a2f9436f741b8dbdcfaa79ad8d4293131c9bad98abed86fc231c323e78d2002cc56d71aaa8b0b6e5cbc186cd20ea5659bd16cd19d1445010849ca467fef03e59e72777e0ca41af8a7983fb0a81474d351afaae5d5b0acc8087407728031f59958c1c01c2ccf738e78f8ec6bebc5781cf40198a6f4ff0b4aeb313f2566eb2e7df1a91624061b35c0b8d2dd9dbe6525acc9d4857d5830f25140080fc875e48863d19ffdbf65b11c28c33e84c00b7535194365ffa79ad320b4adbe85ec00717d38f1bc6187df338d73016090acf29b95226ed80395603c54129bda434f05bd1456df9db0c3e732044eb9e59fd1ebf12e4c6d9c9ef77a47b2c1412aa9f480544938a18b68c7ca3e5cac76b9561e1676116a5b26f5b932b04ee30334a09215f31bb97e529bcd58b26ab661779e1cd20b198b65a144d90582c5b6f1f6c8ae33ef01b6d1673793ab5a9b1e468c03e6030d72405b82fb52fc0275e0ba84eab535d909f9bbf295aeb9d197f588f8abc6dea48e957a1ffb9908afc1f919d0c950a04df0f7b31c9b60576078cef6ff79ca585d625a2ccf0bf0afc36ed6c41e173481507b8685ef3cc5efcbb4a3c9af631d802d23c94e2847f8e7ac4df836de8cbcd0f496bce7c1c29ab752fc67589898bf0a48fd2d7743d05199646fec3e166fe12aac33662ee967f42f7295cc22d4efafd7c859d6b3ebabf58af9f1443f183ca329cac9fd8172f9e47a29e3b082fc1611af642b6352e39fc3572e26ce53b8dc14f04a2d0abc65acdb9e9b41b81eb88dbc6e2570db14356244d6b2c4c5a405cec76813f0b57c90248b9600379a2b153fe7b46bd03d509d3866865ac546f24573a2df34e04ce5cb4af6399ee308c38cde6fdb8f7aa6b3d4d9493baddaea907f15f23d501daff6698be3d74da7891820d5ba8471975276dcf2626cb9f4c53be4b636cb24484d948c729b194f346c5463c3d6f7cdbe57b0d0ff73d3e3dce864f63d49e8a6bbec45a145605b9ab8a187cce8c8d0fcde36813213a0f9d2fa9f6ce458af075777385b631fa8424b35bdf62ad95c0755f82e099a7860325d8ba3e4bdafa8882635819bce79b5871cb6f3c8c80ee32918aadef3352c10fa2910394ce5452433f83653f15b5034b44e1bbbd05875338776e5a2e3e1eb4b7917e0c768ea7bea4090ddd87a382a955cbbceac478cbb6f142c3864ebe7d810592ea90130b690c50efb4841f30581af8da29a8c978236d79e931a7f19c02dae5a0bdcbb3edd2c9d4ba7f5508fb29a71dec7e1a89f7aa79e32f1095b8ef58a04c02d7a003f6b83641b2a27afd94398cf110c2553295ffb28d3451af5cc61df8050422f9460e3f01248d623ee7f89bfb0dee30b27b226cf56db714fdaf9c0e5d5ccd6b5ec27c371ee344226e464c9ce50556d71a4074d384b0b1e49fad4ba76b968ac6a5d1aaa442635746104cadb71adbc00f17b88e36a67ec0c10f6b2d6241fbd67e74dbd9305e103f9d88155d696867e70e9e34009ae904045f935207a295f2060118a2e62dd4259072af1fc9788c13d5e88b9a4d61ed43f166627f72eaf41973cb7d0cddd07c25530d17e796268ba4d14185d350e5b359f0c73fa6853132159df50fc61de59dac4d37ff2edd9b9e9c43c83db61816d9d92f94c6361f99bda8d9b19e65d78715d40d73a1c1255d6e5f098f2e95aa49bc4899295153de9b1471d39859df49bff91ab22a0b74572bebe292b5a717efd9b25ef6d7fa7884c299223ef13b035df6f1ac441063661594c920f0c9211b4f3ccf476584ef42bfa818b22558c4013ad23dd67994751c49ec1c241e653701ce3908c006762c3a0d254c1d314f4b01f2df4cad0974a5c5c11b6a84dd37958748cb535f8a92672a52e544e9269dccb6128fb668b78fb93df8306b0fbfaab4a3a0db0c60b8f98f23b2138237d793177c0a0c7701ea5001f3721b144b87fba3406a21c85ce005298147b44676ba9ce5087b0583a8c85c08a27c5c3a0d459afa9f37397eedb155d4d56ec7fdd34a5c81a326bb44b06c732e87f02bffde3776b91a0ff15f9505c7d1e7b11fd7311f0cb7f4977a91bd87cc15a058fc0a6fe9373b60c229325f9333cc485ee4ff3f53b0bb559336ce582a1eccfc8e2309931a1a1dbda278157fa2fa9751bd042642bad1f771e1294f994ca1e507db230ec256d75566e94599f5235596de8def841a6903371e51b34edca6db570b9f279a374a2e22f9a68c25232b54d8a0913e623b11397235277776e6753c777860d687a5ede6b3ab21d0f3337564f736bcd2c7e305c68cc8e586c91272420543a46b6133a41ee984dad2b113d48933f9353af4a649726f134cdc30ed467baaffa5623137ed1b4ea753074c72f7fba33f351d5f1d8293271b888e43739386b5463d9cc31e2db9cb44bec32c21da067830b595b5cbe9bf0d4bfb8b8497b59d371b88f5c547e4fad7964ce38a0134ca1b96785755d319d4d7fd7fad5b28a64cce6563d8957b0b4dd40bdb96a7ea4fb3504b30ca3fac9a1dd1382cc6244175e1110795fc3d39b02c5e0b9f1081ff6098677438ac579380788433140e8e94f1e92f92295a18c6048dc61551ffdaacbe784ba18c01630e8e745d011f4f08b729df2883224b5ddcec6583c239a89c0b78d74a83482c73855db6b86a265776b8d5bed0f3ba58760095a423ccd85e89193ca759f4a07623ab8ffc48ac73f19a2306be2f951f8d5cb468c03b28bbdad503d8476bf05d174e78e10cdc8c6279bb43d3648b542ae3ea80d43e517e8fbc8ef7a27dffdf04cfeec7db0b53998c08d9fa4bb40e4f9db1ca6c093546442a03badca4b139166006ac26d870cc355c80cfe62b3f0bc103b7aa62cedb6e818454650557417ef88c74ef1ec47cf3413121fda47c4701f20f44c55c5e9990e985434d58a65df00deff3655845501dd0121669fde75342d5b8baef9c200a3b223d04c00f4f40482cd04ad9e556e21ac60cc7153c51525f74b750ec34d280613b8656c8daa30d657cb20c4b2ea6076aa6f116f57cd606e4be59b623c00e98ccf96efee38cfa768af8729fc802774819844457cced582914ddb68c937cf31d6afd5eabba844cbb6c76a062a2ff7c3dcb02b0cedb182e314bf7ebc942b0d9f94ea96c2c31a1ca4c4e686183cd53907ba130da6af1c147a39c215e2722d119d340a8d2983854e904e579242e7662d0054d0fc94b457edd79e711097ad2993d807ca172726ed7cfcfe41588f0048971428926353b79971eef76ebe901d3d0658b3e867007b98ec05ce081d773dccb1c66f155699f9687baedebf04ea2c783d192d1ac9abc7da2af391a7b873bcff2b64ebeb0eb6701808a4fee90e48f3cebf3d381f58fbcf9d3fd8eaf4082ace3ebfe7c6b077b1365123328561eefe8f4f454f5d643fe26aa3555f78e3df89667f46d2109fafae3b2af2e8987bd7850bb7a226093d4737982a3e748367f6d61663a021736fcf88ece519e86901d9b7e6dc86b308f505fc38290c904006362621375fa1426a9dd3dded48506a52a8b2ba50710ff64aab2aef6932bedb580fd43523059b25bde79e648ba543a96ab64e06dcc26be1bf3d09729a091ae397f93b72fdd77e4756e0023d9749a33f630f105b401c51c7ea742169596c190ade0aebfa2d9fb577b47badb1cc32a6f34b77c7617200b5bd772fd86d3a61e4a769e952662b8d49dda2111a10c6930ac6db88a160523f71d72454b13cca1e49632fece891da6b007e6835782fedc7405955f69d666163a99479323450f6ad3eabb5f3718b9a0d89bc63b402f1875289f6c35463c3ba0e6b087db11ab8c0c6029f1ce5559db47ca9ec71bc31b46f3ad78cf54ff1bae1134d98e34c9effbffb38fd44fb5eca811f14ac30a61636294bd515b232c182a93e03e6f3c3cab9920ca4ebebf06ab9ea996527c0da4d7cfed92282ca72a3140305f8ed97b7a42b1d70802896cdac7ab835bb18677321b3e9a0ff5c47dc8c35df840e4ac09bd4192227d1a03bb5e3b4efbe375dd52d6dcb11646747e8b96f9eaa8e0e74dd01c540082b0edfb5f33e76ef7a5b348b58d7699b8e896fc514834eae3c32c8a8f0732718376ac4fc92d5b2ca109946479ec9e22add02f77e9520dccf93eb55ed26910133727c94b7e87b9c9af03906ada8008c2e3e734ec4c69ed3777f8eccb2b858c4cbcf84154fb349dac736e832db645e08133498d810d1c8c976c6804df99192e749fc1adf47740f8a3a79a0d4d5398db2727793d427cc94719bfa2e24510156ca87ff6b1d0decc435e8d2ddc8ff17e7f29e38da0753722724bbda11703a0604bf2f3ae3128501f10e67e84106d4f8972e8b9b279f7a351b4906890a8967b6162254efdb57d6dae886e01b39b8ce7db830c316b73fec21437c79819dca7f4978270d30041a97b68bb8ebb87d36fe1d5686606446d45339b1a473f4c2343e5109bbd8db838d48d7af136df8f443ea7478fb2e055ee03615e40ad69333cba23e4408480c3ca023bc79db5a6e05cf5069798d1b7403679b0c41dde5f6f579cc9423ebecfae3da9468527305cbd4c2938b791dbda2cdba73b9c1abb70166d3f48b41a8502a0d1023b728e0f7bf73ef9aafdafbbb75bee22f89d27e7015f4b3b402d17e21cc952d631c5e98754a6c98417ad7fa9116c43d644d404e5ac399f4397eb60272235d1f37cea829f2307050463155e964006edae8641491d594885cea21202b8737bdfa24cb133e1949c2deeb170493c6476a3750109abc45a818491394ad65c8eae26b35ee405f404ca980d36a5f08800d74ad246ba7a7cd270f592319243449efb7149330a6b33d7254bd0b7bfe92a5f7a0db1a68e41b474fe08914523a89e15f2f66dbb972222fe70de1dad4ed7b76127103c168cdbef565a136da2926e0861dab118d2b6d13186a20b31002209be15bd15a98f9408016b9bcc2845f32138be6f342fac4c1188e7ac1e19ca91c03bf0deca6403b92235c72b96ad9b19ad3839cc43a44f5694f35ed418a0785b5d78dc77b1b37592fe6145c4d092e1a00c89ffe4d05febebf23aa5a4ba80c1f8366a8eb5f52b6a16c43b0f7f2d91d62c3fd1a45901f7ceb4cc4abc9fdada510770b04b0e1d0ee84add9a43b3a53603636efb97c2a1ea0fedbc60a6f9af1745f13af90585f68460b53129edcfd22791b91fe98bae0e04afb9534c2caa66b5bb227648900ccf68be040639fd6e68153050371c7e71e99667756d1c723a1d5c9abd7a5bbb98497cc569acf8dfb38ffd7461ae354c22538d6efd5f13a8074e7392ca3c29a2e04f32b7ad6bbdd0cce20bd30b96e9c2e64503276a88c6b009099c81a023461e18bd99ad3c2a8159245eb4c0c3209f0362b958213782c6d967c71b6f19dc86212f64532c11f7f715774f01d06de4d455c315e7e23ed6b169867eea816a750182b1689e2961d3f88429736eadc250a9e585e4bcc9c6c054147ad49af01be3d48a7f01b6597e14a3909b282eaf75ff2c65c4df090ec4ec9c115e5cb2b26dc3d16cfec71189d73e5d82e47f4b5e4ed6b2b4671860e908c7eb12a990240111db68c14d45e7b5c0c42358cde4ae8a2cc84f685d07a57c059919ebc30b3be40a0be2fd37cf3a12e1f1b7b80e3b8165ee8210fa126a1eebbfe7acab8541136e7326052bab4ae4b2951a88af1f0b611da7828bdfc603d0b2fa08287db935a26682c77238fef61619592fbb39892d0a3b4af2dfc92d772ec88b5601cb0692d97da82e1bb61370484ef9a6039dd7f098e80b8afe75c8cbed77303aeb61555f00abf6a4315cf9416cbda0b54132fd53932c72e7edb2d52618b8e2a7956038963a6e12e161d1ff1e123bd4f96a32e5556ad1e8dee2436795df1fc7683c25911a3e4d264626f27bd3149cf71d34e9000b628ce749a00e44eff0173eb6f910211cab9d7a68ebd156889504b8803f65d6c14111af5ababd64ed7a30b843f1d3fa4985beb2755dd8c7b73b0edb56d38120405a5494aa761233775728b3fdc23a6402004f698280260434d6442c5c1e12e7969fd71ff55ce045cbfa1bfbabac2742636710acfb48e30bd3d474e5f9135784b922a0199d4ba1f9f059cca4899e7fbf116ed9c0b13e4152dd1123278f5c462e3066602ee33820a9872f34088f13150b9e56f85729a716feb6f1a04a6b0c95900be7a2df5672f67ecaf7254c3f255280a74d3aecd0c8d2f61f986af54fecb337536a619fb6805371b5bf3c09e06a5d1df877fab5e1d6761f4ee2041d7a7a43d3857eb776cf6fd1e44efd97e20833dd2ffbed27749a38dab3091f4d61ab8f3f6714c93cba71715e3e3eb55ab414cce9b479bbe56de33a64a46da10933bbd36e4d6e74d415599f676b7ae884f73f57934340daa9d90c3f94c463c30fe98bcd2836d55b9c8c357dc901833277cc475bee92f6cb0f71133951782e2797fe89400d11df16cd6f5390ff6530a61be17dfcb13ba914cc80133f448bb5d27624d43e821aa8bb20f5fdd2a7ba797f077a7f940bb0d32d564e02f799557f737f983e9bee4ee36c0f0de5276ee8ef23b71b23b4d8c3c2da7eb250923e83ee72f33459bb22acbe0a33caf09817762e30c88540bc695999d7a2da0aa47b02f65fa5be0a9463d20893479593a5f9d29e04dc906175747e2718fd63567f35fa75d230ed9d400137fc426299452ec650c8e2047aadbdd8767cbe74d542fac98ae12ba0ec9b927219a69600b9bd67422d5f52cd376206c8ea0e5ff0d35b2d9de4e89867a086add063af1faed45c5aa8744ca26ac7678ffb11748cadbd5c50b52f79c7523e330cbf5e10dc3710cd37ee94d511a8a6478b63fca9e6fa38020823d1a1b8b909878898b4540ea0d175b813b997c59ec204dab021220dd236822ce9ba6e57010a71bc4db223fe7e4fb86064a2d09e17bf7bd1d88ed297bccec510c129a3268026b9e66de842a65e3f7937946bb9abbc413535bec476d7a3830f368c2ad7476eb923e15d445e3b100244c027b60fc3dceece613510fa479417219f73dcb0cbab424e06e95c440445403f11760f26d7fdaa7133ae5df6dd0aa6e24b57502e3d3e62ea430227c19f25852ca5644d858b4d3465445ec8bd289de029a67d242e9ddd1ea3d05d354ae50ef8884277672e081404f8a20bcc0c080056223af2e182927a05b005547c643a485ac5668d9c33af9d14468e3871c19eb78218e896d26abf8b4f1bfdaa76bcc3d6f1bf32f2841c4331b84ee71851119c6f637f55a6071203bacf599108681aad15866c41a8f1e77993426ec9a7b5a71f589eec17b17841b97bca3ec1cfdc0c42b7159af5e15e9b27ed9115dc7252739f12705122ce070f2d1628d710225ad977b1d9c23baee869f37ef30dadb70cedc3c7257e20266cb5b39d1e31375beb312fbcca727f6c46d2ed748fb31272b35a54c4bd38097113538a072270fc6f5afade4e85af423dcc734311ef4cadd5f35c0ac96af2059e672ac80faeaa0973afcd467608d5f05912ca7b78a45321671a9770eb10b55fb18b91057406db7a9230f96a4bb3062c3d8b20040891b2d65c6803ea7c8f7666741b5b34500347defe94a469f71b5c70857f6330d5e4709d6fe6e0e99669e45d90e4ffb2f36db7b841974864a9b327b8417bbf6e211cc1d4b95895f9ddd60f91503e75eab7e2fb830b7aa9e0fcdfbc03f8434e77a567b8de552d5101aeebabad5551b27dd7d4d253828363c5e69fe12caeb97b97599fb2ff1cb377264b10be6aada0798a9e86112fcd8343ff883cfc5a0c9c60e09648725794ecd298aae1767d8e49313546c6355823077317afa57a03b85c37c24825190a38d52b82a9508ce6d79b04d4f0abe46ce11593b2db8e150cfee3a0cc2e351a43eaadcc89f21da57c055eaea76220276996d9eee229deb73900cd4bcec4322e32781a3f4142aa67d101bce6c3d905cb69ab6a45d92d539a315a09ed44c9373440ced3bc923fa757e37179c454cffc68fdb05e1e93af884a104619fe2e2e8636655424b2fcf57e0379569846893f4d755ef50eda1884207b8b9831a0a7fe001fbb324b6211be32bea1582496d084f43f80f34e0aa377eef2e5f4785aaab05f918cf58e549b9afc443517a493b025087ef5bbf760d05b1da9a06ef594f4eca4e3a47077ca59fc473826877e58b3d735dc33a3fe0163183ef4a44e24a4f27aaf7edba3b2ec3ba41ea4fba31ab95edb264908fe01a2a407ebea77b0bf5ab176ee836523e65ebd9e7614c63f379616c52a7ec01eff539036007a1e228fe976cac3ec72b543e06c06d30918182800c2d3cb1d9fffb2b228f1a28c9185390912aa00296460394d8530424cdc9e8e1a2166d76296314813e1a7f453bf9aea8c919ede999eddd25d95d2cd10b532b3d9af7eca1b7dc17efb882792e61b3c650f213e2d2149b80b0ad128a33a8c2a155e9430f613b0faf0102cdb57f5bab08e102eabaf7ff6777cc199cf331a37f718fcfeb3ac9c72b1049da9635b54112628828f7d4b85bf15e68d6baa1ed311534ccc4499b42e85285ead817c2ea0d1c5616190f17b537fa5029b0eafbf3f4aa6e2feb856e746193662afa792a9b137c37900bebc246a6b71a45046828637d99814a23ab434b07eade89dce47552d3d281a0660cac2dad646b0e39e1792fca5c625498041cb11077bc2d5a1aae0792fdcce6ecdec324d5c24e30549661da30cbb543ca6343bc49ae98178bed1f6673f0effe0253e8ee92ece3b6f4f643796bc98148295a3837265f5164a7674bae2eae0be4fdc291485d9d2b0b48026a2ab3b62ddfe909a851064084ed42208f53bb6265c638ee3e5d79e8e9d76a123dce37225039095d49b7d55d50e307a7fde3376edb7db001cc026409c78c70b13aafbfba4279c2d827eae767e4f6159ea7bd03642cfa83eb4da15060d97505af80a977ba5bbfc0ce61743b61ea4d4f1b9baa3eb4bf93dca9e3a7563f98bee28262d717a08c5ca16e4cca5848970af96e9229f669cb8cdf85029afb1eb7ec2fec3534aa163323dc2e0ff5b201d89eb34cc7d20568bdfb2187dd38044488fced73ba48c038248c093eafcb7681d0d92a40796e05118b76bc3732781b500becda13b181b728a2f5c946d80da8086118188696e282244dfcd18a1c3064663fa42398b6f5e4585c27a6928f55a589bc51e2d47346a9d2885b99c79acdc78cf574bdabb65d240d932e2922a8895035d64b6d6b04b21c48d1165b92962b216196e2ac3662e96a2a62947183d9eddcc904a0c1b36cd103f6d60c9796bbaafcf397d2b9f43607ff6a21db3f7d321046e042884ebb0e09e3a7948bf34acb6e12879195f22d32c79a10b84eb6a57c163b179cb4d683edaeeed1a2d2a91f14e531c12aa07cb1707a26018345c8d12fb3a89ee767db64b5bb68abfe1b5d2864a9a351fe5c6d90796093b5c5c39d5926062fc6b0e0a7691c99eb6b1678d8932d61db18bff7376426a3278be497b6a78adb9d5b1a2278d4fb177b14c89475d9ab6c8429994676560992a2ad8e21d6308dc56b16bea8676f6afbc4d587a13079342d3fc40638701036ab5ac4cf48244119b01cb8aee52a92fbd525ecd909a06c585da3792f62a998b8ba6afe49154a8b6c5dac04e3b7e1b2e4151540284bf40bc30a24512ce4c1db93e7425a6020f42e2377d6bee114f2fb20702349c5ee142f70012a0ab12d89cef35601dc35d341592aa6d2ed060f0d035a1a823deac67bdeb1f25416fc4ee90553c99676bab5fc1d78cc3cc50ea0a94c53f34d0da0b1cecbe78018655cc698272e64782c4ab310fd3509755cc4403c354a36cba6ee6fd44dcc7a79210296e33594ec7657e74834fe65ca6279170ea163a68a7a9b67c14d1955d349e0ef5f5e49606e74a94fb7f01ead0a5f55580158b15f30244fc568b4dc971bf33518c7d98d37af8fd93174f7663904184cef1b15d44276bf1ef283ba61e2bf18667b9eac988b629ce62b1ad84eec915d3e3e0a423b6e0d0f57a44810e3ae3356f15a93f38fd1f0a5e7cb86d75b669554ab8596146c0a309c534363b4da28857774796c656b6f54b76aaa3ecca075bf1a246b23930b58715cb1365aea1d9ee2ea3df318085e083c72e6a17f28fa0a58a5dc60e3d09c276b971e887e85df52c497564c91dc997e5e4dac99497e6960478b42bcc0c4c13ac0efcb156dd0eb1f6601ab48ed07717fcb231ea66d5ed46c3caedf93dbb82839312f012f48d5b599c0f164db351e3e70cd411d0ee22bfdcaaf23b8698eb3f1f5b33291226ff0ea7e8e21a46caa0ad6498c82fda8323835d1de7473f28c6c85936edf93317de93e8abc48150ef1beffc61f56a8e2e4b2d6d7233dbb43f5be7ab18255f09b7aea30620ff3ff428fedbec1d71758bceadf480776e3aab5b25f87528152218d659d03e80d4d1d43b122245931391b16b3f2bac2e3df28b171b164c129e7f2effb63f32475755041f740c0caf3c56ae587db387cdda583da54a86622d09315e3c1f3cdc77593819e6d9f6c436996ed2a382e5069231f23bce7b6fc74b425f97ce0527453bb4f117691ecd4de6afbec2f24692b7fc55459723639aa8462585d3d07e287b96859461b5d43386931c498abffd78128da0238e65e62bfa85a6ccf3207ee9c6037e4f9c6d44006e277cd2a859b165c493e5d1b56aa855c68df88719817b6726b90f8eff65f72feb66e75b51f033d9fa1277937b6a0f11074d121fe14ac871685c913a81aead757935a504127ba56ef41ca2756b54d751250e9a11f431534b0785f46ae4fe8c0dfae6bfaa660ece3387400c29d9fe891840820cdf83698a855e258352777a7f6ea7f07492eda2bb00a3bdb1f76bb3a1a28d50ac40ffb548b5c56a27f049625fe7b456c755a6b23e1ee58cfd944fc48ed629871829f4d4c793c81340274c4203d310ae9bca98ea5eca5ab1b6908b34c77238c40b12c0c01a9cd66da578ff271d55701d5b2a0fc6fa00e5e6e187aa1b945c70f26408e72e7d51f0b3799a5ec4a078187d566baad22b13907466775912566e06d245e7e8ef352e92fce00f8261a0b21bc44e54168618d12f686ab3e48bbe083ec807a598a90d1585f76bd326bdc5d20101b61be0b93320e6fcb3f23fdf52f8338df650b722f0514feb0fd0926b5f9ac4155449f5f46487052fee93a528cc2237ae349ad1fa101972d721949c737e8b0a9e74467947a35605d85ccc59813e387015103f6fb53df51f268e5093ff1aa57b08d8e84cdfb26aefdc24ce0d6c214747c7023939d839287ee09f71e7c6588ac13407e8160f7d5e2a941ae580084cfb246ac8c5ab99156afbfebea770c039cd2d0e175e3d2403614b5cbfcc444b0408ee51fd98f2df301ccbc2af88b00740df83b850b43b5d2fceb9eb18b1ff05f85721d036c4a3e28485cfac0885764e57e4e7972daf7e915d3d02202ec00920b3d6671ae4cde0091f3d53e7332c16600290efb6a039eeced69b30e2b153aaa37c69b438747aeba1134df37a2c5ac51dd0721e1dc5f658bf50bebc736ed7522b5dc4a5b9004f81d9247b0c4d4ba84ab4c634ab9b5e5f39a5d4fdb961234d10da99e7105dc641a808b05d7d55dc37d1f8fcd439d2dadbefcfa26f4b5da2c59f76c8555c47a55c870d680cf651b919bdc5cc1d5fd3771004ac40123f7eb1453e70676c48f7f0ecdf4c4a00b82431b578b7108b882b69635bccd0c226984bf340c3dd8dbffb5ba317049a9dc04f2be295f3586cc2562e5b31847e19e4ea98fc03d02485ee712e86e742c5ba2d1acd9364b1ed73758166f66f3b85f385254c6de81539f9a87eb413835313923943b891e2d10e7fc592fcfedac6831965eaeb04c9d5a20328bbff7d55c832f6a98e9da58a84161861858a72e319b89a164edf4c886478fdcac6e354e8d8ddba2a1f2487e5a5d0faf191791c16a807f20f2297a759e6dd821b9eb2f983245872eb34b9fc9feeb401e07b95bc56c9e3fda0e00174354d2374cae80fcca12efc8d74d9e74219cca8fa04290dd1aac8a1559485bf0164021fc9ac1f1ebbba71a2955fcbf02f7de9c9821328dbdcf0adc3044f4975e4b450e5fe235969b45681a422cab34ec445ae91434e642efda9e62358c687e57613b52f80937f4761c9407338dd19f48016b8fb97c1aae1056b36f25cba6214166c25d6f9fa048db0d5ff08be938e39ab8bb6be1e04aab16edc309c2475232b1180ba1107ee02e72fb709d8bd2abc9994b260cbc1eb31dd17c6c08af72b292bc20529719022f481ff8caf5eca08cf31e36ff797d73bb272bd4a5208beede075e6029d80ac90ba65634a326806f27c03cb6180bd2942c422ed18437bb2b9a5482a0ea244a08a568ecf4983cb69f95d49d09c7498e6759c44c862419d9e65804e817e744f83eaf5f4aaed76a8fcefe9b0f4e8e155270632311b79c21f875665df934d9547d6199ce871494e50530c71402aabf0b07317da32e915e1bf1071c8b64d6d5d3ed2d9956c3ae3bc7ffdb76c1f255218c6ce51c73ba44e4f9fccc7ea39063fa27d3931cfc614d541f12c197b203440a05603bcd720bb57cf717595d64cb098d1122f1220facc6e00eef16ad62f6ac112c3fd221e7968b750806b2c7190cdd80e30e17c160523e92a94fc0f77ec2d4dcfe4404d00681933466b76c74e69c6cf1f538817e09376dd634888d768871aa4816f3a11f5b601eace8b2de2e311f63c504769d894b6affe5434a26d449074fe020b30cfe28b05b804de78d7533278a330e779066d989974a95ea813f9433959fdab4b4e5d3195b82ef1faa568f90945960c3a9aa35b2e50998ae83b3dd7f2bcc0b8aa16655257853862073c4f0fd550655d3f7e5a790bbe6429d50081bc3c9c3524cc349ec06c5d3072abc887dc55bcb8d1631b34c22cc64c508058fe47718e645906b948398231a1a49e462c5220515c107de37d304fbb361fdde7f015159ceafaa2db997dc5cdb8e80d5ebec3bed5929abb7aa60147e4f37aca2e8068d4711ff3a98ce8aedcb762b19b8d99157cbde201961b9766330a6700395718c5bcf17a6cdefdc126977b4ad65724684d9612f9019b62d97c1e64d00efa04c86e192b57e64d3645d9492ba52911b3708b9f2a0c989cc3ba7aa072ba6762296c915353a61b22d027b8d6b2aadd4d1c5f8586b8553c51af31f00bcc2d74f07e084fbc4ac74de0826be5290ff9081e308027903b2e177ecf7c78170ae69805b2d3195a195fbd80e0c2c92ba922673072aca25ec0d42d2318e3ba11314e35d86334479faccad9a12194b54e853c9a7818576037710da413f96323c5d4a478c3448e8d5e6c96645b88281ffee184c1dfc32fd5ce42a2a039c4411f3a0e1541a08f329a8b607eeec2e7f0e2cab8870f041ee6f6ec4c6700101fda6cbe0f3e91d3e4bcf3e816d99169dd6fadc18f0e3a8b6b0e84f55de2b01a01066d105ef4b0807d3a2a17781fb458fe1d11d65be9bc8121ca5361bcd579a19d96095d61c7376f139b86c8b40e0a159c4a779197bf601c31b93b81c68f20601c16f39d20d535a5145ab99109df3f16620674c3e8f18a6df7a298e4bfe0e9df6f10ce9cd172667e91c01519eb87589cfd24a93516b7066001dc1e226f26946a08950d47bf7e5f1266beaf099f86f8280fbf0049f91492077b5ee1736d5a149c5e61a472aeebd61e6e54a2ed0d63ab9f7d8a858193839714d02e74fca86b74c0dc78baeea2356843c00b401410482697f1697412af0f6babb55fa6466ecf635c28458870f3a1d5ad3b4c6b66f6c17e46f0e7a56f1756bc85ee6b46af7bbd6497b8a3571c307fa168074be036edd659f3c38494c8dd4d0354a6db210d257ddeb15e1da62f2700044d673365c110f9ea8475233bfc8ee39be409b01b6330242fb1f3cb983e011503fe1499b7d9cc3c4f63c0a85dfd77096180364b66d400ac0520ed3b48c9a515c665566a79097d50bc0c4a8ba7b33efd76fe92db6307c3fb249668a630256af10d2ef6579e386ab91a475d5498f0affecfdbbf7bd1c119554cbd9eac2fdaaad6a59587e8a252e470507d1d4e029b7f790105fc617cfa5b92fc198d1a9f13a588e077c37ade6ddbf6d1dc7affd1edc4edf898fe1d474dd4664ebf462a4bb1b6cc2983b06a07f9cf30e1f2c0ad708e880622424da09ef39c9c84ddb2772e5b68a8566446282e8786fe30bf32dedeb2477edfdeccaeab6961623fd141327aae5aca4ef1fc22f1f6199055a5f28a9eebaa9b0255ed3a9e485ed386c6b34cc49c3438de380146cee1ce4f5f74f9bb0153f24c746dc219773907d5da89db2ccdf854d3953c6fa73b233d0cafc8a47ca7a30f4a5b869409a517c9de9296b2313ebcbfd1c54be38f0959c838dbf154bd7065109a71a7d3435eb412c9ae938a058fe74a004ecdfb90d91b757b56572fa73bfc2aedd9cfc11213ab928ebc7662f3c0f37fb1b0141b656c9dd9c885541e8bb84c3f80d85aff46dee992cff5d60080dea78c3d2b5a93d8a1616151a180110475e371caa51088bb6b90e1fb770cd4731d5d26b3f4ddda4a5feaceb937575aad386a8b9c5ad2da1361685019481ef085580864c82c713666300ce4ce642a9f00895bea21c80cf20f3481fcd11238699539690c9290be78d43767a7c91ed127e761191ba852c3031766278c318ef43585f66ef03a49c3e87438cf4c19e9a507dc791d2b76221c87293a73afb258a5e28e15fb8260c6eddd359e9cefca2dabc7900190dd411f7ce080f373a4106523a57bb8d2634b5f565e726042f8facea32d952a9d04f99538f302aad5086089df69996334f24b9faa73f20998469a0231b4061f7077bd89a5885d203d79ecd7c255c5d366d8636f043ff57199c75ceffb2f84f03ea47749b79841a790671d32b617f8250dac8c740a6e0d1ae58a45145f981d9c3235b8c5da1f4c3b23a006780d742b1b01ad485f33d3a754e2f18d626b25a28318deccfea8b9658621805d62080faa2f3259c6842102db5df6f8ffb7bcfdbb397a007f8ec86b4d3858373c0075fee7b76082a0c09fdf7b20ab914c5ebbe1c3489995a9e7390e16511531a0905b7567cdd3988735e565ecf2bff8b1635d752f6f28f093034017563dc76ff9c2b3d51b8b436c1a6e43c7b8330060df9d5fa7f1c9f1426d7714971a595b6ac187d250275d59822acca932683987f06a249d684314f4b3528793792cbf07575bc05cd33dc4311841edc6f50bbeeb09248963b32e2aacaece9af69fc35cc00097b06a799e333fc71f015b9dac7fe80d8c8e95b059089c5ab6fb4cbca7d93df58d111fa6db1deff28569fee3f2f1c9970575f4a2386c702cfef7f4e051a8967f0910e3d535d1c512171a53df3931ccbe76648077183a65bb0c7fc2f5af1b2b8ecaac782240a290218ede560f5618abdb59214fbb92e3e21fd3746d7d5132797225d41e2d274bba94a2e23c7d72cfdd1893216bb768b5d1ef5fec68f22c4cc4dc72353bc0b321bfa72c506d93723ec088c898be52d328c2f47e0675b53c79988895e6f03f3b4dda6e56428cc874d33db48d0104d015ae75aaf4330a4215008374728b17be2af6c6c2fdf152a293db5208aa7dd2a0a1025a0b351f61e28eaf9a7169f8489ed9675af58c006961acfbab5e7ce630b876af2037006a7d52dd8cf993cd5a316b2662e192052409f5fc2e60697a954c491fe0a6ff2a8668ee4c5f4906e6b539dad3535dff3b0baaec6087be8688528c08f2efc57d567308eccdf89e75bc1f0c0f94fe119d7a7b7661b3e23d736c452ffef105a0c2a3dff9d86a9587d443c66c80ac562b76173423cdca5a2e4aa6f8ea6af36af8c31017b962a45bb6a83c9e38b0a452e46c8b8aa898129ef9fe8f70c91c96b48a90c56b752962286d4986711d57f877938ec2508d9179c79cc8ebdb729fc24b29f6a3630e004992f9f1483c7adec73d158a8a59f359e1cbe939906e903593e4e2bf7d34dfab5ba61c7abfa466265205a1b854da0f98e2ad55751b3c2d4fc7d142175a664112d6fe91a83486abad5e367af5eec519e5dd03b5bc86157cc7872e16bbe4675931222d25c06a64bf0e485a4f9dbe9aa808602586639cefb32170dfc38203383f47971f599fca46d37ac2cc43ccb5842b1511407c6df1aa112f74eef2409b2311ec456bf7cc4fafac1427863a8e6b6220b9095e4a805059ffaa0598a4ed8be4ba1e38496463a60d88565f74d3f93d0986421175b883145c516471b39a0c7c475f4f0570232c0a3fb2d1fc05e7c9402e219c16bc9f42ff94333ae195b44585a25b9a35b8ce200f4fca679ea732971d7cb5ba6930b84f61f34f7141d052e212c889a4c5cd04b873a9573f1fec74d830a37ef400ce9b676e6a785c84df941942905849e265c90d2b5ea0fb47e8dbf068230e15950dd8919e686c65879a5c40b2a01dc481a95a68a3de3399b1a3ef7c82a07917ac0edcfe59fb561e7f0cf2eb4464ecbf65046dcca36100b53a6450fef46c6b931f507fb5743b1b89727749566a474c679e3841b511990fdfcc2b637f6174a882aea152872756ffcf31e72b61932d1dd3972c7b1a3b2febba2fc9629f8660ec786e5f65f8c9f42f34140607f76413d738e83d438da74da30cc4f2d5aa0325ce27c84cf6d2bee4437f18db99bd2aad1d7f9cd5a542b38d7bae2987f4c884d2b9873f7656c8b3624ad07bd8c064cda2997048ec67248769c4eb716522189cf628fb44bfdea39cd97c6de57e873e056b3d789bc3a7ec38d889a27f9e8fe41ef0943cdf42d68514222a8072edc7b3f375e9a16926d9035f6f8379e241a8052da41b9a8a786d90d742b48d02cb6a627f63ad2e7366269323efe79f02bcd2ae5559f1b0aeeda26477dac5a500bb67ed4d4518569f32a3a6dabefeab898d1a89cd471743b00e442253193c08837f03a1a7571a4debb8bb30bc9aa3f12e9c4f48d6de9f9ccc3d971e9dccd48bf3bb3ade0776353ae8935ff870ace69f484fa75dbf0bf411591b1e726dd6f42907614a9bf95489584d36aab099dcee859003d7bc348ba5e8b56ff8f4d21f0464bbd4cc499ad7bf71af79bfffeaf7cf797b8d0b6d78a1df5cf607205b54bd3de0c296ff56a095a499b795886bd5c5da929cfd324b2388d3e27468f09c229de896fff16d23817f214d0a27304539a517ac7ce0c0304aaf8b8c0ed1c5ed90e4655aba17585a8c8e7c885fdbc8827896f4528a010e915dff7d460e4ee97f47299a2d63aad1909d0df8e83df8614d2f48742f1603c970bbc3749e367d86f6b4371364dffb832b65887824b7276c6640c403a9666995dbeb57c5a4d20501b7b07ca6f525a42ab084785e73e1541238815212c63bd0d9ecc6eb94870f9722b3c041767e8eadcad1080f844650ab308111483d32d79ef29547dceea7f03435a4ebb457072e2fd06976edde810bee2611a384a8a59bf44c433d15518a018359fb17a601297390cdd25f4a29de1c0567d7e8392a867904f4bd41cd4c760c27d1ef8a55868e07ed89ec6dda8fa4e3fd7fcf704b9ceeb78141cd3368ac4d8ca05a9a216b9ef7903495e358fd85725d96fe3af5f944b6e0126cfc038833660adb30cfb21ee85bc25485dad8221d5900b25dfb9dc4e1d772448e2fc233b5cee370dcd6755f28e26b6596450147cbdd83bd1d405aaeabf8942a8169d5c2138681a7e5a080b150d992235d32dee51d03e2b557a7731a91be57fe9faa02220cdceb249edce13f1ad60018d2b119491506aa0bf7459179b0c5ba23a766885a2b47b6ce695800ae9780654f7b0a2d15e2e252c142048b84b80cdb8894867ec28fa543014c12c3e2bd06d44c7aec44bd9f1f7a3b4b64ab758ad448e6d99492c675ec7d45eeb85fe9fd3d1419290ca84bbfebc9ae4b962534b59df564bcd40fc3edecafeb3dcb8250f7115bcc87baaff451c7367be9251088a6ca87e2039764700bbb51eff4af98fbc981091e8fb77813196d8d5515a3b4e4edbb0c0cae4bc6cbacc3142d3e94845c7e3fe184c70d36a14d6d73b5a08eeee9e6e7bb04b5c8e076c69e51d47deb2d7db6c0416dc61a541f0edd37d3e3b80388539a71bcd3d96b4e2ef47af6b7c3aee25fb559a622f6f3a098c0563229973b6f55c26557029de40848b7ebe1f398e667bedba27dc7f02cd01fed0509951aba2330531816fabea1267610806ae3b23df9a1518fb2c86f00d34bb726deccd328ceadb6c6bb58385362879dce984258e56e8c281812375a0a83ea45bf303c4cd75511762b25d43723848c02038bed017b4dfdda418eaa4e96274facb74d8bff9c4401b618c246b08c5578d0e9f237b87349c83fa7ecf6ff72f7517555a8cebd3003e2e4b06baeee28c01cd4e92dde92611753799eb818edd9fc0b9f834267de253be37b5c0a8c332d2a2209ba18b2aa308257534288a6c302b93a9d193bfcbe7a7eb8693f65665b546373df7ada1306204abce76c7fe3d640d7c93b8d2dad3dc315b96d9e9c2a05142be48a5baf3452207990c25b4f879794c4d4c432fb0fc4f6526eb7eb00f860baf91e7b6a4a3b70c2df48acd209551aaec477d08840646b3a28c974085bebca0341f4962f007d622f33f5ffa775fbcf228f78f69d3b49fb182a888ad88ab0de044512754d474840671dde8a5c480928a03c6c7ded84f1fca59bafc6785f120fc6172f05455e4f2e4a9080bb380041a74981dbc23e7322419cbeebdd67fc7399a309f7c5e1263fd230abd3fbb194e2c1845940d49eb9e5cf657fd108cbefb1dec668b90ae9499856096bc09a86e92bf6cfda257dabe3dfc76884b710e7f88bb5ca6ba84a4e9ab402601fc8df1d2ce955d915dc0d1ce5283c5733d412521af019f662a8468d7de74d6bf4fc5a1ff4f445626383bc3555f1f0c67f85a4e2aa5244436444d856bb6f8a397b03b8b1f2a44c7971af9b93ff910b38c118d0f2b74d4689c2ad58134ad0120a500ce604ca6e7a77a5f3431168ef635d7043501140c222b580782293412333894d13a4a61a9cbdf2abc9533fd41c0c43b46ebcafb5edeb7f4d3114357b886e8ab11f6c21fe3cffc18604e7f17bdf5d590a2184ceddd92b65772e7deed600baee6b09293d87dcfc5a363dcaf11054530ee1fd2a28533f69b73bc4d7a6ce98585f9180d299c104bba4294c1327fbb602790197b366b1e6a6f3510b1b2852c285f27c1f899c4ac5b46e517715418ed7ffa8229057869cd47fe1f6bd338a86a8d60e41e910ad8e13d00f22f71de9948004b72b242657ba54bcf4fa52597838ea79951f2b35a2e2c2d5a42059a59ae94c2900cdf0d8e3296b9f88563b033a6f24153cfff375b70711b9432c5fe79c2e4a137200c2cdd9a588a2b1789e6a1bbb0852c7788aa050d303f1c5d2909fa6850c27d6e395ed86d1b54805f3a7991346eca3a2decb98981a60e6959d2821764bafc7f24ae41f49260cf0d2f923917c2460af47bd77682156434703cb93e3dc0b53f81beba24812e27d2f0e0aa2065022eadf1d1810a81ca3e4c274799f82c0c9de5fe333c6daec34a3075d99b15a18387c58f2d7dc488571b94488bde94142e007e925574d5eb23685c40f0dcb8e8b9f1bee71f8e066b37b2b3ca58219d9ea637a781b96532ddc2f69678c64dbff9b48ee2ccfe5005cbb43e720701870f39f447d3facf0f9262ff7bf5c18c3a2b84120448d981c7b157a41820e8920f55ca3aaab056bf2b679e839be0612816e7375d76472f89618296fa59f907f730ba7df9d795b053964cc8ad4a2d45cf039d006adde6013cd1c8d9640563b64b8a81103a3a3b2f00e5fb6c6df62bc1f090951ce283c2487d47ffba827639e57d0f3d0e02ace558c3a608a3f7c9e25365769117576b3e48a4a141af793dea0af3496c7e0fb749662db4f423ebae6c2425b06534afad4d8e728a5e327a4d2149f2a4a5ec39a6d1a2b40cbd929316a12f5057169b6a865ab1ce65ca1526b0a55dfd5cf309495ad0f4b3a5009ca8ad4389966dd9e7de2cdc2ec86b5dd7e626fd5ee1a333371bfd1a68ab68986e625474db6c5684d1b217f937a60f700adfe8bfc6c5e3498f05ec843c044b9f15ee12d9aa7d938ab8efdb67a3f786c297cdbb1da817a23d28462ce155cf6af0801fac515f041ef7ed91dbabdf83866f79ffe33da4828ccc7f1f9995c8c718b545604b168b9c16cafbce0e794d04ffc66aa3d27a60e4d1798d5f64c89921f712a2833532bf1c950650d8651ca8a30ab0d00d0774dfe45447db4fa7d8414263f7eae11c74843651bf6df61af25a48cf1ecf5b40f05d86b27141ed6f20f977db03e3c2d37c54239fe17d515ad1f76b43647a6c38a64bd70ddd7d0785f9b070b668f78360c8ba065020046acda34d7d38b3b3e79ad3de95f06584de94a895cb22cef4646f968fb503e53602e35174b567d25880248bb55b81291641e75c583b2e42e03f0bb07585f24455eacfdb1e259ad0cc98eaa307da79f93412840f517853de54f78ed5f013de0099a794c96ac0ea7863abae11071b1f0cfebdd6e9121a4d450a8406543c33a0393ea5513aeb4ea20abd461c49d2433f8bc69e83cf84fdc99e69e4b6192b7b0c4b9ba8af1c29972d7d0763ededf4867a2f53c1a0ee07c174a543ded87b551a736edc324d79c5d98a18180d71161c7e209d2b87a17ce7e7044ef1c823afc8772cf389461b7386025c179c8ac49d7414ae797cb6faa2b33ff10bc1bbb196e7f6fb7c9f87f360df645dfca856fcc4599556b12f01309bbd8254e6437bb87114ff8674fdf7477be01a2b78d25ea618a15fec73b84c6955c5ed82c67c39d1b46cfb1202c3f46f370448a2b9ed7d5380190b091a66e2d063a7391609a2a03ca7e6ad39028f12e8766c3d527cf62ce1e3bb8741ccc2dffab4691bf4787614ef9be0b103fc4f406acf717892b1a4c1be5edcaa2e5d536b98cdefce0f8095246dfca77be29e5cad6db3e42af79607067686bd290cc322a38a260fba15e61eef917322b0d0dfc3350f198142079a8cef32d0316f16baf6ce30ef60bae439908e000a02145c7abe4103a704fbbbb9cfc5d537a7d7691a71c7c55ad994ed3cb91d59c57030502bea7a8905dd3c8194d61523a6b153c554b51b7f88426d142b8f6decdaa7beba33da666303dbb3dae40bd14ec07e57fb4f156fcb5d70686bbf00c6c81331d862615a524f2f3bcec70d7c8963827738990c06262e9b471cc5db1a4f4c3c15ac94a5c6119356b5af4e84e51f43f213f1c30c9fdd2aaf110efd1e9c9cd749a8fda20ffa6cfcacfc55651bacc882651cefa11ceac5f0ff85e5ec614e6d49956ce695bd73cad5c69e9cd823ca9b28f0af95b40f1f93e0eb52e3ac22e7b828451f0ae4c9cbb6e355092abaf052d6f80df6002ad2619de7f86e50a32c8ab4d4cdd8b30938d25f49cac984e0ccdcdb48cbb3d89c8a4f6443016aaf696c90d3a09c983919d53a6fefb085b2ca3598e844a5b2c197e68054e08c21f009d727065d48fb117394ccafc0a584cba5a53e84938b1ce4973db0483149c32944b02ff157c3856a0e0d176998595ca6a9a3251e8cbd4fb5062b7ba983a090898ca12f229fc1137183f92bc28e489f1ac994ea30cbeedc0285f2c8ea3ee959a15f107b5bd59de6b12b8746daa78e02e428262c89d3affd011c6f106086f4b1c2d1f6102ce344754d6b58569ff263ecc842de3e1720e930653e29e0f3f9cd3e97247f1bf9805328bb9f6bb246f3ced8e3bd75931f60bf6160dd327e0455006968fe47fb6bcabde5381dd099348c682f71b7b02b459386425731d4a0868bcb2a052286e7feb25f4580bd1202bf5f3b6c2ff32ddee353ab0fd9b96fd7ed7861a735cf71e29b301adcbdd88df22cfb5cd06d27c4f172f51d1ab369e9b5b7cc5c9457934a84aed6543f2fdb3a7e0e7152a6e2a48bb54137d9b9784a5219c36d01215814c40bfebaa3005a59d91cf4851763dd82ba86202d764175b0b8693da3f6404f06304ed81f163d57036cda88e204599dda97117fcc289229ca419bf4254beeba67e057bb83f6d6c640f36782046f01e39320507341232d6aacf8f8fb2d2eebe11cccbee880daa59d1c7fc73e26197534a3fdec0c9e7637638371623cd3761f3adf70813c32713d3e31f566060fb440614390843d49b50ff48f9240f588c2c4fac1c881451c46588156241dcd5ce41a4067ef0fe4e32c73df460ec1ce464dfaf6f9cb22db400831b2a2aacfc97585fac9213538241e4345bd36a101cd68b9e10245cd6d15984710ae8a898a61d703f5aebfffd0f553e3d81491ebdd3c868bd1496d0034c8be0db45cc8bee78832c925a874fa94c06c37e3fa74ea0ec4b5c5025563a010abfa066b1594052ad1cfe6320839a172c38423d1bf1299bbee1991d6c124c91b671d42b826c40b0604af1e07ff93d6ca4e0b77c65316e5e436970cfe0b967993d915d71e2a60d2a0393dff79f24c5f61d7f208f79d9e8813f43ee3487233145d93ba223fd69222b9cf401fb1d26617f9bced28519b704deaf2ad89c213ea923ed2f8d760b7e693569406413946f4d52dffda8660bac88c691b679174c3a412fb32f80409a76558d51d921b4b1a20654d8bf7aae285b6bc2d6d9e5b3ee096ed17a64d65d665c4acb31b22d5c77d9e7854137b58d3b24f6d0c20e9a23102c45a33937a3997d5d54b9141072dbaa634d505f3fd7fb06d3b7a8e23eb9d258237e221da91325a095429b99b0e7d7ba91cb71bda3fe2ba202d543d9b9600caea5e19d175b842061859a12b3da9c1fdf561999543a6aad5cffdaddd3de036d85be44548ac77675cd446a39c4d4462e355023a345cd0098225908c355717efbca380d360321db946cd85f177b9ba96f3d9c0a00907e3e5e6d5b23077cf7a615d11c827adca855a5ec406521b7a8469f584c7da72ff70093339d2f75261e021d7471edda725a70459a567decaefab06f92e7211d141ea45375c0dd09fda025d3974a1b54ef07aec0c94a01686dd4be7ed3665a491ba50d53af9115c7ed9332b2b81cb2fcac1291d00953a7b3c3d07239de154e079c99bd17fc67eca2338fdcc16fb2762ed0eb066c3b08fb67f8dfee2e0cc1c34aa68253bbc392668ddb00939586fead5ef176802ed334e515d5f0da3bc29df5b0f8f5cd939ac8bfcb10f8292003365d950ea861b7d9cda3fcc2da4401c305dd8ece6b6cffa9d88a5000d5c72a73edb8b91a08c66e5a3304886b9ce6f513161723aa98f30f29aaca2bce8dabf7eb8f0b0f089bee17c3f24ffab295c81b28a3a0c63b15a6db2826458038992488dec5e8d82ad18eb1db580f2f1766a1d6c0786e49c4122995a49b3371e99b10494fb89ad2e3cb66164ce36e84923f684f5395705ed260608d55df1dee558134217c917c1887a3f21eb4de6f5e9a3902d139cc8d34e1c53a1d9872a2769804e3cdafa05c29bf78d67af82c78c8ed2e445e11d113d6fdfa9afec62886a7d384ab7fab0a3d113ec7d18dccbff7b5c3477807c1695b320b07ce11cf923edce552cd714bed4eac6980c1151208998aea79421186e0ed1ebe0afec45c25ad25af53b15be9b1f54023d70598c21d320797c9b1fe8ded7e0e0755d594b406680f330de3d74741afbe8aaeca1e4119be1042872805ab86a6276af489e15eb3e214ac2aa43e0ebf87ae959c34a19bd2c339f40a46d10423ff87443c3b7b468cb32cd80cf9c1b23e7ff9e644c553937109e967465d001f2d1c33edc9705698827563424e2de0ea2e85ab806265081aba8e8fb83580f60a797992719cbb1f0ac9335bfac9d99266f0857ce72b63bd55742d2ad7c0a24d4051441eac912df62e3ba989328d57c7fbe6f6fb328a6ad143a117667f235056d6717368c1a0a3380774c38f2e0c65e921d4d631ebf3d879941ffbb7864d5f7840d773cc4a446847717f9f3db5f7ea1d065aa38d23d4d9349cfd76ac4d25ae3b3dd5a90239bc17c157ee085dd50e85e9bc2785477de8b592da469773122dcb2e5c658cefde74d506eeb466ddf9660bd934188ccc9f5b8e464a4770424886acde27ef1ad99e5622830028212c29602373fa22eb69c9c145a72c35df8cf1d838b4e82cfb1f3cc9fa22e8796bba5331a5a2ee81e769a5dbdffc34149273a690bb5f91b2ab4b4e45727db3093600713b2e6c48dee8dbdfd49a81590a367777d507856addd00b26b5a23de53ac02baf030aa755933292ef929c28ca46f55f7a2d365d56f4ddfc74a10860c9d5ceae91f70e2f745f62149d50d291329db3cf86067ef56cf22008a639114b73ab9ebe499e923f2a5929d7b3ded332083e19b07d3b9c8f8063379c3c0d9f7faee1faeb48fceb9611ef91dd4d4f2ce9018596da913961a2ca06d8865913369088c5842a38fddc04f2171a30f36bc6c74f2dd4e342ecd6ed3c090b4aab7b2274d8e76ae9862cf3cc776d49cdd8b79fcbc987a77b6bac6738ecd1c2d1fe26797acc01e16562c93843ff74e9b96165e888eb199738b23bd0e45afe25c992558afe632efb32443a4a3182b9da096e6de811a379ca33c91c6cdce5aa895160fa3b53ed65c44a001bb86c1913e6b1afe724f7753537ee9308a6f147db484aabf66ac9d37a900f223ccd3d161857f1317991db9a2f3909bd515d92e22766f3b412c91d505afb2b415420b3b2662bd3874c92596a650ed94a845af9db8d92b7768f71b5f7e32b43f6426502110d7ffbee8519969ec18d7666a094e45f8d79c85684e092534612b3d7559250aac1bec5d9f98f05486a916d49f7cb44d05639b139dbbe884d9f3bcd0bd507e6ad5cdaada748536f39f23d458c32bd4ec74d9bd538fbe30e3b6525a4bd8af66c80ea0b0d426b5722b80b05c557d74a132e012fc45978bbbd305e5385147d5b850148bf40517b41f7905925f59ea3af3e72d2012aace42e6c503cafbc65b46ce813c4df2021c5f2a9ac3b1c09ac5ed91d15342e5ffe377a4176150f31d9f09a622e21468be92ce8beaa95226cdfad4bd08a5b701ca49e9f509c5846d7d36ecb7c97c1c12864f8bb1a99306f3ea46ad3d91a98a444b3bf99a6a28ab18ee6838bf8e93d887be78e512a58580bd74b74a583ebf7e7a4e014fb66f049698d73d72f004eb4ca5cff5e48cb7b00d88427460da39e64fced6c9e3b1c831f0b570827844f01e1b2f9145c046048393d4f03724381733db922c91f04d36e5e65d6e0429219d32910bf211a42a38223a4d41017ee81f52925a28560c261dfee31ddb5ce0c41156a77afc3502e15869049c7006ed7eb24946d62c9c4d19ccba4b6b24a4d61baa022b8cdbfe747f63c5ffd3f3044ba1e4b93949a3c327b3b2c78ec7bcd0243db230fa5f2921b5b567c222d75834ffab3c6cef801800cf6212564e84cd43a0f6176354df74ccfb3acaf55df92ae6a0c3f8ce3d7d5b18f134456f6ca11be191160062feffe541792bade56b0ab9425ffc0203720bc7c67ddfeb7e0bb63661e5a86208bf8d3b43ef11ba2ca079fecd5ba8ef3fd3e9fa813562387c440e7b7dc77b9c615977ff0735d9e0e880992300866cab0a7e636d07770282c575bb184d9736cc94420f1ef60982ee66e0579202df09d13fdbc34697f5cd108774cff2518c34724b37f9163e92c5ca2b3ebfea68c48d7058f8aef92ff4b598f196aa5c98ac482dc8919e16948756f10b3c4b5fcf4ad59499059ac5c9b57cf3b6d774f71b7a741bee07a3226f36eecbcc7abb085dd62aba0cff6daa0c5dfa29d64ef436e9953ba257902056adb5c303bfad64256fbd78d4be333a0b797a0635a83ffe03e79a0712d665762d289182d8018a86331861758620a636109a686931eea830b2de8e5617046d68486715d88d7fecbf0cf8fecf21fb1783655018cc46340f3462e767803a2e9e7ea6007924c6f3c8dded0f47e451e1d44b4411922d0cda477edf3feb026ba0d74248cc244ffdc430fe0e6a0e77128c9d502e0ec6b1ec1a0bf24f6bb16454c07a31c28689ad4baa7b52c548bee7379bf3de0cd9edd10f80212c88259a83c342547d1e90f3587925659c55ad13e833ec15af3a7e8fa68e4bca0cc52b75330757dcdb26c5cf88be2bac5c105d06b37cdc313b5871f7d8936bc4858baf11c82b4e0ece23b859644a1e258ffac7b9f8e5a823b144c5067bb2a26ded51a2040966b4b3ea53ea13a9aa62f4e7b1f77a1584b20ad35f2a90a464e58544ce0cb712159dfa800c7beba3bac5a584bf2904bee79442fd5e2ecd561e743d21266665f0d10fa1ce96805514ac746307b211518cfadabd02b8f535396f1e40c34518aa8305c81196cb3621390bf2dedb992f81db0f3943d2f7136a1faac148e9e370fe5852534afc99d2cacbf472034604e73916ed1ccc4bd1e12f9d58459f9b7b2b81aaedd2a235ced1fea5f3839c9008c13029555374ce7da9e7205a920dcca80a21dcce625b1b6a8acc35576b35cff8b64645a4f1e9bf849bd6ad38a95c79693d868695123120ace45bc6a0abfee1336f459ad2020e4b2a0986f30fa41d9e027db7403daabde2f62e86e63c411323d231b57fb67df725711fb72d0c7985e49f3d312cb3dcf8fb1a2c8e013323b2ef5acc33f5faa8e1ec7f7cc01a2fdc516e35365a81d51bf2f7ea07b04022c0db5c5b559bcf1edb1a6743bc246811a86b74d0572c1216e04154973e4095101459487a93721d3728a1bd8cb2a68ccc8e7dfdde764fb3a0d695d78fcfd35c3d32a1735d1f72781c7587e30dd7c696c35aa3a1532a05d35ee197077c566cb54463e66128893bb5da7724a6450472e8be7016ed7fce1e27d00770088912bc78ca980da823864f381c0d21778756563ce0f2cbf1705c00f4b46b6ea45b208263905d8f93b944c1cd74058648b027311f8e4089676ac62b4f9ab82f761bee46e1a4dd85e876c57d804b149621dd8cb008d9c64271c55e59347e486c3721a7e7668b4bd9d75d2f9bc6ff47bb569a893d40837808e7529d4691f20ee22f9672fa147f286df5c5bd92c30d69b399bc4168e4d2f2f462d071245ec66286dfe6834a3572d3ad6aba7311dcc1b55ad6c84feb0965f4bceb3b8a8aa24e8aeedfa408884af1ca6bacd447284a70f2b111c993e5e090c97f43c7b04c9d8cd598f3480821ba8c66f87738665109cb385bb4a17d29ccb1cd76c25928e8797c9e87a84e5a5e186ff908f51473a09e9a097bc1aa31a480a882df74203a975e0de608a2cdc71f80ffbe8cbb4df056f4b0c99a76bdf036c47bba09c03cd7c38450f57a56ffcc4e4687d431ab6b027fd5c5250dfbd37a03dd0f702a2f708998ff08cf3a6f3b8919b5a5a10ffd24dfff7e1a011eb595d731b61f6ff33e162a46b04c2de11d62076cd39be0001d0d093e25d0203230aa997d01ab46b203a96d6fd0529dd6dcb58a9a41b6bfcd78f158ebeeab9ae7ec6958319492b63aecebc1cc114457d5ad507b6be7494c50afa90886a8fdfe0d5c536c49faf97f1fe73c465f7476dc5ec6736fcfff9792d87552bedca0af18e3d76763db8a18be3ebdefc3710805cdbcf30987db64c7afe79a19122a81f9bbf13e2fd0d3713b4cf34ceb8adb59f0646231b6cf35774d658d12c1bd56e5c670743a022f1756aa200b6882b649e6e1e445c2fec474a40f0fb8c6cb98710503b457041bff04305654243311f86e1393a6f8650abf4532d141aa16cd4a378d703dd51c3ffb37c3742182873a448f2718b7ed36ee445b5b1c7d0cb2085943f61b0887eed80c80f3d06aa58f656be4775d9230f47432b546d38e264604df13c9f2efcf4f455f356e7c450f31c057d2f0cd4e151fec1ff7533b9d6744face45d801b080f776657af2f108fc8868d0677b5a8a16909e7b4cdfafdf34fc82844c864a30139da123fd287ba6984c335eafce54eb3183678709e5a549d38ce66b8feafde91f6d1cecb0f13bd1a88196f597fa8f8115213d0f2f556d3e8cbe2b0780596241d136655b6afb4579404d39dced23a371142f00d371c6c9710d7f4eaec28d8c5182d21b0cc6a4f203552ba7f53cd8769e73515bc6737081ac530768737a0f950374db009aad54787cd4bca226c1407930de3cc0faf454953e0be009160ca0354ab4bf1d4f2d091598e8bdce8f63d0d3d33164790c7a72ab51d74a10a50715f5564cab38425cd7e7c657943a14a61d561dc7e1e1b0cf40a2ba153e3dcca34e38302cd74c2a8002d10257bbdf885a77f1c976f7d63c97dc9731b52fb37363a0e2e328fa3d676f638150ab33b085612a644f146ba7202e75cd19d866badc76207a0400d64f1c6aa1f28915247676b8fc3bba4455abbba0a2586a11645c39411dabbc4682f84a401f4baecdcd5f95ad1e71d8d2e202e30805027ff4e487954664ce6da3357aa4decdb5a1b36a9a9f0f4c5ae448bedc3c0729234b64e778859409803a951817466c2c2a07c6f3b6df206a1f6605ae1f7f975a43ccee57af12ec56fe90a56793e958cc8f8b472e4706ddd1e90fe177e6af52a617151e75df0ecb28ad2ed66fd2f6ef8797563a54b00be93290a51d22301053958739ec6f709666c69d95baafcea6893b8b97b3af5480f42b8aae90c984f7f0d2e8ca582239e6e1d895ae31e8b5758210bc963690ba850bf135e729d317a8d37a451efe1fc69292d5a9ebc32fd91033cbf070c69e5ede1f8c5002249cbd66ac2e1c6fedb8f60e2ecd457c17aaa5dd5d8173137d57ab94e3ae73e0cf6de84d14837ecaca95c4fc677fec8eef5e665ca9d05fb6f3f2a8709466c8d5aa400da64977f07ba017166f2ee7bebfb7a89fed2c38fa0f61ddaab2467f4ef9e293b76b592b9cdefaf931915471d560c3caa1d7763927735545963d1d68a3678556cd8607ecf57ff7f893669d95abb409c110ef7b58d81f572e835404777022b222d1feb79c48850fe5c2f23820efd9fea8a55e36c89f0980f6e00dc375e0eac3280ad4e623339a4326f29d4a2845da25f7200da4bb4814a85f42c44df225554b57435c46ad775308e2c41540e6cd86da97e9f5225aafee65c56a5bf373a092d47861b68abba53a113cae48d3ef16aeb2557dd3eda54ae02ed2b9af14f28d90e01381596551160e73c640ae5b73b2ee2607f4869f923f5d0327dafe0c10b6f8ba54dc5e3a8264ec40f6ebc537f8842badf283ef214303f88ce501b5d71f7c92b3f5c23f21c262af3e97706647664e42eaeeb69a5b1fd29efc4705db55c1596edd6943c58345ae7b861cb905902b6257272083244e001ee81936e8782cd2dc49bb601461bf8ba3ac2edc58e7a3f97d5c4bb5d94c0a4854b053dec01ab57ee37ff703244b0a805e1949cda7b6d3999c6ad52d79879164773334da60101f9c69eb4c9d2b437ea3e9b7b0c6e94a53ef15cabcf41af2c0a7b07665be0f3206f7e8bec590bfed4b7be40a9229e9b512d1dfc362109466b9ab10dd4063e6dc21e62337f7730379199f997f367dfa4d197951a6d137118eac709800fcf1c064dbcbd6025283c204bd5b24e3ecc793b3d390bd80323bf08386bdaca2bba64ab59046bee9f4eb1df09e2715822f10359f347462c0b46726a81a0011d58e1bf4f602f0237ea798a0081f786bceadc7fff1d9d9e616e82604537340fb54a1382ada3e322db39b31c190a00ac810710dff02e70ad821c5966d95d97a8d6e5f42f55e9f3b9ca38d493ddeea640df7d6eacc8299b1d2c4227630e67e85133ce3d2b32e002e77380863bf25f8258a2337dce43bd3bf92ee8b761232503b94e1fb117ab8018ad26d2e81148a76e5a930e8d5d710dd50ec7477be00df7c15a1e43926787f39828de0c5057a361ea9b963f10a19f9f24608822b5e9aea63364726c2eda7a8473ac5c2b0f25cae194bb05581164697a7dab58be02246d853b8e6b827bb621afb1b4307ceb1632e98ec3ab45738cdff1c96fd42bb52ddbb68bb79470bae873a70e40599a28e013b6070d6cbb5c5ed14f9f552e8db09c72791a0d21eba034f8709c4b4e477394873f5609ca2d29946f809d507d3c12d222e4fab533bb1f33ccb97b1b711342decb25fa0231e74524cba6306533bf778064d3515a242ef97db902f812faddb84ff94a8087896685ff3f1224cf6cc5987d8ea2d295ae1f83a9404f2fe75ff9f9e37ff9c2df30436882486771f2e9e24abb854d3f500dfe418a026bafa86436cdeb6ab361748b012ec9fed4130b6a4ad419f52066917cd3c507094d4495471147f85176768da5fdf362c19376512caaee6709eb9259a30a99c2024eddf55a786b432029dc22487e20744f8e64a034ee8ee134956fd55250255de55d9e8f30be480bf1789899bbb4a081e5a83c5254380ea4e9a9ec90ee5450b57d94a70b5b50e64be2507a94273789e7ef04e7be7abf6808d66ed471aae7ba0adca46503415a7d8fb992c66938cc429f5fd3605711159221b0e1dd6de24d73ddb29044b27c235bb556f662d7853678cbe52ef8649e41474d5f1f2d29e6a30dc1a888c8c134537b398edf287265a2eb1d20baf4cf8b1cbcd4a5fee68a848cff2866bea48743e181c08cda6d89609652c0cfe29e2f960a824389de856d04b16e49b155486b724a92615322f9960d43582254a22c4fbb161fb249dd71e74de35144586868498f07f520226ab655023aa6175cddd3568a75f576fd114ad57d9416cb355857c9d70ffc13df127482978fb132ccf233b27dc39e43cdea93a5fb3dc60fc77edd856d9fd5700fffaf26fcbab77df6adad1812de9ea0e184f2070fa8568b7a77f4cd1f3f81e96c03d8df57b8df3efaa2fb3c1a6f1dc488c5b2e90e8b5c91a39e93fdabad8ba829b27c6b3d0b02b4ba658070d88bd14f726084e4d7a9969658a1474e3457f99cdbee93287b1f2dd9d84f6d908d092709be68f4578db22b9408c5832d79b10453062aac3401ad2149e87c65e271d9c387d0aa506222b83925610e7ca0665f7eac67ecb280d03284456c087a184fd90a235db23188a02e0d792914772e45f2e21d9a08b2bb54cde4285775afd2c411c81d9047699ae44f5e584dd49e06ca3b4f41531e3b92971840129b5e24dc370c4c1b2789c0c01b19074cd780b3734779ad1d144abff559ff420962615924b635afbe5b7dfcee862178e664b5fd8e0539c80179f20e43f2d23f955f17b7226980932833ef6b7950c391075d798ececca86bc6d32593a7609f213343963b7fdc2dade526234a14fa91be886d372e4a2f8342d9e886a98f53472d149dc8f0c0fee46f610f706a3999caa8c7dcc5601a65b38edd4dd7d6928b5fef028113d2cb04fc03fffa69095d2f6d0e8ded5ed5986da14287328cd80d5b5f29525bf87e80e296f03b2552866f1d7d2d987cdaae43d26203217475b787cb19a18f7c4b08efffcd79c0cf4a6558a15ffeb5891468adddf03b4d115c6a6f051c714880c1bd6a2cbdce22494f7d6c846327d67f75bc28e5fa239dc6b9e55307df040b97be7e1bdbe105be5951aeb90512e6529e52d5bb77e75b9be2d26a90efca029fb0b3285c91f65751874a1f98ae1a001712e265fb3db757fa2a02c8a4dfac548e21ba6e7066ca51f50b2de1281f930e0f7f8e71969b8976923f635b8ef0b48f16cf34667148496c357b0b00f657929c00dff408fda5926263db6f6e450fc1f1f3824fc42d5ae53d704d4ca13d96949b5a80b9cf7edf22c2b3e7d7cc3d7115d2a600e57a09129460b3c1d16f62ef80fab0bea5fe34ef19e07e7fcf04def9a979a73e1cab9a0e47f752dd37cd0195ae0d12759fd8b295e657820e65c31dcb6cb5065529f352c0511bc3075267fa26032b07f1d4894323250205e9e51200150318819386189fac813f74167c3e5f636ab2afd241e47b1558c426c552fe6a04e129225771137015b61d30fb8953bac61a75bfe94a4b08066acef5d3c4c1555a756c9f3eb6e1cd2b3a23984e25dfe5c90f8ba6c4627f2c187e291bedea204aa49b7a24a5b573440d695078e702488c032f33b00dccc27668362b71bbfa1a0016ab5ea0b14083146ceea5f8d8ceb3f73eb2d7f5f63c60b73484cd21cb20fdb50cab28c0a0b54a7176cbca150de392601f469efb0daf40c89882a0bcd02d88ce9d5530c28e3714a0b6922a18ce2ea5b0ebaa7a36e73e82d9d0fa04d32feee29bc14a5f40d9d2e8ae1b60e254f68d388e596aab3c912ee43f5dc0287a5933ea3e705ebafc6217a608473f86eea02e6630600ea47496ed7f682eaf1e5d76debaa954de1c0df1f1b29f2d047815ba61547f5aeb1baa193f0c62fee21035664912a5a4ca4ac42a684499d3c3cf182dffd645a3a23ea937d072223ae7eaf9402433644abb2a88f374c9ff90936c7948bb6e1ffac00281de8ffbe1de33b36e446f553322e39a5d6ee190e06598506f32ab007432dd65392d7e874397e3ce5bcc5a97de8af915ff4dc747384e2a373d3b5da567e4f77d9b8785679ad28e7a03f211d491f03aada12e16bfd2b62c1af0913b9323e5e7717e6727a130a5155e39a72187673e853dbdd410109b4b4632f27706d44e0b451bdc1ea9f68f608ed270e00f9dd2f8d3af468e3da2624dd58d8d4f259f687c4cd33ce972c5646e1b735269bee5761f178faa73fdb2e2746791787e76fc8f296bddcad449907bd9726eb6f04c43a490ed64303537c28f34d5d73063ca1be85d060f9d9a0cd25b4298d9ba59902b6b08b80156e09cbab7c4301fa2a4e69a58b65c5827f8a39233a0ec0ea6d10a31ba4fcf46f78ab9b2ba7b3aa8bc92b1ff4bc28038bff8dfd280ab2c5ad9f49dfc75faaf6c6c70219f6d1a004c20b4874a8fa8e3c32c33486d6a33899f2ecbbd68a9756ed3150c3490b053d819c472dc60317e27d740644f5792ee82edc205c497b0e62e2450a8fa8ae833532a0ab41d754e7513bc30f945a6c15d70d5fe62b9c2e8090ce443b15035a7dcca80ebbcd4a5f2295213d8da926b35076c40c4f6a4d4c4e60afbb639413d1618b37fe4f5874bf9fd7a7aaeff594bd921604fae9dc32d3b166ef1a42f63a01f17c3f75567244968e3e2d09017570b7a79649d82c106d4e1bc436651822d7f441294d6eefb394598d69c16521cffa7ce05dad9cda1b6ccce2cd5f9e9c8cb0c21c21c8dc0ead6409ae44be9f163757973c86bc6726e3e876acf4793ae0fdcedb8c1e7257ed1f3045cdadc3676143878bb7d4a8b510eeec14dc241b5eb031a510343efa5f1a79ea235b3b7f629a011d51b6e214ab56d7266064db832fd0cc028498e3487c20bd88af5b500b6dc8018e07afc7b76fd3ab5d79013efddcad255c1294b121c1af9ea4c6f7cc3ee655923ff0eaf0a056092ce3ef21fb7000e5bd6ccae7cdc4597901cec6904042edd7044a6571ba4b6592d4e02c79ca3f4c49f7cfdfd96124d57f8b8548c9c6edb975fb46ebe07e87a7c2e7de038f3cc8bdeeafbecff2f32f86889b909cee9a7514e689ebb3cebf41b415d37338e96a93ec31ea376982af06ed9ac4e0d1fc0cd9ef4c633195558ffe3924dfc86c9966c92c699061746a1084e3412c46681e40fd5e452192e7b84d6527844b80f6503b18b1505c5da285271c33ccbbddae00ddd2de868cdad48762b529e798cb622490504b38528dc7a09dd2c2c0cc427d779f158083e08f81294b5c7f0fb3ddbd25187973f0dd9863a702d01d46c016e2829dabf37efeefa00cea04143ecc809f5d66523cf493af7981a90f191cf50e1c64a4752f4ef6d5c714237cbc4f2fd674a2b7de5d3ec7e694b6ed95d9c8ade23d4bb70a56bb2db47cca2ccc85aa88d777581b11afdd627c4501ee3632b81e52180d99aed8601d617517edec55cbd6df1bae7b517324473b2d4681e4ad79ba7cf0499218b9e6133e374b7ec75fdd43b703613aebc1c33ab687532985901ef279380d78cf403d0842ad5437c6bd9b51509ab85d4c9a7430ceeea9a242724f3dbb5617be989565b2722809190af6bd94ff650996d56a71666da88fa1382bc5aa0383b9909fd5f41bee5b834dc6d09b4888024397708fabd334915246ace6389de406fbb9b4eba32a4d13ef21184c1a5a9ab6c2bf1af9254bef7cfd48c1d5f13b0c3681bc513dfeaa3155247e672c1eaacf224404ff61b330a6dc3fb48dd452d1c6f01eb20af07a3b23300c67d9792e8aea537a98f274d6ad6295850e2b930402c5a4d705f0cff476c4d694d3586e6c70d6391d694a65e1382705e36202d182c031df6d6227c92cd81af0a9e13532070f141ae2f5b09eed21b6f443380639881433caf9568ca0316453b615650704b6b37bf588955659f6f1802b6ffb43087b7efd3ee7a9d8f0827ae1c2ff27574b51645c2fa5844b7f89aee8003f72a2e2fccd6fddd4aa188b0bdec9bd296a9a79aea1898a0d6412bfd7088c32348b618993c2bef58aa903e917bdde2357f58327b5e716851da5edad8b81b974f888310caf9690f20cc2ca14006076fc85d75d9981a8cd35f65625dcdf2f96e06ba083bf503c716c18f646593264f60aead9d97b3800a737e8c42cc31d5827b3ca73ab7eb2560bc409c78104a0692afdbeb63d7ece1e8646bd55b7ee898bcbc9d718593c333984d239d15bc1846cbe72850380751d9e30f5063eb3247e672f72fbaa3e0815b03eb2770dcfe303b028eda6179099f13786a68f90ca622757b94936c01a5ce9e690059a44eb5168035c024fc54bfaa8c85b968ff563fab8664c3703228b8916abea305cf6a4aa8026f8e567d4c5e7667f8ed39ce48a8ac229b2215afe860fe7e5d478352ca644a5a5d810c53d656d13671ee360ab966763181f15e72e2204debf4cf382503ae955c4660853817d9aa7394851cddb09262edf586a5fd88da857d145560c16e33a9d3ccbbfba3ee049b9119455ceb1eb89e5a14fb80ef7ceaef9c037aebac30ff564e1e959005741cb6d1d38560beaa667bde5d5327694d0770fa5c401a769351c7faf8978baba5f928f782ffce71e85b6c46536baa84245724b0b4f8efd66efc8c83f6835f67e62f804809b3ce0ea81c2e21d67e0456ce6e4e6906d1f02e7c95beec6395310c00481916658b71bb8abca807713a151958d1949c02dfac0ebbba247fad8acd62635a073be6a2a8f598a7bb1b1f911ad51984ece79db18379d6f1195c6ece6404c10c5e8338bc71270e1567847392e0dcb531951c72986c9effd0f371228b1922411c04a1694951cd5df406649083fdf98ba4184f9d3c89d68d19e3fb70edb22f95f388def03c5b50cc9baa62c9c17568cf497d6e2b692902cf51ae2fa099f09690fab872dcda384194fab5dcc73c1090577fddc4ce74f866c1b201392996afd0f8250915509d9b2e49cbbdd5ec2d413eeb914808436f136e566efa1c59d68d1d32b7c5f83eadc5f053d8a119d6b38b8cc4d3106f4380c2eb4e2f8b08a5554a720fd94c6a6ab4c019e8c2c41fde87319606d036fe9d2d767e563350d640fa964b9b62a9f4662baba932ce2f7d91dc6fd7c5df5e516fc33175c7408d8e0a39218576551508f6b80554f66e91b2001604cae2bf37b28ea9fc64b5f978230be3b6008d8d73f75bcb191a72d3b7c135da5ca490f8a99dd60082c9c4d532799cfb6106070833920c1cf98bca3be3e7af6f1483f466dd4958d1a59fa9b1d68c6126a3c5f87197f4b1b7ed632b3c9f5780c782b0d647db8df2251d809d62bf04e97c2cc4b651d880d677f3566897e6fbd4c50c30948ed7d371ca898f46ffd3db9a33356b6616ddbc69dd24300af48c5ef47f800c783a50982d187fcfd780624d1652c5f7d637c08ea2b748933e3fa967eb42c72e357ca1946cee6e960ceae616242c509f80b10372aa77bfb26e2ce3bae14b71f611c6f9d034a355e97dcaff316bcfbb63f79902cf6e8073ef81b6ee0b538eaa08d3f52fe975515b2e298b22bc7771b839bbe42366a0fc5f0e03e27d18c10172c5e4ce456b9e6a6af1d637422bedfa575c7c33a764caded9f15b417ee9c2dde45e84d5aa262456f0bea9a002785c72dce2d58f9ec174dbeea90eeb38deff8963bb0ce8ae1eb52e1b259712f9cb2059649832059c25cd8abe8e0f4eb0911247d72ca41f519e0b54ea1c69dd49752d7d5838ceaa4ff7b77aedf7898e492ff209e58d6c7835a1109c045d76de0f29c33ba25f89dcc5b78a819c627b2b557c1a0027d6c24a72db7be61dd4a00608988f92fe54beb9a80fb28cfb8b7c946c4178851b149c7b5d6c9748b2ec7d1c74ed9a96d2d8e4e7404cf0d0996ebaf0f6c1da17f0f3cb4817f5698fa9418da268f714373a129d8d22f2d80beb7ef9d7e5600fd63622c7fd22b38bec9939192a52a725004b2560155f65f1eb3ab9e3a64b64f5aa391386605cddf878610db1c0f10e0e5bbe0a0dadff7241cae5b96cb3abe8c7db29fa8f9b5a177617df5b713f9458848b1ada03d82d072bfee70f5c7f66c3076c2240856eaa6ab62932f0c0158c5f7b38f229580a3ff56e4a1ae326c170970e1259eec63f7e3db73a2a062484a9f037ad11de80c5bcbcd6ed411744682b3cc4880fcd657e2b125ca19fe7f8be92feed642eeba159d24e203577954fdad0e0ad33a57bc17b7ec35c88e7bc7e911012f32ef2e87b211a7ed2caee437fc47da8e7da364d5f7ac87b9cae864f1c97463b1a93f86cd95b50cda80de9ab714448b4905295ad7f45b8c0610cf5a278d7ceb8ff79ab5a069bfb753e66de4476702958270938accb702c122ddb4861a40f456b115f5d6185aed3db317c25cae56839f7d6adf7c267db619a2a113faeffbc98170d1183611136c794a5272a3cdcea431b2c4a134f23523e324c885053e2fef7b4ac3e1d38d9de952c1875a45172b8b8768ed73ac5ea9b7f9072db6f4f1eabdc4d6291e2b25fd41b35b6513143d4c2011cad0ddbb99f4a7644a083b172280098f8cc04bd7157b3cfa56fe6fb4fac407ec3e174fed75909a00ee1666e83ef99cdb3e30b4f77404b103fd60f87c5e7920bb4dae5eafd692a80b6bc0e250ff6c42f2625e6cbd9a36433398f15a8bf822001d462f86ef4b2e18a21ba9bed4a3b7c4ca40b052f0ce710dc6a330e8e637f952e19544c1ce84d624ebad7c560d5097a3fe9c4358715d3e8660cb8d9537bdd7b817958a52e1fb08c5c68b03e927cf063e76937ff909c534f02352389bde3c744144f413220e130846f09ddc972326894f592230b1d706238d65d7bbb5ff33268c9d351bf51b7597a708a3fa352d3cc6d28a37e824d20025697fa25fb1ecabcbe4b3258a36c105d5f025e00b68ad262393d6e4ce0f5001b4542e8a1eec52e88d22ec4aa6442954d2428f2d007b98fa4df96921df5be96cbc8f2983fc1c98dec1f34e645f95ca40e8980e9d4e6ca5ede1fb022394fe9fe502f402f556d8c0ab28fba426fa46f4f365ed8246e0b1d358b3cf0a667be257b582287094e07856ccf38eadccd8d0416fb950f15011b34144b6723f8219c83328d9d7999ac3a337aaf96624510174f6bd1656e4a40ab32d7f5e041974afc4ab3e33beeae89597079d703614ae89e8c39e28934faf7bc7fb7779ba88ff1010efb4d9da926c6f6db4f3020300eca6f251b199c7ade6cd7468f4ae96816f5b0b0b150c615e5d6263305c7bd24a1152dda239bfd36a2d5729f5c791a67b0913e155f8531034931c42e9de31a708a412d04faab130a8493daf953696d591d0ea975757b9bdf0300d2ed5af3f2cc11e3fc9dcdd0c42ce906ea5515090f7e909bcd433bd17b69945f84552f4872d21c397f62946f317458971056f81254d4a81c86c3fcfb6844cfbf498c212bc56418d49f0442b4691bffffd29813456acdadf6f078765a6e4fdac3489a5dd84605ef49809f701ddb695f548997a751a1fa71efaa2da40c048e5089dc560883fe595e4a1bc415b3659882c78f70e2a3923c7201e95ebda740d3d451a8be945283e67c51d5b3d54f1f0ab5b33f46d5c2d83f6c7729b1df45cd0a8b91f086dd20c71fc62e41c96d669855c5d9e39953de81ec32901c4b29f7d74ccfc372a2f6d3bfd26785c014df8f0e5a7aa9591f3ffaf244801b1fd58dc82422a1d3b6dd845e7a43fda70c308aa2a7ed31dc18632d62ec405196528c32cccf84ba542a73c9b04dc767af30e73a13ecd9876afa678331b3ef4a96bba97d0385c629a4a218ecec9c298d792cf24e56a8770a55301e89ff1cd3199a185968abf7e91ea97ec53c99fbbd96ed0fcefdf8d71fe532e25f1cb9aa660ee3f2d43b6a183d62916f34a60eb6d81bcc06a1b243499eb0e50472d7a4694b9d60a6de745d3de749940be0a44db5a4ff64918296e12a8c20819f2537dd15833bda3c0fd2c5ef7842df9b54f1d30a8b046cd0f6f487dbf2f91de87ecc4e2948ffeafb4e2046bbc64de5c63147dd3a01944bda8d03ea4f5328d39508541cce86b4435b5212a208a47249d1ce093a709b7659d7f36bff6ec6be3878c721ee48420587b3e7689a32fae42f4b7d093b8c7e05ddfb1d718f266eacdad00976ab921bae4e82c1755e365bec6d856b0726fbc095fd233f251c236718895a52826926adf05a4009acd844f1b8202ce9f10a76a60c09fb8a7a9eaf5d4f7c137e0e52ecc0388c70092a05767e51668434bf26d2ee56c9191b5edda0b5dadb2b4602ced4122c1a4caa8628ffc504cd6ff8ff150daf620acb9f6d6ec8d263db13fff187eeb72ff661dc8dfd484b9cc617b66d625f43426599775387e7df7c79eb610453fca615892917700028358771027fa0a4eeddaf757c4e94bb1e7a322fe9f33872b2928df72cc995c3115587455a7db9f4213f8ae76bf3bb7ef555a236cdd00ce2c09aadd41a8110da21406797149e0fb2923a2730002420b4c3bad8d49939bc4328c388de2285fa8ebc6d3e498fad47ab6b9d31df0b9817996826d45a62b2f17bd8f44fabaee979223d7a0e48d7fdd1600c3a23c1c15900555efc0f22a6390e188075f82cb0be6287fc0971d53d25eeacdf6ac1a47717029ee1aad31d4e88caac23e2f116230beabf77c8e8f49e5a19178aefa7fc89cb0d8bf24eba0741d4d1b9253ff5466c769b665402af4bab3887b6ce8ec9373688ebbfaae99b7afd0921d861e594cec3b58c36f064bab45028063ed175301fddbed291ed9db830533e9f63de713c6a32b6d1a91e1c8900691e3d94de4f6e3b720459b8c9ab5421b3f6d40787ae5829f480a6724f4606f270b276b27aab4d71735b82a18c7ce708bc34a3331b01a7fb5e341c5f9c17eecf2cb517c1f57bfa4a88a2f41c76e5fc97877888d7461d678285d5fe98d64584c6911588169ec3df5728a4a8a83ef7b7f5da50db4764068466d2b52bbc2a86fc742bfb6f1b8d5341977c750a494945b53e5be0fc4bbd1dafbc1f962b3f4ab3bdd9a1ebabfdd2a6818f5bb6a0866549135a3218a1ba6b059f3c6627081f34a27e98ac6a36af83c45e253a2daa3c96f9e869c8a181fbd7e9c0b38fc713583815b2e722f18d0e164b220a13a95ac86b2788549640c03ae32b096f71c75b57b20f444f295f8d821d1a6ce664b89bf34e61c91c2d1d9babe8223d95ec102e23d5747e547cab332e27ea50686f7b9c86c96d89c1f1233be2f59e8e99ffd2e86e8a6eeda73a63e7dd82f239f3862c98d2f4843cece12577ca5578d437b4e144f48675f4094966b8249c9d47ede4c95403e8cfeb088ecfa0f786d46d4a47ebd43406ec46bdf9f356b01365c3b36f9fc4c7923cc2cbbe21d838ca65cb537e25910b667240dc02e7397e88bb2f3d10024690f0fa223c29947a12a78ca63c864a4ec2f47bd033753445e0af1fad12490e081e97e08b5a66a1a077cc1580b140a390784965b67865379bf5c3ab629efc631586a8761b6d77ea6f02d02043d730f4c8da581b1e2076ff738d2d885f02c665e0e82426f0001e7db83f3ba81dae7f069d370a8836f4ca9c2a85f6e5cf56171314a83d93368ae199dbce220be811c65ce15f4d0efe91990ad4f08a038c3066fc9dde0fb0156f08dff6c21baa76801c435461bc0bca15c2eea88b30aa3f8229f50c81b1894247d4616eec84c2e424e1c7d8a32debf7dba4befb57d3f162c5fbeb7a80dcda6e73fe5ae74c0dd40914f3bf3a89242ab7d5899e8b41c7a27d838a1050faa86725dd953352c7011558f0a72c5e70483b6546b51417fe86951aea015083f5d235a70ea4119a7c9c15f8de243eb39bcb378bbf37400a1e514af075953db74ba2977582ffcf7bb6e8d8d16a8e9ef6489a8dc7e23892b994daea20fcf3f30bb252c7319e9f3a24e7a094646d7c807e5aac40942b3c69534c61915f98dfa5905f645a6c0938a947c3c7da4b311f65e349455d83d20a95e568624fe23a3a0781f9ad217554ffcda6cca39342454164490f780b36214e2ecf11c4dfa59f54b345f177dd98b0b6ee60cce55fbae9043132c66137bfa29ba9dea0d56b1b8c05c83c6d5c2b71519c5d62bb7a49353ff3d42d8fedffaf46665083d1829ce44dd42214c37b65ee950b2d3cf96f97b25978dee4b480ff12bf7584ac83eb8ea8d4912a02b6364f4d1b5f1416a8059eea1e45b2295e5b4cdf60c623183922044a5412016fe7130e3fcefd488b701fb50015e72484e7b4e4262730ee9c7f98d56172f0692ae6e0bce7d294b68f0da62e96556b51b92b688f7a7a89e7749b63cf5112869f75d702f677d982cd0022e993426278510029c1f84008a0c304193c7207759771888164696a945d20b4be30078e76ea64ddfa093d8eaef7c72f481cee3cab569a4ac428dfa9fe9f3543f5471dc89065381e0f7c7e0097c5f998fa388b470e88e32bedb3ec451263fdef402f5d7ec7c18956a974dbe7a24ffb37d7286bf281aa5279516dbe1b5ac299f3325b70e88c922382096229e1de7f4f2cb6c92f6ee4df3647f4221aad764f4128b1a3f8ffaf65bb4eb44f81cda73c17ab4b78985a29a2968a08e57223b5bcc38bdc734fa77fb2bbdc72d32e75dfebeb6f626fee35b9bc68686a1f97cbb6de483b630cfbb7dafb0e16e80addba30deb5ba3810ba04841e3559c3ca4905455010ccbdd1c1123bc8e968ac7d1ea8b88c31af536085b35a36aa3524dae7fbcb0b20547767f9905fa324c5cca34a2f5fceaea7dbc198cf23258e8fd30e7906e62c0c91392e085e009a87524f9bec5163482585b7dcff015d26d449b53b16d59cb107b7ee4b4698e8ccd7de4cf5183db797f41e3058e86132db882a4c5c57c0d3b227e84d32f101f8b8148c40db3a148b27513c8b6b24770e25c0ec51f7fef782127a3a06caad2f8ad9556eba5e9d2bca86cb9ab5c88a238227da3747e5fd4036f15136cf84b7ea7a3a407ebb2f4e038bc101bb7aed5d054e3779b321fa5a171b2260166201c74fbffb87b37b6a271b3b49162d936ab789494a894043193365fd9cd098ba725a51ba020ca6610257dc70eeac4d4d2cf917c33f725bf6c6c461e99e75cfff7edb4bed04542d40828a438dcca0866a152fae37f3035f93c5fe74a6e96bff75ca5bb9ace74ac5d829a96b8aa077a08d9249fe28630def945e0bc446577c4cfc613bf9d28cc92a9c1918d838516e616e3f2db3c30e1204d9e07589605efc9b67c8937c4238756001ffe9d16fcea5da334396c6a87bb53c416d5cee52630c05045d6b05be30ceedd42002c55486d9131beb9fda75313056b4ad39b5c492a7f1dd7f7151338ccc60648930c46c3f7b966b97f20da0ec7e11d70245ad05e666c792e7712af4d970e9603f9e0922c5bc32cd8c267f3f849e3a0a142046771791c6bb58ed8e48e82623662f6619c732ca94ce17a5cd588a6c2cfb4e70069ff8e3781db12da4a42f65339173e626f6ff13572780f4da8233c5075064f9b75b38d48f4c65c5532df46308201d2054f0bf32b4ce248d86fe67c612e5dfd0cc39c996b5ab3e85f6acd22f7d58a77a01e3a78cc2ab1ce47047d5f190ccbc1b599df6669d917d98888d2f2f175cd6bc08ec181f93e0b0fb8e3ddf3c42359c4b47e16f80feec9af1e6e705e1a3cfba8d374491e147443ddae21cc3eb75ed337bd51c7216e0c46daeb0e4006f297b04f22bf5c175b9bf1cdd5242637187602e22f7cf3565815c4392e38cde3b640a72459d8d4ef2751735e4064129e85d3d4209974ed06c7153a1b5d3c359463b58168f748d30af093ef59bc3c05551c10a07884ad567b1e8ca5fcfdfe778539d4549a694d92f2cb0699e595dc73b38d61a58b20d43401483e00c0852316edeb19e83bd2ed84cd930ce81809bceb558a168add1709a8b70db9c766af578f265385ebb30c430b78d0737906cac9b5450b7e10d55c9b1f33924d7d934a712d4da59c388e9cfd7be279d6b1939a53508fcf02d31ac319bde9af0a7a01a0adaf1437c557a66c30941acabfbf99bfc60ed5845bb512da244a5f32f376cdce59fccda3749b981caad2b736c957162e5ac31b313fca7f805eb8ab53f8759018effa160357714cffde23b741e8fa947ca23f9304ea9ef0bb22a9559811193fe081cb4873c8ef7f3c759aba05bc07135f054b23956b843fd324ab86157d06c41d2b6cbe12b70c7653e8cee3019aa546cd1a6842d7c84fe6e1c498904b718fd513c06ba11d0aa5c1eb8223c5ef1e9d88c3a1c8d298a79b0c0cd5a514062ce49e27909f0a494a1f632cf9710c1f4824aac588543eda8c0f69619362e6f19eb1476ef1dc6498b90d9a0b604436cdf4c11be0e98dfb00dc026154daf29795e1ef510c608b1deda8cebfeb209befa4f69c9e0d9925a4a4bd73fa2371404d3c9c4cc7542ba2f34ae0f0af8b6540a348aa40d6802ac1fd20a68b4065b0a5ef25d91950b0abcb27f5a68f7232ce1db8bde067e3e70599ae834b53d74d4219d23f44a9e05892a1ac75d5f7c9570f46c4fc2c1304ebc33967145286572a01707d25634e97317123302c471264c51826aa2c024f188e6969535ae451c477eba74bcc180dd7577a9920e8c6a97f0929c0a8363b660b2ea05a7f73d2974e0f61ff743c45c1fb8180963f1aabf4ba92f50232be0e23f9f5d53ed2aa42257c562d54687b595868959a0a5261944937fbd67c81512d2c96ab72f6645b95595625b61bfbda8796ffbf4c275450850a4aeb9c55dee1a636a292a8141f9242f510e68bae36c209dd755d39a1175e8c45c306acc0b7c7b9f7e1fa27f0e99120e84dbd0cf7791de8ce84d98acdefa1855ef9519361f8067c593c8e6a03839d707e879b488528f0a70c031670e552c41547303f4091afb75498bb399b5b956e54aefcb76c066388600cb3af7ae7d311b028c4b1d0cfab2eee8a317d1c43c49f832cf6c2b6751e14333b655742dd5e5ac425d34833e41e797db4916c07370949e8b28a1aeb22ceb0e70b408bfd48c1d7f1f0bae052c5fd986889cb5904c2e05bce4824f07f7c0c51b80cdf407959a0c1ecb34e5befa0078be36eaf937c6fae86f3fbe66686c16d588bd67c8e6e72081030d67217e99aa4a02f43cf6cd6cf0b0fbe38c10df3abe82ba81f913f9cde528f1395af402fc61bbf1a58744f9c8d3fa5b988fd80ac6c663f8771566cce5498a696804bc6701153a25f5cf4dec7cb1e6996350776e4f08a4841056fa6b5af87c8bba8c9ef6f32e88d1456de546434b21d67104e618c555494f5d512ef8af15393ad670a487f737c2adb13482111f755fa2d0e6aeb29d02faf0fc287f1f5e9581c0974610b7dd3539dcca9376a9c7a2dbfecdae28fe09f69abea1ef9b07ab90f957ecdf4605f402475bfa312a5efd1bf5769a8b1170931381f6818d7fecaa4cdb81f5cb4e092039fa39c263f76a2f513da644550bf711f2d9ceabeddf46dba2879cb24f2d94b39f18139984a7a56058ff56c38b87fcbd5178ec6eb9bfc10cbabb4fddc2b770de98be586ca0bb2c80648d9559e357c28d365132233b292f63a7eb9eb0950a2962208713650e6a98b76e29b5db3b60ae0780b01f5bef08fa97a0f2f2e1cc032dabbcab77ba3b9b90f9bcfb4cbdf28cc95367fb2b23865986402fec84b0bad6216d8940c6848b3c24ffa792a708f9730ac75017c82a434a0a1a611315948e1f2409e94f7aa7fdc4fbac73aa711c26daf44a8377e5494989facadba4605262826863e7819c5858b3d81f319bdd0cab366e40ac3252ae045e6d259a05c7c96cec48d20dc65488b9c1b3863afd45206b222bc3fff482243fff67733a6c6f757b688ec5525f20320b08bf5e88f06c1ebde3f486f4b37ecec3d2452bde1be0ec3df2fb2da925cc33eddd9ba99d6e3001f48d08b718dd6e0182a53732db0374052ae61d35cec98be2ebfc0b767f318cd176ea6d35b3bb95097ea405bfe335fb8379ffa1f235c6a9c5926eb2d59dd0e43c7b8252b834d0ecce7208642971c79ef63533cd40ee6da53b9c92d8d7bef7eb7ae2e173ca500473841d1ca2773a2c063cb89d7aa65058499c8f95550742dd21b9276bc108e29bbd14d3dc7b37688befd200645170029d7a05fb58b16d2c465ace006ea5368d3ad7e320fdd2ff109ebae907d8091a193f885979d89e0b0a4e33e321cc565bfc0c09b8373dcc1d4f12158987f93b9a01049b5d899848947179c848c6c33578af66accdb0508098e327761f46cbd32469a129fcd551d70b71d21cc1eef16b68c2987fdb63e73a722a4ffe096e4299852cee9bf88d1435bcf360f028485d19b8a82bfb36bb128a5be1bef0197280f514c98e6df487d562bda7a4965de700d962a2afa48cb23269e640bdb67565869dbf0bdfd7749e64cbdd7cf943f92a588c78a6b6e1e3b08a16180c11889e0cb48122c88b3751281c663082bb7e90ef1ba572f04339d0042e90ce5097d56bfd05fd14511e6678256b88bfe84c4c328588717a753123dd95de1aafd25cc08673a3a4488a68227aabeeeee667d67998d8ee629d8ceec4ce54b08bdb2a9779b846a4ea44313ce2d30b34b3fc3c00c046aae41558657ae403cda1fbfbe8ad6f7149bc0ddcb61f47d6e21b830dcb22e8f84a8dd3ed720ad9843169d156eeafdecb25407e4ebbd2fa2ba6c744b0b86d869a66e1dbe6a0f82fbccdf295dc941df481911558e2f65141ca5d827a7389c078f03f0e25284aa0c281c893e4a7e862267d4357396758a1117ac7e59279ac50e21abd0c93861f03aeaebf67662ee3b96726b7930c5ab553ac180f568df99a7e758f361561e2bc61997655e0e0b782130b5b4c4f115f6c2c3f4a73df064a34a41774cc734694ddabfd493901c5ae5512ea1e35127b53f7c96d2183df270af6eabaf9d687999564043d47b676b60000eae675d18f072c925776aa65836cedfea712db71f63c679825c38b4b6215799fd6ef32902967bf9c4a9cfb0f947eb2ee1a9875117bff1f59119f3bd1ea3373663ff48ae367b715112bb095edb7c5474fe18f4338c46e57ddf88bf5df521decb8852c8a995bebe8cf0612c908250d62b5202b947c0a79676fecbb5865f807609be52f701719481a6372e32cbc7b5b6de1debd06eb62f542f9ed3228c180581222f609933f7acbd1b63cb3c30a056101cf318422c69519c807eb2c8d0c1289ba68adb45ef9dedb575f27f92c51634d1bfa40c01213e2da5cfae7429a7c9550cd80e14ccd1155b8b39c8b46ca0635c0f145b254a466c9535df215143d97e3e77ff4903439c389cfd396d8fdcd038942e1361579d3fe6c313f5bce7a4261850b0cfe1270f0e5428dbf8c3f722be00bf17bf1ef2d37d62a4816e11685b28a257d9d6df7e34bb5aafe6be0184da2ae699d0d33fa793cf77ea601b2673f88f3b330c48ed624ef14ed72957d26765cb7e90b4904e39aab6cb2b6bfcf4485e5557cdcc44d8698b3759995bc3a64e7e53bd0072c81980a6179f90f5d508d57f37319bf5fd0693e5610f9e97e9a5d544361663996170efff02eb9438cf5af9c7fea90ec47abe78630877f5a5c4e47e9c13bd76fb6483133e0e262247c93f35bc5504a092838a231d62b185f388b95d59da04a405418b3cd74b65d9c65fd233a951adc48613199646959878a3f8c9d19f94dd3ef31e13a4c7d8dba74ee75d4efdda15a8cc06048f0ea88347b173a19a51f2a65663e277a4637e5bedf566f48e47f3eeadde797f5d910ef4c64297572bca5c135e421f751146136e67959dadc2528733ec6f2ddc39888211797b107afee9882420d9317e89cf926b1625c2393cd3bb88e9dd1e79a83ab4c6649505635810b73616303a8fbe5b06175c8bf68cc97b9cca15c6cb3cee72a5e56153a98327d997c6ca6af19c642dac80c99070b0a465777cfe6370d87065c53ebc7c6052830944d0f4228859b7a0f81f98425c248d0ee828000621a130802020e56fcfe500a4506886fc89b2ad76e8f0141eb506c43f541efa23d6386ef4f8896aa3975299c64b58e7e458365c714414e6d1a06baf3e19d08c83701aae804643ab575a480de3648be2f8015c4f4290db455b5bb87bef80fdaefb03139c27908d8bd413738e43744e4b0ec5746aab4f72504f47855d77b2f0c6ce8e8059e0f5dacd169c4e341dbe1e89282925256738eec8d4717fb9a436695c63549970fc31652ca9935c96a973b1b5d6d7d9b5cb8691fe3e224d6439d372e8a90267ed10d39de86a8632faf7ec7d5911974f92a31071a8b3fa5860fd7ad88c1b07beb63a07c2f678b4da910f9d80b389a3ad345c28f17d61b24b7e2e6fac4a408d13108139db70a2783477861f0445288482d6ccb528a75e726b70ed884bb91bb4044e6161eea3148731bfe2c2903d2835df13d47a620e211e30f7cf31c306bfdb3422cb1ac21155afeb16420e47040e40df10bbce1c70629695868f58406e1608a523f2ef42c0d438a36737070adb9e5a0b9bfc11eb4f49b24eb2c82c1d38285b0dc2cd964d68c899506133413695f3c58477c0fd7eb70c9d8d50e1481edcb81f906e40a56cc84fe867befb6e388ae4b304cb8b021854dbc4f291b56c434e415b8e9c2d0255a5c6c25a6e9efba7086b8fd54a7a1134ac2154925eaaec088f2b9a6a1f5b70eda46160afcdd2b00586c20ac92f00a62f9b77d2074e3639d780831b3da0582adfc7af2c3746a6762ac742e3564e4d82efc223a0b8dbb261e193549ce3939a6dfff74afa765c7a20fc52aabd200c3f8110c8be5e18109515684215fa7e9eff27db0e33156b801ebfe2655cd581b579c06f3ab2225bfc7cde99ff14f74355d9e2eaef028ae6108fa139afaf712b929534012dc2ee0accf6ddeaac248c35c6cc4ab48467c5fe2690bee6b3504e58306d46008bab36bbf2de490599c517f9845757f4278a6d0dceac046a7673ed354ab97e4c5fa6fcd14ee53c6bcccd8a2c62da4720a12929a0bf55317e947578b79b498ba921786a947903056823cf7d4bb3bc2f98de7bc8c5f9b390b79b56e84f14e2e34b8c01c847fa964d44b016d5c1465b314dadca364c8f1669cb609477b39e438b87ba72827f6ad7d22a55711b000b2e7954ab672a3b8a579321fd3e939fbe986b60954aead9b750ca071f3b0d1b2d402618e7b9db3481e939f8bd36769577e327e296de8e40c418166acd3953b606e6e97b12dc58f7da244e9cd502d7fb4754caff30699d6357ac4573999e4074c99ae30234c1b26e012c0eefcc59e6e650809d1d724debaa6c7e674cec7946f34fa8f81f436f3b351b99a698da0d43feda1cc9a253fba7e729dfa521fa36df263dd984b4a98700391c4f4d344857d8cfb21392ec8c3208c8fd26e633c43e8ce2e6983088d539b0d10725df42b91aef7772aad7d5734bae0935511facda14ba134c3f5fec37312d87bbe488481815ee1f95d46749348a79f7a149e2291cbe8017dee550786e29754aa54e35a0a5f81c08bbd5901cfacf6c71f75912d786aa2c0ca22a15f79b79f4e62c9f50f2ae1b2ff1284e5dcce4889e290ce7cde503aba2197bd6e326369ce97d45c547fd3cc2682ee7a4f5a6dfe000c7f2126a552f8f1c40ea6d0e155b00b5fbaa998a5061f6c5d304423e1f3cde57c8cef9e780a788b76710e26bcb301e05e2e2743f2bd05360e853b64cfcd464681cfb2db3d404766e7b38ac57fae84836a6d609c2fe6c0b1ffd50488096aa53ef3e978a3a10c53aa694a5a7598bf589597cdbbacc478c449e7921cd2d49999d7e01cb288dc0b9170113ef5ecacebf9997b2d762eac1ff2645684322f3d4591e23dfc8817f655c397b53b621698e90726a49b38c2894e1d6997d54d83c729459a0350c288f679f26c6c2d9511730c8019b82dc223820544e30a959cca03b72b5f5cf511e7899ee8367b251c37d8a037799ae6bcd2f1b66bb26aac83a98e7a368c04bae1858f6075d0f80262f75d0f6da6378a9dc27967ce6e606ca070f54d4fe57b81e18aaf22c5a7c09c4c070730e5ca9794c99ad7996cc763cd1ed43869520d571fc6b7edb533e2986479c4f72b152d17d37505932b758003607fe84e632c169f315f0268897eade114a2582123a08348924cfadc3a39e9e958eb5dbf08e807d008aba1bf27f85b80312a7cebd80d5c2dfb420695665a82b0c89b7847a4bdadf7fb42e0bd19dc15b267cefabc273418c604e2970e9f41f4d6a039207deb2e96b4a16675fc3236c8b73101a4b0c12d5047db2c289168a0fbc8ec3c4e00cf785e88db8b25b706b4ecd471649b80d65c57ef21f4677fa9b9d0145fc9e26d704503230530f7535da19c475b5facfbd6d3687bf717f47ee9f29bc92800afe2a1bb3d813a17b20bf5c66f3d133267c212139734924e8ea32bd42d9e40a2a9bc5e391e920f51d400ca83294a5a79dee5b7195915d0e58ef2333666bacd2945782a239f1e38cadf3f148b549567137857c764e5d8ebd57d0c481ee2681b680607493fe7eb390d691ec16e7be0d5caac954a45301b04fd90f90c55718ecea696ed90d1b965e859cbf74dc7644783e4fc1285c738d55fd7ced2e3ea4934d79cbcef942ff0405be443f5d90728f176149a28546cd5d50dcae65142fb2f5052f4ae79333403fee8ad57977b66bd645b0993af7eedca89e49c64de19b2068bcf9ba1aa11740d979252a6985eb36dea79847ee6e18a4873449554b8dec639f11306004a1b9a744065ec6544fd73687d01a64c4ccd77d001abcc0fa5803645c297e3c1100aea603c1f07e255ba6d5567949b25b806c84799ac6f1127d3b8e2637be4fc4540590e0272d3e1f2d40da6a82698bd136a86673d86cb7d5d4ec76d6f4ed6a21b63b14f11195f4e7e79bc69a796a62221710cbdec3b432a6e16890d47851814ac56d88174df376b44bef4e6350b354ce3f487f10a59f5fc20aac4ad9a30f95c0f94a5b29e25aec298d4539fdab4322c37b88b8be8417b5d13cb60e17125b2c0cc546299eacccd773088a7b93c19b8f6be9a6816e82e156e75f384805c66273b987c065492e0eaf272df36282c85b560a73dc25f61060e0f8ae13da67b621fbe4fb86e15a8f83abfd5c982a6862576349509d6e872a30cbc39300cf7c023de26d310f41053872062fbb3e8ef57928c511e775f577650448ad7b649be3fa7c321e56cb7dd2f0416338bfe41cdf048aca3888906c9b9c8e7a21d8a839a5ee8243b4ab5cfca17c3996ef310907d54755d152aecbd80f1a917acec8651c8ba9df1da80dc55c172d376a1e76eb163ccd45f272c2d22accefef02ae461ea73bdb6bb070adcb109683b5d594a4983ff01828e7b4fe51772ff15c99a079d2c234b74464cf30cc3015cdff4d1129e22a85084ce8a18a97dcf200c55db092bb193f5a17bfac67e899bc29bd4044845098f23d3bfa8780bd906b47213f3ccc8689035917ae033291eb5295efd62513de71dc8751a5eb8b526c708f3bfa8db27a1f3fc7cae776bc4467b6e808bb4b304130e17fed111734f00736c37644da5fad10317ab5f5f0dacd273fd5a1e7c059758f1a26a8f0569eefe7e84f321783eee34b57ac84187baf8adeb35d8a17d0192836c5aff5f8056e83bb6865fbafa970565581d6a4a5d9ea97012525bf0c2397599446492f74f9eda03e3e54bdafd4b0af8ac1aae865dd53eb3ba11cc615e9db6a4cfced72e4b1cefd7a98787363377234b1e02ecec75fe6a9b1e09dd160f6e5fa3244c0d3256dbdcb5a3156fbe215d534da2c94c4ef9b9f70bd098f8859db4010421e50f01cb2f27fd7d7d6a23279a00f4ad1d4dcedd944c31e33c897be6a8c5806c0aca5293f36840a4aadd4f03e5ab084ea54181d0c68415ae9ba5d54f6e2b28ff315d0714279e1a3353793a4bff4e9a356f14db4f32b1ddb6174a81c3a27aa753cf0f118225025d9d86aef7086d1dd9f693455b099c49db9b4f23e971c453b62c2e200a8c691a484cd24cb142906d48ce6a54eac61b2b8ba75b3988ef300c2d99e4002daebc2ca9b46216fa71c892a618125fc9af3339653da46e395b99e8f9906d8a96c7b66004982450c27caec4eea96b8cd3e05d17e8c9e5ba2e29b0c65732ffddcd20366fc90c2013aff18061dce55ccdaed9df9b0267dc7e5aab9d8d928786addecddcc9a09ff62215a62a81337cd4ba1c128c0becfb7829fe2e8ab0ca63ce87705dc6bb206044bfa8d2c723fbdd83df4458c775c28d4069c056f9fb97ac7676117f7ca0d355dbfa263ef9dea5cb1029561a7c554584d2c87fe346edefef19ec6e40910b08d1ad2844234d26c2dcaa8979e97ee097b89f0ff4746deacd5ef2512dbf7d5643423f66ce00e591554a48654a957a4b6fbab3d33c3286f3eae9bb55feef0951b9f98c03aa66f092e7cb7237c9bb19b988fb57642d746a7574e92b8bb4dc6328baba02917a281d6a53e41d895d378e0292648a9120f7c661a60b4de4a5846bf68af0b7323ccccceac93944311d11c199c763dc3553b90e3d9392790e5db67cf5a7948986848e4608af4e9d266dcf8a867555bb7a13d0c522354b81ac91cc7963a1f6728978ae1130e73978a14f42dd5132cdd7f43c068520e91b2bfdbdb23f85632305cb8954b16174a2771919ef6559e1813d7ba2ad694b690c7833c25ad851bff38c9727759bee0dda69359275a19d07e910581bb669aefc2a35d7d543afd86b52dded177de34df6fc4a44e6b952afcb0041538ea0b29e21a39fe0ab3d7cf9ccce6cbd01b9e2d335e757fad91d1e839f20dacff4d38dc2413591dbdd26e9f7d83daab6bf191e2d447f56735b5594ef4e47f6b18e8f9eceb8bfdbd2fabdf373f88fb47890bcc3c3a7bdc27c06869f9c859b6bb15c3c1c399c3043eb0a334e41b30a5fa0bf62980338abe6fc5de48418e1483f388c780d2ae829ac24fd1ee2d78250e4ee87377d7b6cd92740670eafc56bf83bbd77e79e3b6bda35129cc73c6dd5dbe5e4210a10e47edaf6b57e5b044b0111f1418ec4f3cd414f7801052fe3a009565927b1feecad71113c2a2c1a3a91d0dd755c566f2645b83299ede22836da2b718b3359c13d3c290805793c966cedc3782e7751ac25cf8fb6d5802eaf08964bc7e3c1bf8e0c68cdc9e10b631943ae3acd06ab90e37962a5f0cdcbf885ecabdfa941b2a79a1f572167e39df4fe3a97e7dd95845891834146d90ef642ec516e4d91750f527fdf283b4ed0b7ce87468255f14f128a6ee48be30b63e4016697f568c3de7ca0e3c93bea0768df8af4e8307f107462ddea667e578d0fa55cfc9d69a61af31f74f5cdbb8c85125375f20c6236560894c999ed2e611fc2d515b2fc0d9378a550f8a4f023297b827112eb22abb5668a1d951a3cc38625ef92de9099871b6b45bec55c64f7b354784692895c6bd02e2fc7c0fb2f86c29165577de180110530ae5fcd90816dea33f6a7a4188ed97f7bee67de87ff6d745512382f5e83f81c2ff1d7d5a29a1f61a1086b967b5b28dc8e95b205ff18aef4958f1062ca41df595823f8aa0561bae1eccef544be12b55586563098b9eb6c10abbc4b52005f79d35f9cd95d3f19b39f02bebc143deaac580362b88e275aca8f039b7f18eff3e1728bef63acd574c0681f8ca5f05ed452739a5c6c28fac42b681d13a9ea063025f0f6d1d89155892f2d76989539dd2e1a23c803615a31c6a503d5525e1458f9abfa4560b41402fb697c23eca27d6dfaf9a5664fc94f210c030be925d4be91886cc7c6a5bfa4ece702ec682e4e7847696cb53af515a733bf82971360ec70d73c3f68e7102388645df6f6d8357b01c1efb467b287bdd94e91ee1811949c000c9de2e6ca90fc05daec1757d7580a1f1e28cf379803d48edf5310eece6efd9d38b98b46569cddb0dea7e95f8a0b98f5dd768e3e0973840225fb80e26b0f97ce5e55574f15a57d15804426ad23883023442beb343adb935e0e944e3bb708d9aa285dc910939b4b8d036c1b8892e3f19634807e46748d3196fd33653fb0908f9bcb54a6278ee97a55a5d851ca1554f8a03d2c8fc13084d3d94d7d9cf325f55666856cbbf68cf01da4ea1e72bbedf57053ee63d139d60759697a1f8bc7834ee55bae23350249f1f9b6b15b740507350318819af46847b1b975fbdbfaf31a0ca0dc15539d5f58fe3b3a26ec81535fa1c189ea126e07dbff30fb419d1b4da2068791925a1d0c6e320a276b9e6065a0298da8855485bdbee65f505e82a9ca464fc6a8507d17302dcdc70bce017fc4b156571ea1186cdac15fd6a4a60713407925daad137f8d9b7459a04916367f1b3730a8587e32226bde296ee20365e486acf92e76b81183edea6f892a0afd2e5a22f7a61db52cdb6b10bbe5d7df66ea5016e2c78a8fcba58bdfad969a852051ec41a1debd7de3cb44ac3da7b8bea0e2257e1811debc1087282c1c21e2ab9e388e811ccf591911429d914ffc956c999f5ed3d4c859d286e5257a946a0df83f85a8b57d7c43bb9e47fa1aeabf0c1a69514ff26c25bf5f20694cdfc6c84fd8c9c23ad4dd3a814c467d8580e665d952101be7921b0419e236178a759e0cfd9ae7340e8d3468d35751ed528da199a296c2ac9ba1506341a07c0550c0fb08488cf8e38513bc26255124c84a3002a119a716c4f220fa880ef68fdcb93234c245a8f1e998a92563fb837d2efb5fe4e0ebde3658588e958f3dcccc18195686d0bc20ca2a5c95261eb5c34b12958679891459d074262463cbc104219624fa813ae731a6fb2ac6be60c55d9bf8b53e3dcb29c4542c041f09863187e1ec7f45d02298681ba5ca66a95a60cb9bfdc80fa025295ba37c1fae089add4749bf76822446828fa894508d74f074be0815619621675dfa88358a83140d80cb5dfebf18658ba4a9e60982fddbb8150029f1e5e21d0cfde080e5b9b839f64a71ec4d641db6ec58688c97de5672a105e458ce4e89edad7046df2da07975f7b9d756077b4d73f368b34c6baec4181c144677e3af43ad85373c4d0e6d0bc7b137b2a088ea6bbf990ee0148342ffde5a087edc909f8da3fb6e8216fe9c19957c1fd716520aa79caf5883795061420789ead91e899a27532057234a772bea5d69c2c8ec757d24d210c9b06ec4d5b339152245149c387633c8149df8b4ff1ddbd557bec4c0c2dc34c5b1ad5c5e70a11ab37a3f317d81d2bdb99431f27af17e309338a85536619e6f329b849b22289255ce0c8c8a6200dbe7ec62d8f9d2fda226513955093f8dd002c181ebc9311ac525fa8ae2d417659c2838464b1aa7c3fc81cdb82bb7572a07374fa93ccc41670633fd2dc9b64adc6cc22eefb186ddcf5356315dbe320dd6669626bb90901e6d63d2ad23d2fa839cee0eb45f5a3b6673e0ae60010034cd52fb92a2d838d1fe79d50483a5df60c0fd4f3b5b07e98b3dc69e94f88e4140b2af7d66d9e7cfb7b7744fdda0b378ce2bcb3cb91c24fb05e989f0db3e4c2da459715905a29cdd03b63e40185da9eb98e8247d31d01ce1d29d8dc135f6838e86a4ee95d9db38a93bb679b1da756c9cb294999c941825cca0fd6ff2a03c6b0a3340467981066e2642d18047052e6461c59df6103a2d9c6d7722b56e071c0bcd769f630fa0617053b40c290b98191b689894e54fd2d992814c0feba4158a41366bccfd5ab27f48a0bc72b80a898b3c5f8b89d03672514bfd0ae60ef029a6db738af150774eec4e1f196dc90794cccb8f3990f827d0cd1e63ebc3daaea189df8f28544bd958712a6184058af1ba90d134cf4bddd95b2e6de251ab8f87a4ddfb43ff6e7b5bc654128d476ba23f9afdeda85b98ed775554bc100009e3cbb96322e7b6a3fd1f6a7cc64fe1c7eb00fdb1f4e65913e957b65a20b0ccb5c59990af4aae3d9d201b373e28a070a83286cb6ffdaed8f0fd85bda2a505cc85104f6f17579c9063d0be64c5591f748db80d8a629f621cf9666e2b9f9470139cf3e60912372cbe230ebeff04487f2ff5f285928a0a0e0c3f24656a646920dc6ea5ecc930456a89a9204f2f82219422ce56aab1f93d4bbd079cfea85f74aa221bed60b0117bf0f2d44595b93578a240c9a8e9cc2798c4a53a8658d4d0a6e32a45e6c068a07a959294231fde1ccfe562e445dc606b367c404aa21fd9c549817a553539bcae19f4f66ca1cea790908df8f39fdc99c693e3346599f3eccfe043ae1d77dddb8b0ea5dc0ae62c320f361d139cccdb9a5c068d64df0d0654f184a4ae41c450c99c01bb95a0346bab81ba263b92d5628431fe9713586dcd1b242424d6e99836959549b0c81fe6accd5eaf9efa03afe571c21e182647db5822c89413f79b11e2ebe6f5e69d2063c2674de474034e41a44ce6da4fe6f4afc61d8a7ee082607a8576a05c6583fd59e7bd19128ad07fbf476f55156f4010ae059cbcea583d1677a9b85689897071e30f4d24a5d3708d076fd6b60fc9ee9ee6c5f69f3740b9451ad952ce7698d831386a0da4c21aacbf146606e8844405967bae676c2fc3eedaea86384fe5139aded2c32538e1860ac7f539df7d909a84d41328b7d171c6f892f1302dc373b5baf3c91fbe1a4868f7ec531f9d9c781601c410a17a4cef6af99ac8e334813c906e5e7fa32e2f18b877da2d099cb0b8b2a7edc7a934759855ec6360bad43a6aa359ed065f6a93ffdf8726feabe68f98343bfba6dbe816e4bc22832d1b45eaf8c9d6936ed0ec997867cacc8e3ed89b6ddb96b1cac2d0d91c6bd3db3f89715832a15fd2b16dc5ce0dadba72a3a95b355350c31c980de255794da8b6776bad3d8725061990f596080fd68a4cb1500c23762270853f555237924df096150d0fc6eb4a0a1d710a50ee1cd489e9ac376a6150bfdfcf00f3addb7e76430bd53d0ac82408fc381b672b681665e7a158e7a5ffe236e7f67f1e0147b05c11c9352b78579bc0bb7e2b2ae805121143bf2b519fbc50100bdcc36f83441c5f13c3af786bd3258a608c16152d1e46cbb74d6f30810eb02bd71141d38694afc22069c5948a4923074b6a3e41e83b43b118e3c9f774661453bf9940453a7fc487a2dbd7a2ef5132b8b37387536ceb3c60678554b72528ddb77035a2dc6be4bbbc673cd7bacd765e1776ecea317b7761c088b5025daf4b01e3015208aea9d138dad02e591af2d0e870487a2cfbf39a866bf6d2846dda59767b4f883a813382b5a152a143192a960294473bd6570c4fa3255c0fe4a4538dd928797431b16232d0e0d76c91864fee8499e8712fd7c3dbce22261b05a1066d5a79bf7c1d5661a99a290c6addb4dd7af624912c3ff1102ca89c05277a8d056a085d4a3e8a338de9a3945cc2811abbfcb0794844b745e193015be70b919695149d672de209d839ab68ccb15e80b87ecc63fd840fd279f7078738c09778c72bf88aac4af8498a499d9cb0696a67a31b073d7c7ddbfdd3367ebe2de2a2342cb493ab8e3a249652493fb1cc7b4f6f02cf8339f8e1d7658180841d3acec873322d23aa5f4736f53d55301fd20c70daf5bb2bc1bd9b0368d088099ca57007138c177a97c6da29e66154a280e3a58f14ea47b3743e89714ab5aa2b34054962e3ae6d8a87e569ae2a969d34e9cb0fe1b4b0ced22147774c6899552bf39a2ca3cd7cb0f7cf9f9b1b7546f2f5278ea8eb0e5fade0e1f6073d1dca6a093fbdd935f3a8e2989bae1fbacfc3f042a620b448459e26bfd9baf2d2452bbaff13e746a9d3f4bd60da195a73b9009a03b8e2401a95099fb79ce29aeaac7e6fe73ce9413b62dc86628fdc984ea7a71d355516751f14866317e42cfca7cefbda70255b531ef660e5e5ed75b78459da13a03068cf0c89ffbe8b1440ab02e6e0cd33416c7a36ba8728b268a1d00def8d44520d4682b5738370fbfb37c401f2282aa0deef12c68be753ab3d130ad38edb62bfcf77bcab06c7f95ca388d63ea0b8aae84db8a85c8f55b2cfcb44806a4c0f1ed87cb0a8666bb7769de02d1c108b6a2ba0c983f0d5bb7960f92b665fa4921bfedb13d53f417193dea528f7a2e20971a8cc6655109db7076d27500026bc86026b7a2b879203064a73a2e54748e3246b5f1e70fe9dfcde86d61ba072fade3c4a520200ca1cab1501b0c13077c8a6e7bfd3c7f365c0e066b3e2a95b5467766013e52b4ac49096ad9b9f11e8cb301c1c36fa59c42f8b8c68ff137f09c4c144b2c005fcbaf85a3933a9acaaa7ec91decc8f065acac6621b3d94dcdb9bee48061d1379a864342936381eead914982ce6ab5f42e6964e769e69ce4dca71623e2ee1fe507638990d50f92869cbb982be14e54221db4c9f9dc4f8c3b8b33fa3e2877ff63cedc6f4ed7b78fceb347aee9cb19b50d13a44ccb520026f4494a98d8cea95bba2c9a55c718217661cb137f8e147e761209149273463ec51f2bec0d63008dfb81b3dc337b1c20bd719e1bc28e60fafd7c8ff54a7b1cd40d68bc74ab01cc80bd9e7a39ce9c1a69a704eee7adcf171c7bd8a07f43949b94412823cbd6e0c9699966cdf8f7ed5a48b65190fa700d56af9e71ca51644f1b120c62d28ebd357ea494e333304e9e21f60a50088c10f1a813dcaaf3a9bf496d59b6d55cb8a163f189378f420aa3dd9c6b68dab5a164d2fe0b43562ed215945d97834379388204fcd108269a3fcc75bc735942095a4f87227600fcdf8ac5b8195a2872fccd55bf52831fd9267b1773a8fba447198fa6de89a0127b5096808ce14c849bf60fd1feaa70cfbea528cfc94f11312a021ef8845e5078d0e09c803873bca5f94e93c97164ce043cc1166adc2affa00fcf7970389ace6b45d3104ba994a4ac6dd1ef5298f6a22360aa28bbc76b0c8ffab3f1e60078760da67d99461369aee80e1283edeb31e47971802f71c61a5a7c3818ff13ab4226ca93d4e4420e2a060cd5c00a7cd2bf837194260400d0566b7f84be87b496171bec46c7b46c149d33e4eaa7e3485e2e6a79719b317042b1a55c025f732d563675d5811b5b4a25b17f2c375bbb07d9f1740b2531c210be96b320f176dbd625ea9c7b615a86250f35a4860bbe9c4525949b81451991f0153a8b1390d10f2d70dbc8f9af7d7fd68f6e83748047be44c84ba44dd8b840fb6b2c56f66dd758ae086bd067363c4b5db2cc6fcced733478638ebc91057f78d4ef02cee598d10faf7a1e702a498fd35a481ad1b94dfa53416f321f40f1df8172eacac9f43256053b9b6b0f26ffe2fecb71ae9857591852937115c1af2e328fa2e41fada39445f71c0e11618fb2db8cd298568db4400ca68b9d63c8b9b8eeae58e192c8abcb99bedcf0123258efa25744a065e030edb9ec516fdfdb9257187f20135cc6ff603d0afc0380f5ce02eac90929c364791d0c5f6aeee35b53156774c0ca618b6bff3aebb91902f31a75cd788774c1f4beab3d99a1a30b2c43835fcaf6d8ca451813074c7a736edeccb56efeb4c210cc1f465dd7a86811c68521ef8b3db838e6f85e2ccc80a9af0091d968c1c1bfadb10e3de75d0907e61a608c14f6cdd6189f14795677f3cbb29488269e758c271e81e261944e1e71c7a63692b05426811051f0630c0de3bcc23426d1d6146903b263f099a297e1ca5813cd4472e5188a4bd27f89a01885ee09a980a2713d263b92220e0730c98f4a80b6039bda02a7d4ed8f8286125a0452cfeb24b2f6d08a503979f936d2c766eccc946eaa1cbe84f54a8d018528a6256b521818dcb0fc009972c8ae2f083f40131c7142db986a453b7cb2b065a35106cf35f62fd62ec902a2b4d98b0db5e0e8cc8b2ce18010669952d67301ca314f8a10c7634baa86d667b7280cc6698a02e7fe6ef87b22bb748313cd88519e9c61da55539fc77f26adc0ce9825a93a7fd6507544dfcbb72f33c0f9228f6c02542e429407cda7ce661b2d7f920ae404e8cbbcd1e0264daccb9bc5adadceb440d5587a2757403f415924081161dfe45b0912dff1a58085b218463404bf2e53fe2ac63e3dadff46e75f5cff2361bcffd08e8beeff14ef29917761b684979c40c7369e2b3b9b72e55da6ee00c7a0e57d2b2524d9c3aa5d73dd887210196b87088f175f6254dc5a94bc1e564d307fdf40ccbf1f2fa1793cdcf007b1a3759d3bea00a3d356ae2526a35bf42350701f907362dba09fd4243c748080a4159385aeb102eb51b06d7abb9e41cdbf693a26290a525cc5e60b79a7b5b73ffb6117cef004ea171664b5104400232e3a65196507843486a37893877ba90fe7a9b4064a86e31821372c6e6781f21e4d392dfe29baff91e583c4ee39f4028fb5189009acfe77d9f2ef3a4664fc50fc8e0f540d970cf62d039a054685d77e31a995723f0874dc2972abec0b4e25609ea1ef2fd1b1b01c82a0385a0855912333c56933a9227a0dbf40cecbc34cb56f717811ed8c269205b3f57503f79485780f81bee6e1e652701fc663111dfbb6565a0026d4daa7838c6c406cc4b66a35d8b2d10390991e111f1826873698b5b83c22abaa4085f20c1f387c4c26ea9cef9380767d39b5d4c816be469b5de2f53506e589a297984ae855cae544c33f054b110b1f5a4ea37639af82fac5a6b0b0191e949b6ad3830b801dee479a834aecd9edaaed7c17837bed08057afae630d21fa9b307e005723e2e9fe5c322dadd3674949c58784066acc15eeb4799cac1f0af79adf5303ed20afa04fc4423076b10745181ec0cb66aebd46c0b82f60480defb323b7de780302e3b9c49b01d16f8617ffdb45953c8cd75141032097ca72975d8811ddd858485bf6c4f563ec876cc9756490aeeeb480ee81c30fc47a203485873d2da94357f43ee772121ee53d9b7ace4f9ee90cd827d9ea3a1ba35827f5118327d9f33295ec619e7e06d298e14b484c032af9249d82b347144a8f722f00edd0c472dbdba699156382cf1deebb2a323895a0c4828d0f3c2e2965cbe9bbd084672003bdfb2691343143ea416d8cf1723374d63e1d8eec127c69627168c52550b262aa377cffb3d07adc3e246c66ea970b30a11a2e272c4a878b3c3341a94c8ea2af64260bfbd504e557fe3a3acde54e0fcf1fa649d9f21ccd20d2fdf858137a6fd7cb13395f7f83a697e4c453d131c26b7554492447fc87543bd7858bcdd6fd99f9d9ab60247683db7f9238f1474250bcf9f37a3afe5e20086bac32d07c8154e5f206aaaa09c64c112cb82a60c37dad94aefacc446ab8ce79b0f48dc107088c8c07b20fb74000532d966dd2b54da2439a714db28a32fc5080579a7ca67a76a11df584f0bd7838f9764ccddcaed745d04ffa869bbd645df79fc130f99cc958bb6730470c45a5a32073df39ad58393790df9e013a94288f6d7719e993db620ac477cb9eba482877fee1e32e42d0f8dc082742fce2313099ec81a82892c99a94e6bf62e0da3bbdeff01dfc75035b5735c3644c791cbf25d128198c4e1f2d66e328f454a7fac1b311e991cc1b68206a5d52d4288469462ea743eb38d39345361242588d020222da7baec48b1de330d2d9db2f31ab4c2e8c39347fb88e8127711693acd22fe4f94635f5bb620ee37d8b3de3e934b07513201bdea9e453fbd2b4d04b23368218c235e52c8e36605b36e8b08fec263e7f0f5338c990b4ef9a45b4b3f2a8afdaedf6dffdc9657c0dff8e64895d0cae5fe1449f9a8eeb3a80ff25451537870c60bb2325aa9cddd8b3b9ba1cd918d3dc410599d685f160ffe4055285f55067d9f294e58dc04bce85b23dc24aa5a6c8a0cfcee85cd2a18c689ed8bcdb6b2848948d3838f890be1443d4ada4fc562fa9fcd74c270234625e2e70d78d4e6b385cfe16500b0904e89affb5e9876d51392c0d86335655085970dd6aaa88a8200a30907dde32cc5834149c815bea41c3aa986f0c85593eb4b318fca042b0fd3d62eb4d2f5f6a7a0facb9e9477ff6d794d1e23acee242fc3e06f4b514a735eed1b1555f35198ae658f371b4a584695bfedd25f315a2d28a98a50b4366f16e3c5d590f9bed7a852459c67dedcd41ae71d2be1490265803d7cd421441f98a211714a2fe2d86b17a9f569f9b150efedfde1b39bdd919416b07f7706a387d8aaa62cc44fa0ec0f80a9ecfc2726fbbf0f00ca1f8f4ae579a504ccb9fbc99037f96dea05a03720503cb0257c17a1b108a04b114bdbd6831372126f0754dfc346e01f6cb1695fc476f4fc91da3e81a349828f16112674ff20de119bcce1e5218fe2c8054bc67beb77c4e2e7e78448704aa9b025354e6f4eebe464571f38f14c961b34c512e44ced9962d48417f7d59201713a3a40685c3dc1d05989d315140556a539d80efd181b8c9128276db048a98f458a0edbb5126c5b347a0479fbe92a9accf9dc2ab1d8313a265fdb9eff0756e4f53bad4cdd8d900f812f2bf0477f23e364ebf1303ac6b56f91e4f494daa04af4ad39aa620ec179c431ee3cbee644f84aebd97ce5eb01a0178bd4f828ee6ba81a6d2542f7aedb99c9acca08403af43b7781023321dd407b7836b4f01b2d1394e1c76eec5474101a0efed18b06b7e5d7315e15d3c43b07d91604a0687ef237dedc57ba9c844328a9d2b36bfc3d2745f5ff941adf902e01eee7fdcc712c84add1e698871be121c8beb4cb63794b969ebf0bdedffc61665b09b56f52d56665efda832fdd1974efcdbbaa5c69a53732240292f05edd796699f9d1db02b02f131123143b09bc8f6e0c471e5cf04bf37a14fc8f023f39848c747f05a34e7acfa80dbcdd3755a00b71e0b6a4b4386e1196b1836ec825a591ee4d31ef6c59d82658a9fac9c253a91763e790cdeda5cf6a2e1df42b21739761a00167377a985210ae17282d962e81f51fdbfac662a5af8227aab6e991e301ac7e4d88674ac006c76a957dff1f339ed6996ab57d4985ef7c73cd889530e9b59a049a45c345b673d59607f156bc75e360b9ac90c7e9e90a1aca61c5a557f578b4c0060973e1aa68507aa2f0f19854e2c7f7e1fc9a9afdce459196dddcfddfb5a8b5f69d2278fec620ac4164fd1a133d75e8048b3016919f5faa3c0103f8fa4e1b49a09a40662fd2e031f180a1be3ce2bb041d9a942b7ab4b0339394ffce64c34a9bc936c8bb45d4fc5475f10d8cd37d80e6c5d4f70d52affa6222039e3963f5d040f6d3b0199f1a2360f32e9c0fd8ebee7c16fbef14a78eb889ef77916774e26a2f3fe20ef6784e743e510537d653b0261cf5d8a5361182fe15b52074f45b1dfd74aac712a96e4c2b88278d481c4d6a6ec99d8b639d98162a5e81d66ecfaea04a909977989013283ca170b8572a45da8203d5232b4e372126013240c91112411fe316292384d136dbae1cfe170f3d5f7728788d1d715cb55150920edebb3b4043d118c8afdf4eca1fbfd50e584e1aedd1946722acec26350b56f6ca9e26fa68e2d904ae0528c0c37febb1eb8a1e7cdd213ade11cf64152f2b488a91660ce8cfe6371da629c3e92c8390a1e76041db8075017536e86fca04df25cd9876cb6a5139c3550467116b2ad01d581ea8521232ab185209e9eaa938831280281466c00c8e829801f6eecf1f0241f1d362a2d9599e9411883f594b79535d70cee39f40628eb649c3d43ac997928e9d8ea213d41067050ae8a6bfe1a53edab0211dd2ab3a2317b162b075caf7ccd76ee0b5ce61a0fad8207df0e9384a383fd813de8acc0e46c31223e89f9a04415a224ee7f72e5b2cc14a832e7aa4c86638b1b4f1238f47702d8cf94d94c00a1c3d8874590f9e4f1cddc9461518be3df50b6f7b45c3f62f83182dd7d2aad8437f47679292253bd73b8a0d69dd344ede00cc1f6bdf30fd932703242d0c695d0dfca3a5769ad7105aeeea06a8a808bd97ef8014b7c05570192ac796477f8a04e75de3cc60fceccad59bab6b10e69be66b4ddb741da1158119d209a56e2d89d302f1176a63db008cefd298cf73577b6231e532fef50cb64fcfbb508d3bcfbe4621f63173407821ac1a502de68724e1415638a64b2069a5bd6fac013469a81437f1e046f7489379a7268e862aacf79728110ba6234cdb4b8ba816aa77e9f0af365bd488b509b04272ea0e3d6ef08b2ec513801a4bd1a91520d46f9b48e0e018d1b56669f967469f2f4e1c3a71eccc2f9b8de2a266466779b2c198c4b262f8b2b88d9469f4ef12148c985fb7dcc012d0f9cc32e0bbecf5051312d01d14040b009d2128d61acb7f807ac158474209554ec9aa03f4ebcdcf7c4abb10617aa2c2141003cdccb1f9ff4d48144cd9e65e1ee10b42169eee621bb38879a35a670be555fa457a6a985efdf17ca303b9c6faa2f453321dd438c4f4b0198d814257d91499f83161a89e0d633bdf920580171d09de3715f84f67510e610e32544057faf3a4ea0ecf11ece16bdeb95d8969e1b4030f5c6d8e13f526040f0b9e344fed8ed7cc24db5b46f88124ceb037d5117a1b9cc7eacdad77c087e0b3690bf65ba3c785ac5aef75b678b24c5d59501bebb14a76a44d6d950cd7be9b955f88ee84bf72e767514eb63c923e404e51c784ff148823a57235e7ce4662de2acb1db5856e95f13644beec44418c0f69aee9f4128aa089614b0a65b875e058ce3860d2e1d418913342546bebd8ef0d032d43b477c1824dce8506d95979202016a4a6dd3fe2d86220e3a2f927134382b1bc4b16931e14947693370e8a527c0494a221fd798668709319a92b99c89d0c7bacd4e412ed0b5a726c8d2fb9cbec66da43d15024ff28dea03280c24cc007e63818e55903ba72757674cef98be35ce09b5dd187dcd812ccf7ef4960f92b083439408d559c77095316cf26cda76155a0f83301e2ff30d358048a846a02b501c6795df1fb5d6b86c80715a9d890bb5ae3eeb3991e6fdcb573fbe34ee5a4dafdd47004b10f62b7702c95585a1a250f60e20abb8afa1328d44987d8e7ee7474d15e2af9a2568b213438c7b33f882ba1f3adaaed016d7069db403c24671ce07f2dd922f73cba6777a4cd41cd96c3c4dda9421f509620d0f5a172a4bf584e27b9e6bd1c5b31484b325f83cae172e44e194d1538509c67eb82b0825c7ff86f4ed87d85e6dd120a4765796c038159fa576d7b5c027700676a60b977d7d9e9c593421d8b90bff94e8e0a12e67fe8856a9373fb8ba14c4dcd28d38a48e0129397537c71821510536d6c77076ded16f075f894b228782a94ffbb2a15486d11c7665704f19679acc2a3b20f634f30576e4d5cafa07228cba34754eedfd41b3b2bab455b250165d1bb4eb646790b6894c302d55590de1057128b4368bc58fb7ad1e3687e5bc7366db984f77a102298a58d7051694e6cbd69310045db7febb40308503efc1ca86440d8e301de893e9f271c02808aa6cbb64563ae92fc3805565f8f9c36d80e181c92f5f0ee893072d60e22a19bd9d235c939979e82a34f4df9c507c8d77a7268e4d51e4825b4ab50d5fad653166b352907e3bc8be49dd6ee4914842778fbcb69b9827c5d125375b13aae2f8872b775792164fad797823f016b207c8be8e65fa862f1398597872d08b2c740fbf625f80c317eba29a48a7a8d33591fe9b805ce15a2c4bda28048ffc2132d9b98ec164cc047575039ae51456cc33bf70be1f6d59d898911c2b001427a0cd0e0be55f685b040bb2faab4e4eda78d58f7eb3840c18e319b61b7e00b79d158b2dfbd3a4d95abce4af84f7eaa68557cecaa124cc6ee40d78cadd30500c7df0a086cd4c4cd7d0c199670b0195cbaf9af95103f5bca8ac1b18f8cb201390c753f6a550f2d905e731597d49c82cdc0b66be7cd8c14d7a2bc2bf321d372f9089f4ba6c283550c2c0c1514e4244bccd9f0966f4f207209110cfe0410ee3e3faa3a325baf7b98ef62ec70162e7f41bcb5299e19bc64995d555b295075e0a41590f702bfafc820f4c4a6bd140b130842831f812e164f8b486716a411b9965bcfd360536b47bfc2e6339d1920c6b6484f78ba9365c9dd3e6e815c8e6d1141faf1583feef94663c84ebe137f85d336da2c4d9bbcde0810e711bd6da9fda508f7acb36e9baf3a17fc57a0a576855bee04613c48aa279f340391202fd58d500d4ccbb88275228445c70b3a8e97ed781a30c8ea28fa9c5e810b5d563c5312032afab3ef47b9ab3ab65b8e6da6ff14c2fb4806414ba4882cab3aa9e0b61af075950caf78ea5d6e5903c334a78c91b042cd28a740d19194ae1aa189d8efec160b47d8a4244fc7720cbde8c5742099df956ca2f5057ae324ed1d8396bb0e46d9698c499dcba77b248a3221ad0d3835f857fb1586c5dcb37e0779a20568338d637f3099fa6a3d8c8e648d53e7a2a5cee9692a14944dc5fa746bad9f358ae8909df21935456518879d7501489568177986f53557f7225ea9a0cfd3eca2e744c38cdfbf30b7f84b94dceffd668815f5f4dbd336a2f9bed0f9813ea25b4a9fba2e06e783c4f6d396c6fff683e07c0f3d75746e0bc382e44197ae7c54b2fbe6eea4a29f8b6941a4c1c19384eb9338d26ff201f421b33f0dc9aeb51b36b73973fd2cbc3bae5242623a8b2d17f94dcb1a2ac1b890087c3e6f6062496c160541d94176a4e3d4b6e1cc6abc4891a3d318d8889ab2a8dda101f4fc3e6c02c01d811cf25fd58231c45d659335874a66f26d8cdb9abcb83c465bb1e3d0077fc447e4ae71810e904516342798a06694a90fec138187461b72368cb415402120f131df15e6aa2bb0b45a62dbbbb9b55c8399de802a1ec0404c3b869121bb2d0ffab75069ae90efb9ed5cbf16aecd54a37b41622d93442779d5b748eddbff21f12f329cb5bea0409b08ea834c26ffebfcf8b04d53526e30833c519afe12447299e947eaab84b16e4bcdca23d6bdd9b3b8e8c97e529e76c1221571147edae6c27f4a7ee52dd062ae4a929ab6b7e988c9815103915a0bc994f2f3cc407509e1ec421fd438aa9b83a0dea055a04e99192c061ed0cda0eebd1148023ff91440a281f3eb0ef6ae7a8f0e33b2eadea82085b293dfd7c7c2929dcec3103bbc434a5e55a8fd4b335d4a5cff0ae7ac709e096f686eaacaadfc3f9f0e7995317fcf74dc631d17043b4a0ed574752309e5e36e4164d653558eb1807e58abd8a1f982edb99041cfedb6d80d4566f77ca055f5909750bf5b8ff21ec2b29759ce246cd711e67765903aa869ccd22acc4ffb3d7e54da2f452920c96669bed5f976dd20002fc4d0e271556d77ab40d9856003a2596c112b261879c0ceb1cdcac3a46b7ab4a4d90f46c416006160fc6fd55343dcca5484d146417e71ac29110b2188442743b716f7c027cf8e6f045bdb81ae640a27e87231773cf9d5923bf6c84563bbdc643e60a4a9ccc670e69f9b63745ccbb298861fc1c7c2935dfc24e1c27aecf29328173261455b3584025268b45a89b6db1e58aa32f6a228a04063217948650fbdbcb2ace152e8301083fbd6ab4c1b599e7ca8d814531afe63bb4902a13e81c0b5d7164b1a481234c8c909a897f26ef7774f4f0953ca5e2d07c1866c23bd10b0b16af288b938c403fcc632fa34afb13e0b2e5d0076deeaf2f17b0932203c5110eb2ab77c1404cee97b074bce4911ac693c4d5c4f395ee37bc83f562bd7a8296d84b750337d8357872ec4cf48e070c5d6ec5876645697278460be17352d8c2f6a42335ea7dfef2567e8007e5ffd9951cd943eed9a321eb7522e35a2eecc10987aad9e9cb1f636a0ff21fe4a2ae42457cf536b8907c2013c987a396c2469d5a144fd655ed6fc7471b908c49c8117858ffd353891f4d7be3f0c87cb1517862eede88302ab49250f887d7ede892078c18b377da58afbfdb1734c5ee2c57f1b0112c89a1c95c3da6b1371bd9dbc5d95f4c3408973060efbfcf4ed931519fae50348c6db06e1ba1e626691f89de08c8a520407de227876ebcdf39e9d4903f6d35f90ec8b969f92025572f7e23246abad9700c1dec8818742af29fdfaa2998bcb2cad21d36c0e1b03b3c990097975396b88da0a68ed8e8e5c9cebbaba466bd6063e9ed3c73f245afe95c50fc67cdfe80c341a4b8a8f245bb543e6d831f0f3f318a5c286aefd00650321b7a0b3df40d6ef39c4191091ae90a328535cfcfc2dc798dfccc0e4483ad78abe1250c78367400fbf024e4fa57ed3ce85a0f9e17bc51169840fabbf1f23c76f1d177fe7c3321347818f450fd9bac9f43404de6c4b02e7d21e0baa5c1c3b06d5baf11140dc3d236c5856ddd40bc85cd37e44232202957e5685478b70380c9e4f069342084763d08b2b9b35a9d694869f0110ad2f101ed4ea856619cd76d95593bfbbd62685191c5306610249e32dc85ffcd7a06c1f498daaa0a587add140ed50cbb7f5ecd2202be17fc073a1dda8dc62e5f2a96be3c3e3a4075c8cde32387b87f832deb2ce0c1d2ec7d4bb54cb46b67b9654ccd3e1a55255426cb373a64489e6a14b9bf2b55a1fdd43e6d6dd0e439d5fd4c0597a16dcb7ea52eb39c6cfbb0563943b81b799555e7ff4c83cbacc12e0cb5afdb427e10515538db35d37b54430bb0f1a6b2a6249115aad05c1774fa0875d8025f8367eb039a802a2e9a1eb5cd4532e280c1ae59182bffbe58c903e3e413e85a79352d1cc7240555b15879ad396b1244642d754859ff7cd6a0a96c61113c0b9840718b9bc5d2407cab770719298808b87e6ba5ce62fd2d2da12b0024f4922249fccebfe06da9406aaccfe2c8e312084531974a139666bda85f89687f7a599962d58ec411ee268acdee73cac4e2a8bddece6f2197469f7dd8d3d4f836d5963027f946bba45896d3cd6715915121e668238d9d43bdac83eda096fbd6879e3b0a8ffc079e46c1cad48a6251f2f6fed36178b59ef3dd52b8d983a8c362405c1c8dc9cc6b6a6c443e7b1be98857097f52cf6e0b1ad97fd7929ad94a6427092a2b6c8340e0e4c6d5a7ab7702599b38b38180d77a504a93188bbf9c282857e6d28a19abdec8af5f3d6d94d8682f4e94a3e7d01aeba853f8f10fae495e4d2c0ce6e1589b7daf28f8e533c5f8803dadf64b9f6794e1811f32ab3be2a743632b53cc3c324ebf5189065946afc56db19e760d6d5e6a236be208f8878a04e6787796e7be943c7ae4cc39e5c91dd435c09e016378448beefec8df5831a8d972252c0d6fb47056e150970e885da628e944764af04179a82b31ed7a20b3a5c2ddb21dd829c89af594d309a12eb414d89433174a2c7dc257afbe2102c6e02d7f3f2db845741658787f7fea667a1b2a7c5a387ef314b2004138fadfc80738cbdfedba8b5d379929d116abc09552308630beb615ac0a86cc63e39b0c827970f41f8ed1f8e83ea145dbce06d02fa1bb0597524322d82cfaec5ee915513c3b0cd1f6547d22125eebbd0cff561eb6e7d4c9897f53085b93f2df74f345412ef3f382580965a011ee8948ed23e5604729ce5b7d29eb3a40c450afea26b15afb5547a78f7231ffd0592c405e58653d076255e92a23553710ab89a28ce1d734538cce50ee4d3e821f59d012d38ed941834f5d04dca9c34d7202960107fc8ca8250421c4b255b2cc742fb9794be2fd6d04a9bb507805fd976e8202af67dc7e25b23e29a8d4798b9b6b6caa2a325a2449886ad5a97ec6e2acacb1cfd201df23eca9bdb60722eabb5127e65832e0abcd93dc494cae56a55a80127d7b6277e289fc4e003e5f85728212af2d70870906944d86fc04d3a6aa464b2928106d98754d97e80d9bd51346c8fb886f55f51afaea9a102d86890004bcd82ed0263bdf2189339e9c3888be146112fccd94f85ee8ac79f20c3411b7c29021ce387ad241bcafddbdebb2ec359b51b1ba1717082e706c8ea1db1b78aa3f8df179e13596d5cffa834d285e5fe0ec8c98fb87088653b9d5b4f0ff24e2707f24eec75ad9482c897170de675a78b556bd6dfd69581a7cf85a7a00c1daa53587f5b8c1783b5707d60254d1290ad99dfceb428a7df68954abc42f3152075179296807bfbe452dfb3a168e9f74faeda2986b814b566f77dc66a57405e6eec3ccb80b018ea8ccfabb6de5cf004f780d4f018f8188a740a990cafaf49f16a5a729107ed7375b0821a6ce0fe4d778c99a98fb6e4c3325146f7a476374204358bc677e2656016ef4b584902901631d02272d106bc4759bba79996afff1be640fe2061b9879201960e461755db5a714d9b2002d58c6b970b26cdd65d7e850e10a1eb486c26f5a2b65932d8a23cb12ee38e8153f6bd2b44ed0be826a5f875bbe716de01c8e3ac8be339c548847768ee095c76c51b7785508b34c66524427594b90d912be90d64cbc1df720c44766cbb0a316d7dcd413615eab59fe6d401f112d91a36c2336df673c98f9a4c27aef9292e9648156c1ef0e33613c411f78bb88f229b25a53c72f0636fa10ffc09c93cffb0dd7d24ba6eb39c1d06fab6ba46f1ad9688ddf1d939a2c112120e8c2cfef9a0c258c11bb465b373e6c821accfddfc762b94e8c1a7b9d49d7d5aa7f6c6114905019eafcaf93066b935bcde4c5978ccb9b294c93c8bb7deebe82aa8285c01663a427982ea8569dcb9d9180aded7be63d823b2a75f2d7d3317decd6185762dde5cc8e91ef03b3600b9d82fd89b1de47ff74f314ad1f90383cf8ed1519e2ee370e6b826256ca17270250bb3fb247aad9615c54f91d58dff88d2f08a16093fdd5db9c13f428e1b21a30e179bbed41a0c45d4a74ef430747de7984800c9d707528bcf95c5d3e49d853d60ba81f3d0fa00737c8574d07187bc63a24fc4a5cff5eb493310262b7930474d6845ea4e4d56a43ddf5c1f7002629bc54dd2326b79aa7d55c73867ee192473535da0a6e81906d02725a888d9d3eb991c6ee653b5ef91ef4c42a823cd86f420cab210cbdcb83af0576d386c8e4aa4002b06287ff82f009c522cb351621249dc5cb9cc61f8493bd60252c02620398b4bf66169b726f181c0280ef070e90f0c81c0800ada9ee0e334cd43608373527044f693b28ad141e130a3dbbfcaa3ca67cd4e85c1c664622446320e84e427ae985ef1064f55d3270eeff779664f6c0d7cc422818797134ba493067792bbd3c4ab20d287f3e22d6d922a405f6e5817155fffee40dde7880df8df93ff709d3a028f24775e74de3de4d9ce8dc9a036ff6276044ebd629aae51f76cc662a1c75832c9b2dc69570de56ef57851f2a9cb44106dc909935be656b96312cab2a6f6b5cbf3d77c7d337551d6b0c4860b039712579861c1193850eafdd80719d2eff30572e9319fa28c2667761c1753c2ece08d538bae6361f9fb407efe4cff3e6ecfabb7770427919a77840a8d9ce4bfac775867e60bcd25746b459bf751f1331ccc0035d8549eb3e0b10b653dd28e67da9e0a6bab02a44c60905ba0b1ea03c655b17476cc86181f0cc3e8acec53d72981a5e65eda269a1824941bb31c5e69b0409f602e4597afcf48eb8e4226fc2e237620f6edbd502246e481fe7ef4d9ce427505538848b6d22aca3faad7c009cd50db7dc62385cbb5d25d7b9e88efc417022121d4974445bbcf17ccd16bc4cf4f5058eafd0f9d32d2789d704624dadfc853f611d6561cb5e3d75af3cd2935f4372dd92abd8b139c4e26308c9bc24932cb2a77c8d8dd20caa526e6de5035ba29b729518262cdaeb06d8d76c5a82757cfcd3adaeff798a65480fa37a93b14c543c6e327cc80f09bee9cce685179dd3f90082101f96a33dcbea46a93b64fb38575fd99d1fdf005c4905ea41aa490924bee2048c03265e94dcaa5d032d8b7bafe908831760a017576e7f696b5b11d768bd3d621fa27f2d4a904fd4f3b6bd03b5d3a4b988e2c9b94df280f36932b1e6476e406ddfb2990b9fecf3c267bb88a34516cb5648add3b2ff3526b0b736fcef227dfc32199b6c89ade99e602000eec79ea6eb2e15f7ef8f940c811c94e569950cf72e9e6a2327bf667226f0bdeb7bcc5a47c6818e30ea5a1ecfd4f2ac632ab4f5039daec47eb0caa89e19f91882e0eb724703c9b79580522b09afeec7b82c570a8fe1d569e914431c49d0d6e376065ae8c1b03a6802d2a5ec7102fb8f3607871c128063ecdb4137eb34100877dd3fa703efeaf5fb269b24c8e75fa100e330138038914d08c5bb321bf88fc68c9585b828e30ba3a331222bb46f508051870646f39cbefd489ef4aa0a6b375fb559d1bfd30a8fdd679c9f79f5528f209fd8698237bc28d3779a1e9454d36ab62127ec8d8bde544daf73984245fb78058b0b90fa111cabd90255e0c6273aef92aad2d969713644f21e1416b925a9ee47699324cdca6671c6c418359af3c70525997bf5ef72cb3fdc9c3700e228a63607a902d6520fc70126a7c147cd4da393f60dea800eaa8d4ee3886d8e6414787f3a703794b6f68e06e4b4f03551fae78391c8e78d293e52118c6ec88c34240df4951c2b797b6277894df63579b35cb0e20248727ceab877365eb9b5f150b884ec2e977c5956c2658394cd2f85c53f3b758bca096094c2078600f90d14aa1ef40f33224883880f45bef3790356223d10a7721cff7a07aeefb825f6437864e67527362a9a116c5e4c0c9321d0199bca5aeca74bc69ad4897380a7e9a757b3bb3f03019a36a484f06dd36123ec4c0ec4662221e92ae91eb755f4ad8a72fc0e27214daeeabed97f98bfec3a11569993e96c7b32455473d328e4418dd708262a3bb82f1c8c71f6bf91b3da47f13b4141d46a2062e2117f406844c7d58d83b80f2c36aa863ac66b4b64e1630a0f41bdb690452109cfe68b74514f6973094b27554b09becfc868b0b0d47ce331bc129a626ead596a020aaf99177053cf98917e8d427142f862b969e72e02cf8ad5d2101a51414ab49a59b3dff203b5ee9cd9f40b78d3f580aa214931feca3ed37be90b144107b06a107a4bd55adba7771e86c109857c6fc9748958bf37546e1e29014a0ff930fadc0b505eee1c4f073f456430697ec6beb1220f79bd87c0c3ba3f50511842c48f37a742493d4e00778a08353c625c4fe2781d6bc96a8be26e35c0248ee6cb7d7fc56d7f793e52927d607b219b279fd99b70a61f49f995e20a2f41a85f3fe96aa7a65a449ac7ca367faf4efc29ffbdfa34fb88ca499efa9c1afdf369aaada0b87873ca8fda4ad84cd892c9d577f7d0908bfa164c0e7fa1a02d7f13c1dcb92d576fbbc0272006333c2241e17eefe39851fcf9831197bac3cfc615c98895503b83d6fb3cb11766dad0515532cb83769edce8b0cd0f7b2de3320bd84a8a08ac75b4e6e1b91c3c434ff6186e0465e47ecc21346f2073821da3131ee2285766fb7ffd14a76190a81c7c0584d2d4bf05688a5f57e856793be47160d56db185283db58b53f9f64be5546b098dc6612ced654d5b4563946deac3a0142182c7c62ed15b87b81837b27159fe10025888baa317068a2f275b7e36989ba2b4810f1e90f6f9666b29dec7fd37c9d45812b27a236532842e134b529dd5590f8ec1a0b4f168b8b19241b09ebba91994c7e326229502b7955ac357569720248dd4e77d1ab5e4813b71053a8672f7421a9cbcaff0b89a4625c261ecd0b9336ac2af75c01feb402a6db914e053fc1011ac5ae7dacacbc9d50d0210fa0d1c4877b366580f0069864286c0a4c71f59b809497c655f880a78102f034804bb3a188b642727a63ac528c593e5ae9264ff2bdedb75e775397a383504549cff0f9030c1bce5b64c5156ab6384c6ae116efb5395f637b178d84fa8b19112d556c2d5585fc94f75c30401aaf6beed17d15915bf6d7fc2b0a1539ae2701888e67cbc03b2faae79b5168c796bfb9ef41fdb10728d2dda17b80573c28d2093512ba5986fde188e30db55a18694683a2ab4a7535fca710b2d374c129dfa042e694903295b8f8facf39e128864a9d6da8d15531cfb61738a48e137b471e331dd7e8386f00e1b596e1049c88978238500611f0fdbfc1fb642c29d1572829136e92e134ccb23673821e147fb42b4aef7b5012e42da5be5abe8030a2b296cb0d3d9ca010b655ea9c59382cb467ec16308d694e3fbb2cc7c70be6f8ce173c20bdc998b9cf0f3ebd1a5b81a0e65145eb2f5afaf0fffe8b768f9e2fa7803ed28935c7d8d45a4c794041e43ab03b9af4d3009b61f57636f0f2273483b55ff81910c70f813b563485bc1341061e40527d5d2f5e745c2c5278e357393d9083f50ccb76480aa5a7dc1b36fafe52efa03b501c63e1154789fb77c09c5d3abf30b221b6c26c5dd99de38928b71bb4914b50eaaaf7d8879caa3bb1801fe0ebfeed9827bc0deeff534d30e9301a9bec88ebdde01b4fcaa6ab28d66f153b1a2105222d50500abf7b47c0a5c687a7f26d106b2c81ed621060fd188afb71bd51d7c8ea48b242b2ea0705523e3266b608ea26018670824e34f0cae6e61b9acd99b99dc7b9d2b69f2d5edec8e0fa9add4aaf48e4f5a2ef5f3f004302fe5903c546a4c9c951d37e941b24563992e32e5691a4dbdcc8228d73a2c09dd576dd8b46acbc9ee9f7ca4e22f50231da0e141b4c45810447c6329869f95c64a9ea55f87370cf29fa4705fb2655b58e0c3803bc74795b73118b61fdb7e630a3ffae2cadaaa2daa86e32785ae290e5ceae61ca0a970aeb8b73cbf38df34baadbf3b7fb2cbf6a2d6d3fd0cf2f6290e67eec7102c691054745d211289a194bb6fd92518edf22b01927ea0b3d09579870b244dc141e0e164f3f0c394a97201a7f819fc450c2477e5a3d922ea44eff5768fea82933001007c9cb1b686884d4b7095642e1e40cfc626b7feceb9f269f700983078e2ec7f8ee2057b9c5101024198097557d0f82c6a853e49d86fa81e39d9944017c07e9d10163bba0937e50dc56e88f0406ca119c6942923a1c248fbadf44fad448a26c61a871a647c0cfdcfe2fd9c9f93f930a41ec0a42c3fbf2562f314e3acdcc05408383ce1106c10b616ed1826bf2446a21877f5706905cbe115d93fc6759a8dfdc33fea7f87f3b89171b81b2fe5640f06ba6b20e315eaf7fb0aaee2c502a0dc80cf82224e8969b0b8d285c020085661d9acebec2a96a5481d1fefc4f288d78fb8f351ebc1d9281054a76bcab9f9aa135eecb15c1eec6570ccea7eb3803be870c323ae53c9d7a0d07487f9f95b000b78668293fc5d5320163e5bfc6410151864b5e214ea4b96a0f841c5d0e1792933efe10d0af9b7f44918bb4e7f2ca0bef44f56082901f56047413be783bd770205ebf5694332ff34e5400a33a4e4181f1075a10e7ab4579a8ce2ebe18e2333edec787c9e0acea7fcbb9fcdcc2045f756ce540f24242c4a98f499f063d09b10e05d0f0e02170d52ddb8a2be2d715409418e25d6697f35ac73df0f7ac45d4a1199508483c96cbcea2c29aafe85b7aa5d27989c28b1285e301ee7be21d38ebebc2fc8bbdaf22abe5cfd7e91c45d8322c14d3220547f926c794b5c6f79b69e5d1b40c20c00a1b5474c654a142f2fb79144e7f96d1c1cb77769579ade9307c8ae796c6312b838cf207e092fa6ca2be9b0e88463cb02ef1b12e573cf90640f009225c73af080bf915e21896e18226d718a088b4b59cec9971238febd5c43571f7744f5a9fac907031e94a981fcb7ce02490fab41018b767db1127aba2522ff0c0bb3fb6f281f5aa8bc169fb2fb381650f53f29e99409871233dd12927224639076d3df136a68842c87cd65f5972e25bf4e0833175992d7d08b4e1cfd000836e152febaf5c6ebcb90ca320bfa5be61022535196847ccfebe73e96153e982bc8537678f3d5c125a68daee115b6f8edb0641291479fd33ec4d7c6c592dac8eede78f2304498bf6c91bcb0211c4a0149d27ad65a89c10f4a3ea39df7aab7bfe5dafb025a220fd2516ab759a5a9225c81bb1d1c2cea0bfeb0b339941889a97c06a1760c124a6229a3650ebc27512b2e86e691a817bd7a0ebb4195338d81b6387c05d2c4c09d4cdb4aaa2295afe0f6e94da1d65666c7988f63ba3535f821a7659134033755f8774e6a82150c8f918e788d41b6f322d6253806f377ca84d87ca9f6ad7193dbc26b3fb7a61fb3cdcdaf2ac81bfd9f67cf70c19fcaac14d0c9721f00f32834c60f383a8733c56c0e8c455cc3e7ec7945a6e116a90e639179954aceb1333ef476225515dabb5924d65582000b30c688223ea55b5cc00260a81ccd788dd7345f680dc61838ce6351bf08c776cb764be2cd12258d5c662f0c800fd880c5a21398c8c6ad77d5082a49d7534cb1eb593bdd57b982c2bccb99fdd916049488dc752b58649dac3b382fa1232da3f91b8e01b9a4567d5be65c45b47944fb16244fcf527fc2659680ad3890949aeffb0ac77a7ca866a75b1a6c68d7a3a50725a11c45402758b4e95f48ae2846272eda115a541c261d8ebbfd2455ffeba5827d7b1b7fa64b9ffc370242a42fd4a7c5fb7a3d34176229125c505e3e32ded17a5f2457eb9f8ebcabb2202f1467dd1a5231cb2f8968705defc04a9875506f0cfc39abe68d4a5e6fe57feeba369927025f2d65954943206dd4644e0c1e485c57b84588c9b9e3c0a31520a92d5ebb8b2e113e00edc71bf590211c8dcdb80865f33f56e93c6db53a1e50030c2b83be7941caa4ec76840cb5b80d92bc5929099fef3ccec174b9ef337350f279deed9bde4cfaf2b750aa91c001462afe4b81b74583bc77e5933b1316d90b596c750e1b437d39ade114d32e4d6ffdff68e58a567adfd87f720deb6dc5cb4e169b7dd06474bddc243c88499127926128a48390337581aa7e2a1c144aeee45c515423ec5046d4b248beafc3e250981dde8d5cfdb9311c1caecb3a248be3a9f2be8aa50777b1022893d905e032692c7b1ed563ceddad63a17a7119e6fca83b95d0cd48c635bb0fe2db77f9d98a7d3f5c2c676faa1ebda8962e27a5acd83aef3932f0705b1fc318b3a099fe8d36f893d1be2e8da093b7c6d9d03fb4e90cd97d2c2eaaa45bb91c7ebe98e8a2df38e139e50c1d09c61e5aceb2450546812cb7988f369be23c663bf47685d611c4df7a43e9bf05a2b6ea57afe4682d9b75d335a0920529f7dc8657e2c95229484cd38024058ed3b9330efe47ef648d3ba96ec253fba7a262f6e730baf9e19a833a812583f44e157311ab9bc317e6f18af7ee4b5d691318e1ea4132c038a83c4c65a97b66231bbfeedb06bf375f4aad74e0a899c473b93eb92d1731f28c811e73b93fc2666bfd6033b2374fbfca08fc94383206de491e43edda69b92a2f932fd0ee2466f1363ce453158b47065acfc1445b57845dc04687b767becfcf8751450304b7321b3e2952fb2391d6317638ca1d53a0b0275f7a2b14404cf0aacc36809fdd90a813d2d2727d3f48c631338c5e2c04054c188c84e088462e3a02e0723a4ef6165d95b151a7b1fccf8efd80d5d3e0f48b3cdb8240c04239d6f3cfcfdd1b19a3ebd1f0956f3d384381461344c81145c4663d5f11254889aa2e9055339fbb5ff7d256b84c0370bf03d1e6782e2a012330cb2e222a046f95e1b1340d363246e0473aa6d5208f5af4fc17f0c253a800824d86146a91a8180b7c4d387604de399ab6d50c7a56fc513b8ce5ec1f9d6b2dc6ac92b450aa05288e6d288d9a4ce881b87ab07dd55b64edc803b545912848fdb3f2f3da9abe4ab7ae5232438356304ddd8b5c79eb7305875295a753b96f76483fd2ccff21cb5435b46eae162e5ff8e3e76a7ffa54a277f4d8922229c227a5f561e9ede6ebe755d3d1f0d6f7d12fb59b913579fed7c4eb3bf9d9c38cdef6b2e40bf27dda6072a6d9c3fb0d6142e6208949090884d7aff7d68fab66309aec85069146dd032da303a2a8ce3cb3cea5638ef4593b071bf5b418cd3258fa7e60423cda015eabbe75626bf5be886cefcc0fb214c8b07a724f810ba018eace41ba0351ed6f2845b9731ab62c41d82c2f29901655a70719180f74c96605eb777c809331a9a6450e88f709cebeb4f828ab971a02b39acdd7e128294268a380e4f7ad44ffb17bd4d8ce844644bb8aa947346d5a7e4fb18b798970e513538ea64702589e08c78790d69693e8f6da8cb7302a6c1fd8a33ad9b4e5c37484bf65af45a8014d11d78cd81b472053dab66ea5956548caa5c73d761d48628d6f866a61fd3b9e2296bcfeebe0308c1d8da3d3663049373f6319f86f15c369031845c3274bdcfc1f6dfd3390965cb6a115c0f54ed0267ad72d8541f55cbce6153a7c5e0e60de775fab47b8ad8a1ac29c011b8c5c1eb9f67235d4155e4a58c26fb76bd862bb263e7f9e5101b876fda12a23dc1763de5e865ccb218a84d2ad63c09dcabf473081472bae91d675b6104726410a3e7dd4981209235ddf814de5798da68f3ae18e805cc557cd8fe4cd793b1024062267b52cbd2c01f018fd2b9517e6acda81055dd29179556282c611de09a53f3736abf2ae1e9e21226a2deaae62b0bbe5c368d61c1f2feda338831bde0e5d14a5549ded830a5d066be4a1ba5fe0ac8d97c02c39e07a34f73888f4c58804dd2ae8c865b2a464d2b9f908f726004121d9db2a6b8affa63544274926a04438068e95e732a0835b3ba492864480c12c0b5c24adf51a8f27377730f5efdf45665905fcc668b1c4c9a9e2e0a8124deaa47434ca3b7e1f7e92a528510d5b317558db22f252a2f072e54abbf24abe9db2753c68b2335e9ef92c8af1a0d65dcf22d1931e0e9772721760a002e87a87868a73ef6455b0006a06a372025e3d2fa130cc7d852e9a8ad091270b4bb7d5dac0f2b18776313bdda99dbd0e8f528e280b07a77d93333d5d6f3d9db98706432ddc7444be70eda8e54e7b500f62d2dd4d71267007e33f2f919c1ed018c95e4bc099b406c5b054d186eff818018a87a6b6424b5c3d88bb9bdb42d37f47f7af84991f6fcf4d262d127885cff207fb055e543832dfe5d4b771a94d698bcdca19bc78ee81f32597d0be732593e677be1f87177fc1b8c9d25e0b4033b68d2d220457eec43c3610a144c2afaf6e2448c1a233f7994434c9330cfb88d1cef931cbd240001eb928d10b05e103e6f2ab16da241fd1157a4612059721c2736d707ebede31ee007213be6d8bfe76001fda04ff2e73598e66dc04618278f02caf0e0c46143ab2288debba4c78656aa97227dc7a0f0c30072e37f6b078af73b800537d4bf02a55f62600c7b594620ecc671dc438e09ec25e70e1b7b5dbcedce2173d3e9b9f6c7f7fe62c65ea4acb3b9602983b2dff32557eba1babeeb22caf447569f6b22e9169e0a82ee160091e88420b469a6b9b0efad2f2bd2ac512d6ed742d4658830451606c7bfaf62c291968e856ac3b4ee00ae7cba5513cbd2511353eb68c8505906dbd7c8f0c527be26e151251c51cc6296a009fdfd8acf7fe005da15f62a872d8dd69600830ba682c397825b0477fc319145bc6631ff6b579a1204162b12d44b071adc74abf2077a7c980bdc03cd4d4ddfe3b6f9c7fb5f617f102ef1b678464dbf6f0748f166d15dac14a354219199d78926e316dd964e9894d41f0171df200e90ba42af3f6f5d2fa6a074258108077fc319c583c7e5e516a0b40d56c30341d401b0daee0746219249c06c8f8f30dfe6c2a98b3b3540c4280a3aaf42046f77bbb9a2c7302302b85f130397a665f3fade740e34d2b9fd9f74aa92a4c28a98ca8193e9832fa0cfef7e1d5adebcc2353c5d2f06796fcc37c548bb04b38aea8f221d6b3a605a96ee8a48984e00c1f25c49684bfd59bf7747fcef49f490f374a951f278cb44ece350548d191ba0d0e6fca6f6a7c38de1fd9e2f9f14641b0669bf16aebb4e11bc87e4621b5a49e91d06836bccec16987313278f1ef73fc91c81b4b9c214a0dfc6aff68200caeb148e40d1a30bbc7c6db411931b86b2e7f6b71354ab53ce7fed0c4ed58ceaf9ba7ff9d1a6165ae1febe4334cbcc1512baf412ec8299b5b074f174169527f6b30eedfb3b4129925422af5ee739ed266ff7936c3e042900fe69c489fdfc643e018899e78b20209b34e1953b5ae2edd7bab42a674ced3f208feef2297cecd16ce32a7f5e91816e8ad755e176a8b12dac2ce5c6a4287dcf98d8054e989d9337aac1433065380dff13e4f76cfef0f2d9e4bc7e2b6018ae3734c8043483fe4c79ccc593637acb15c76d7f5741aa0b081b7225f6cae765ab0e926dba417a05d02bfa8a7a0c214a71fe5d6a28e8c0fffdc674036a85a26575e069829c74b8993e71b115847f6347e884c6f02c537c83a51dcb26447c700203916f336640f364c0cb0bea5adb12d81a79f87eeee21c1c4980c6a944140596644064ad7267546a8fbb337544e21d356c2984acd2d4b3449ea1012b549feb7663274342bfb874168eb43b6c4bc1a37b73bdbde46f4daa21e0b6ed820f2a2d0846ddcfbfc50143906284e62396b7d38c23cd6d57855065657a8ce1db414d223e762e2882e380d387a6104bf27666ef0d4127687ad55aa56fefdd9f38be8f97c3e3a704111171bb05f1086d504042e164307aa3a2a71b7cdf3ce66a6915cba8652114af8f7c9d52e2a0ed1eb609d6143e2a458be481f4c78dc658ce8e8e776c7dcfb0351f11ace34930b535b3652d428d3c03bbd04b64d602176cf83b7e55e98941b4e9715453720f47ad8cf0f233100716949879fbd5dfb47b215b8d17660bca509609d4d82735bb7871933805cdd94ddbfd58d9f26d73c841dfe04fcdbff7dd1cab92d1544af10fddeed40088f732c7b97b7714d88eb2a4d40c2262a9c0911f7e2d7c51ecdc855934020284c54803aeae11353b27df7b737442d44404a4469f2ef79bbd2913751fa3d7c78d88f21d732b1bd03c4c86d56b53f7e941c31c1d9ecdd33a6d7eb4b61b75931ca71f6090c07086bb2d7c9cf516484c0d6a1ab3d4318186a41017094c244547ace9dade86aab61970d88da49fd6b84ec38949fb49810bb1f3b98b710b6608969f4e44c8c952913e9e7ae2b0c97da7ae6943d36718ab14ef95b2baf8b916745f26799bb0b04c506a2b71b897229b6bc76d1a07dd40e2f05c2052e1f6de9e91186480a40172fdd8e0a13bb6bbbcaebb4c67f8649bbec4a0404349bf1d1d1b370ffe83fdb2a8606f9a9921eb1badcb7a266758642f5ca2783b368da921fa8a5c3fbedc590bb8e1e5764625ae42a3eefd121b522652bea2e08f1e9d6e5b22a1f509d44e2a282c46ede679316e02283222fdf037347b69f445102e716626926b1a1c22b203930438c2206b50b1a1c58dd5346f78c30ae5e637b8fce16505e432f911c827933b0b0a78259add6dd113272fbb15ad54179b53f03a762857bc5a235c4063ffbb3dc065ffb7178bef8a9d7363a0aff1a9ded77d7b4c4cf953709431f53f31a3b0b771f674356fd6500a428f3b5201db188d9ade6ba7de8da96dc69122d41d8500610336a901141157c9e6da658b8b2830ca10a9a3d5ba2e84c6d69fe84353a70f3102a994bd5f95b37725599a770df58a3580717e215df880d8379034f300cc58d8bd6f7dbf7082bf37262ca47f5cdafa8155d40174254997f62a2ab6e7e60f6895a1f60e440eca246916a4e2584463c4a8f19290e96ce230f08496ec0749b0df5c54af3a11f648d13c1c02d6c5e60d3db01f9930075aa3fc679d1e0b65e2fb2c0114e29cc9f5d69faa5a34822419ba67b04acc6e6c37febbb6c4f42bf446318042f888f14df2d7ee9acdbfba000ff476fa8fe3d2f97d923eed9171f99812ab66bea155013b45cbc7e54ffcffb99b62fc0ba1840c1301aa78893a3938f52af42ba557d69221fbe720ba3a5b7cdbf9fb9e4971c44a41bf57f86adc45fe7b87e0b26a5f1fa7ac55592541a27cfe44c339903f40e7572e5574d17f2d75e0e7b484f6d8e8a334cd63177bd375ecc33b9aced91c20b8b21402bb882b2532b6bf5f2274b5450a9a754c24260645ace70017b5e6aea3026dadd039f100960a5506b68f07523b0693e491e9634fcd0d37b2c114bbe8766f828bb57e3bb69d18cbd9688f9ec526ae1dad04e425a2a028bb4604fc5f994756d9973d1b14bd619335ca0509801b7b107e89b87d312c9bf34bd9fe2499f5147892c11d7ef276aa6dcf5858ac1bfe03b5868b8c8cf087db29818f3593b4b1769192a9e4a668c98f2ae72831f8833e9f35183841ed0f073daed4fbe3774a980ec92c806a9a4eb62cf4b3e6110b30df2d1c1ff6bcef54402358c6d5b0873311fce6099e4c7589f713e5eaef0f2819fd94c29161f564bc5887a86f34fc09e460de1a99f8ed142d5ed487b036e99bc3f7f99c900274db6a91a63d7acff2fa5cb2f75020d87bff920665a57ff51743955fbe63472c568b2d85920269e2d7b43978a50791fe61100f91bc96c30640d773d322d4a9f85afbd61a044a7fab2e7d2b5cd1a500b184a3fa6e89fe13de7f04d5603775ed270b5df4f572ef3ac4f8d2086e2bebf180f8e41a6f4b4a5118149298ceabcd2b93dca01fdd63b1e0465a095311c4b0307a71aaa1947def93a2bdc5a8cfa85fc4a65760b824206b370604a3eb39fbe7253f83f9712e61ab66dcb1a9511e8cfc34a1e4c6930cfd57df08c6e208621f68b8956d18a32b8cea2ca4bddaef9ab961f1e1309c8081300be365f5ee79e2b289211ae9c9014bd20853f44583036fb4b86abe72fcf7640fb23950221882c9e89a97702e0c8477b164639e7c0817c0cb06198e38e15db21bfa43d4efe69ca2bfe7d8c858ee6a51ad1bbb3d622bcfa8dc0ddeed57ed3916f45076035eb41f411535d8ed48a00bfd9a318278edba212926810070a702c090f221fb1b4c27864b693c632bcaaaaa05b9649c516b950b37ba5ba18bc1719d080d46a06be50960b2f720c905dce96b7710cd618d40f9de4706b040314d6f0dd517a4f18746baae6d4f092ce4b1ac5989c613db3d00a5cbdeb365513bba9745cc8bce837ca90bccd0095a57998d59a667d03dc53633e69bdecc78b88ee6358dac89e531d6089ab723e3b1c356691c5f186518282cb34257320e6fc286d9e7fa80c6d09730fc813944304205c6a81ce927028a8c7c43c99871ec8bdd4117a5bbee5491a5ee4bd8c9dc8636f2cd45c57f9969df510e5b269e8a8c2fb8a6efabf613e7ae98ffb72bd811b1cb997510898d282016ec613a973f4879e9921f86857152b36a1c32ed7fdfab57daaa36e84d01c47f7d70bfbfd97afd327b29ad475153c478f01ea1a247cad08078f5a3fdbbe1185fdbf0e71895bf3d327b5a416325209537895456d94084aa9c8528a563f2e0ae6669e9732182202f90c1d0a029380abbca149d9b7464010ca65cf2e14b1916a071d586832e63b4dfe3047b37be0fd2913e4af1f2414ce2fd705073f4b8cc802c3bb2c59247935f04c3a0a7884c69c67c9ac495aa758f3bc4a158d25f740333d45fdcc139ddcaff1d7074e882ee9c0edb2439456638736ad0d2752f122bbfdcee53b5759947a195004d22a2f0c8189c4c6a4a1e0b2e7c5fde2933fd4f33e0bf5213ac4d424e8ae1c5706912cb9b65d295fab65d63c9deb1605d2642e3a9e89c5301ed8fd9315b6465fee286b27983ec9461cbe10716d083c62271cf3ea535b0ebf99d539ac8b53393ed03bdaf54390a6e4964794f13c0a1c553b76d977678e0f44c71c4014fb0da2228888a046b180627da0abe7063016693bcadf3fe267cf35209b3e5b9eff67bc6701bf482c93e5339ce25b9606a44a1497b703f5ac0eace1ccec95498b1d223da40ace43caccc58f4c7945b558e593ab85e6f633211a7d5a50355d978bd4c08b0803a81455d0b0f70a9a9aa9f13f7e68c6c1e33fd1e011ed2fcac4e077bcdac8a97fd6ecb468da60827a915bb1be898ef20d9deed83b397668379dd10498bd5f979b6b9e761cabe7a89033cac7d8210f7e179ac9039c23672a75b77558194acd16e377bf0813e96059101976fbaba1a7b9b9f7c76f2fbcf913f75c5549f26d7f6c148b6e2c22c667e2df786a2db70d11328db7fb1857daf37e88a91b0176c201a080a486311b4912114b91531f8c1102be70da4b26e1b5453a3663898c0ec72d4f1e05c534cd7e7355d95c9b592b939736c76d593555ca2c01aa5bbdf14c9ab3a04beacd473c01e6e4ce007effcb114bc78910856ab20bafde65b45842cd9bfdca7aaa87f32a8636b7f5d4a482d97648224055644fed2fd40aa8e2abf9b4e97f3c85e3e2be9799c94f5234616a0f035bc95e927d5f1e674750422ef1486c70b20feebe877010518a751ccb19ddb4d763edca21a9c53a1341efcee2c569d08150e29f4014a9ee907dbdaad4d8cc259ef94ba4c91ae3486e3cac32112fba9ddfb3f7511f53cb83fc41dad89308ec0d541aa04703bac3428ec55072e0b4874470017654969297eb194f615aa20b207fbada6a6438b8d4e0bd4f2386fd706de1b9cb2b9325d39cc085195610ebc210ea37b097434a2fcae72acb7cf9918e39e240c5534e03f1f58e8d739ddbf27c0632bb843581d029f1e32069cd75211cc42641856cd73e53e6b4dcf0704ce273c637137f43abeeab01140bb58870b2a798451e488ea9c6e107ea7b4d35f97b7083017ebda7b97d9f96a6dd684c38716412ab27400ef09f9da24a9b60c38a562e028a7cf194fe8ea7e2327b5dfcc12260bf7db0c51ff6fe232ff8a7fd8c3eb72c710f28dfc7e840774d130673755f86a2b7ce31f5f2e2e323324cc8bef417ca51653efc073c695e1fd078728a5e50c5e09944fd5c07673b955809712e3b44fd7015b0d69ce9e6dbf53478de95bb2d9f83cb9c240e062060587f561ab549b9a22f1c0be6b8eace53f6b7a9f337c443fa950652edc09386b773271ef132a2c77f4ffa747514ec9358fe67f1ddd671242f701ffa3d38c411c1759a81610192628f19cecec6c55f6670e20e7805333969dd1fbb13a4f02faa18c4ac11ccc67e90892ae178a9cfe4ef33884c57e25d2566385fc559274226571e1f898f390cd4a9512c7afff3972784e59d7a0f5704a9010f4a5bbcf8d31d318ab8524380a330d72c48cdaf6915fa40da7273ef9989447dcb9e351cbe56dbb9bdcfc37b7b92932ced066dbd0443738ed5a84af5dddf32e8dcf68a6cadeefa31f67129c49d90202123557c6755afd445a4e83cb8b70a8b1fd42f2385c40764ac125187d1be5112ff3754c3ee6a5479d9e5165c7b6d6d6968f02121fa86ae2c257fde8ef52be92f414a4fd09fc208e7d0e6879a0b7b7c37a1a61f76367801c638210a171697a695e8f0c117b8db8af0127e6881bd23aa90dd1f2771656f31390514d7801c93c10e95799eb3d1c12907f5a11f164af525361bae782329e4c94bf7a3772136b76cb0be51732e5672565d0efe207db770fa8af37ac930325b6f5353d6e69c4551d89d868d161a5b12c383e19b4d285c028013a372e0c817d06f5c4dc5ee4197a3dc61989fcfb5a62f93b2f48dd613007eea6b4ad87340217477e7232be86c02ebf4d8d5c6adf190b2af9ef8fcf35ce867af3cfc39c4f4767a28fee48d090577d912a3c08e4b84474cebb89f23f13ba3afd9dd95cc9cd842e1ffbd9b1ca0bd1318e02abd8e701e40df71e103f3deb5307e8b6510dfb440bc5848b6e56bfbf429bceae0968c3a61d11670aa9af5567b61cbd366d9c93c7cf55374ca2b0748ba6b6a16a4da0e611827da6778bec32ad547beb5bb724c65e5c8b43a85807b30a33c6f24ad47d79b69bb04562cf14db2c1647f0461baf7119a00d82e1ceb00e663eb700bd62fba24e9b33da46ede612f5ac33368ef57b6c8232fdd3fbac477e430dcb5628230e5f336765062096d2936844468ff5ecd7a529ebe89f14cebdeb8dd09dc6dd6d15fe564f3d53363a9dc76a90046a1fda702fd3b3bc898f51c24045f7b8fbc305d38d65d98cd4bb97e3645bf8a75a8d96d46761d06a16ed4b1ce3db8d9205abd88f6da8bc7253fe9e56fa2697f20d1a9ffd624bf2d6e820fd8b8e5663434f8a99527cec723694654a33bbb875ab85839fdb92edd3fffd42ead48b2ff7632b58d365168768c1747d0e91fedee55e8789f252b003e5eabf5eaa5705000e44c2aed280d5fbba5dd27a940adafd3e72febdf5e7386c69ef9e7fdcec1d61d7efa4c79d3409eb019987c44b9a5dc107fb2291957a12935ac687a0e67de2e52601606e825712d09fa949adc28a485283298a62c3213d152c03b7786b2f84265977bf512126a5006b83708357f27fb2b6120cf91b60d28278d3c136b9bc2c020692673d07ca6445eb9c789193c5581c3d77bc2a2ab493225d631fc28863c7e331ab3aa369dbb677146b927979147de23ce493eaee2afcaf95c33bd51b41dd01a457ce2b9124f370c9e09a3591b851c5ea59897b7b3720bd52ae68c245905ddd77dbf353b750cb09b4de656d035994b5ac516aed1bda3e140f4fc16f6a21d8578c9de9405005295f99f5cd72b22c6430264a570c62073c269a944722cc4de41239729b3bd82d4ea53c4397de63b5c701083ea87b6c38bfebb6bb95a5ade3664613db089cc561b3e739870d016110ce5242ebf240c891d315d560446c76a80e9d1713b8056c6500093cb8c2a13ae31f8dd81551d6bdb7e846912c2eb0b0168046511aacf771099da737a3358b059bbf89b5cadf0f44e806426a71abd44b6ddee6bf22048788c408b5908c2439cc1eb0d13e66f33c9ae5fd8d54cf08c5bbaaebe24dc039b50fdb86273aef6e52bfbd0173c13d3bb935dc1db0924834de5797145f090c494829a8f718d73e3e86ace7628cdf2038da10d6a361c3ae033d4a03b22a64c02715da0f7a4eb85b23eb0a05f545eb3f987dfd133d3168f68ac18747c26789124cb625f58fb2af76392446cb0696daa0b46b9fcbcc3d7743816a1554f0cd184065ef75458301c6654f6d926ad10c072c0c1d08c18fb323d91b79a27f585d2c112bebcbaafab83039d085f6f9428a60cb2822e37cfa0272836016ce6c2ff90a5d2be91421b26d7f571f2177f4329f18fd0c96d37e0ddc644fa78bea4a57183918b074fbd0be3c1ef0ded98091cdf6ef3c1b82daf25128ec3b94d5801065f84214bf8fc13a62a519dcf6b446fa8266da66f9304c9ecbc84e1476182b137d1bfd1a0103b55ebf5df0e2e00b09083372eb988ac6427e4070fb0e946c76efd1fb74ec4ccfc0c1488aeaf89553c8bfebd1b06240a1213a021d1fb5df6871348fd305b3f72f751d2b6d53c13d6f367c05b5687aa1e3f7ecbbcffad5fbe9cf4416ba0f7c9ee1b9f76f506041a1082ccceda7602535ab6b0c50dd9701dfd65db7ccea077a85209e09d79b9860e8dc797a43bec30f2e2a8415ae8c5e7c8f9dfb219fca8dbe645b89c5efea5df944ba931a34fa2858edb4a8e041431230f0388706d9b8e9d5ae4976264fab7ac3d2331332abc6058aef978a7117db42c46af8cc34c695e747388b5cfaf67f455da112a9928e11598f40809310b8a4944da631702a490fc261d1cd23dee7b7b557de3e7de58eb64c8b96bf1d7699a14d076f070aded5c5f620317eb82e9e991a320dbdf681979d442ba31e09174bce7fe48b5d52aa663a22641959daa9b1cdaa1fe240b4464b43a4491fe7793ac9d52a69337959d8e4f787086bbdd3f1a048adf15863a02cb9a2cf12f047ddb11f858bd7153eaf7007f58fb2e5cb65c213c0612729e26a99fd7114a313f19394186d1b3e279fb54ee963de90710ac65da060e0da80715a12df9a86f7ef393d6e1f635f750dd891ed438d824c8747e5f02d2217decb3bdbe7f0ffe0d8b5fc1dd019c89ed8ce9b69efdef7316d464049719d52e2f23371f20c15b2923398fe9b11dfad6f187ac6f77779c3c6b76702d0b55fb71f9c2abdac955045196584048d200633a0123414630e0fbb9a45e64300c05b22d3d0f424389eed1d1d7666a3dd46b3fc8d9b1186e0216e434c3b0fb4f628ce18ca77852a1e034a1fc80030ae4741b1310d94df2e9590206162f9156d2711f6c550d11abd3b62226f08f9204a8cebb734e042504856e4813dc93f2622a9d936dc6ac416663207a822f08e67507897aabde93f76c72878830519badfe2330fd7e3927b76da532d471fd97a825df017500d1f18de976ab651457aa546cd558ac82ba6fffc83a1a00a13fcb1145b3ef2b2db1f257c8fa8ea82e1cb87a4fa31ef72608a3f9d70c6f8957fe53ad6e5cd4b34da90d8e5b40eb512ce5628701c20d75d46d00a769bb9ced0d0d4c0a9a44e92c77b768674a76425290809d65b9f62fe9d10914e3bf1c7b0008c77657962da4669fec1aa0e206e1a0b188649d56ac2ae5c50a8ec12a0942aeccdc61b1cce54779bf74738a3754f62f29158b403f3ec1af764e8c9d8a2324282ae5a034a63014b338446d20b88e98adeb75517d7dd07ba8e955f4af08de42aebbb98365398f94e0c3ae7ae6349c81ac6bcece7c9f7f2bf21749a61a3b0a1f063996f013188f580e79df254ed6f14e3843dda655cf23c4390c6f4a19287cf7ca70fd1ab55155fd7d524c492026f34f214e16a838845d70d761bcd1721cc4273261cd81f72bdab1a41211a3b23434f72b3f9fe23d3ad9a91ef62865499f916e28668d0227dec10639c036428c95ef0a4d8329d8152d3520a5a4fc0351d7b35e7b49e7fc9479c399ea734ba3a4232df33e7081d98d848936099220f50256530cfa3011a4c61f97a382c83606d2bda4eb1a860e464b27623bf3fdf41ce1714142eff3507e860b0cfa5ec845b889a64adaccc761ab8f2e07bef09380fe4331b2e3d864a311f4afd7d5d6560e53eb89abdde6c73bd28a8868fa8b70f56af5b910122a8cfa1b4e999c3fa9a114bd74014672d5e37dd5eb1f482da6f64b1bba08761afa3df0cfb80ab418a3ef78fc431f90716d05886353bfba6e38d522cdaf61781b0e709b1393bc5a4880c767b0657b5708180791542a79ba0b1327287e70115e6ec71419395629cd19fda9257800149f2d1f4b8104a9c216141529aaafdafedc03ef9cd225dfbbd505eefaf5f660a3303a81c319a4b59fa42e7c550db4c0c3c08203a6b5d8f897516b9f7e59521961c7380dbf33cb253b04c49772537a9c54eb210acb68fc4852049544fd8d23b9c5358f79a256b51aa923964a3090d62da64d97d2abbb07f5c5bd5d274d35e027ad049320a2182ab30e46102d0ebbd490e50bef330f74a767d962f366051753e5c9477c5c02b822ae16113f4f79310e4fe30fa996e8ee5a4eb9be6239609e5df00f1455d17d7b617858548a63f5b051fea9872db409048e273b4957eaf71ddae50f28286253dc76f61a46d5b6f80973b3c3ac4f844044b7f7f0d19a6d7cef7aad4dbbd42da96d991805a8ca074ce348cd3803deea66ab2a68299a9f4d065605b5aafe141d78ccdb4f5663e52f0f6d81b8e958427aa8ea153bd724c8aa28623c797b26865f31285e6b8cb19d48e23252aa959eb92c00966b621bbb3dcd774841f59de09bf6229997203355fb6aedeff133f3add2cbd0ddb645b14a39f12aead09ca79a026298130415504c3088efdc3026e687257d41e627ff37e9270d9ba1142cd7ba8ada1c49299094794d578035ab2685787cc7031a6c636db8ee120290c04224b6e687d6f7f2030baa2224fdd6cf72be0f687198afd455b2f748145ec2af950f523561b35d0deebdd9c72daa3f89a95545f4a92a127a1e57a2aa8fce8e2802162da0e0ab182bcff1f7530e3f11ba5cdbe59ad28242cf44d1988e49847bf2fc5884372ed3deec0045a42bb1266c66ebe89331a6fbf45c183045528d152153dd15c4ad66883cf64d929426dc4234aab36785bc2af00283220dd10cf12f3fff290971a77d693eb42e089f4e8afd7bed38f13e7ceea29aff03de2ed45371436519816898e1caf5a0ac4dedcf7941765437ad74ba033d6ef59d48b7654df958a15794d784b2e839ba2eb0fa3d3e704db50f2d26a9b5539e812e594d0c8690ea02398ba19a3a8dd2a9806ab541002a58649ea8dccf9f2b49e6b1065e12bc464c87d61222114d1297cc79137e26ed34d0bec872a00208c3af1d28bdbc63dc7b803f13e4c7539c1738a279ca0df5d0718ba21c5dbfae614b2b22f9823609595f959c956743aa104638ee46f5bd8e6a822ece3bd740a4cd590ce33f0974ca2ff4c4b35a34571f0b2dadcab162734e73c5bbc5fb4d3b8d650d03f3bc8fa994c530e35361a3f954dfd218962ced69f37e3d064a6233c1f7965f44e4b0bc3abdb18c9c6d5dd6142dab0db88170be1fe686c118d3b52c10738c48683bee15ca59e6c6a8f67b03fdb422953caab4d0cfc72ed243708875ed423605bd150d6ceb121309e4e626e30f278229bd407667199114b3524ac222dea54c5507c8bcefe4bc555eaf51401caba0a952b12fe7d3d625b90793bf88ca3c84ca886e0db89a7708338c80ac5326b3d32d835a23b14767f1cba5069d1baac99a5f678d3b4489117ffddbe8440fc005afcf9da22c6eb49f234b0a53d8ebee65c70f9d165e041a8972edad889c78af3dd482a3eb4d30827aaa112e99e7ff90f249121dd712d246e4947e55e5915742adeda2518f80499ecce7bdc12063c5d33e4c89278d739ccce1b231a342e38d6cbdd0d2e98e62324ad242fffa80c22ef57468078f5e89319f62dbba218f1b9253c5081fe91e700ed1aa9991d869157e4bab82956cae97a322b6b5c39137864f4c3fadb613634c9d72208249c0fcaadee97421316410ec9da945accb5e1fcd378c0d93ea242515fa13cf9fb77cea62297ffcd55093009837265c90d2456532b9d476a0bb8090e3ce601f756058d63f28c6a03645187cd59bd9cde5c8fe169ee053cbfe885ccd6dff70153307fcf17da001339c1cd9f866edb6ea08986be18402cd0a022dc1afa10135c26146b8d9140005b2aacf73433961a646dd27bce0cd8886ccde30ffe44783b911667ffac3df7dbaab2da6915056ad71f4e46c7b980071ee3e51ff0886f5907e113ac9bf3f40e2dc4102bf150a846548119384d4c5338582db2d6641629e97fa4766386356e94acd09151efa1b50c5b7e406d5d2dde0d9761c4b127be4c466f1d3c2ac16d011bf6fdfa023f3bd39eb74114d7b40083c4f1c0df01da45da4c17de496b2a1311a35d97ef730c2dd6f1d1f03ab4d5cc86b512549c12e36924c4c3ae7ceb5dcc93ea14344d3ccc17ff10b78360d9a77599a98e90af39d492f26454fe03877944a153a9e869a2393840bf17dcb24b03f0d8eee8aacd7b03234a76d0de6054e2516514c14407bdaa7804602ce801c29d938d864b1b7d4e2e27405c4729f5b6fe48ca2a909683646c5bff88e0d97cab9bc86f1cb689775d614c9a9024303b44df98e7a5544d772344493c17b7f5e5a5f8ef369c7b4195e1bb89eee12f6396f997a3f469bf5624c22fa624cdb54115fc3a4f841f9f28d6fce694c74fc825bdc66a5bba3d1e2d6b05b9e4019df0bdd1714e4a267898c63dcf126e014340d5c21529681235c1e42841e74877aab7adb2a4c6a5579143d03b3329929a3412eb65a1d7b3f95967661162032ed9191541c4820bb3f8ae2c3fb8c00ce55e7b74de088def2b6e7129a3ddaf4c30f4203feee2bdeac9329fa9354c7b52803e6527da6adbee3c2eb984b432310b97f268ef4ec45d361ffd6ec61500d25089ee553ad7489e61903ef3ff077a45f6d7c6070d8635e93eae7987505bad71e33fccce1c4b7d525a4f515a85eb951c3c1737391d97c05ae8933c4d12582f9eee8190cb5a663701dca35101e525f715acd05e9dc73690eccd3fa12b0b2dd2b58860ecc832c70d5bc1e70c8c4dc60a5a0393c42d107152ed95bfbc6b1c267c7dabf82f4ae7c891fd2c39f22cff580dbf4c99cc33d5b21c2a8465c29a1a3e5e9a15d493626600ab3d1872c7aa3939a14ff6a8627fe114a34ae18fe66acca96b5809de78d327ab6a41e2621e933ca1e4d5f7a73965f9c43fd598c37f1cccfb34e434c5e55c6436a26358760de26fc10ccb59cbe6df057c25b5e10fff383cfcc376188c07d53d0713ec92a3f84c21ed826b38c18940851730058773e607acc1567a5b57cc5a35b2b83505719e1a359e51b6c7963522f54f7d3ab8e87f37de669db9052a5f5d5640c3c6de19b99cac9e94223e22748f46ff32c7ab82691f456c1c0925d649274c04ab505d330213faa419e1d7d0969240c7771d94519df9ad092aeff0c27af317f32d0b953b9005761cdbcf7deefa152484bf9884cfa7a75216d4bb9231aea67737d577b920ca2dc1d9bab5f9b2cb2bf94809da391602106060902207dd7517d9939f897f91961e2e13964998b7fe75fd5e6c4a5a4f3bfb2095126a9c04fa33bff70e6cf35a1c707c0fbbda7c18ec2bf52afc77c3632d49e150d49495e8efa57758f043709e3813cebe743bdcade3a17971ed9dd3c3b19bd82501b8b8b66facf729c351aaa41422748f13e98b42e25b984c82104d3548226ecc73c7bdc7cd7b4ab4c8a2c1cb0b8c693294f94eced65bf5a815cd14caf01328ae60aad9d56107d0dae8050982545e1da02911c85d53bb00bdea0a1eb8b3bc05ccc2cdc4d0bd4ce7156c8b7c38a6388afefae804090d4529301e7e84e31133c2873025426c79c9478bd4e071a9f1f587591096da1daba9b4de0f804d142f421e109a0e7ffb77151ae4e5bf37b933bd774e0628f1682ee6b43d65fed79c5165935cb34c726e00a46edc0875c12cf19130a5ae547ce587a5b1d1b0f6663e597c5f267ac9d1656ee2422acc4f1d8812baa378aed95b0e814ce3a55ac6c07152f197b9d2fcece5289fd9eaec746ce1009b50d8f2c1e505c5fd95ba9c25cc9e223dfa994df376d24b67077b25bf1723e30d36ac5b335b12fea08e83e0c69f43456defe213bd06b54b790787ebcc793cec83e9a28979fc860d2b7b4ce2e220f0de3a7c6e707fc42f49a6f1d1c35d72524833702f061ee687b6b01220a696ff5d55ef6019040c07422c98e1e7552a7d99499cd34d3e7d37813d96ff67202e73e6c029c9e242f6a0c72400e923571bb6c0b93d015b71724de77b6989e5049f80508bd5b60f0aad1bd59a5cc3f81f405286349473c175c46b8ae1b1627aacf549f13f53c1d1ca2074bc674beba983f88deb9b69381fceb9eb3e2fcb6fe7cab04c1ae2398f22fb0e165106d698c4739ddf9bc040c35fda2f04c3b2e8f225202d12f990d27cb2c85d85fee75664687f91e4c7d0e975827554a5ae6e7addf073a353c612dbe61f32828f0f7e3841de2790c2d3dff7f3dd647c14aa264fff5e0d41a7c5d050527661538a1a56b087023cb169790e7c568fb150675bb9ba1d199b1b2dc8aa026e103f08fddd057cdab4a4251f311de45ebf6c4322214578291c626ce366d2778fa3cc01e2fd190da23c1bfa7004f598a92c97307e7915c05269e7f941f8ce6fdb8d05b57a7e48323532812fa019d3332fb035a6bc88c4b741af2ef52dc01007d8618bd08742259520f8409a2d741c9bf8365aa50234c2049edb0b05046832cbb45fbc3e003e0ca1a043c0cdc221b9c10d814604d85cdb8228a1a69107d00c2ce36c9ee189ff3ad1700de495a413bf542167fb8b854f33811c82d12eac62a2877347ea22d9f65e6c09675248c15cef8a94b505cb981b892d8c7525f238ac8e51241d8b27b906f18cc70179a99f9f49df87dc2ecbab46633cc4b5c7010128069ebec3aa51f841f35ebddd427dc1375a79bb2fc3262484c88f473e08b70bc89ee7c33858af6e8100d3150ecb985dfb7a8f06bd13933f2eb1943b348944e7b2fb4cf6121f38a73e34490dec2c189532fac5903ea606453f2bfb13d39814ca5bbe2b795ca8ff4fd9fb282246f5d98b11939b5307a8bdc033b13b9e814429e65a8cae2ec72b17761cf15f2f1fd8ef74c08e2fdae298a57a582c044c9a7499c887d8cee7fba6cc0cde83d768065a87bba1ce10845140ceb8c12a93bdd833f59a4b15af581ca62afba841d45460278a29a7d8ec5686a72076810a7fc685d45fd73ee93ae6dd36f9e2b46d0259c04aa9c0b3514f3ecbd37f85e0b8b6877288e18277b60f1412c9377bf47197166ca9e169350b87c44594e529858e5bd513cf03739eeb5bc859926d9d4af035fa762f68b72a2e173e4012da1ead053b7c3e07015abd095e5e31a898a0aa9b08efea5998c7235d8a2038d9b6478b1be7498d0619438835cee22e5f54998ceb5642563ee52213887e7353572d67416f603c4bb0237398398f3c9ab903fbf9c91ff40cbcd7a9c61f405e7f44bfffdff82cd8ae532ae9f8978ef54bd4520f85fa14ff4d3c56c536abe812343ee691e0631183167c30dda9dd75515f017d61f1126bc077d75cf8d334d29ef3f4a4b2158a8bc7097473501718968a9c7d74d13983891dc16c1046aefb6ecf555f1d1a55a69f72a41994153968ad988cd7b66745f6331f05f61a33f6110be1cd228a667301032c8176a25cfb3c37dc18d0dd6ead63e936c19f5a35dd16cce23a55777a771226c6d460661a60f4f73619a7ebac522e596f184a4995d030d351df781af81f12e63fe6f678d249006ba976189dc8008440628781a41c06e45bc7e8f872afb9095eba3aa5568a56d19d9036eddf4f032af0ef9c4f5c2d5baa434cb8a1d75758665a52b08557ecbd96e661e8058e9d8c58541b679ec5d19d52e22e5f935ade0e050f48a6691cefaafd98bc85802aac79840b3d9d1e05fdd4e676a9dc1d81130861d1aa97233350876ba12c7a6c9f8431c301b0f0f1bc6ef6d16171dc6adc833e8d937367f0ca8e4dbbe00e4dfc1fa4b964eda7de7c57cce2cfbe91677b0a6de48de17a15147019474a018095f0001c20bcb43ba8c374c409f3c577278872c1809e9c7ed8421103c4f88eab1b208de5f20f3760ab37f1dbeeeb44fbc73aac4e80212886a7a6f7b015f408f6f94facde3fb4380bb0bc1969f8967aef5184eaea3075dfa2cea188d0bc83265d905bdc4ee3722ec347bcf8b998aada685636bf1612065102257ca1a591892e3140b136c08c356e404f765d47dedadab3820ac71cefb66df1dd5e70dc508bb91b0eb86dd61121d96c595a1979063cc99e4ec8334d22004dbd08fbfcc237bc6300da65b2f442f6a4ac2357597212c19447cda937b32180403f928a59c358e988f3ce1aace5c725d8f7b8cba621bbf7eab41f2448524fb34abf622c3a0c83d3a1432b595a4585861de67de2342dd7a7734d5700a175b62cb2227df937a2a4ba8d12b4d27dee944f4ff64c5e04c02446a5cdfa457fefd49c8e8d6b0001aa8b2da1d0a17f2b98d06eedc243fdcea88f5f9da1d2adaf093df2cf89b73f3629cb984915917a5f9d34d966dc646c36f4f339cdde0429f6ee999964b57e270382a2687290f385bccd2c9827695621722446e9856c999334e2fca04f08771ccd7fcd9be54ceca71b8848be9b9da6fa468568b5b45672780123ad41e95d5f79a87677f291c9104d6b09b7889372f675bc1e88479f6351508e203ba46663eea96ecb2a3f60f99903e592891ebae01d3dfeab0cbef28746c1dbd7d4b5062605a746e47b87bed31e2518b4e6a2d4218304e4f666b2c5a1bed35dbf53bad556c391008b9e5693c4df20b6086864f33436fdccf6935f62daed8e4e875c753e7d3f083946bf5db97921649cd6a35915831c3c878d1d763e3b6015b4eb52204427372cec360988e09776358314d515271d42efcf7cf6c7a9907d846931582e917e04b7b83024ea3de17443c6e7f451fc8a33a6c5b33a00187608f3c8a26b5c8cfb12da6ff2e6848d4f2a40b81fbd3815571107e70bd8c53de779f17662f39b5ed2820278d358c1867fdc8e6aa236c0ae38edc9989ed6e47ef91f272b3b7602a713be4af601184586dc92f285624179cd0cc6ac0302afe936888db05566a41be1e8a41557e10fc0638c494c3496108b9edef153f7b71011bafa6b81ffb5d44c38196294613ad313535ff3fecc63c6c5f05e01530ede909bc01ca90c3af1bf4b3c7c63390a0179419cde4618ec2ebb54ab51961cca58f8f0d5c4db4d56add32c6d0ab9ac0b6a4369cd3b350074bdd0594068bc07dada0e8a69c4afab0e17cd6b955c107501629eea2d2f80e4a910c8437e5e8622858b2c489e793dcf927d23c3080302fff81d10b5e0fdc3a02bb91893e8ab474bec4e3e484393b29b12a5973f20e34c14f388fed2df3e09b2e11626a13b1b68f4a06a3612917d1eadb80e10e6da3e1e00d4e040b9eb6a51d31c7a4e1b51ebc2039ce62c7b72e28558790e8a4b8f21bd0ca80e235f4e5b528437c5e49ef8545b37a0dc29875c035ce894be932ec1a4196f63ed46537bd20cc0c7ac191d6cd39b65ed2ece2aff0e9c74da0b40db4777e2c60ea3422cafac2b5eca12e22a76cc66aa70d1777a93a196d3766160fce4b648666cc4f1000a2ce78b69b28a02def25e2dcec17ab0665ed8bfe19a56334444530eb14d1231db67648560e3db23c4bd46f7feec8500c7aa8cbade05786ef8fdb488c49361d6a6d9efc26fbe99d6f578ae461f043070aae82aee56d34a56fe2396f86bff8aff7a1c4384e9fed60eb67ebffad64b2109e318480d933be4765a05deda04322585a19a1cf65641b46a1de145fa3d35a70073f2ecba93d6d0df634ee2d31ed54ba24117cd26b3e66021fec751c13ceb19974c9e23276926faeb25498bd96d1b008495b8eda1ccc158589bf25081d528d383d0ed85e9faa334b9ab7145e2aaab806c7422f24bfa1d3ebd77ee6f1ee4a18974d384c3a79e065f15dfef499c46ec192fa1fe8e8c2277916ab6afdcde83a471d08447aaebb3aef9675de9452d79f1b47b915c59db5f5a1df3816b4ef7b14d536d285382e433d1efa0eb3577631b28df4a18c03fad3b670cbecf43b9df86444c71ff76d377ad58b25b7011b33fdd598a21763ce36a0ece6ab42579eb13c19b7856e36a79ac8c7014bb1e4655477bff9e51afd7689272d3f377e3b459569608879807c43ed4fb31e27440c3bb80c364b06f13264044238f2a8c91b2d69ce9bab9586c915507614bd168869e27ca1d00985e0602e84b39e70bfc361b8566489328f5354851f20828b575ebea0b85f04dabddcd873dfb58ed982dc810b77b0b58806d80f30ce76fa648e9d8f7283512937b093e5c1740f6db3206c3bc1f1e9fcfa3d801475bf016ec1efc9b5a57ad0a0bb08628816477c0ec98a7956518ccd38e612737fcccac8b41a1819a74502fe4745f04e01cd54ea36a2e16ba97fee834803634a268a837f1f85b7bd03b1dd9d3f830577baef3f31c4885475e11e16d5c5697be3bdcf5da2837d632518037757c1458d709b2ead05c43a8217e0db379c316fc8b702539b703e2583492276d9040a8db5f5ecb4e21fd689cefbeb3d2931e8ef96f2d7130bb9ab496489f09de5479cec9b15caf8b3f4ee848742641817810f2ea1c8c57d13b5753fd35903611d88eeddb53a4f4a9c2fe72757fe7256769e3afd2ef02f18e2b20942006d1bb4c8ad619cbb166ae2bd13462b220509742de9511345dd1a97ab3b6b48c5fd721db15e60078ec3df317ba1c3a6249b52bb5c6994edf2fef94627342745d51dcd16601482facd47e256c845e51810be8619c43e80f5080168a906ddfc13fc70602193f14db23fb98cb0923230378af26f57a8b16ed9c134d4a7347a5ca1a398bd57adccd08b2bcc3308c03c33495b5c0a1aa21e1165a7fc584a4deb864a4c66aff77741c80f9d6045e45ce7b7e17666a143b116f097e57ccac0ff6c605770e70559b2192686a57cfeea841a0bae9d52b25ad38eaa6649513ff4539f6e366c7b1ca99c2fade8741925798049d94ee4a8a3aa67aeb60bd39d74e9ab493d65b71e69f1045d8ed38430360e907a1324a9b503116fee99a92734a1932f2472b89fdec7fbc5cd2325fe366a2d7776d87f5d5a9c279b6b99fe7199ea5873fbf74d7fef10694e4875ac0d926ce701f6600edba5244f0538b8ccddaa4a515e101c0e9f45a5da1422131cbec1897e76e96770d7e9b2f9c519f38b20e613b129d244139be6ac1945be82711ddd18dce8405636c767399e4212ad78fc9710644d321303262a5a36b9d9cd1583153f9b73b721d006dca6288e83817a9bd20024a880b76c88c6d183e92897b5021ff298a03ed5d397b83653769b54d908f0447ec818ca0df99ea9915bc6f31879e69fc8ba0ca68ad6af7875054b1a28fde21973a64702a510c850e3794b89a0aa200c9a4901aff50dcaaa8b566893fbad5fa45c9b30ca833c19b9214be0d4f2453f2c81d4e097d8359485d9f85c2be37b28dfa82d8a1896cbc4f594e201539c3dc1dedded2f79d26fac3b910b4641061afa88f35e635cdd89ebff676e7e4a2d5d46b423691920581a7bfc3fcdf81704b07d09595eaa9a6ad8b5ad561fa9a3b4ba6afa92205096078abbe79e10dd829fabd527608528bca2b654314ce42cc17c658c30375a8cd0c9928c2540804cad559e69ef377e8bbd2b9a71f331c75005127fd1f623c3b4aab3208167c22576cfb43c57503793d6e18d8cd6f521209aeb44f8f4928ed25081e442471b8b16bb25d5840f6eca6c39afddec6bfc4384789d220b6cd2a4fe08c3aa2d983cdfc97f2c600e15299fd947a9ebfb0d0c3f65a926d5116277b6dafdc03c8b59bf535049016f43ca2c58cd72e7ba6a936a002645c9d6934aed7cd82da1013cf4d9496f5bbfac487ef59bfac1e6182f34ce20e78ae5fdeeb1e275c11aaf1d5d1993845dddd3853a74d3657249844774ee34b915a4aca7f8bf8dba4bb79cf61a681b72e125143c09c9358b4f1a2a6977a5d8ef07f474ac4ad0ca086d35fc166238c06bcd80ee9c69c9e6697099065c4c7d366a77463fed2f69ec4c4b849539f19494268e8896bd24019ca627b8dbf5bf01903e6264e6d9566d14d060b9327f1affde7ce13d5882e57ca8bb5047db485de541d76169df3a07e848fb85206870c037d33d53ae23f1cb6d86bf4394db4683c5a7979bb0cac97b8a986cdd772e87eb1872cbe3cdedf95c820b0fa01535b217efac77a105a0a9b094124df8aa7d2f0c928d9fe1aeab0aec830c9cc0ac966f466bf2856986d436c7b224eb804fb487b406386e9966dba3cf6ebb144c33e068a60b420c34093fd8502d30eb1ddc2f3c5c79e6e8556f46060bd883c4ba5f91898b7cdcebe6bc7a82757c5b19775d19772c57b5aaa308d3a5b9533bbd9008f5cff77d859d3da052be6b15976f9ea480795d9d41dd504fad087a8ad93499018e59a57472c881049fa21fb278342d012125c574207716404ed70db725ad700b8e0ac2557c664914426ef551f82a61188e129ec491f0515889ce0260c401d1e2da1b5b3d8c5ddd88e80f68eaa3bd098d666d16d643d7960a91ce67022996da3d8d52014c4d9e2ec9be35408668e8675f8b6c2c358ea48c5f4690b18d1275279537d407fffc3cc4f973bb7524d945405f2bcb63af1959b4197061bde23baaff13b63505b26a8b8b900457cbb84ce6a40f7bdc6aec4b198fe1c486354e4c245179e486dd9f55509d90c30c5babb84693a5e192d19ed2dc8ba5b64fef9b0f455cff929f93384f4795986cf72d93bf39490fd92ed0b19037ba7a315035ad5daf0cc77dee35c9e7a21ebd92b2b4897cf95de83058accd1a67ba475ca8044fd1de140d3761eeb038d06f03c9d1fb3295ded3b388f56d42c63c4e5ad0e5f74cd34a070dbb9e32b33ca5f60a3214bdc1a195b2a4a8603552e6c2bf638f7dd1520636037b95f36b025be41b68ef8995a443e2e3f6c7985bb0fece4dc35322bea840996d055ab209d10bcd4aec07bff6e094e0b912a2fd38e0936317a2b492fe42ffb13e2918e96e659c74f987e0b63439476f1f8632d961ea4a87d1d170098abe826a9fe67dbb4a1234d9c0d243e7de8b72f0e7f11d55f592e348d2033b6e68e2eacdd23d4122dd6793a60d5dc45569fc6460273d903a15cf3db22aa6597d5e99d24b180d5f29d6a85cc38a8cb030ee724ee1255453f4aeac06e0205bee79103a85082c2607c609849ca9e9cb80fe2e4cc90a062e85c579c6386a70354393070f04c658e0d9f22375614d08eba9045219576563a2b46475f1ae9809ea2849c486f8afab898e6bee795df6bc1d51e163f7e8fdec50ee14b85c24312595e55090564bc9e4da2aba30e521ba5643367cead4645c37a3738d9db40cb38b5bf89bad5be277a13c72c29a1b6e0b04fca5ceb18b60a75f0b218b4bd7a95906537064fefdfa423d5546dbebffb26384510beaf668f777faf8201fede5f4682ff25a043d26659601fdfb4bee45ac930e3478ba263403c6aedb52358692cc3ce9bafa2c3c93453b4461254c21dd561970141648a42fc50a6722349d9289aa3611b31e0762a58b78090dce287e15946b55f3c225ece3114638a76570703713703b5379e19e224452cac33338a58434ee333c51bfa307193ed4dd158a10b90177b9a46f96e927b30a522153c1bac6004555d058d35b4bbeed12cfc053ca768a4f89000a38946fa7a36a41304e56d4818b7bd5a385d3cf96fcfe174660e2a743dfcfcf971ad03ce073270d9a0ec943592a80a939073faf608f06102044e996388904c557f59df1df48cf08028bcaa0d96733da3fecc081d3557234ef6e908dedbe9e5941c7694e5065c2d9559a4f1df5fa8d158c6491103d6d16b88e6ae1e0d2a92ecdd2dc2d9d4bef724bae59ad57a21feab61b3cd33b7df7169d6744df36d30826de640380482f87876bd024aec1d43dc16a28d1a06dc21553614534025da6f0aa4d0bbbdfb620bc80f89d6ede0138c3e150926ee22db7ad9cd848672914f12424cb680d512acf624c6b27bee5eb5446c9d26aa0b62882a161466bbb5828350ee2a0b85f177b59eea4be4c4219c2481cb22fc378bfa898b9250c95d7073f5d12f3150a62793062d31b30af949e9b31dc09a9b9650fa769b8080da505bbd8cdcb26e15a1f76bf7d261f559b9950f4d0e12e661a4dab0c56fee563caa114ff5e6098267a66c5ce7c72788145dc84ba04de724493fe7dbeb2f720b7edb517db72379a90e6151590ec1a28e9aa7d1279c82b82c569db27630b97c442f899fe8aa7d74d43529843b4d83e250686e4f30fa1e7ddb9cfb0f3f9393c9ce0913ec8dc69186b0db09deb958c9b8777a33f9264f8b0f4fbccef67486839c60477d5c20e35f86f39c73f7d70dff8a47b35c87bdc5e0a954de5d1f52e1a4a4da710f85302c6b72a7b6599187cf5ca3e6ed81dd9d14d5b1c6d4dc24ff4149417045559f73d1d9f95fc3b02603686bdfb2279f2867aa00a696d4b1fd7c36b51ea8874331b7193b6673cc0b952cb29e76b51a992df8677a97c3e05d1e80ffacf063df2a94b5e00fae56468ee5db75e52583448f744e6844dbf70751fb5c1cb53e6eecf8085d53569d1c9d3ef63df62512cb4ca0af1563d482cda12ad49a062896e74875567e218649113a69143d2ad714680e4eb47f6ead78afa578c311c4ca5f0ac2c2b4daf58b63a62078475d5dc591611c063becd322cc29c9bef3fd5244e3deb106059b9fc3dd31cb62125c1af8266f428d8bbe6452a9bbbbf4dcce204636b34e21f56807c589dece1f499f6d9a3aff90c7a45c0ddab571ad12143c962513e67578cb5a071c3be5659a0f00ed6b6e98b21b4388abbae401b776eb5b41cc2fc39779171b002869010a64f8ecf32030ba144bea6ab2256fe85db2c5b30e794291d7cdf01190629eb7a51ed067aa08ef8c0bb5a1753b1c305bd0a88619a914b3cc6fadd431b6220ff84890cb16c56f89cff9d662764de16ed40aa8dc814020ded8e06bf39292a0249a59b68d2210568126721ed8c3a831364687d21f596a9012a887965b0c86fdeae6c4a515351e71bda8f4e022063b8a36e6afa592213040f5df983e9fe284313456cdce8f3c21dd5c031dee42433a4284cefe375be375bb5e126658b8b743c3175c707d3640653917b65c2deeb2af01a0cd7018c14505df6f57f2e092c1f0d0a7bf35532c8d2776727d44a82ef1063effbca3bc2296b638f8693770e82382a28a6bb891c90457acae5ef10ee2f7f1bcc0e688b38dcb0b0cbb7ed7d0c3f5d83780ada4248dd7dd1f69d6acb0f27ffb977e4f5f50b8e67842a07a61f9ec4733a867d625259e46f9494ad656b2feedcd6b8617ab8147346dfcadba1d2d851914cac2db0c326588051773a7f57ddbe0684b859c12998addc8983b2ab78549f2d35b04b82fce134014daaaadcd68bd561f3ec24a6c70ae433642c2d73335200a03ae9bc6ca777122da64f408f7dc1c226aeae31e73b35fe3f66ad5d20d74abc8d0239a097e92b36ff265199f2218387aa7472565a61ed817b3bb4c60695b57bf2131e7989f1fe813a712af7dd4e7c255da2b7f5855ee11e1ca7e09b9d916b6889e1bc45f4513bd91a8e9178e0dc878561e5126f41dcaa50b9106b633db45b6e483212ab20344c9b241cdc1cb79d3ebb9e70bee703f76100273d7ae51efad49548e44499ca6ce0de810a7a5f5bd083932bfac4cbd7b7d44b5d8f2b0d87fc9689dac9bc88459a792a2272f53270ffac140d4737fa566791ea1bf11a3a1a26ba453749a29d20b5a8bedf650308972c38e38ef3facee6432adeb93cd19607260900262d75fe7042b53d4e11a82e0fe3e6504ecde55f29bad1b3899bc99d04cf17c1348bf88dda9a4c45eaaf52093812df5c19df29097adf83bdefd9bacc0e2b969aea9e165ae5e5f7a22d869e17aa3e5b9034c11e8194ac31015aaa447d87122920401b739cd1b9e673e451d737ae80050cd9dddb50663c3552e671e4b556845d92dbd2b68c9de1f13952a737c853a64bfbb331f0a531819157b621b791e563a5d2d3e27c8da0bc1afef3c0910fb456e46f192761b36993516759bd06f2284c2318da50893600d13ef34309532c0a15e1c28628bc27fae3f30a894bfcdb896c43a25fc95a511b5bd42a30f4e84eb8521f02f1f41b1cf872443fac8d7a221bf413fdae834c746de1749ab282a238e4cedeb07424ceb03850418412432dcb6cba00a40d715d680b1155f8f889c7eb9494ebf625dcc56f5f4f3c58dc230b7a2da352292f9c69f0e3469ad57be383a8c87f08ffe1b46e8f8b49f30cf76e17c727ceb5af731e5c340026f3a1feaabb0199d11e4e6c48321155b73c1c5150a8172043c0edb4a4303551e7919b8b6be5fdc2baa71faafa9f031d4e1abed03bfb8f90285c6827925c36aea7cc80257c81ee4760d968577dfc878ca6ed4d545b7b4615d0468a0d4d3ecab4e70b7c3c3bc2ba914bc58d8cf8e69ebe9af9c3ed3a43bb49f3194f67bcd5d2907bc0776e96add76dbbbdad7885a32f24f75bf44700411a7ad1fa991052b25e869b2bf1c83493ad2c9b5bee8f42cd29c2aadcff4a21b7e7a2b6a6fa0e514dfefbed259cd00c7c2ad8fcda4034b80aed34b7b577569908178d67874e758ee2f9ecab37e364e94a4c4e013d3f10447ca1ff7f24a3be107e82c047deff637c0417b70023bab8d3a9c60d2876a8fe817c68b3f17252d1ad4332455664d96e9488fedcc81505c8e5973f9a39d39ff3189d433d63632a5e0a958835ce85017974eb4829da554eedac9ce77a09ecdafa02587696a511c589aa025288046251d992c56dd5c1aefdd939a31238975fb3593c716d60185e8d62b215b7193fc44e67d52715901b0f5bb1b03dd231e727eaafdbc40151c36b9e6419b28f373c0a0efd022de9f0599c7b2694fc1c352673570620e5c5049c3bbe1c498a95dd6b52ea1d8515c46baf0185377683c9173c4ec5ab2723ed930daa231a8047e5c5554a0b020b713c475a11cdb1ca2b542216bde3905e03fd485ed8d7d2aa0780a6b146966b2e5eb2f576f9a9baf8d9941d3619fc3e8b5691a7d50834511fd96306165587eb7040e68c592b623ed3991d2a487f45484a6cd2c866d99c4d1510801867d70041db42d258ecc8bc3c52abc3da1fc32fb85a11da77afa9e434ecd90cddbe408007bdc4bdba2b855ee6294a96b111e51ea7d2774d2c18cad6b6e8e4515963fefe0f4adf7781a1728536aba6986fbc4859232b3d9a1eb2fbf2e017a974e29a76719785539c39a3104aed8f9ae9dd037f26ca2956d4238e99f76a72d9caf678c12aef29c2908ea5136d20a7fc7a89712dd51b8134ebe1d3964c5bfc6bb0a389d80917cbbd891d1208017fe434497bd6d11ef68e6e34f31d6c7cebaa49de801e32a26365719c9a66125586451de8b4b5344ac1a7f26d1a0307c105a0a6e8f5b26931a1905be741fff88f4e5c24a90e7de43afff4b9e8c3844e414d07ef2005be7841ce987080dec11c93f0ebd48c1b8fb1c856dcd26653fe9a7dcfe6e28e6d18f67fe93d3afb80be1f44e40e77ff27e0c93ecb8a6fa84434ce49ea9ec9efe348a475a03cd75ead58582a30126e2af51113f008eed42231e879adc8e721dd2bf572f156f2788aad84979bbc47b9c43d2f94138682ff82a9e2d414b246fd553e0665cfc6ff82e37fc1a3398e1ed0ffcebc08928e6f4ad682c16c87fc88e58aaad6bc3257c219cf12f07130444964810ad332217eb58b0dfbf0f85fc3f03735e09c6fbd935cf035e2f8b8cff379d341215d0486085fa90306b80a33e7a072c7440b6c0bf9c8fb071ed4cd795ae992fbe0775e78ad52057eeb7365d7471e64f3bd68fdea2e75a3ed5bc3d230e44181b73cbf4003489350818dc5d0c76f976567cf33c4e52d2cd5fdcc4fccc0832621204a903cade0b660624c0c22122abbd48e0f86d1214517edd90cc60209639470e475691925c79aff7ff6828ae7fadad1909035793fbee3d93659b5faba1a4f203a3336c8a8d1ac2572d51c71c904f1a813a44770a9715ea264af2ce85e8990bcc24cdd220046127aa6f080c79b8e4ba0ecf3294357c40569d1465ffe67dd749c1ade8d3dc4f3036f875efdf1689c5181bda9491b1eaa26ce2687ad0292d08c9edc431fcc9ed38ff97ef631fdcd629f121d6a821d072dc85b04631e6b31b5158d139dfe5914a8f23b0b1dd6f79ac55ad318bdb7e939446a82af4559f8092fa16c8dfede717292e0ea923a9970675c4ffe24d97975851e1678659ae52a868ce8f35e4cf81077b53b5dc9336549d5b7c23f1ce980cc7bcc23fb7cb9e36df6496ba6ee2b7e148d6ec065e335dec0ae2dbe9537b6253bc66f56085769d2a26702b239dcbd29ef19597fa8233215e0b6882913c51b3493cb92074467a502ab2468a063c3a4923615d51b83f2903cb32b9258162e4c484d88cfce689fca67fe400b9eceebf6b8a527a66b215240d84d6e4c7e914ab14804d56821c60119f3bfec66900a6b0b6a4860a3f6a0402c4dedd861bef86301b1d138bdfc680feff6cc1873ef196e8f8d1103475d6aa4189441a5443039f63c8bd4cd993036a1e1818d758df944639644712b36f74a335739ce3b9e35d109582a8db3bca4aa27f91d22843f91ffac71a39dd3e8fc6e9892d15aa383e6dcaaba04b76315454a7418be2738b6617c7ba29305901bfa09266592d42f066eca26fd128a3c01880eee3ea794816273d5fea979666456528e19ebd3e4d44ddd5638701aadf5bc1b6f0a362df731d4b680c1b2289da35e5e7089b3edb1647eedcf3ba585be70d8c4e77786f59038b8257e1178e08246429cd80b0a07912cb8b7292ff6172b93d44c5b742885b55a9aaa2c3d708c3037e35f0c23fc2acc964f1402b68d7b6958159af69f9933f463cc2c9956d92e83b2d4e82bb42572406c3eadb1887fa16250c96405f6c521ddc3fa004b3b61aecd050c99bd8c9d3b8d365d77709df72610e6ca4bcfcdf8c072519e5f7bae90942d1e4282af68ae4f641c5e6593f69f0e1907a80f6c78f46e0ab1af0b0f4ee4f446a215af751c0e422db60b56ff26991ae808735293a7c2543f1bb9b8ddc1045e68fcac64f725058bdf3b7d08f419d98e418833f24b195a26ac58c777db8d0a88e6502e3b3ee133d7b3d095f270a417e0d61f2dc48e69520de9f9e3c582c50ae2203537a1faab5d32211dd6720b050089446fcd02584d74b618489a72e2a810c252a0362a44f7c5e219528d3945500f508c8d859c8cc7465bb8e98cabb726be257ced304df6539b19a9635d9eb3fb1afabd9a79b9c6494305bc211938d16653121c8daa1f4836754519b02bbcff419003d63a9ebbab483ec610aecd12b02cd8d413d7e205d6d752d52526bd2a36497a2c86cd6cb16a903498d9415f7c8e3b09588ac793b74b3cd87b280841321ef482b25f2040fdebc42135eb4f9f79c363c9c73f2b62623e372ec35ff6f812dae9d181ba9c81d0ceabb2b362341d07eac88e6b8c815b02c46e0c85b2981a0ffe57eb8bfba2f0047c0abc24a512725e73e98eccd13a20927d489871de22f94f6094e38e7a1dd76b7b274f0c6aa6d43296aaf00241f084dddd8691b6b6d670deea29056365dc4b57e63338cc55eedf2a493ba2f9fdc876f4cca4e46d47e423aea53d79851dcd4ddf7960a89c99934b68ebeb5d44c3c7e14dcdff65c3ba60091c858e07b3a39f79b069c053a8d4ed6cf0d787b3577faaffbeba3d5714dc5496b257f87aa6c84491dadd59582fd553f7466596da0ad1cbf02a6f23a1f7dd21ee1fcb88c21452fd4988465bbe6e39439a5ede2e77321e35684400d9bf9c6f2fae0d562cc744db435498000ae5023c5a6181506ce501e2148e25c8e2b47e009814d87b576c50b2b7b383e3bc81eb52707b73b901178e1d605d51d8bfd118cbfbc251c92c0a7508f2ba9ab912ad1d4a0be4cf852ebb31ed50405db1f8b364bb4b7a6c5f02e6ca680703e01b479c19c204d104b43e45ff900fe4cb27c84d486b9adeb788417abafab726d87feeacc3ef8107bbb9ad49d68c346699c141795b34173fddba8c6d522f234870c8ce726c93ea3ccb144bfaa29834f29576311d6ce018ad0f32396d722631596780eca3928e48457743a64d8addaf5bb3b567bc8aaf1d778147f71aa0fa0f26eca2ff5a353675f392c66b8ea52b9f332b4fb03ed3aa31e6a2df0bd5a7d0a690859db6a2df7a72741d1ead59aaa5d731dd07706c8af60332047b538f6e70e33da224f322463ca100cad6f8c161dcfdb6aacd974132c9fe77dd306af8218b488df097a2005573ff33674c7e6036455d6ddee4b80c3a357f2d914a8eef36d3071c2f62ec3483548ab3ed46d0d3fa0af3c1b15aaee06f3b6e092a8006b4a0bc7db66b170e43373b2549c499adf9e70448584aaae76e6980560c5f560b0df70754149f37f813e5f692cb60c2134494ea7fdd3d65cfe36438289965c5f5e9a9a06fb82ef77bd6b44758287b7626b23b63fc35b3fe4a2492efd5e495b626212fcbfbe135f03ae2f38f9fdaf42f8b269251f3c112aa8408c2a3fe3f2700e8c89fd1918ed121aa144a830da5405c93fa58abc4740858a4cd272ba1b0e61de720f577706543edbce4d496ed06d7176976793e80838cdba0c1169c60f872357683a8f82a6f5cd17ee6c32b5762f81e56e9468b268c9d3654534db0b3172aca445a24dd3ac2549f47ccfc511b086ed7be1781ea8dbd0d4320031f865cbcf32ab5af4d1718fc7ca03c3c658e30d57fb555e06f7b1a064879fd647a1e9dc765583a5a340f4cc486cf95e9c018cf2b1268377a76921af11654718bb34d5fbf5a439ddafa2ebe9f851a9da7b5e4f38c588117c51d932a69e10875d5f14a3f859aced8f7785f470e99d8e6c1baecab4b0610ee7c6c22ddd31471d3eeedf8be9d889b72904feba3f515ef8f32a508f633f81fe2544e0b7022cc011231ff94556614a36644f4e10afde24a31206ea717aa9cd4bfedc094a25cc726ac0ce4757beb6a653c131ee4d09e79fd46a4adae8e35a30e66c88b8215cab33ab410b81853853dd85e964752cc98aae436dbda8162f291671fd5109957077dbcd6903684b9f707038caca8ceaaa689ab9d68f368b2cbe7c5b053af25bb57e75c89989a93261f5de0adcca577cd18ed984d9f68e0f833ec67a4be79d051f090b60ab27dbf28de8bf7efd87f10a02889aba924f1d67b034e477e734e8bcd8d182d72536ff15e9314066de3a613a73faa71c7bab316fdf446e52b6993a5cdb124f4e1c1cf7e55742143a9c0aac97fcd6e518542c9c67c8bcbae7746bc691eb45aa7503143ace7cf3478ab52a5c3e7ed25e93654dd501f174268b76e8f61ff12aa998b96348c5f3eff9a56b361118bbfd0efac43f1262c48d1b027d4f4d6a1915f2711193be90170d1df9ee5786c88d0669dcd38f21eb7b47b6c49c568efe3a60320e4ab2f3ac3fe933320c90a168522df565561a89d7015469539481d0271c9de56048d7cef59b2eb169c7910f69946fbec4c40553ad9185e610c077b0f6e73aa0ce89f12a4dd85cd284bef6333bee270819e83b0ba1048fbf18abfac476f06b563590f4faaf5b82472c2f55f98f50d7cedf5b3c19535794e0f1334281b70b6bf261f468301beef7d8e38dfc0e5680d651f2e16c282ccb15599c3fac5255f950c9aa8dc4545e79f6b9413475a777fcfeb5c00ed7c025cbcda0fcdef9935002bdfc9740675f4f61a0ebe04adaefd1b4234da18eb3169339a7011b82c22713d3a537ea08020f37451da3144c3969a93e6fa96a09d18eaa2d15fdbf252b98b9c157f03bf7ae1c900cb126a312254b5c9458d07b1b3d4c98d273fc1bc15eaa23ab52f22b5f008776f91d86cbc0932b2a63f6356a23126f210512feff6a2e9083e371331f55abb2851902f0825ff7884dd7a35ed8cd3efc75604e59fab41d2cf25f8c92d4715cb0b36cbbdfcbda962c3057685cbd895cbd854a581aa9d7eb72e3e7d6abcc0ae779bc97e45e1ad4fee483bb2f04be7bb521e0d81e453ad7f935fe5ce956e3ba2220781fc04e9630dea99d0efbef9e911e33cc7480dfe0fb165744cb7cf14423196f5260c85a4e073efe68d12ac6cb358853df4e3629868b9c52e40609ae0db2a573edab7c2e5ba4169beb5702dea9b1af3b1aba4ef16a3ec7e06ca4b21b00e7c302c02580c6e09506b26023039c1e3db8eea2f15280a337cdc5180d168e8829b7e3e65ad9dd531d5acbf3e3e7498e0cde76fee397b4489208cdc3c0579f4d168ca3a22b7ac9f50b8de7f1d60d0a721472270ede449ab25e42b9db950923a657be5a3ae52138fe0a7a06e8f004fae68be104657f560d9d153ce578e539579c6ad32cefe340c70d12863e211912c93ad0d20c56309fe235051f6798759560624a45ecd3ffd8f5eadb3573efd14ae6aea062ed204c6f7a209167f1578e7fb6a44a445a0d90f255da2aeb8081ae34b7c528c141ce05505edcca0be329ee1747fc28967360b4a9b84bad3341650360ad6d15c8238b53a81d53937b0160c18eb6a1ad064a204698873b2514f9a139a1fc1e91e52a1c0b5e0f0771f6d1776105da0a21bd78f0f3074c69bee72d65afb71ce31a9ec8e3a186d315013a0451b9b55146024de2d5b5b435e25639b47cf2c2f52be9ba8b45f41cae31eec65303fdb86ff65aa7a2bb0fb5d83188e76681e2acf18c714df155539dd3fe31f5d01f4e7b9cf790f0820eaeb01a01b9fda3a460debedde2240b928dfd265eba741f4639bc95be55265d00b94fa898bc9fd0d0a1b1acbf83af7f3a9a9f1ebfcd035af6b174a925a23e9448498ccbdbb24269ed10202b35b77147423253386b118dfad1470ef44f6b9207ff98b6897f87cce9011f700bd1cfec737f61d2788a0039e23087f01ab91e86153da416e70f15b8ec26d6397bea9b1a96bee72e451c1dbc67f007af4c507af6393fa4e59c7152fc4179c1e7a99c28f847c9872945bcc96d5e343c5d5f37ea8405baa04fed4522571bf6bb7726193f02ca0aec27444c59286708540d097133ec01c67283d4f9eccec5e1bc9ea12d34cb736403967f2ea250ec5c3b8bca7d768c1643c8691b0690b6024738d60ded7a1d2ad8223f8e892b98405e108c695b7c7e2b1c22ac42f6457bc97628ffe0ad7e607352e6cfc2e49ab0644988b6e48e65a888576a474dddad21cd56b5cbbefec91c26e571ea5626ed3b32b784c6ab851e6ad9e7222c8dd5adc1280a6896fd4b8cab144b50f54773682df7e53e66d623b0e2f136b84f20d83c73d4069cde8189591e994255106a4438e5e2bfa39d500860197c8f4893990049b4b62074c7df4f41ae23904d82aa993b5aa4c9f12307ad7c927db6bcfa6f140b36dbc705ae96bf22298d4a7a5c61fb133e594ca1d7664b04eac9124dd16c68b5f9d8a8cbae69e3f8808b64eed7929b94202c77df0b74ca99e5d18018c220711c7dc1bd82526f7092de183231ff6ce8980ef2e501886e332ab74a9a0bf825e6bcdd93b6566c0d418ca47fefdeb11edabb741ff84b55eb391dc10394a917b13a318e803c2b7996ab250eea0012e98cecc6c70e23972aa42b96d77d5fe856bd55d31e5f435d3b4679a89f4402cb8892e859f852a5a00f74fbbe8e7ee7e11fe57ee2eefd93dd6e236227271436f63efce1fecfa0c53f893d43ea614abf9b3cd76ccdd7db3ed7f92b1ce1b40fe1f3d75fe9dc945f2edf26f6411064f83e6e4d9ce1cd43ea70f28f541c2e7206384c1945fd3fd0f19b4f35cb9f1a040bbf9b12b31b73e3e25761c908de6f9b23212272e2fd0bc7a8b7021ea3e3d14a3340075e786a3dc357880d9edc2e2b6490785bccf62afd743746e47c04fc060cdf7aef9f390f66d80da5d14d9913a859c5fb849a4910295d13c4965bad1a75f489fd879ec6e5624c775487d7b3ced77748b357b6ab7476646aeabc6cc8ab44794b54aaf55301814433107d33a0c1133c0b6031c4c22540f52c8b1185b94ec974f49d0d21da5f61476a48f48c29939c22953a6342ad4509df01dabf39c6b8034540a55de7f8e8039d7481f5b4f668085895a5f5abc366d486da56a1e43cdd949f024ecaf222fa531c26c1475b2ca7ccf74dc1339f81b951e775aaa733a95d0332d42ab2dbd595289a7ecfcc8216fe73ca40fdd6c1556432c1ed060350337ba16e96b3fc64e159692259a564bdad629a0112df6799a4549396f2efa69858f1b045bae5e43db9f8cc2c15e25bc8bd92e740b21b54854c68fe8a4dda8943dd0dc3c9ce27d67c7c4cbb5cb9c0c8783492fa548f22feee73eb268c48df603fdac64c294242e03ddb13590ff8c5c9d3d8e241d8d1176c14eec291d1a33b91558f4c7738558962dd36af93d0ab067db111bcb9bcdd5719c73a277e62c8b463e2460f58f3856884ba90475bd9dc1453a28cc47d3688f739c768ce1eb6cbb3031cf9d82c520cb84cee57fd94985f68aa4519739d3d426c03fada23f11345356563bad168708fab8c84631d91c38305c1de9656d0df9e17e31c204b6056f4f237df2e71b167a2c57f34e3a2328e7a79be28b550a595d3e2264b0f88c7aae456cd13eb31ea377f1edfc16fe78e2fdb13e91bae455a38b1fca01859079da7efad1694112421e4db1c957092dedcbefa32882e748867acd6a4013b7faf273327ab3a2d4a8cf2ef704fb52f96e731aa9ab95cbf9221601997fcd2145dd12954000f6d2a33bc799156272407a7b2aab6e43956a98ef53f1fd23418c06cfe403657ef83c214db8bb835651235e38ab2df321b917d1bdfcc465b1a7a7e98c41f25e5355af5d390a009b27a2345cc7495ec4d5ad6fa1713ae12e978dfc645305ea89dbe1329528cc332fe5dc17ff1aa6a7b487deb9260c2655c68ba57341a150e9e6a9474fa8efcdd815b63291df46438027e96d2af182b60b982a5710eb28d266cc5714efc0e3841e07d3d29db49560582fefef91773e98b47e65a2b28ae30bd74cddb2d3791dda6d545b21c18311fd6518980e34d7784038fca145ad05bf5c6c734c2b67ad57419951ce53086e659ded0a7d3adfbd9e9d145ed35b15d2ec7b32301bc5481e8ae30134b507b80b82cfe51d9ce39bea28b0b19631de29a1e24d9714b281287a36e6c2b14d604b1f7d4fd7bccbefc20f59e15cb5502801ba4213176ac44bd5b2e375dfca093ad00446f6225fffd56bc06f7c83cda5d51396ff34e3c0843b12746e13536c7785238b53539845d7378585e086c521ff271e433719420b13c79bd0b48b49a245880ff995c4f85c3dcf39a968f099221a402a5b386c1d7ebbe9dc6d4c5be65c81b9faadc05ed79bc50cb54aed5aaa0be6b2b58efd82b3f0ab132fe68d8cb4885b5d0300831facadf91a585cdbf9694b05e275d114bd2a5c4209c576ce5beaa6c901eae9776bfd6976335356d47694ceddf535680250c2d79cfb9df188c3d54419efd5690bb614679467fc5c933576ee61dcde4252a6fc32c54d2da40a7f21d0fe60246565b6c1f2073422303aa6a4e9c6aeccb382ec28cb943334735e610680f201ab9e33b2815056fc322ab204ad66e960f516f0c5eb81ae328609984b849e54cf9227e03e65fc1b55a42da665151f6911d9a891fd76f180959acf2eca269c78359c665bd86b8a4f963d713770cc67c32bdf6d5cfe33d7d086de8cc8cbaa73a3296e97e3ce739b779bef529805a1ddafe65727232c5bd1ab272e7c02279c071a5f53f57465e71b680369e26a6b0503927025b017307da850d60b83c4fd2c933fe25e93d3e98fddddf8ff4d854ac67bd840f61ed493171e01accbbe100c3fe5963a136ee20aaf66d6f96d75aa56998808de02af8d2ab0869b1699a95cb5318b82833e0d930572fe116622c76556e4870544e71066db79773dcdef046a8270410f2956589181513484c64aaafcbbc3314f864f429a34828b14a395af6dd80963cd426a095ee9ee28827b5aff27742d2e7a398c30a4f895f0702452ba4716a77555d70bf79147ebbbd4592808138e0249e08ef810590535c97a7d8908093ca51b5f6f90df3c250d735d2df6f2ea05199e2153eb0bc7e3e602ac96474e759c0dae6b0c2f0276352a37f7d49804830a361ac29b5ac0e359abc284bd3f7131818d38e501cca2b01f8c48841f0309117065759fa7aeb8999e4614f8e733e69dcdeecd4aede57ff972cab4957266f06ae83d1a066d052e5c35f76802f1deca0628a75cdf26035d3544ccc62e6b1a9ce8b5f63832295f8da9769b3f25987adad086ff6cf42f985f90819d8567d3a9e36d9d3994bf7daa4077edb093a229ec11e213aeaa0c88e6eb7c67e5e57ebf75d80bd7aea150b08d0c129cdf8663fdb6efba27e36ea10025af6a746d66c40178e24af5896b7346c0fa1f03fc9037f06db42ab10019991d862563604ddec14d5842b10d7d688397e80b037ac56fdd5645b6db3a0f196ff8578cb7e41ac0a78cd750f41b0f81610119d72cc8125d672c61f365aef62f16597061118f640eddb5c8636f2b56b36ccac7ea1526cee78e6740ef6f7995a44a9af17bf942f5ff65b2c2d6c7ec9d7aec71166d6684ab4eaf186d5e4e97abdfe3808c9ceb2c0b7e1cc2583c35f961c09725b74272ee4b0e8fdec14c5c4bfaf55badbca2fdad540ccadd31bfb9f47a4e54876b8c9e4b863ad6ef75c2259b6d0a91d0412a92adbca792bf49bfe847026138048b0d18208bf51b4fdadac83458197a3f69cf1f34d183d93776b0d92f304a012fd93fa3fab324e8491bc34959cc92bb85c30971bf4a2a57728904712b1d1b9e06323d1d2a79192e9245e813e23205da217f6fb79665e3d462e1fd28c086bdca31ee9ccd7e167e0b43e4615e585fa2e0137f933a594afb660264170b272e2af5a24530023eb4d723381570c99d4aaa89b09110ed1215cad65b3428800acc392f67fc256e2fa6ed07560c8bede38394e52574c1a2120f90cfa407c49f5c77f001eb99207c5adee7df01c32ffc6af3f87955cd23800f90a317774c601911b00bbcb6499c9f116c22fb8b9d583cb3920ccb4094fd7a66f85c1dbdccc35bcfa55f12e73b6f1ae8c57472c001643b32b45813cfe5b08e93897e8b3796a8e77f43aaa1a579d9c5027a07a248a1b0c1e242e504823c52b46e3b7ea54710800f6a3af08b10325958dac94a5c62d44f7de41650dd43cd80841fbc8dc4d0966a1efa202541790dd6a32cdcce7db2e11bedbef1a4d7bad8e77ca5c6e225bae0255351688b30a380f3118502b17c0d5f1df265ff838c395c7fcf75c45f2a6c066f10728ea05f62dbc1896d1056030e66a8de12ccb3d8ac6524997777ac770ca3fa5599f3f55064f16da5acbb25dce3e85005ebc18df2c88c049d7ec81440a82dbdc28a9faf4edd63e35c6a191182f0dcbe71d8aeffee452e96a35a2a535ab1b84168ee5fac98e26a86b7bcdbc2e872f129e208951274e0bc6ca9f68c34fd38daedbffb3772a1db9bb17d3a311b10901679678f9c5800aded3831e11c207b814ba79e3177399622eefdf296c5e917032fcfd46852a8597a2a9264d2982728decf15d55184cf0f44a6a399df4a367546529bc0dec59473f4d3f09db95edf3b76d0b65968f82575706babe1629dea8fac6d853fe2914c184e25584b168c5eff296bacd19aa7e92e625eedae9c0e24a66f3e8f6a5104fedb2fb972c399a07188abcf310a8d722517b95b405a810f8384d64d9d72e0fece6a43a42d08634f6c09134c857602a3aa4798eb32efdc1983ddd26e3bd054449466fd1dfe5630cedcad9c29a78e74c79f0e924cebe0b57c4bed5bf2bcd5a70907ada38a6a74a6704fdc264cee6e0078d60a4c05970a4a10c38c5ef79fce7dc54238da474b846811766fd58ea5dc1a973c4efe103afa03d47f68846970ca4c1720fab0b15da5b37117296ef82cec869b3230502be613058fd19dd5d6bafc20dbd0fc534321d4754c8a5da7f1f2b5294278e9eeb9854fa005ff08dda8bed637b3f7c84c4b3cb1c1fff69d59c0fb9654e9b73c88386f8b69a8c89354277618b60d9a13f46bda2ede51f0b62f698c4b43ecc9e894169fc559bc62decf3061cf56e0451d0afebd10ddf84346dd821c79d2c3b701699cbfe26e4d865ef3f8a5dfe55834ee9453d985298dcca4824a9b19fb47408c9cb12788eb8e5d7949da864226a0b7e79fdf9c91ebdd8e88225a33f3cd5874a26faf8155ed03f49fc83e79c8e62748f768314785989937153f38add86f6bba65d0d2983f1961ec40be0dabbeed81eb10b722bedb7fb269f8a2a3a60fbd846bd82c8de0c68d4377713e68bbe296c22db1699b0734626a61bc5e7d486ab140558f514544c9a3eb9befcdc062805bb2a40d492cb3bf011a6257be5a2a0f90c8d228cf2fc444142c286cc51a5eec0cb0e3bae4fd7a993f0306441664c54ac237ce83cccf95dd6e66246091d72b704d6b215c03f0c3fb51a33da1ab7172544be6e59f79c3b13afa7b1b75713a409f2f4a8bc7a1a4aa7546b339b2627c35b75ba443d1b1a4d52c755c12a7206f4966eaa86b36ebab5deaba084322e4ba3beb6a1fe49cc4cec8b3791e67973b7f7c926b6b009e71aa5a697e2bc6f17e271659c7207974f8902c9f360808c5bfceb599b66fddd988735ce9b78705020e6fc18c8a350a5ee00ddace4ce2ed52c1239ea2cf20427a5e865de2cd4fa9a5519e417a6f11a75b92301b26c10d5315e0ab4fef81271c2d1c244bb21fe957f4700a28963ebe1102788f31e950087ac9c34892f98917f3df4a5954cb7b7ab0d7c9d47befdd3d0db12d4b26b3943a93f9e47f1f9ef92b51827a25c7b89a5efe6c95c1d821efe9c162df5c099cc37d9bf97da8ae052081246c19387a1c0e77032015716647708b6428bfd9dda5879de4830cedc6a24f0d4c1fc506b68488029254f296c8f5bb51068fd3ee4014f50f2247dbed079b19726edf7adda5be4a6fb104e651c676d8ef2d063142fd78e1c5293708e439893b9541177f3cc5e541478d613bc9cd9ec5985ff2221da4ee8a375626e0a0a3dcada463002efcc95031f8361c38fa560c314ac43bffae097e72b6314c9b7c9b444a2a4bd282d7aa7cc81e91031449e5f688098ced12b630fcadb93165b77dadc24ed905ad6159a0e98f39156aed83806eae9ecf5efd5c8f9e0ab21f63c54093b66c44acb34db114e02d7d68af500a1113d5aad7a79fbd4891c042c55dce027d32e0838b292b50cb89053871fc7f12b34ab4d292fe5d86d6a31ee6b36af021b5fa4645462d95b27fd786a11efa8a753bedd4dc1c62f463ee608d48a491898a0187dfb3168681d189acb6e963e9293f80bf26e82c247be64c0958ecbb49f3283e21298dc97ddf9c579430e650d19690d3ca03bfc2a86b8227a07f320a84ed652d7616206598ea7797d3602bcc27addfc2b7a3e132683eb1393a733946b5e01ccfe81b2905fcde48b41789bbb591760a048a536681f80c7099a122186b069a619ddc753ee47cbfe3746fb2501856b5cbd4a9355764d87b1561677245c7da535a51166154205db26ae76568bdb42d7deb08c4dc2e7b87d9c50d8f7a0fa8751f38e731d5f3a8452b7ac9fe9146f43f9f841da7a42925e755a4a065d3e863ed74c25f304c7100b1f4c42734df7f0206e1d4975102a5462627e05a75b6ee6af47822e69a64c5dc2bf5db0e3a942b69104edc7203e63e436f9376f4c8263125dcfe71990d56aee8c37df1f915fa540e14863c4d12caaa6c033edb38427c9c0adbd9cd7e40bf8754b7348265e98fd6dfbe364d4f7181615d514ae85ea16cb438005ee059024a55f026694bd8e5d37a4735ea774e8c87b6452f65cf4c3afc4b9e30688d796d995fa31d4d6c381919f0e778a2c5b4a4335369798222fef7efac92c7c0ea2c196ab9273a5bc95661c116ec44f86a05f90b6f24a6e126d58facd5435774d897062f1c584c78cff4f6de7f662557c6a8799336576cc2dbaf6184887edd81a14ce76710a5d2530adc335ba3dd5317d7be097492fee04a67763168181fe6b595295dc238965d920f2132bbfe6ede446e4a16c66c246a51bcc4b286b38af829aa98920eda7e7dcc793cf1509412dd5b06f3673d3093198abbbad4664e80b348b15a1543cede4889cdfc8369b0738c4dde30db6f56c973fd711e6b1432cbf926093cf85b587f212d0fe4ccf050a9d33d3216613973b24c4ba72dfba91211a14fee7dbf80bb4e139f20f7ca5c6b2f92a73bb63f2da9d2b1acbea0eafb1986b65a361df6d2f23b962ae5b76ce6a924d96ff2f503b4a354444640b982fbdf3b5f019a4cb19b5de4d209648635089027d237b3a8565dc025dfb3fa558a9a59fae4b837857ca0df3d414d9e037137ef004fd67e546132c77854a38faea095bd81772afcced742b6cd45997f74e77c3a8276e73291fe28003253d9843f91467ab2625749566d4a5e1546ab8508c94be88b8bdc5c1896c21221550de4a8ba728b61146d39ff749de2278dd8e759d36b25bbaef386d12bf4293a99ebb34b1d32b37f4129cd8654f8207df508f82dffca9c72626c28a569ac6f00cd8c974d110c6e664c702fd211776b1c1c70500f7054edd7c5e0bf09ea5bfc4b474c6a7246a530418da4b728dbb9e4d938056c74d9ba1aa6a30908b9da9187b6940d6b0968e2762802c6fabcb807d04cdaedf4997c5a22a3a2b4c7942abe6bea9dec341d5a70b1c313864f9496af654a1541158730656b1cf3b21f51b9b495633c6f7c14b0abf711491c1a3efeb8c7dd294777e430211d7f0937be928428f2e134fa3d9b2a4257f3cc3f2cdc8a7c57f7ad4246808ef02233099e4cc4067ded9be562fe74e94055849f969069efc29ba8d361a908f564108f05fffd81c2eb6b106ba6f097fdcac992492d28b08c34f6281a7d7184de6e02d3808d3b62b63eca7e1fd2fa5053eb1d2592f851e776fdea9043b02fa0a68da66246c9d1eb14478f64c14972f58b4ea1d4bc6dd3da4b2e9226fd4e863e38b8e2ddc74cff6dcf4a22a09bef73c37827c502e887e03b89f5eac0a37d8ad2ec7d12e9e1d75c0918eaf8783a5a7b6b3f4c1abd8d87485eae28b638ae79bcd47564bc5f71ed899a59b88b599bb696d4202db0fdfc0e8ae691d3a7010483740679ceed1a11e72c8f7fec2fc13eaa58a4179f3ed2d4d7f95616dae2e7e3efd9cfac2e7305ab5397eea88355b1f025061659477c3a7929908e2709ff6537bffc5f922c90ceb7b22af76a7cd50e15df04e0e3f66fc6d5cc48577b5b8e5d4b47d9296ad85f9d8b56a56288911c7d7a08ca0295971fe596b8090d11f64f425a6b0f8e89d8c949edba2f3407c30282a5b675b49928ea8f52a2565dab931bfb9bc92f3937e0d7921c44c50d55e1afd47aacefadb42ef1ddb954617256254dfa70625397d9f0ede82f3d1949160616ce7d8de472a14664a9f3644073a701b4b929b5ec7ca411794cf2afc29a55d9f38517ad88a364b603171f0efae698bfee2c43c36252a681938dc5359a0fa068abdab6da07711c3bb4357614ae35b5803055cce3f19c1b07a493fdca4a8833c41b008c87a52027d3f850b39459c051f5b7b3a00e194b473e941c25c2f62eddc18044e8a0547d2308236600f02315c5cfb63e7fe16ac33351ddc566630067e33f3eadad192587a0fabba307d50e0b7db23c0c1e0878e594a933e332253b787261ca6eb11c12e06965a963fe69ed5c13a3775e9cba60adbd687cdf81109eb866b03993c1ac8494b6db109d55bf28f79ca937c7d460ffbfb1967d0ba7c5c64f6604fad53f00b70cb9bf23d1f2ab5ab2e9dd855153cc1ed25d45da1775348fe1e9086c941786626ac0eb494870796bdd36cba4910a447c407fbbc7dc60bc8419961c43662766eb7db017d66b2d5a04f68021f3ecaa3da194a86d5210537ce3798ee6279c566bd0b57b32e90b52503fc9d88c3804ac9fcc4dc83804c0339e5fdcb1b8d19b13892d952f333bb60fb1332fa1350680ee3520d7598c740bf9330dfeaa5ba30146fd27c18fecf036a3c14d79ba1647ab7016b2bb2acdc54ebef562a0848a4423786cc19c9a8dfec5aa3eacbe9a305ea0357e5e97e56e93a83914616eb56507dee32693d24dcdacafb1383d0267d0ce2c6fa7f931435ca52ed662e001e451f858ec3c6ea7439737bdddf7db0e22909a8e9e34779babee7198b87b64cb03593595bbead0c8aad9170c6a9447768b945f666eada0c38acddea371f904d83aa074db7668a9628509ae1d3c2e9bd914c0c1e03ac4e20c2d409ff6c553b4266d6a4ab33e34ab0621c32b10b61fa1f10eefca946eae61e714c17ddad295ddfd4cb0b8f86f1d920cc59d5026f8ad3030b6529723024c4762a381315979e796cef6613344bb0bad6b34b677bb96a11fed7f8d501e0cf12c34aef67ce72fd9a478528aa61bd71468f55785af837eeaea55b4ae3681feb689bef6497c23b71e750ff79232e0cad6df4b708a8684bec23fa79824109bf928d90442d881a57ee2c0ee9e17ab19e781790b8ab69a5a378e3a10f0f7b09ee39412740565f70f99d7b770a4fd9c0206d937ccd63f0d6429aa148009706a0b6e49a1cb892edc836494e4fa10fb90d562ec9c634f0fc14c5db3c0cb37c5547d25b29fdc7a9a0c935245b5d5042b45893d5c0165e5800981835f10a414ba312eccb05ae26d00e8fbd00684cabe6d1dd5888e860e6970f7ee9f085cb625bee23986a9cfad6f7856ca516c95479c1d4c007ea372f16c05850d0fc211c7ca347d25425ca6ef6b96f884b292ff63eef85e63ae0f17d08cb111480c4411f257c4126d6c5d93e336498e765ad1eecfc77eca196ae2b98311d82dd2648dcd27b15ac6ac79219ef29f14d051ca40d74f03d9712de83100bad289811c01b91ed7a9118aebdcf316f79a592c78ee1cd987645f1fe80a958e503d7f64f58e3b9ae70e4ef3684ee3e341dd1a1a31b004247b54c41211d2adcfa6912abd90118a49fbe20a7a6e9388d637cd796e7f2581d1fdf6f2a541ce92eb7ca45aaa1d55fe8a2a50fa4d06d1c385841aa0d917afccecd57650f84d926c04c364ad62d330d276c8782a70139748e5f9d9e79dc78a6dcfaf9a6459a0ce0d16be5a850cda75073188c25bb8d3bd6e37360dcdf74f6312dd451c3ab6e59a8bcc1f9cb782cec5fd622a534b1edc6c44d0b08a667e9b19d121559e997db61447bcca532f18ef09cedcd6908591407cc2e62f67ed1d6b9233a2fb7bed38d143adbc47dbef7912b8af3979e714cc95a6c34373583960ba8f36fa0e6b3891e9ccbf485876dedaa71a9e1ee26f21569e9e465360881a9a5c81635c5fa5c9f429df8de4303c3697f28e51252bb77e37df03aac69590d3a2b9701a24f60176db4d0ed86227a02ac9ce4a2b4e50cc71e4d0a3adf2540985973c8931136a925b4afc2799df72cde1193a252528147cf5f36870cbb6b9885dad4fccde82f19d019ecaf8d0b38dd1d90fafd71f50035eb407d618466b9fe1966d76165d39e04b76f6aa74b8486fbb92bc37579d0e721fd26acc29d099936db141fcde17d5373ce17fee65be60ec985c493049ebdc843f1b9de5d5a04a4b350af99ce8625f22e004784197cbf69dd4112c2a3c506aa9a1d86f7973a4597d5415d4b12cc9bbe90c119a355cc91cbcb046e0baf5792cd07da3b302e5ed7a48521561244a441703a1e8460e03ba30150e59a53d5f1447b6845d3d7259e110b13c5d0df27d251c49291877a9a2ca7d4c328cc9a5ac868fcd2a8e219e1068418cf8b9e6f172194d62445dc76f57a245c8aa9745ac6e218a21f2986cc9fc66a0b7143b584be216e89de78ea28875ef178040d32825f67a3fdf44f4a4dea78f047f32f8a17973318da8dafa0d792ef23ef00b15c6b850f03692db3b118003bcbdc63f305a3d18dce68cc8caf43416f66773eeef8ac68f396f9ec15b93dd6e72893b1bdc80435997cfd6da12f9cdd188003bef747eb3901e06ecf3caab3fe3c712a86f5f258950c9cdbfbeb0ea325ccd46607b8f71d3f5baa968ecd3a90f3ecf2f0e8d2a668c5e2d65d6889b1ae6ef9670dbabf18ccfa255760490d2dfdb5f9ed7de2fd00542605217a1583cf1c12aa5f067c6aee0425efcc1865cded2fa2d73934b881a169e09e0bc6a3369643e3c50055c12587927d9d14838082722c8eabba631fae284c8b6443c469b808c68d5e66d4ce4a2145e40a8b1c77b6c8682e077523ef893de16a4250151a8e74de1fa27dbdfcdda5579850423e34a9fdd298a6967a5c52ff28899e2b270bd05b1083a49c461a25579863b9bf0338fbb2b438021d89cb30d52c23e6006da41a5b4a43330f4c2d4edc4c05e3ed974bfd544bbaccc4c90d4a82590713409b785a49602982dcf465fa5f554984881c44cb8388c4466c1bc001b056ad3e155b35c7741cc321df4b77b4edfc0e2bd934f40aaed60574487dd6e7abd6ccce40f1baa4caf8d0746633ec4c022a2ae7b05e5502742c1598a9f73b5d5e674be8af4fca89f444bf4fdfa274a18cf4a8f81266f7faa56bdb6b0d412a209842a8b40504b869772bee4142df037c3ccf5e5f9acbf08bccc7a13ad831cc91edebb440d225fa43f3998b8a3977306ac406f3c8b0aee39a3df9343ff073d7010219e0aab80d3836378df3e99f7bf87e583ef9a3bc516b7d90d2122947d7c18fc0ce26196533b16197b737db1af6b59052b5d8c92f01fe6015054b0de5087d47e0f7b24f7d96ee5a909979c87de0d1b344dcae65dcd5c844de54a8a6f378d6070a39810c9a1807ff0135b82cca59f4295a2ef0631abae15c9ead643f93af9123408165c5b07160c40f355203440216b671ade257bbe8de600216cf445ba03a79ff1139a539868daec3f2339c00fade9e43a66382d296fc3d23f627904e82baa60997a71d6d99333d0f91c119cacacfbea8db8ec16c6de6e843a827a6c7d12e98db529b4f9680bfac2e38e382a8531036d63344fbd6c0737da7945e0ca83da646790e824f832e93834cced2130c1b96a03d6113cc2197f240d0d086784b8a95acb7e2446bb88ec4ab499c903f5725075aaee015e2afa69416db0f7212e260c4f9be0706b196f93b2194caf217c8a1d3a10a5a931d969df22090229f2ae4e93ed33decc8502809b197ccfe7ac82873f1d99ec4a70c03e955a4586dce42fc77211206facfe93bc26e96ffaaecbf1982f203f9e6c8fa5a8f95e6c505e827d6979c50008c1baa84c6b68539af4b2e36012b709dbc3a954e9db802f6ca1ec35eb18051b1819d15f3090d3b15c96e430bbab0d8c3630206fd2a20b2a64b91caec02eb8d2ca4339753df77593da6d36c196980d2de8b77070bd82cffb5b128f242779531c71fa2f830a739f772117453095c2ab5fc5fd79638dfee14ed809f0583e7e8a45fbf5c085463a0772b77a3e62629f16aff9422a592b079ce89de54e8416709b92730e12beccdf1bb6c6ba90a6b1a6a93e22c3f808253102f640005b5e754b49b3d43421911965eeec7ddb2b640befd1fa84cb3c522e00e5166694024177c669152aeaeebdab587218a59c7bdb3f5a9d4e6a476f2deb06e48409013f5eb00a16f4a83269cc760e10d1b0dc30824dc3050e452ba53287efd1db5a6fe4d0bd904587379f509e68700a4f3857479739672471fcd58ae39ae8615440e4cd2f407c6246f9bd1ea703d5179de6ab0cbc70807e6e476a413e983722e5c9919d103036e42500fa618b2bd3687ae38e283f84a65fdee41db78deb5b3fdd5afa830827a0b4adf6ef37d1980148880989a3b1611a3da863c72cd866df56e86d1715ee0b14b33a6e330d6b6041b66b7292300ce4bc0ba7ef1f755a2d23a48d5f9b27f729f6c3740324553f5ae6fb1f71d45170b1d992644d7567d1613aa078788fe7a6cd65f9b256b93ed6cccbf8abc1c3ad697834d1fa05be0cdc0583bc5bfb6e8b9ab8742f96306ae9cb4f62b4925fb479564e5c0cc698ee6ecd2235c01416d272bcd7a45262f017c67b9bfa84358f7afd8ce955acd3032b7c7ebdd1ec2ab4796a268adc8215282a472049a43c92c3155197d7888d9cbef2dd132961788847a1bb11277b1e48c2d3e58385b4caccdc5b82f15f17f4e49ed8491281d53a0f003e8d0c8a45d15fca4754de71010ebedaa3fe1bf85319c4598f7b3b65ee390ae05e23f4657d09da3790e8b822d80bbbaace5cae8f86bdf7b0d18daec6c70767763d43e58c3788a1ddcb523ffbd8baedd1439fb3f844f5762637b5dfbb0bfdc348cf5531229c6c84e9acefd3a3590c5b1e5c52e8060c6540e96b874ce0e07d10d3a15dfcaebe5e954348754015ac9f1c80ef81674f5591508b28e04c96b384044d24ee6a99d4d263774c6584eadd947a85d9db1c291b514c51cf26bcb0a34ca93fa37a92d79bc604acb1b884eec674f803ad74468cda5b99dda00c7c6fa7dc324fc56d852b08a0ca832d475a8525830708daf566ecbbc9678d4f6ff3a76fc1bc9cf31649170af33156128e3e25709685da70f8d9f901e4af2d977ba7088fba8eae398120072886aa6ab93557f8f9b9f09d68db536229da145c140372bb1a71f11fafec4f0e8e4a4f4cde0b12c88da795cfd8b84465266b4e9f10f2d1fb52b84a37c35f7618d61278bdcfed175cf39f8618dc175f0823f9b0b3b80f2a252b07dac08917dda69f63d72f9e27fc0ae7e9f429a28227337929318a0b369a6769a26e25cfbbdddea6b4556de219b1a545227e61a3d9679eed9a1d5fd19c5af4e645954571f9695b1d0ba3b4b690042b210f4f059fe24c6d2401df7c9eb052da2a072c39bb3d144c67409bb5942488be1b3f89d54e5b678b49221777dfdf747bd0c2c440dfc358c5e391e7b6e31be97a2d368e84d1127628fdb270faa701c7a19096bd115f7022ac9642302938bd3218d6bbaf0c7bac7a38cd11e6a874f6365bdf9f5c4b83346bb9b7d190a8b762678cdecbdbc1f26ba5b08efb11c543b0f65b2ca009777a3d9878f61deb63baa18f53a1092b5fea29b569b8677b5ea7f6c0da01d72921130faf4bc690870ac8983bd336169c11479324f6344ecd195b1a4d4e6f5790240a81860ad5a427293eeaa9a07c1fa4562d21224b8fc598635ca8db3892e7443a1626f79fe9cecc84a6a91baf3efa794ff87f418113aefde8fe7cd4629218076044b794a253642f11c39556c233348f7012324571442038dcd0e82358bdf942ed76e087b96aefb18057285021fc53b308d5b2bc9796060d30c6bb550662e077eeaa8ec106f5a4b042f2348b602129694b477c246ac22dda9e6e8f95919c8ccdfbf014124d550485a76902287c95e88cd590a205391013e31595869b5e7f11fdf775ca19a5b941e38b00786c3d23f2cee475f1e7b3d123300617b819788ca65140cd60aa2c0f37ae0449ddfa8a3b9ae2dd7a865a894adeaec3b6cad11035c86afc7e1f700f2cd3a4d812d0e46d19da5fb2ec5d1f1abb2ce33c538d4e979e56e573c77f8f740f5303bb55d52d1259730ab8ca5ee83584734b8f7ea791c29ef0be565560da3c145be13048be499ca70814c3f575201c8b9d20b6c22cce77a8e9c20cd1deaa5b4f37f09f1854ad8fe46316476a6008d039a25e36e6fa87e442abe7ef0d5c8be3d77038378cc0a825ad3c95b70f515e8ad83cc2927d1ec71ac5778f61d51e89af51fc0f61efa7646f05238e98c0fa0dd762eee01f7d8d70043c33286f0f0395306b06a29dec09771460cf2d90bfd22769aadf613e079e3477a7c421206df89026dd224d5000f3b33a2962efd34e7b0f630f1e1683331f90bd0e03fc53498539d90607590aea9e6f1e7629a31fd2743e48c9d0927efc44e6eedba7365401b5f7f40db72da6778580e4a8a702984d7bd6afb9c7920efad15b361bf07a19acd87aebbf8aad1ba6f863aa951f487b51888ac81f10a6b38a5f499955ed9f2e0f0ee87fbdb8c65ea94d9fc719c2c5f302ee5dbf886490daf97e1aba5256b8643392ebb854ef44ef2185a6cc14386708cf96095c0ad2551f4fdd0c297bde0aa173a9e9964cec6361ca8bfb349720bf82aeaf522281810e4a5eca82443c0045d3c96d2caeb912252bf42218e6f8edce86bc6eb297347d1373f9f8a04c3f80aab41a31b997f77085693e6baf9e3f2738a6b9793845bcecf0298c7cfec7c0ff8cc76feff77d704f202e5a7326f88be0b687f4e042b9f544ec10cdd1470f21fdf0c035dc767085e2711a7aeb8bc4c2e1e26b40de6a3c102e155711c371b3c9bff16f6b8adc467df8d48bef21243233253fbe5fdbab084d36d4fae0d49e2abb03d60e9d0501125573d055ec6f2d3eaabd4f1030f7cf0fbe83e1e5de7935fc288797eb38aab50ec18ec5ba6d85bf73f258e150906bc9b8ea1c47cd250973738f43d9f0d9647de8b704990a3d94f42094a6988b1ddc3f1a783bfc87cb61aa3294b61e9c7076b6bbbbc3a50ae314b4ee14c58c7a8cd6274993f9ab9a889c31a16225dbb68861b67c43c4baf9bd1f8550aafccf28244877fce832fa355df79bb4eead3df117072c4b92571a762f2fe37ed13404508bb07617d36ab483874ef624a515350d84d90385b8b4e8fdf8fac630f1a2079e98ff44570571701917dbecc9b84fb8f651641a2e47d5f247590c40af98508e16e8cdd212d58a51f7abe6b222257c56b5ca34c827d47f11f444ea98718ab8d8eb382c0793e3aa58d8f7461857b2eace78a7c3a1b6796c737ec8f0d93982a0883bf1d648867cbb050807c83db849804406ce5fcd1eec86f4e3794c5771fae70eac4f6493fdb65447a5bb4277236bf988dfe30db5f464a7188c1eb2e060c35ce010bb6253647c2823c03a5db1e0dd30e28a821dff303054c14a0ac0aa8292dbe28820e541de49d48f5b12034fcaf5ae00b69cea15ceb902a67ca162389433ab1a24c2e6e916bad66ec2b2b9780b31bedfdd9795a9ff069a306780d900c66f3242f44fbac609e321dd5796b0c806ffda1c67d88dc4872e051db73963b1b037f2fdeb4665ae7041b821a8c0756841efd3a4c7684e840d6a94c9a64f80cda8be271c14bd8a05796a0f7d81ea5ed2a9d72ad7e18f099a32cf8a23b98f7d6e36d1037069a7a4aee204d3f1741cad6c0d5dbc7a6b0f2f6c2a41a5e087385123a69cbb5f8c69dfda764446555c7faa20abdfcfa2b055573e1ae1a3dd7504898ccae71918af171e3ba39417ccc4d06e26e15367f16f64d17b26e0331c2b0e97bb0540760b39198bbcbd986f32c9d0629fae927d4e2d7f686120a7df6b35c5a220a5713d094a0146a509833eae5b91416d5d86c25b9039df29074e45e786ac84c6db7a13d6ab123cfc38d43bd6fe05e5389e9ec5d0309d875b788c196ce5452e6d326d94725e6b18114bb1c1fbfcca113b4b9c50b728ce43d68270cd31489e1be175a06a2b67dcb011bc67ffcc22a172a97f5b722b37b08b05c523f45fc9bf5135847b67641bd96da6f140d2d90391786938225a91b0ae8e69f3f4cc20d7975a29734697973f89ebeae0f7f19f57b1706adf952ebdc443e36b7fe2308e29b3b98bfce1a51ac9f0eff76595d53ea88833f1eaf557cbf65b7317b8f8b7b1f40b13a349779c9e2c1f5af81d5051a5a1e7b2ab91dbde2d3b89f5cef4c3a5b573108bf6960dbf33081d7e9f7e07b0f324f1a65e042271b17cd36906677fe4b4c3d4f4047b233797ce5c5fae621388fff1f7978e43237deb86291817271b7b50d6aab2661f24da6cb258e80dc522321cf3372659c5573f5457b9ff9a733b7d87e1852ad2196ef80b5146dd37ef303c0f76cf7a31c2dc9f68ddf4e5c4307717ddfa9167cdf957a527fda2ed5af5eb88b21f586c9313f76ae9d75e5e7a97a8f591bbddefcdb47edd9f6d6fb89778b2fea88e09d976677c2c902a7ea988559859ff93dc303b0b50d7bb2bfc463ffcd839a02816debf9b545c51ae222e1a273ab64aa8e556f0f689457e374a457d7a21843e72e09cef0ed95d537a32225b116ed1fbf5e17a6e41b5130134c4e8909ecd7595e3cda17a8868080356a0809735b2fd054c6162b0bb9504e91fe40d3f509c8ebc76417c6b0a9f04c983f52a0212bdb68cff8cb50624c71851c80f9c03bb6c15207a906e7a76bb0e63ba79cc5b5acd86153dd527006ffde2be5a4c722a68215b7836251906c69a4dfd09f44b4d7c48ea73163a42f4eca8cfde0364f3c4d6c4dd1b9df025ab517b4e472ba56ed35516fcb876e861f5ebde9e2bf12e0fcd809d5672ce92ab072791ae618c3446d9aae8541cc2317d866589f5851563d87e6e028fedfe19ffba36340d879719ff4f40347c23dc23a2fb216690e3ce73fabcefb0fff41d99075bc420aa96ad1b3b837d55e1105ddf919765388b5307d5af904b12bc1ec423d2d05df22e8cc44acc70d68d77ca06e14ca421a40c7a56adc0b5ac72011c1caa3b5222433a0b37d25c84242e65eddf3bab2d88112e7dc67610aacb06bb026395da09cf5316c528a17f03f8649222c7a12b4da8fe976929efb6f5e94ba9f1c7f27969014588a9ea0259e3e9310b61d458313a5ec09e7d9ca40691f8172da651aff2d9ba15ac9aac0144d8f81708f6d20ec12d9f6cfc5ba6fbf51529dc90ac8855d0710a327dc7df0aa101b03c1736babbd80f37158d5ef9cd2908927ab2a805b306fc69086740b94cc9fd80b18868747b3e5a76c04584338f37a1ea4863fd0193b3b768a813d35cb3d39f399b73d61c09c8971d8fd5cca864f3f79d27462ad2f12fc5e60d00428abd0e44a6aa4613fc78814a91ae6a40b332476ae7cd403cde372e07c4ea1fde0b1053d71de90bfd00cd6a514dab9466d2455fc5231e2955b7dcbe869ef75b2e148d8b1e734a6d58ae9818aa5d7414fb208e3c1b43386ae4d1ca770fee504b64a500460e70cd3e6625a5b7d288eda79defcd018857d0c7dc2ca58af1e88b36dfc50125faa292e73a95c7d54a425d17efa46ebac8b35fdcc9f19dceb8a6303dafc9e456ce13a3ad7e71c90c156c5dc3614f3557dc9e5ec6e187186ab97b9132345aacbf61200432db11d1dff8d919589289e1d9658ed25a68119c9b7e80e821e6b6bb5839e7b6919a134a9dcd054b4a955c8c576003e525668bacefa4eb6183cbe328fc060f56613099e60ca504f7f851c850875a6abe2e6ae0fd7658a6d3c632be9c960f8550cf2473069fc73e17069cee7c394a17f984e7a27a2083da371c4ee726f42e5558b87ac9bcd8b1e7caa9ace7ff5b97b1fd397ad01d3b461ab9a2f21db94384746268633f1580deb28e967a96c0269d4cac4f88517f26d16e4c6d6cc297d7932864da6ac77e40fbbe23d6f4f340597eb676b7fd78d4fc30d7b62773b434e47deef13906a90ab7242dfb142bde589555caffd0b0372c5b3374b980a318e0ee6e439885eac65f210e6b6090f3690f9d22445a32d3a4a0aa3aae4448e92b2c7217a1627b8ce3e53016252e7e733e7e35a77d5f488f0886202ef3dba3fd5cb4fd877f3fc0236656ba3c36b1a5983fdd203d50847d526b86479470d6d106d20d6cab5377b12f976e033508e7c6b392523a640a392ea7fdc6a126bb6bd6b6d7b9a8a24ec0ef032af91ed0cbad71c5c367dd9de4ddd80e79f0e9e3319730b03a4058f59ede2c57fb6c9f3fc4a492ec79386e55dd8e11ea37e63957e0c96b874a01f5e36edc0b2a7e3b27f5232447d8d92afa71613677521d83be9059edc297020aadeb245641201fb420ec0fc8e8097f4333c214b74bfc340ff3a56a1af780271151f79cd78c8d67df92a66e058b28f943fe4cf75eb5374d952332e37b47dd78a99e22671d838f223ef4505e5c3b51f122a93b8733cb3250aa1cf262a63967d203fe4471002b3d9941f494fa96e1c3b2e054450ae685303f0c4282d9fb4a1bbd559e8e9cd055eea65572aad2f5109bbd9347e52df93faa2b780bc8fb59b7ef1761be80f0d04c6c9058ae4ac4c35b49c1dab1c134b722dd63ef4d7eaf4c3c49f93624f007cf5e0bf7c1239c1a96b9acb3b0660d835fe19c2c51476e3695e52d2bd4ee6911dc7a390540356839d3d202042f14525a8057bf19f82d37c961665c6e7f3ebd202c208c773a10c32609e5fdcadfdc08b858f51d0dd072907c0d6a6f9eb39b8622cbcead4e4c878b7386edc7127f5e74a62c9aaae64b79b77a6c08cce99086c8667eaa88a2d442300d2f0d1cd97cc07c2f9d366c0fe2bd5f525392d567105c155bb58145fe89eb3fa4e100b434b8623b0bf4015661b2194ef6f79a702a3a8b97751e80ca43030d7e3fe1fda27b4c1a8bbb68b21cc9f13a22344e1b4fa4099e35ed3052ae7a8d655d535f364c17bbdabadb17c1e199805d6b843005227f2d13e0e2b6c66d417619e9a29db040ff0bce1befd3eaae656c9da1e3b66d3b5815994323fa0248c9a1ca21e8107c7919356feb409b114c32e02273e789a8ea6b6fd16257fde07b0fe23430675285350f4e4fd83b28a6406706690deee29a0919a043f6ec32f2bc5748331b17de997bc6757144a2888123ea26f58ebedc4aaf08928bbb4ca498200a5563a447ab4df39fe8d61104f41f0050fd80209f8f504fc467d1bd8395b14ba6d846b4f83b9134cb314de81d9f5e99c85ee53e6ea5e32809bc84e28cb45fb84cf16aa6fd3ff949dad919e1b5f11dfaa684a5b59020802e4e8ee9338fa1f7a3451e098dd555d5dda804e3d5bf8391a506ddb03f8dc790ad6c94c8e184c4ddd25c75d322b14821886d1a07c9c5d53dfea918549ddf1c334bde7145d03dcb21eee73503036f3acb2fc9c45be9e1fcb13609d0c079d0cf494e4dbe825115668f8570d736e5fa86afef7fd09345c6386226d7e46f6b9fea61765ed192ebab54ada34b01949e6f47bcdd7634109c088650d97bd8422360678919536d078e2093f6ce9a9fe22b8da1fe87ce2b84dbd3e73492e1cf0fd70645b249c888bc9589eb94c0e0cc5c10f4b4d49390f444a1dee507469b1e1457e2f2a60cd7f85b6a4793b5e0b751c14ff762490282b6a58eb82ee971775078d9e9b905f75cb64d952ef57e57d72d952b04ea521377ea55ea832b56cd508a554bda7d1bcb9382809dff2547daa8812f8688c8c88fbbaa944b47ba9d44125b6ac10d86c027e73b531867c6bc3971dd08dc15eb0ea1b7f6e6c6b7c57d0a3eb173bb1a0b6579c1af464f881828b57e7c56507bbac7ac584fb04c4cdbc8b7d6c9df86cd316486499aa5c7e79aa190abc3ddc378a4000601aec20616ce0b36f6301ce9e2e32a8e59c7618597a659e8c25d75a1dab6bf0e97fdbfa0df6bc9230f789995aafd97881e8070f40a1fbaa2b707e54e0ccfc696a168baeaa1763589291f4609cb8c5c0bf5ba083e95b848fe79afcd57e17944383587dab02460e9471a5673e71886e18062a5bb425090560e1fd7ea9e4ee20f8b71b3e2031dbf464ce3771f3bb9b2c2d1a38cb48726b4f3223efe00ea9c073f913dc5e11bce79adf8cbecfcdd51c5c93aa2b0d66ef6f569145eacb49dfa12f7f76543efaa5248c1be25f9c465c49bf7c031acf65c53e38005422e4d92e3ffdf3503169eb3db9247d3e2db4c61fb314d24e8749286c935a951fe53b29c67e3936ceb4103179e7817c162a865291c450c3e1d1ff987014eeda1a62dc8449e1d68663aa7f2f6c5cf5263454296987c872287611f670995209f76d69b3558bc82a9fb2eea3087b27862915a8b564734c452f134f153b601a9b3ec90c331adcb23af66ce462369403492185e65f9e90bdf59b685a9430a13ccd310aa47dbfc6cf022f684286b80d11b1205611313c1be9d857315632c313ad82b4564774902b4e7d8c6d5a14430bf30f30ce3b6e3680c1e3e5d4707c5b1a3186761199506b1f9923b744a4b5ec26ce2ded17c1cb4629a0f3c6af7b96823b8112015af0700780344aae45d63eba6393d8760bd5b85506ff7a15d30f28c9f30682aaeb5d8e293cfe8ce9cac21758515ec8663f05b924a3f5f127b5c1015d7cf5a3044c060f20e497fab8037fff144ccc02995ea1f7657d1cfbcb95d06238f319e1d11b18257887f31c85ee6cb34aeef7cc9c0062d763dfa1aee85a5bf6d46fb9ec901d5b5e3f8f26c41a2bc67b751d4bbb543a28f80bd9883ec24439d4bf51efe39e62951d05a8404316cc7f93052290eaee74856c960567c7cbad74122052b4806ef7df88a72455a7e2565efb83b88724ce9727b567a3b2a919815ad3390e113ab76ae36017657ccda09bc294548aa0cab6b9c47b7214bb206c2b41b63e3007f3ef0bb5eafa2eb45e2c6c9d310fc3858fcfc418032340f909195eaed0f07af5afc2344471a3ddf9e2ee3035cc86bfe8abfa148a3fbcd28990c3710a628ea5b512a5c5ba4df9dd23b802ed14d2d44220b505cb11efaf44ac3a6f4ce6996f376502ff6da3a1c8443583da0350505fb79af4df4542dbd91b9ffe4d22456df58f5eb30bc06c83bf12e8cacca7dbe5c71c115ecc4101f51182394509f90956c8afaf469593fdca871618958208c2c528c7b3228313392b679863309fd5556fb5cee3807e3e403b3c20c653b30646d75bb132737d7a4c91e2358114850e3b9914c6b2e4eb2eaf15980398c3f57daac39db8c590bddcd9ea90f54d84be3754a696c0f29d39ac31b0246db511f22674c259815060955be327938fd54e5f1fc343fce74ddddbb57bf58dbc90fff6b316414965402cab7b4a976b0f6ac2f3bdb5c90599116a369b23cd205b902ed7cab4432db4b4b85a08d6153d80fcfb09414316380ff55b662ff8982f4c047593bd07f5d54abb9d27a759e80bcf8772e824d2bea8d5ef005074936d5614caede8270057b06f3170c5d3e358fe2c8309ad92dee12f5daaf4bdcef9593de89a881baee8e6cdb7ff2977da6a1641c8d63b75f011751de025b84fda9b679d35a914527303a958f4b08ba0af0aba09c17cb10611e6a2be3b127d382ba69ad8de229b7960bb4746634cc78fa40ef2801ed86f6975f1c1a3b8466aed9e426c85992544581a5f7a9e47c2dba4b6fb3cff2a384cd0d5c49b5dcd6825d9b8e7a82286255bd279bdd2cfa32654e7b393880595aafca38c9568c6fd5de0ddd4a533b2a7d474c9ca28ef1eae511b3d2b62e80c616704eb82e82acb4c90cbc4e3375d19e01aa35125af9daf8ec16e29cb3da74b69899152650e30e0a6114c40f33b1d7bd031e4d856c28af0669405f11690a5494b5d88295c29fd0b387cdbc8297607f18fc824d1e24814f0576c9dde91053287abcd8510b02536553d41ef26242542a5dc70d83b282739db91323a8a8f5ac9d3291c1bc74fb803673a8fbeb7cb00b010b46ba872696d5e690ebe44c01b4fde15766755acbe09807ce659060c075eb4f85c0ecef89ff388febf0fe38ef2a9ed3e6172b53f893426264b6d682d4152a22efa01181cb5372afbdf36d0c1307e1834949584668bdcca3e477e976348b87e180eeb3a00939fbb48aaeb932b2325bc8f5158a30803dbf4ae78d1bfcf12c2d6968c418934aad506e8eaf25152eaebd02e54dc3860ce7ed9640c5fe1cfd49437593a41b9a527ba6f0f9cf49e848d53f5e20fd0c8c5ce9a3778c7ca690117107860fbaf595a4dfdfe70f36af137134d2426df4a8903aa1a9ec28b4b87e7220bb49b8f69ccaa4cb5efd4b9cbc4c47732716a64f9b435f2c1bea287f1172469f8937c26dc9c70e1fc709cead6729b44f8f081eddffb468fc173e423be7db61e006039692d09fcfce19ee08ba332e4ba7e9661736385b8c7c74780449048a2d742031230be1b66e07e9d689cd5eb28bd21b364c5272c2b034b02b5400b667ab87ac4134fda5975f257e54b028c82abf888a4097f9922e84d76fcb69c2966845d96fd20b7dae4408958705f8497c97dcf184fa93380578317b5cb2d81cecaa89764c321eeeeb561010b91e21d76dd9d3d5b0ab65aa62a5b91085f0ba037db14b03f8cee02d44e6079a740df861468c7e7f4d0bf18296b6e5efb86b8e13abfe850065a526bfe3325f46a8e99b06e496d72d0caebeba81d20959c189a84678776a93fadb6cbd55deb28ac682b9f4862ae09a3067e8a1c25a51eafb7eeb5ee07390ac0ce36191a9bd205bbb34786a42a5a11ef71391ae59563b5270ef32ff17382724de425aeec5e25a90dd76fba6f0b469f01f0dd1c2e71704bd7fb41730ff33ecacd2281263aae8084c3aec7e77b497acdb26646e40d49155a43e42ff4f07528c5ea56c0cb5f333574dee5296ee76d70433f23280dd3fda3308e662a2416b2c59b32c2104090a1f764b8783fb807e5fd291fef43df58a817a43d065b065aad202c207fe9acc597688578640829f273a19f9d2c4b53206ae28d88bcc5a28ed41786bf3641699672e09083d016fe31ea8445a32b9a09ce452448164cc9010438f17c6e0cf5f7d8ca92283039d949532a1fe28ed40693c8fd0ab18a29f709e34105c27c142166044a9c5d4b56229cf2c15115f9b1922134e13fa9595fe14e1efd784ebc13a4eac9d67ed2e53ab0f0a833c9367636fcae91268c1f627dcc4b202f2191eb022be205f2358342f61aa775e256be1680a31bf3c1b6f71aa159fdfc909ca4924a993085fb7507f829a7287becd722d859c4b8823807980a7c75ed5e00d70bfb04653e49fb0b27285d5ea8abb76a8e6c2a22e3fa8f2401b1c6dc24986f7abc3bec2d47d9d28c940f3d6048ab371b2534a4d9a921cae836999659b517034c04caff8bc910cf29ee1d0b0efe7c0a3b30174ff09c45ffafc9b42dfa6b75709c228da208a0566c7c85bf0e6702876159d9b711707e087a82839ee28989a0a260eb1faade3912c80b60becc3227f4e62e4e1272411092b0ba5dcc332786677e27d5c7c55cf8fadf7056659c3f9f987a8d2cd761187be9f267c91ef881cb24edc30cd7658a6ae6010a3c475ac58beeb4a291b21c2e7532cff07f481a556ce5e3d33a949910f85c6e408318be0bc6205ba52774389f1391833747fef1d02abdf14ef25103d31bbc3f32374959956dbe95cbc892507af8c8f2b7de6d25c4d0cb60af36112a6716c3745f0e8f8244f48d1b0705919d040da00d234756bea0c7439b242f8484467f1f709ff1aaf473bbe39a7a473687ef83f14d3fc8984c1df38fa0894f7b52982add63aefa8873311ae5adbdf15f3a20c895ef685f4636b62ca9c87159fd245249647286b55cb17eea234f71c243a41dbc3f2b6503ae317bee9e3d7610598687600babac48ae4d24122575be4110a5fab84a30921e16b26f872fbc65deec7981eb5718cf652203d0b8b9232b65db74b92193d256aa67ea49569236f6eff0988fa02aeed94a0082310b189d901743b0b39310e193356a9265d65d5bb376f965cc98f30eba1a18c58ed5a97934e8b040eb4993f9e05f92b3e3f8de0aa3245fd73f649644517170629d38416683c9f0ca9a0b04ff86eda1538f10de113d9d609eef9fb3176fc4d2bce746e61074ca9e60537215bb04d9b4b8a2b4cb4987b90ededab08268d4fb48e2284a846e0e7be368b3361a81f1643bc27cee4da27a8398c9d63956dff5369e1d07006948b469465dafa85b53f1b8d6115142ba68a35d2caa64c392439a49d63c3b50aaef21078caf212cfe22e0e0920edb1b89a4a469d2f56256004dd22e3509a3f130962ddcdc5d5a4dc6502a9aeba85f64732667ea9a988b6279955b07ddacab6d0a6fb518e7d8199cefeccb00ee1db935deda893d3f84dbc9eb0ca46d85603fcb5b546578d72c236dd66c2dfe62bb82946438116c51f9bbd90f2789a82ea552f597bf72cc7d12bc42936f0e95ebe7cc354d3ba616f778d278f7f8197d55e4bd3c8a75bfe1bd072488660853751a2b8550001153d7b951c2e66395469ebd88e3b90f3f4ccf4cf4f929e17e30cd9957f7da9cfeb9e4167ad385c5f91dadbeecc522e0406c72f3f49633c3c8a168f3c1c942855280ca4626110c869146044ee47fce08db3d9deb48f49e2fbf17b921277149d1a96bef6ee20bd498e06f64c0329d985faa71d959aee6d06581f5c533973c0167869a699f1a169018b2e5ccbad44b90b70cd476c683d4fe62cc9acfa191edd16c25ccdda2bc20b3cbfff090a2a7bcb4c21605d01dfd5b7c19f60cf7237d90bbf5ebd10a1f44ef2579769777f3a6cabbd51b45c5945361d01aeda09fb864fd3022314ca10140d846510b56f6a95f50a6bbef2cf59927861ee390f2f7924bf69777eebf1711d28d5fae522359222bdf5aa503bfef754cd1835f524f97e71324ccf6409347614d7a9a09d4c769eb62c2102cd5441619f74b9f8830fe320d0bdf60ebac3815527da8882b6e6704f5fe3eb7729e1a01a479b433a2e403e5c8fec5648fb0817d979986ebd11bf4a78e6c9820e744d0e30edb991b215edb846769a217b3ad441865c54a10705ff1912e347707c906f445bb8e1a8a430474051b0bd9f97ff3b87f3e175f03563c7db854054e7d7251d4b16670c4c2d6150de0b6cf259d37b326625f977c766f40c8287ab7f063b2446743ea667237eb594e04c244010b5fbb78a45dc35eb98f7d1e135fce31503d390325a1d7da216f11325edb46af85a538773be64ebaed7d32eabcea2f7828a9c472c9ee4cc9e69451e1ae848f04d09d0e85cb06d07c616387a235ce333b981441d43c6364d1ba0248e6393fcc4bb4e113a269e6e1da594fd4db94bc164b71f931d0ee748f9af611de20d1a647f83f0bd0a219eab8ebc0f50902f6798a63302196ac7734d1b5afd4c4e709b4a366cf6060bbc24c705e044c4b7bb57bc426aaf83f3cd73ed2f1accf9afd1281df0ad9108c5c23e2d8acfc7c0ab4ca74a0b2196f4bfed3c8b109a82aa89078a1619561d63fb233c071bcea5b6e75ab386aad81efe0aaaa62bafc3004a198b812d15ab7bffa7da997e350b28f000fd0dfdccbc5e35cd47fceaf7f147fa6ef1de9228c16d552c7c69c0a81067e3bd52d61b038ad0a22610b8de6b05f3ab6b17767722e0b67f2caba8054b747b9f712dcc073300540f4a611139734e28ba8f20bef3af664c8d03c4659281ce9ad1a839a1fa0053596526802c541101c9a359db92ba698b3b7d1cde71b064d7bddae26d867140bebeffa0f63dca95d625ea75e186de12d92a00a8f5c515ccdde0a9f3bc83b5dd7f96671ff25bc62673fe293debb399d3d0dff8eefbbf75601d38db94b7ff0e0bc8f3a20ab755c5af2532f7920d67875aeaa0c4b0ec1771ec443096793625f478db393d7bbde75e90135300c5ac042433b7fce33088c2ddd9fada7cc39bf650c63e3fb6908397d0dffd90a074cf0eaf7564ce5546c174f074a9ee7d86eac1e263e77cb8bf30d0c5c6d522ea707703d9bac059c3f4d2cd872b6e07b51ac71c1822187fa34e7cf0fe05461d8b88025d5c76af78324bb3c6ec2c9a21e791140376bde5978833f6317a3be0bfd22d52e03fff785db491ad3f4384318d97841dead3ca7f079a4cb38925acfd0cfa99c4b6342baebf457c7b77c82e323fbb4df7ecc53138efe90a71e107112db8d38bf2c6a39abb09e40d26e4ebae88aa14f2ef9feee2fe41932e9b73d039c1e1d8db07bb4bcb5b5ef22c6895c5de8bc4fa06f44ca06fe424d497576c649a7312a4677674541534f5cfc1909873cc3e17a2d91b00d3830f0c6cd488fa6f999cecd7157b9fe527f93d892a663d2d8a76a3b40b1f6044a08fb585c6070aea69a20e05f7809e556e390d21874cb98c66dd2786502fb0615ed8325b638882284825f14ec185ee9ae237eea9dab57deef16a2b3444698bcfbf04e9b63af72977884e580ad74d537750e429f0560ae2ea1c49af811c83f858b25cdcdd5c231eeb2cc5ded1bbd57bfe4dbab7b4c39177affa3c37e10dc1f4d2e18e59a6db576967e5c61fa7433ffae209cc444303e2d0b91e422bba155b44acd10e65cab67f0d714f648c2dfb62a770be403794540cf4ed7eb8ef33e3a625603280c340914c9caf24ee225d6b52377e7154953cd5d15c725dab62f4f96c7a1ac317b53e2f1ddab442031838edac4c8160fe689d30e3d3b9c5a9a0a19b0bd11a364e9e817f05f9423ca257d2096b9adbc644604c39a12fe331976819ac953576872979837810b7a0268e22bc702c8e6b770c9bbb1b04d017a3afb47546ebffca4ab540acc3473c38cda124cbc60b9468437bf9607e0e1be3dfec960b8640d64bdc21391db48ca492ad69d2cca28eea2f7a1be00e30d31e0f84870822cdc6ab8ef6e151c3cf9fb505e16e5b3815e3a9d11bc2e634832960ae7b781d25ef53e8e5fbda678fccf2e98480b1802a11c1b19d84e36147bc2197823a753b1355b48d98d9c5b9fea0a387c802c6c205fa8a32c42fef51192def71e6accdd888a9d21b2d9b69ccf7b03f15b389582f7cf9363c8f924b15b3623c99aaa9b916336f674ed5fee333eb8b5e9dbcd7f484dbac8d515b3c0b46838124145becadeb5a9e790f81ed56c0d4bcef908d168df9d9c5efadd7df1dbc2ec6f855fce7491b2c01e8bc9e60976d96d2466890cf8a7d228665f00f032155224e2139ce06d41be34fea21828912eceac3abdeae732dc1b516e857be27d393e549f8c8e1bea45e4b5bcfd3dcab2c758713e6b36142a8f73e205a68fbf6cd3816a06594a8f78fd260caf7c766d39dae318b3ef0ec25b56c9852f1ee63e421b239d21539450d5babb53b1b024f30d3252bc46b13ce9ce4f66d8836651fc759d96189c7d85040efb0b046e92eccaa00acc069edb118f3ccb89d3c8703483ce3981e84127d70766566a41e15e0af714a4ef07c5ad006150e8a951c5365770190224d2cdce42d6d68004bd6f014ed748caed081854ef53cb48711360e06eb517de12ac71d79c53e0db29b47e2fae563aa3a576fd9f0e75c1961610df459873eec09aa1b1aaeb594a3707c43245d48783d6649ba4af9e85b9a76dcb3ee5573db2f84384a4399935e07e801bfd38aafee24c4961a15fa6f4c8ff7062718f93e10f1fb42e96ad29e32f5e287904f9ae7bcb5ea6932e7111b1f1186eb84772bf7e758c29a57aeaa84751bfed8b21fe5a0edd715ab224fb0a3656e11c418923e120b24985c6ad689a0444c561ab8a3912f44a2aada1418fbbde4a633f38ab18928deb631a42a3e8ea86ade70e8d0f4d355952a709ece98ca88b593e3a3d541a46e97358a6689a39d3e0141dc281772ccfeb252b0b03c8eb71f5fe43fc3cfc82da71d38af7ddbd125962e9d132376d7776eb6ff32ebdb498f08a0c9a7dc71ef356522c5f49bdf657fc87125d8d37c8f57d8dc1397844f4c26a480a8dfa478dc56098d9eee76dbb3c77e50b124e032ed6816866b2fc1af3a4f0ec8e4e69e2b5f90b16d29f7bfd5c7935a9090dd945c01fb83f8b68f5836bfa26234b876cd53dd300a50d3bd5b44a87c69fa9d1485ea1d8e0706541148eef79f2f2c43fb74f4790cd8aaad6d4becb526fe884849eff820b158084ace716fe088cdc711472fb07f394daa117c02956a1d3bd8dc44d4fc932c7636decfe3f9d9ae5f88ad5dec60ab5e1b161e54a34863c6e922a1695b52051f8de78280f1876d8c9f1e5f005b071b4d19f7b074f2d9fac8c11208513cbc4d3fca2a3cb212207997ed316f57cf94b2068cd3c4569062492c539f08e865fe6cb0631d354f44653090eea9084408059cc1d7fcbb4d37e567af76102186a5d509c13fb1305d54f9db6d062e0ec9d2ed354d972cfdb334780d4d792d5556a42de57d614493178472104b95fa8076e464a533f219a2c829de19f907f02b5ea3b39d4858dc5065c135ac0a7bad6965a2fb3accc3b4a1ab2165f51adf792944bc907324e90d01e7e4ad094c4c5d53ec73ef663d4c8be8f15a4538aea7553f19ebc7e593e8db2596176876683c48c90b3051e771868e0ddacd40f40459e72ea5160487ccbcf5e17d072a48b2ffe78a9077dc0b89eabe90a74437e8d934de9ee8095b795d28566b9912d3c98d186aa3c755abf9ad54c158468a80e2510c5dcbbded7fd79d087a8e33c74e42405e6ee8c8a4f7d75e09c31364a61466e24cf7632f373aff12ddfbed7be82ab39e1386646c8d49653e0f0667850c7fdf5dbb6820ca45c5dd88a6ddcf0c1542dd527fc4c435047ea05e96c71c1111e83a0cd3e1d5c50f8852935616c55fef2737853978a0657dc4816a37c3f4ab16aceba42c2a773d5ed6ce1de33ea95e7ce4f0ce3431357cd2dbe1b2b85510cb2f9651fe05f8a5439538cd0381ec9a911d51a1f73c3996f2f778b3d4d62cf91e15f5877d3e8a09d13d9a967b40af978d0d6b83a7ccc8a53fd501dc2ee48bbeec7eb5ca1ade45d950f1838c542b76ef0bdb6b2dd8ff61a1c81d4f5478829c437ca2b2a3e7789a6d802fa6a23f09b5e0e54b4e37cbb7d8626323973b4c88781b658b67c5a6feb0a6099bf190eb194959a6d30843748c0f1967e063849c223b332d81a2161f879dfc6a256929f0a631c44f365b81f80cf498cc62280268920fe0b23cfa3bb4a0119fa11ab39748fbbc4e68342eae8ad884cab18db51289a70b7ad734afef75510087e45c5e0b106be2593c13b2e15ce761e81fd7e4b87e18c75c833738d1ac6ee8c6f7281a4236bec360f02ddeca2f62cfab2a80bdcedeaa8f035df4e687c356d6adbe5414c8c137fff74983fff0b7fee0b5e75e553e00b74db884d263e6dc059eeb36be88ee270f5401b14806e6e3ec72739c75fc46bf6f6c8f879bf7b7d3d301809f31a0f44ef935e8f53dc401fa548ee84e3e93650a9edc8ab9cde90aeb9a4447ff359d74e8c0e4d10d84db95ddbe2f9995da93373546549752b6ab270874731668a274d48345c97b45d453224138c4dc4b40347736534bb9a26432d7fc8407c0981dbf88981543d044cf5e33fcb7fac121840134871d614d896192fd970e3b735b19b253362662f70844fec3b56698f26849c09ce245a63fd95afd4d14268df6b9c7d850b36c3a8a76f171eda18986c4e91d8a34dc787a87bb7003014bf60bbb6b6ee51ab27250717f89fac99d9affbcccfb70e1efa278ce184f0753c0ef81c3f0484b6e37ceaa595224a1a2eba3e837d26d9491d0c3d0a22219767cf50837abb37943cbd69fbf5ba7c0ab9d1f41785b434e5830ad948dcbca4bee084980d14a5ff342b9654d2c9c4dae6dc1089b8da15eaaff7e7f4029c8aec81d42f96304d99da1cc141c9bb81eb78332cb611bf6c4ee135c7f54d00f100f6ff9abbec7a049748f7aee1e7b0034d6dccc7438356d4eb6b6e21b815bb99d2551cedbc1dadea0288929764577f79be82bf2c48eb3a97415511556f65772c5103689f750d3631b70a10e6949e29b611fcf8b8198fe669fe2fd20dc032ae361410ba1d6ea56debb4091324b5e8e7b4fef957e0f019c67728c831399c42d8da0dbd8fe1e55588e7c95dbb13f5e8720fa491f33c5d90232e19c7277e6a83a4a24056fc97e77ad87d448f80a91fc02b78e2b9da95a56bd6bfdcc41191fa547a46bfc966577a674cc2a16b568493a209a6a51f0f1ff24345447970083ff06a7aca395461ab753d50dc4c7b8368d4bbe4196480c5730333d9cb6f03d674f4fde3bfc9cd82891f0c1d0f3df83c1fd5cd3c75c0a98d63438f390b2cfd970520d165f57e19f95376ac205e178546146d4d54e7b8f7902b6b45a5becbab8c28301d09e7e0ba6ab16f782b118112106213ef6809be3d68ee5d18bae74db324b0d10b8f9bb76a7361b08365ec5a7c1a221fe52c207620b523beedda9bc8e53210c5adb129405ab6016b1a2cd38140cdc7439fcd03b6a4544c0d7b546274fd898325c4c28c3cb609f6db97f37041c5b49c3412c6f1da0e25571040e600a6aa8bdf440f3d9796bb1ce00da285e25510dcca36ec85ce927e76dcfe161933bfffc55cb1d249d9de1ea63a8e94a60271017fb7d8583f9af92389b979d3de2a8f52061aa2dabbf4d8182418193e5ca85c2d29d4dbea9d0711237cb4db65ee0e4b92e9b4d0bc3a3fdf819211edbf7463a12dec09bb3209ef245ffa7f6a2c7a1bdbbdc0f6ee2b90505c3d7ccbaf0cfae1f38128b7da809ae1538baee0fa5448386cc77520ea719e520633c65440b8b1c268cf9dffe1ddbb73759c36e4257df92af41876103d914bc6d4b902c64daf893cbdbed53fa81589eeac64d5df34d4928b899ebee70ac28e112524891b4538ec8f047e4263ecfc5c1240525946a910cb9cdacc151afa84a0e81e48790be7171838c57c5e3ae8a9782a74e68120adfec7cebdad0a814dd9c43da4064ecc9493451a2e56758f275f9396168ee216e360c4b4b5930469ed241581d3469a4950c2108a75c42000820c59585994b90e59254a286d3f36cebc168c6465a1d36b5c1a41140eb6aa075156bac6e6fd9f6fc2f4cd35e8852835425ee2b865cb56600bcfb75e947d142f12e4080f30c21241e1820d4f0a761cd445a8cf9da55ffbd438d4dc37c37556a0c7f187351cf385bc088a95a681b957dc600a773b8357959bfa0f6c6893df853cde0510224150ac5051fe4a4a02398c11893329fa678f55e917b858c9c70a057f19578036aae256df9a3fc77bcfb1b838633770ec4aa04eeeceb5621271140c48503cf671616f43a9c6fc5ab20cfbd7beef7ec3f615ed90144e7962297be005fcfe8b7060931a10a67f286a5eb8c8035178b15c925cc63c22f0f07b51551c4291ccad9d1dc1cf2f55c22cf1efebce60df4b7eab25f4854d03fb4ab9a2ec0bab5723994e1e4391642f77efeb76861ca0c7b0990580fd257132c252162efb793e58329847923358a57baa78594b14eb020362d3da4aab58c9fedf08a6287009359d67edc20273ee11a68109a55d84abaf7ff25a2060fcb58dcae3a6945cfc4e22b8d34609b320584c61034b888a09486d8d678aa13dcd57f0f84bd72d2d58c06e6cfe41de4dd376a9f5b2aaced97faab12aeb82e6c51a2cf2287da648f2d84f868438169f9d3f7f4cfca44e318e44bdbd3e73ca755b97152af4e1bc47df3c405839966e2551d1abd25a85cc8ba6d1b2024404feffbd0b758f5445873b73fe6b38f703a3cf89e35be11112e22b98afda6e5ad922b8d25f5a4c15e16a7a2402bbeb0565403640de24cb241e8302e3eeb5e16575aa8c6862e1b31fd95be27711e1b756de6faf3a8f57e0a7444bf7bd6890f05efbf64c2daaedf0a23faff17b128b659399257cb6aa014624f00e2e98698644becd84a70442b58c50dcdae20ce766343e7e537d85938d94ed9500acaf53879a7435a9272b3806ed9a7ab8a502e8f5fd063f20eff44056738fa7faa92e9fb9291c8fa9496907fa40f16a353d51ad6c8d61fc31077771c8624c447234087c300366520a245f56122e049402bf6ef472de3ee2a054da0c0e7fbd18f0829f74e47d9ff0011aec4d59b19c8f42319daf2519e1b9ed01a06f8b850a3c3fcee89db642ce1375d80b472cf5d0a49f42ca34148077a35dfaa1858968cb44bf27ea39413c98542c30151cc9fde090b60661286745f57e62c6fb29894b1ae135bd8aa1ee89d8983062b621003f13deec494db7783711a6a2e608f13c6abd274d69f53d4d02698e7fd8dee64aafbf5f851e4790272f1793540d67feedf32e1b82cd05ef7cc1e2a75b82a7b1de873b26bc300c7490278fd48ad52d27db9070df31cf676fd598eb52480c431e01e2836953cfced8419b8d875840c110feb330c3a09c21f26e5e7b2d2427bbba70a397fe772369caeefe50d56ad8c1fd9ec5f99d87d61b302e5c798c6f018cdf1bbabbd6ed58011ff7ee499458d0ddf6d54105377024070183368c444531503c7e81b13f50cbd85f6b19b8502aa0b9b9739b0569078cb49aa7b13de34cf95b5b7a2f8c16dee26589ab679c25ce8102a19790a0d51512eb8f69ac0cd8e43ed8c0281563b336ea9a6068783a85dd8037578f773103da6d0e3558ded35bc41eb434ecc1d026858de44d79097e71261f68f3835cabef96aada918db57b81d6a40e0d909d03b1403299b839b2caad89e8b2c0ad17b05be3b6fef7fb8f606a05697d3d8fa371c69e44eaff5717d0db6416fa4a52caee0f1cab75ed1355cfd8dc387bc7698f1168660bd2f50af3421ffdf1ea658d67bc53c42283160a956f9d0055d8624d6776e692d4b0a2fde41bdf4cad57c574bd4c9292e6cc0dad537d9f3c4619e2d286d205144ee9e437bf268a9861a46851f2206ef1615c8c2026f437e317381ccaf6a42baae1cbee2d9c0b23aa19bfe5c5336271bb0b9b4ce0eb1773681bb26f9a995830001060f4effcadb7d009ce83530ab4478d3ec154bf4c2da8cfda5100ce4141fed4b6bd10d55e6745f37a33045670d70d7884e1994565a24993058fea44cba18021dcd4e37fcee682834309682668716e8a6b459d4bbfdbe4cf25e92be9f77992a6a961c68d1fbab850cb794e4296643491fcb108f49161cbb60d2ed6b183a246a7aeaef4d00a5d8655dec4bd64f233133f7c818c3d18611624750a1a21af28ee5e630fca24a47635c1d02a82c83b9eecf33c1522fb9cf19f5a72ff9c0772a6ca48a7d46fe5a9a70fff3367b7e874f912df5fbd2c4919a4c3a5c6cd372781155d466a2c0722cab067ed4039162fd3fb00783b97bb9172fc555e0fea70eacdc9f65bceb072a5f25268520398d033960e2589f33c538f24fe291aec7318d3b4622cd87004fe042e6b31516dec5c0a2daf421b3ae3477183984b8a2a731eee6ce978b08b363a79333f0d9cf0233d7b9b41ad756e2ebbc2ae227abb3782369acebd67f978fd0bd2561dd8ed075fdd6f12801de338e5355b659a93152f11ecb64f165d758a8f14c3aa509c5126bc599708e062cef8dc5c385d59a15086ea6fcff3cc53d08f75c7db263a49ee3b68d8457c8003587120372829a044c6da9bbe239993a57b88d7181b04591a1e71a0241c744147ddbdc205e2d5125e5d997b8be86cee5c54b97b58eb8723c73062e6e3a205ffe44c4f2f184d491300cf045cd0ceb75728cd4674c0231362945f7ad79cfb317c4272a6e80a9204de01f2e126ebed7cfa809e157abcb0ac98590512a0818ca5e0eea33c6646e300f5c07b3bfa13a458f478fb765d5841a274f19948978489dfde351124b2a796e080b1e809ae4fe50951ee9b5a72dbef5bfd49d2b130099155663f93c40bb670dbdc329a55d15e3ad9dc779cf3eb313c90e647ca7a93cf046d2a58906dac6928d5b85850ac442efea09348070be8b14a7eb5ba2a3bbda8bb1bb92b412ff0ab508bbfb0424a3fabf4b1dfed1aedd15fe66e59f7d6efdf7cd345058068f77298908b2867b15408c73d3f2e84222b05fedb6b1f90c3da435243af59a35562ea632e52366c98cb77fc8f2bb6def02aefd0016b2b3fdf4f42a31f9b9128a1e64fb86b1e229b3a8effd35935a111c6c9d01c2b893cf5f00a6fb8ff127038273e4ff8296fc6b6e0f71b1c9601a620237e836b584e00b20772abd40991f45e264d6f50b1646ac009f39dc298bfd61a0dc2fa6218000c8d729056a92fe1139ccc722b954f2449233f7455f5c63cbd83c3331566ba17d35a29a847c1e647673a040f39a130a17480f49487efd096c087ed59e219b0e2cbd09db64e193a7bfe46dd8ff9a8e6db5d44cca40c9b4869f7f3d71d60ae4536458119bceadc02b2233bb24391dc0855c9f684585dfddf553b72aba700461c1f39c8a2d00c3263461d46b187d9e753278af205c820c1152ea3a98c44df40319321ee9578cd958d670ec316a762c2c6d8465f46f835846bf1642cb211f3816e294c8ebe6a51b7ce1887e582b441d09ccc97173e15ad2de4e8e3561b0495c31b5bd7fea94ce12cb1a91171eaf1b45d616c35aab92e76fb3444e4a65a61e6dfb6ff1d6e5ffc2bf5f67bb02cf8a286060b2a6b1978c3752d31050fb9479fd33f521dca42b318c300eb73191252fea4721e0991fcc2b7a51b8b7967a41eda437cbdbf308e937bd7ee44c662706ad41036f813f41be5341a3a800d1e2cb1f2a231d3d96909cf28db3d624f4da4d367c859ca56ee78ef523a75f8ac77df9c162ad68e77419f59f30ef1a2c6e891497ea205a62a35eb61c33921486daed69b44680c21340148ea20a807510337d08819b07703f51db0727b50b1afeb6913d83f2054e5f65fad487783776fa72d90ccf4d41d09212709dc3c36f8dd115fef77bffc4ef1d6f1d7bae369a3281e2c83643f9c8c04f5266fe98477e77a413282c3afc8868974713bb54c9c8abc5bb849d2ffd1fbb0c1ea75316109d9fb75f18f7aad198067825a48b539cceba8a6bb63417dedc96555efb72cce4130257a6dd5d09a3e08b8b5322f070330b7f950e20c5022c38c225fe32c36029e9957bb00056736e2fb753c1a7051c8b388b96738e78a6ae4c34c23258ef72a3b9f313116e9240f644511a3d1210b69dd0bac04e62efd42e78bfbd429c34e7b5d8634979a9d1cb2cc7171eadd2071fa711b04bd85ee721072d424273b73e3a4bd0e86d29ca27b6d7dd13fd88f734d416fb285c3c0e08738f1b975951aab4b881d9e3ff7c3cc834e46c552d131f2cbc2eb3565ca05da69b252d8d3b44696cb2b2a4ab4a3dc18f6e095642a2bd133862194565ca283f91765d5830caf105157774ad702c6f8014ee326ffedb9780adf166b176fd43a5f8a47e16a93f36f4da6fa195fabb4e21a24dfb6968bc6b9e58840a5e77310176028669846ab1a40d49854bdaaa9b12c8cbf0678b628b226c85f1ccb5eeed41b36967ab34eaf152f889d6d2fc995432e7f0ee5106c26be099e041e6ded0b57200bca618620926e6ecf739e22d03188ae2cc995b5356b7bff7cce16e2a716b32ff4f75206466221a49c725bf41e18ae1d638d63d0aa4bca456a9efe89187fd88d688f46d65c933b745548e46ea785e5d268bbbb81bedf1af97230ceca32b430dd97d9df0e557f8abd7d0bea533064a6ad6d8e573afd00d7b0a37da14f3c87123bd66a51d36d9f60775dbe6509949d11570a53761b78dc72372fffb26300cc2fe365cb01ac00a42c02af1667ff1e37cc5b6440bde370a8c7b6a88b7022f38024c678b7a48b04e37ad28bee63a6bf9feffa1dbfe57894026b51311bd0b90bb50eea6592f566b202286b360bfb25e6a11fca88e39725b821bc8f1a79fb6a1b5a521ad9e31fe0398128f28c326d6a27b58eda41a2a54db7c740ecb40efb0a242ae7542239aabd8a795f4716d97dedcd86367656310856d85c58a2baf2d64cf0cd8e0423ef33e4ce37223efd5dd9e738a684c80073d374813f25f56295ff0907eb929ac87468f5f392282b50af9cc64acb40a575b346fa5149fbf37cb6bdc34ae40105d0c9571def2c083c211daa8eb4c86b704d2806b61c175cb94d91585d76f0f6bbd862e60036b394623bc9d60f5dbb391bbac87a2e46123c44eb472597b7e881132775f66bf0c8f0080f5ac9a90d3572350c5a204a32dbaa27f9774271f850c0cfdaa86c8d55596a65e410ef1dc8faae595c215378a498b55bbf4be1a3dad54a9355f010f01e2a3cb4f4c37ff50b9ae70f6e3b9876df39d3afbac1f303534feacc18b6245c73b97cab22f21888d4c59ef503c0d1d27bed8cbad6207795d09dcea9fca214a9fd80e01f89b3784b2cd934cc4708837e02c86f4101a8497c83d5158bb7be7951ea319230832beffb13e144f9810d21b740a62fcad421559391b6f05837d86570655980d1560c56e3afc29c9870848101079006429356faacdab025759d1bece274b79359be01552778dda710f4e3b4768a98fc97b77c0f80f8ff952a78280842182c1f3fd39b4bfb6a9f5c01b228c1847240029702a6aa19294665a78c1e0cba0f71d46aa600a2bf3db2d27cc9319de84ce70dfe474972f3fd4b67638ce230c72c9fd4d4e0720a652d7a97b2e0abec8582e063060a5b6d2f898428c752056f03c12ecce7a8cebf539ef80ac86af2e7a7f066b63c4c4d6b3281f4066d985f0e6c0426eecb8beabf85fe9cd158857f3788fc5578269b946a5abf509e33c7f8a5159941cef85c8b55b50e51e336ffc98a0983a0c4fffeb531d1ec38ad164797fb86f2a338ac09e69bbd60c9e39476da0e4adf008b4bd2cd38c7170bbd5ddb4935abf730e4c2b81493c92c0962f8aa63c628009be09c67f25efee73142b6dae6f45d2ea5dff40a1a2eb6c856e9f1b85715f0363bfd93367968f8a759b05307cc15fe241ad133abf2382a510349ce5aa3d32267c6e866e698cc2e6108913b15c402188bdae922cd016fac252048e2d13c8df3a7f5d59f91c48fc2e931feddf06b82a0d072cd00030784d22231543d420aa4e7f370e2e2798e2695a246f138bf4cee34d28a77082277a3f234a83a2849ea228f4e0a0209b16152846c120e5b4cabe03ae799af6883083fed0346e3affb30eaadaaf7ddc6849c6ca05e76b445b38c7769608ecdcad9ce4c545635dd72fe8db294bf0b71849a6f0afbc2d2f896fe156b7bdeddc35aa82e1562ac693fe82ca96a718fc66c10c6c29895360118482f1134ae7820d32f2ad871a671d900f732e9d5c9789686132cd4a5b00ba77e073de8ed0d8d32f9dfbf5fdfba6ac33f86415be887f88d05d6844e049ffc7061ce596646d8549c7ae81d8f9c8c612de33d046fce3533176f35492628de23bd2dfafb3f394483aaaeef14f9ee1f8bb998095678b72bb6632489a310c56d406bbf5689170eace85926e850fbf4771150f3845eb5be56321cc1c6c4cfbe01b67c5ae463f7c5f9d2c9e219572ded9ddda1826f6b67f71902408789ae0f9d9b77e6f15ee3bbd192645b397c3d502dede9627b7b6980299c737437963d08bee6af056f55631ff760366762784addcacd6a2409c9f33634706250c3de25cba1332848daa5c014abefd74aa764bdbfd8f1d9ab1a47314d8e9689739f496fac1efebc2d9d5309782b83ea2538a0966755ccd89043fed1d9142f933e6152fa069198c6ce42ff0910ca1914eede5fccb931a7ec91803a69ae6c4dc02905e9dcd94087413839592bce34a9ce0f576d6c4f3e40db3426c10937bccb4f1f1612801bd47149641173bac97daeba264c73b57867b1c7f51062fa998ab7746e4b8af15b87a370715701465a7f1046c1fcc3f4948e105a63f4cf0d2fbcb4de4a9bcd6cf666c89abdac9f7484997f44dc6f11b5d54ee65927b60c8ee029b0a3bc4a7686f08d6086eeba2153dcdb4b0c49b491fc6b35a974eaa75744aaf96dc4bd6a0a69e5a726de00f0a2de5c95227ab34b04d7dfa80d60dcebad816fbc2227db3dae803035d081437ecc5dc7920a2bd111e01b1aa8d34417b23c1a12faec77a40fa70e9d3f0257459c017293f42225289bdac8087a2de1f625fe1e1ce388b7ee8eb9bfed057fa353d7b88e7ac15db4acaac859b17b1f00149ed71d00c106835e3b6401a2c7be6a6896198294d7e72ec3728e3c48514226de0777d91a7d38d4f646d44b3a7d83f1a72b779249157e0b27b7a3fb89b0132e695ff56361fae9158c19d7e81578da263999961ea3913998f210c9f93020d5d7c32c8663fe1e62b94bd9ef414fd52f36b0a2e076f31868da2b2be35d9947dfb4ca137da1227a4d367daa13ceef5e190b2d983e7fe5e179167e66b8f4238de28ea01e7418b6412436714c1c95df8f2b609a96b6334ec5d941aba817a394675ed2a07206f79f75cd1ce6710f8a686cf5ac1f34dbb89bfb16d29144a0a0550ad9027b6634647d4152b82ce3e9132ee15ec36c81767bc2b4e3bf07f99b1e82c4c3fd6e25d33f348dde5c7988d22dd29bbeabe8b050bd68e38387dc2606b897e0fc80dcc4ba4b088c41a988edc513d822393fd1a91cf717d1fc800559a9c6704056abccabedd8b9d10a31226dc0935bf9b215774e6bd8c778e468c437cc94f6bcb1bc5c2bad5d01e7571aeb3e8916645418ab57045fd5cd408a78fee3affec985c8e48b8d91dbf4a3acb50d0210bbfe3b6c8b9d61545c7938513ae2529a0f49c9299f3c06eb4e1ace8b7a384717cd742e6ae516d00e839602c8437accc4332251ed3bab55ee30ecfafcaf2ce927dd4e8a572ef7c47c0741fa3687594a0b668c38fb318dd9f72a6db042451f20d0274ee7cd9984d97f14e88184d81a991c921ca2eaf00ebd30679c6fee0f23d4a7e97ba0b320ac285ce83d1bc89960e5ad7e2d0e7860c1532b733c11e55b89c8bb1613feb811e2a6d351497a1392cfb37cc7dfdedaf98199b71cace25912278edaa25efdb0c88e5e6260861dfa0946116ec6d1d591ad0548af2a4fb57095f725e50ada1cf4f4ac581652a673df22963841a658a3873713c5e421377a14dd5552e315b9fd643b59c44a6df545101b0bdec6286e917106174e8c6cb591e322b3b9f43f3ec6961c430dd37fe1038b04bd0970bdf72934195abb8ab9a49760ab6bdc0cd97b847ad1f2a4f9bca7bc2b7234ff73afa2cd9421206ec2e8fbd8b1cf3eccf2203aebe37cf3b94cc50ccae2e8864a0c046c2db975cc3fbb40d4705de5dd12769dcbeb9bf4cee6b05320dae54c38adacda194cdb6eb368f2711d1443ead8784f9f346f5b63e007a1854c83ee85b34cde241cb8d6923ce0c120c504360c50e51cb6c0368da691c7c439f1c65b9b7c0b64dce36139211ee771daa5fd5be3c6b66bbbc56fbc446306597e692f503fbddaf5f3c4aea3415942dfe4bd191549eae0d574168a732dba7a19ea7ca70a3d0232ec2a81b8e4f565a8ba159cf809dfcafb5a7d9861ef584124cc1eb3252be7f60f9c741757e86a4afbc7c1404e11bb1d09ab109b8ed0e73f8eb80d7e9c80387a8c6803e423fa5d63e24d0f23ea41b610f9db3ca800bf73049170d71614c49c74a540a8ed643fa4587f2dffc1e0c096e479c1b8b204c2fdfc78b4363b9047a32efa2115f7d99e694d9b3df68e690d197df0d9e578edcc6dfb7f006d46f91f240b897caddfcc0c140cae454b346caf462ae73699ba8688345ca0d36720b9574bfb6de254b1a8b9b7b81110f47656a8178a049f999a20d5ccb0bc3199e32f057cc2aaf0f9f425875c14137fea3e804a2f2831f320f8365c5e6f9d0205f5010761ce6367cc41d72a9fdd0502927aa83428ecc31a819a1a19becde81ea547c2d02d8cd6234722513c4364ac4ec557ca2757b067df42cdd89b8702522547efefee6b54647bf7f856d6b48679eb71b9217803505f0b0bdc4ebe510363d7ea84f952984f52fbc976aa304441830f2933027f3db65e7fc0d90cb9f2ca3d53bef7afdda4b9fc1f0124bbfa035cb2a4b2ffda773d028942a0db06dad7ca5ed0210d6c8a9351157dfad18f63d1870b0ea2099f492da6bf5093480ee152bc5ee71e54a1969cd334e84b65acab1a391837f508582b276317fa8e5f058763a302cb2812998d61d6cd3db7ffaf39a985975b48c60d57e8286b5b1a1c9ad4ce4e0a760dc23b1cc6dc6511e3c13797b71d2201d393716f7d1b193b87459bbc0987d767b92e1bffe6a6cdb333881db197ec06ff0b96eec1e8511354b3773408a7d57305674cea3f332d59c6e14d0f98066ea02d02346679d16ce08a8a880502b5c133ab1f65921553d190e034cc07af91f26557fe05a19136a9da62042a95362cb988027d14e5a038c085c36ffef37a373896d6a2813cff6841f60d178d117a45531516e0330fd4dd09210a38cbb87a02c0c66b4c136077388633b09fdd61d728108d53146bf9a287e488be990e3740fad96e83f7fa31243eac3811c134ab879db19491dc430823b5bf70616ea21964619b47d3597bf16e204b5d5a59338706222aa3fd9c555325f113412a94d39eec3adacd17370cc79c328c69e4769b29f810a166b0f526a47d5153888b0c8395636474bdc3732bcb17155e13d9c6940438b62e9bf438baee529aea64fcf1ddfec549f933c1b90e15bb153f36d9779d0806e5184fe164481dbf893215d27af4968f07e7e1c9df936656d2e4b6fa8bc91fd80bc0266a5d38235b7071817f7333e2a44993573052b5ce5f8bdbd061148701c85025a4cf51d4295920414d8e0ef3b0058c30703aca19081fba25b396eeffc1905d3ad9740332632cbe2a07c710b2176386764c58e716ca0235e50815064d920c1d4c56e6f68ff1d83fd9c8f8d81ea91cc5b62cd9390b2291fb53115424e77aee5268548a15cf26f741a8e1eacb26fad5130b5908e35b2f2d63a7d4b013b4e98057ad12a8ab2b4593f4d8e0902762aa7889c12f4c29b59ceb60ed90effbcb15159fdad316dd51e0ae09500d9fc9b227a4afbc5bf1f44f147921c3a0488189091b0855e31c734ce52455a499643c48effc86bdd1f9fea3a6a3e328fcd79ee0c1dbc62a9c75d9829b1c1e580c4660ba33bf053d561365269d3d6c4171fc267c042e49cc3cf4cad2a6c9d71077e867a2678770e0851756fe2a53f4d0df6c03167ce25669777319c6efc9f4f84884de892592ea0eda0e33af18ece13c6d9141f5ec4a69a7b3cbafbe71304125dd79e03808655557d67d934aa6c1094141544171fe765f60a2f785be195520db0a675be57cc760429fcf95a9d09fb0f2f194585218640ac1fa83f0adb76929bd6b83cde0f342536176a3b7a0df5717e8098361375ec498945bfdad91c827eb153aac301596e89bad4324875f87f3361f3b7e97ddb90e4f22fbde4a2b47dd9847ef3958b19d99754eaa7e25fbde5d91511b617ed0282eaa648ae25b80497adbd3ba920cf3e545a7358b9f934a64cf56c72b4e70f487b9da2896b005c445128fbaf664a5cc87a061f52dcd04cb185f44afca6c098e3db9a35a3db39746ca2cccb954c162fe71f1fa3f7a1d3335b3e1d4f9c41a5c2cb745086e0592224304498e9572dd5de6cbb69fc47ecd7d4b5c59a8a1411cbcdda7862475f1bf69e570f3bb1baea46530ae22fd59f5b48d4b39356c61baab50c8055945bf47407cd4046dd1a70f68624e89ce76972b28d796284b5c840ee5ec582fbce744ef0017ec66fd8833e2865bc8a8cc62afe7aad02979ca8d908e6c74e496dc71ad22884bd7b20b30b9148f0823db16f33e308668ece29991b9307b359f797c06b5c69942c0443054f6d661f7885e8e9df3e05293964d6ea28962e47a1e28fecb85b2724af21a9fbbee3c6f9cd5b01ea9c16dcb46bc7cd0f61b502f45da51577b69208e022c18223d700c8cdbe8373f4b2007806d604467146565565d2181de63bb05fab24ab8991a42ca5978e99bbfc184882ed5b624d0e392f9a172e8594d3b341cb4478281dfbc2b5fa86e43a3cda334296dd4677cddbfcd55526dd6850f93af1c38c520bee38d4fc02e6b90a91fb0e36cd2c54d0812616f81354b1ffa51324f328857f85a57adc742027f250f78654fc931fb4c0018c5f1d93fa469678cb5ee6705e0c2a711122a33e09a34ee642b743d4c6ec8c1a1bb25a35675def1e15b9b763b56da81c32b2497f90d31f0e93612927dccd660b5451cb5d3c608753f3efdae3259a0473978c9b02a9d67b89cb3c54a6315a13b35274199834f1529d8dadd88bf96234cdd29bb64d061e138e94b838d4bd18fea09f811713a5ae631e7b3a8d0c5cb490a513dfe3a41d5c509bc0036acf591475d585586217bcbd650e81c8e33d5e9993ecd0dab052e9108440a012884dc7a79b072bad4103a3c0dfb4209a9f822d27df24249a5374f250bc31df58ea881fbc4115f8cc4c92e9b913f2af49923ed59fc19835de91e4a24cd5970b83e386e7935da2c326bf061692a70b156a00ef46f4351d658afa4f21f4afee91a2893e50950ee6fdfbd2ff5ee7e1e967fbb58288e24a69d00726ad36622f15e6313369318086ca308290e4acb4c610b951e58c660bb0a40391a15126fe7573753703af162fa453eae11ebc5a7901d9f3f286e04a38e021be3350895f65a255504ae7a35edc7c168105679c8ea40b9d6b3a17fb192321cb05dc1abe79ebed52ca62ce3f8e49802566bb6dfa027e3196274d9cdd41b43594a59a8e92a904f864d0e89ed93eb5c4255fcdc660d421089a620f1e32beded21bf943b15ec346ec5eccc03226c71421a3f227865a6e6893169b24828bdc912bc3b1ac6b28516c8915f2ea0aca990eb968f09ade8b64fcc417989e60eaa111551b64fb1c09002ed05db0b8ea33e34365e60a67f92d12ee59d536112b97263e0c4c9f313889cb67695dcf8101ee2b5c032852626cea416664b5016b0b5fafe3567fd9c7ecdfcb1ece7116cd531fb3a3c8fec080987e48fd6d0a438f5d5a4b234b2f958eea7976b7305657ce20a31eef1d6d80147fc579a3d30c07cb06d14102dbf8337a6d1f08964128fbbcb4df9f61cf587b54386034c0f81ddb93b170a5481b9cf202fd7a54eecadc04b0f6623d281284fb3b7d817fb933c37be3ec55ca202b7d294abcb087dae8520ac65ed9441ce6af7a18aea00aeb3e966f7e3c317ac0a7f3cdd5ba9b299b79fba2a58d256f7920152b0b8ea02a31057a744c9431f9f57d756e5b921f855b8b9e7531e947c0bf982250ae65ceae218ae635d751a4d470388dfd87e8b1bfc7cd32dd02c2ce21a4a018d3ecbc1699c32aac5fbe3a647f2f73e23ad70fc67c5a5acbe706d553f03356b77e3da308e76eb8d814260f441ef8eee6c512ac2921f37e80124b3cc6a11a37274344c24ea0ef7524ef47c9ab3815ee3ec1d566786d796a8fad9d83db6aebad14bfc40d331dfdc55d22fd26af4afce19c800abb59e5f1d50b0214cfb168bcb0181da0015dfca2f6356eaeec8da3b6937430c9f6c2c59a179fda7519b8c801dcb7bf657acaec1aa778285f1aac01eb0aeb28ad17e8fcc421e30bbe8f63849e79ad9dd1c8c5c88310c36b95f68179a41bc0a3f69ccf6bb707124921ad42f8f79e9a335b21c92b317dc15556679beb453820cceff091c85afc5f512b04ea03106cf1066b7bc867601c3b433637a9513cc740d1ffe166dd656b46dfab436f8d3569dbe5e88bbe69da5f9fd7230e25079a06c47da3fb665a0dd4f5e03d8274c8dcc17ba8ab8851946c1bbba3c20745bb5d72ac02dc73aa6d85d256b2cf31e92e1c0834c932dacd245485698809c3103449a2e20d9037bfd2daf1fe678aef589386eca7776d5de867c43e51360c53a104a639f464f30d9b71031113782df6a254cf9c22d8604f3d43cc9e949e2047e35ad42bdd17a3afc3a4716f5a5b926d6b9e5bd854a434b5f0cca1b2d71561bbc2fab9098783ba227e56d7ec00c842d98cb7f15a61d012949a64964485c20dc1d87d3304a8620f6610c8b1c39c46f1c8773287fa0c2df4c0190eb43bc62cddf2867631b1830f1ec604382e7f4625333202cbcd4a42a72feb244aaa6b3f15db662925d5e7d07fd22caab5807259847062e4ea636690ae55485a366b10905a09652dd63d84ed4e04d57d373bfe803b05a84b2b19f1febd8d80a3e42ba5690f833cc08e9b5462439cb9228f20e376f0bbe96dd69b46ad362a1646a0f69fe6f3475c9bb6c297a6d36eac23bf3348109baafe4bea60b3173f1f5647cd3a8927b1a09c7a0467169ba9f7bd2f5a11386ac960b7a38b9ed18fc193fca974107a7ffbed4cbfe9418197af4406f6534c03e4ba66347d74e2c59bf53005c73ae987cfd35fb2a0d98c8cda8d51c2b5d1684fd68436837a0f093b5e8d6d108e56bbdb5f10ee6eef18e1da5e063d1650110a7cc0879b83bdfe3568e97e476c5ddc4cbee70c89d7bc3d07776cf1607b23d2cc15a24602f9026d93d900b632615bd95fd65863c3de0deaf2a96eca7742e07934107dbe09a4f3b83cfd9c1ed3f5331f3e4aee357f73cd01c41db00192f7770243f817d581c885a7a7110d96a9159e8d8088ae05f357520a5ae93fdf8e3de5dd16596e3851578ea911c492745cd02616285ecea32011fba23de80230cce4e7a87d9a2326675bb9afaebc5f808076d6d74a4182a86fcc18ec3e5bd3ad412e57a924d8b592f3079d67844cfff0de7d3c132fddc61040f6a44d3ff1f498218dbb15027054a1c89975eae63ebf020188a597df8030d148b6e65eef2ff9518b77d2473c96239b8e2b6056f548ca87041c9a4e4df4046130c7eb8ed456c22839dfa0717c7c6e994b1395b6cf06cdde89e69823abe1c68efcb3ad6ec21ee9718c36fa95c463b6595a11e907f5e342c59a115f38a51970225e4c6cedab3facf0120d2eaab9dbc2ff8ea3518d5ca3e10e5391c40a548bfe5f3fdf7795e5b45ffb9477cf6d2e8d117e28b61c7e0aa15642e580fdbc84360ca66bdc0d88abb3aa219c43d648bd7b33df7a5c14e85ee0db660c3100096f45f11c3900ce7f589650c6a470b8ad0d0b99f18669fdffd66ddf291ad144a55abca997f4647e718f4d9213689191072551c6c5b7af7694bde89849349a0570e1a54b6eb8604cc5ce318491c90d0aceaa794a0b3c3d6d9f59e8f9b9f41678104bf5df16b3ab4c604692f2d85f87b325fad492dfc8fb053c3d2746b36c6929c7e23d84b96a9725a85001036170e96f92f6e01d95884c4f19ceb43172a33da1ca650586a082c34b810495d8e4d00a1199aad7aa60196ac858e987e9c7f756372f79e9d6398f035bb966b2982c30e4fa0ef84835f22ca1afdd963e9cd76678ce9d433fe2261c63c26a1b910b103f8bfede164f66410cd2cd6e95d10daee0887354bc47112fc83df453915a308be3d8034f687cf556abd112bdd72abd539c510eb9dd921b9ba82e19e20fa0daf6d88d0bdad7bdf838376c12922a6aefb9a9c8d52599f0df33335e5b28a6992da13b29003ad9fa2eef4e17af7909ec2f81302e33a80ada6de153952aa893cf5a85e0f732d71b7bead91a8284047db47694249ba89d65b4b7d6e8104b4e278e8ab4a43840ac88050018b4b575d96a37877a8c589575263124a50182ac63617c46e310668aa5d46313b30cc100e646025ecfee166d50ccac99226d78d252079487247c07e1fb8bba1b4d4badc71f15852fbee268b5d16326d3814734db3ada2979d607b910db5449a0ee01dcec0aef35bcbe905f3a0b9120e4df7294e97fcf494d0e0dccd61f5f672ec77454cbb9c9282bfb8f239103013914e2b44944eaaffdf1a2ac90801d908f3a665617b376def5d646ede58934a8ddd800889ddcac7a9a5b5b8259ad206bd5effcf56ad2fbe3c5fbd65ac82a06b3db8ed8c0197d1b52ecb6afa36ffafd48998b6252e25a90e914134cc075eb7fbc4e786170649ede9230f0113d3e9cf03379dee6b4199aa4ddaa5e68b187dce5d13444d9d9cdadc5ec6a5399571e74533d855be9c965c2687ca62823ec390447088d184dce828fd6e170f25c9567ad5bdedfcfd6ef8bb935543c496fc0f5e4236a565fc47b0fa6bee032b957ca5e54c8cb33bf7da2487e988151bff2d74cb0ce760e4eabd615293a6c0f0947b74d1f006fbd91200b59897839460c3267da1421d72c8695d43b1870d4d30b743831ef2559ba5635648eba42e275c22a420417b8b19b081ba01466921d9b9230bae305b960c922f6ad83c0960cbc43afb3f417a1613a48c84d31dd5e1b3159613a7682da686affc349e715ba8c755e30b9023694d6de017d2e4ca9e751a8393bd04ef32f64efae8f68c90da5ae7185bcfb33c0ad85a14d4c1901d4911d6955783fbd423355d3504c746dadd6bb86f4f9cc7ff09a659a92bd91171679753c933a5c5e632efd295d5f83b16aef57833e0a9c210f698e436558e69e99d538b4eef0e5861f1457e86913f0576457f098049a65a2f737d7182b368faf5cda7046f45079ec079fbc2c8d5eaebc84d9324ac1a1efe3972fb8cc43a73f081b5fc6ac08c216ee2798a35185e0a6e2d058bf384993d3178ecb6cf5ce1438cd5ff15f36c9eae657395d49afef5d510e95a5cfa512c75626df22f61d029438ad5ca196eb5841e3c073c0a360fe3a9e5ab3dda590cfb846058d25b7d03a0ae29923ea069f8d2e49bb2dadd55d0961b31846062ccc67e99859b9a83d854c86cedf5e2b3118d165023a7b39d082cb06f52688e8065cebd6a07e265ccb3675f0b9b58ed1a1a4cebce11da94a7616ab3bf4563ac5e86d43d3bafbc0c37467a792186545e4d740b94e95f5bf747f67cb56e3abcfb67588203c6481fc269d27aae6f12fd86a98c58f7564844ee92b10f367c5543e36782a599c2c76ca6cff081fc4f42e8b68bd2aa71e7bc3cdaa8995930b57a008bed6a3334a4030444af6bf8d6515cb9456f488543d948179d02794b8b6e4e4bb3deeaaff25c562384961dda68655cf146fcac9c85240369fc6906d338c6ce96ec6e87ec78de2ad840ae330d51140559b105308372301170fd9cddb8dd7e505b6fadba7298c06c0289d5038a88033c48b56b8efca9f009173c485a13001acb4ab6ecde66583eaf6496fc16dbfcb091086c2d84062f5d6b8621992c1a1dea91b86eddfd3c053f6774e4cd1fc96dbf629adc7702ee47e7e772e7b9f1ce32d35873521d2a38cdd6ccc0e296b3bc614b443cffb3bfd736a8a6c3919cea1d1cfa7aa5237fbbffebb69f196dc0eb8d4a6a0afaa6b56dfed8ef1944f441c756fc0d1339785d96a440f7904c8291ce88f2207f4355afaa870663c1613c256e2502c9c6c6105058962c723d6e3c9eb1ccc759a4483fb5f05e1a1150bee148e034706fc32b27086239158c51c43278e2e901c8c9fadb7859d470bda41273075a7972905649e71ab4b3734665623bf8871831fcc552199729c2039ac348a8940345198d339d5c642a687cb9979991e7dcc260fb238e9de4766bdaf9e9798cc49fc8ef0bbd8e56f6386da512711d72a9f0ed9687af83bf50d39df78da3f4d46eed04c5203c40865e48cc6eb7bcbf32a024bb6bf6af85c33e80a3deae0bda4d1a7eeebe08f9254cc94a27b0b84688cd3b1fb86e2b06cfba3b0882d0bd3f9cb994301ba15fa322f40f4c02eccbbaf20fc1bb3e42b2277e81af54b0786bfef2a6fa97b7795d07b4998499da988bd0b1cc04c37687a77bdf090c943316d3f4654bf4c210877ddac03f575d80e2b3bcfd5d039bcfad242a441faf5fa4336c1f15f8b13e53b6b99596afd78def59a89c9afe93f7648e314a3f20ff936886f2675ca2c6b5b4277f6dcafb69423c4eb571e85b909fdd9121625e3202ef7a912f1177b09281230812886b5b44fceaa4a2bab654858d4ed862c14782c55e9177d01c70707430622d84711f34c7f2d4e8b978163bdf926667f359ccf4bdbc6f11744a91bb121e53627c6592ee2184ed1b2f234aca95a51b2e2156a9338a42f8f70b0cdbe8af4b067277fedfa7064503fb6cbeeaa34ae7213f0f81081e13af375d4cbad98d7317ef50c5c0306f66bf5245cb1287296ec0c31d9ad97b001d090c36298a365381a6592de08c2a212444e6de15ce8aa9ebf4fc34d09d0ecfe1022d709dc361c839fb70945f776a2726358cfe1a6aef021710e832da27aa4b82eb4e337bf6ae0a91669039232f3fb680c7bd7f80aaf63a7935e4042fb7f38a0ac6660ed5433d76d37cf10a40c4836339e612d1dbb2655d4b69c8fede50a8cfb0deeaf23fbd72f614d36b86f36456f7ae0477ab31676a2532da664087a4dec132a3d4e5f41569c4440b2b8cf5851e600cd9b9f5bae15ab617a53bf890f7c29c3d471d612e84477ba3326535009361d39b422511be4540f0a7a31cd752c672289cb3a5de2c2897bb23cc8fc28d72e24c45c4656619978135f6336ec4138b2ada015036f398efc685e20d3b83127b43346cb8af26b31f75cde42bdfb091a6579626c8e9ee98ed12ec19e842af3b4b4bb15ca5bfbfd0d8b0db83b4201a890c14c34f53c640d3ca02c33ce45cf1186f3f6e1080f23b14e438e87d8f59564583d05e3ffd7ac5fae276a6b6be1d97eebe636dfb678b71000a4a3032aa00c0da25e73a0a31dbc9a01b212e244d26b98ce597a06d9ebaa94559d6a9513a8148e5b7738aabf8569fe238f4b5794996f7333cf22962dda107751dde604248411d25be7ad722bcc55361f52496a878c5335a5a88f192640c5e75c1b565813a3af213fd37960ddba19177dda6da047791f367c75e757b97ea28b2c8bc6d1e4f3967b0eeaf095e098e77e96de1ebfec9e98d1dac64b10d64b9bfe70e538f1cfca4c3a0be54c6cbb399f89b479a42da69b8655604e54219cfef13d4b292faa8c033609bc3dab735ef041b6e6da24fbaded70a2d18dc9d36d66b46bbdfc54e4425119c02e6ee2fbc9bd44aa37a5fcbed63d784587ee65d299da5026f4589b0b284186bfb94a9db532330c9fcd065fb52c3ae3ec329672e7bbba5e7c0ad140cb8adb1bcc7c72e270dc6c5a961fec4941e3348b475d9be36b4956a0a7eff1f724e733c023ca45b5fcdfd6ac6c2c0499293a60243e524ea9708479f89286ea2b82a6378bbc6fc361aad8a2014642c458a8e4748b8deb45a05e5c95e4fc46075fe2565f9ac05f0a2f94f4f4297e9bc244f275b67bed871107ae1a1c440e575de68f63ff7d28c5ee0cd6095cc3866c2ebf0d910d5653ade0e642230fa92fdf27760e0a72fb16b08623cf88a0029b6b78d026c2da86489b916e3a3eb832ba7f026a8e22466afd18cb99e71febedfee1e60e9a4598ab2db1d8ebb4285a9120d317b34dd9b0a63d6ecd4ed884fcdeaf53f5169abc95a0ebece89c5c065bd2e4922c718a28e13ca185c93645bfc73540d6a4024bc8cd05a5553d11ac4fe4a35f8c6a2907cbf90f4d341620b0451554df15029019d4e8587ffc754fc7fa8d6c68e75b97c5a07ede1243a71aa1bff8c1d0783d642aad71ef9f73421c8d031a8d233ddacf808aadd390eb16bd54e11b45f1bba2113a8960ea846427594645677723211b6242cf6a06a0c11f83b0f590dd74333111bb76a3f4ed457362d7170e2d0415480d8cd5ff9e018e5e42c56fbe0ed7c000e8277f61a99f116f50dde0ab125421e250077f2f5bb1fa0a59f33398a71d403d87a0b3ea2530e7a8d35fea3d66219bec6b3ea888956d986b7e0384c32ab860930449ac5fcbeb10e6b42580e0c4cfc7541f2fc7c57d540af4801928688c92d8d904a681ca46391562491d64692896b309a6836923b627c58c7a406c901b2845cf77a3b7914733c888d2c207fdb2be85c4f6c967296dba05008f227181265e692d2d756509331807cb5ea6568cbe7c2eda60eee7af39d15c67a7486a03ce510f9e4d0f57f0a0119ffe8a56a9c7c90d42d283c692ca4bfd6c1fae0b67d1ee5164354e219dec582e3b7a35eaf484a516eb03ea932ba7303c6f783481ee0483cea9eda659562ed8e6ca159ece4ec3749faf30bd91a20509e57a3c1ebd9182652520d550a282dc5276610ecf74b0f4cd5d5c90358b5dbe88fa0bd94d47fdadca389d7b407c9a481a6f4f63b1805f7b5c52add8b983d5b9a95f1b3a42d3b01491c15d8028f543c8716a030b2f31b76216f1c8a2422553c58bbd2889af99eb7d5f1844683fa43562204977384be54353dd1b4c76d9652fab6f34448014d16b79b7a08e26cd9e23edeebaedc10bce6e324f185ee0d79700527bbb9bd8cf5748cb62db80e8b5443ac6fc8cb44df7b1ea069080874bc3d6a14e88b9cb267535710d315170a4486712adc3ad8e5c13bee145fe035c9ab36894351c34b6420e58d1b84ba2d32d1b2167a8591ccace2c96d4d90b79eeb9c0a59f6d6f8bee38efd183195b69aeec09118bd71f888b30fdead393e6bff94c1fcfe56e2df56284b54b22a0b8c8f4547e21b445060f4b10d3ab63bcfcad027a55a0108c94333c37d0b2dc0c65262bccb180cfda9e8bc02bb16b88fc5d45682c9cab52efa50f52aadfe8b5a0680561c07a7b359cd5a7596685a5a6fb79415ee888edcab006bdf21763bce4cf03310569453d02e6ab3943b29fc4b5eae9f9063e86070dc2ab71d0ba568d240cff15e03d84cf2ad59ec6ae6aebdf158dc90d1e5b6ffce7c4f357b4d10ca8da8d93e894e3ebcaa87cf9452e96cb71140f70009ec889b84fad774e1ae6d6f9a3d3167b792e1d77670a1549b66073663469085bb0832e19d3b7372bdb56a3673d74ac9d2c2d0d63eae967ee767391d86ed74fcbf2293f1bd5007f82919bffb8a9562a6940a81869dd11093aa8e4ea078d9bdbd93449dcb2bddf264cbecde5c495d40f01e4a4136ccefffff7fdf32b61a61778540db108fb9f1a30f1868f9cf735f79f3ec959a2ce7c872c4b38f8844ec73733360839dbdb35a2e2081b43f7a1a08270edf7932485d3b21aa0e0fa8dbd3e5ca60bf088d362006abb5a61a92119c74d211c42c3c31c4d4ad2d57222b0835914598a88b6f88fee1e55577aeeb781ac1574f8a44583cc38dce5c11bc8d2aea99e18dc0966d786c71da5825476b113d61aba24f3018cd6442364f1a8777484ef56d9837ddcc9e5b0e4ad2bccf3bf5593131d9acc77884e992708ee02aeec92317acf9108976b9c3a98c623a4519e3165f5edc7226c3b8471b432a7760114f1b05fe3bdf06b4d10cb8708fa03c1b1adc9c02adc66361eccccafe450ad13b9b48be01586c457fa74bb7f214841ede68bafaa950d50a8710ab63385d6d482ffb27d8854c5c524ef933bb00ff4019b10c961869eed462a1595da6d114454f1be5e2ebc7aee623b09c6da0b54e72a5db05bd96686072c7450cfff367d35e3fd01cde5d20872688926f14826165f04d2a4e4f4e64fade79f8d90a5e202f565036fb068448e66fb94f9fdcb5c2e8d4b24cf3ba46774d942670a51253adaa3d7b5b932388ae60669d7c7e97cb344b48cfa1d7b605558de7b04dfd0fb001b1889bc861f4d4af9bc7c31d348748cb44356ef769e51d9c057008fbbdb2531ead4036418b08b3e8eede2c7bff2edb00f3181a8ee161e79dc78edd0350a36a2bd3822b777e4deb937ac277856281069ca5c88db78864cea40b5e851e6d94be2501fd73aca7c601eb4c381716fd3c99d6a8817b1e9fbd829eafd8aab43f90562ccf74a2377d5bb29f54595e257b9dbac85c11e2048b22e103be3a9dc727c1e2c98e34394455d5d6f848bf2441e6510af419782bd715c0f89f108f381a0701691e171e53f8819358f92413547e6d14499e7f8fd763b4c6b74ccd6a881193788aacb7c716f03c534a8c56e9d56c1f674172773ff1d1a78693b86d617dc17cb7cbe12862c7100fa977ad4e37098f98c20b353364856cb4e579261ccce2a123df8ddcffb34c79725c2e2e7de16f76cdcd2a27454193202f1a16a773be8e0afbf23ed354f7afacc5cf6653340a65865e40cc3dd8e8633ba57cad6a5ba759f0e8f978d9a1a26717320cfc3c3aacaba14c4e80ccb6a82960af403eae6a6720edec91e480d3cdd63795844b9f3dd78af274cf64214a2d73e87e9022e42333385c12c05f41f0797ebce68099778d3d459eeafc8917254f47ca1e055fda2822aa2ac933211abad029c64ca2acfa3ee4e8890104a9be1ef9e8d1d1e8900e20131ab39129541f956b84e41feb5637afb1e156375aa841b155c4ed8dd103a9cecdffbe1b7bd20bf80af5766c49e07c4a5e8835a0d392b720b41719befade6c4a51703edee4f7355db0977e79db7468dcd3bac219d89c3884e84ada2e0d93e91885ad16a37d85a1a40285eff4f8ae1f2007f4a68ff389dcc721d3f879ac3a2a0c6bb20ede9ad569dfb555ecdc773121dcda3bbc6a064bc65c67f5279b358148c157945baccd876e114c08292e51443e523dec4456ba6179da42706d4da555ae49d7ffc2465cb61ef7ba35c497df73652665858f8bdc1341afe956950bcf1d6be788bd77ef26fbeba300f31a48e3b6962c4c126686bcfc079561c7664420f021c7d807130ae8ded422279a0c2689e90ecfec6068359447fb7364e1e3b9628e5ab229697eb357abca36a6a2bcf72c188cc65ecd924758f1e68b510efb1343f0a968e3c6caadd6dbf7ce8e4f74d64eeb06f4f3460824beb28c2b0372a05ee1a95645d75e221a5d3066689e147e05b1b013cfbdb0093fd48fc22c75545bdd7752f631526d6ccf89d6c99d9bb1062bd9d7591a4718f2cf16316632cd36075af82e8ea6d14437d889f095eff0609f7e938ec55889e8292cd1900178c2a86b5144cd7d4a0f2eed708cb16dace64e0702469edcb1826e7bd69e0319f28d744edb58c98876d90bfb03081b952dc8c44026fe5062417b25f048be58810b4839f71aae7c9002c5c7344894bdf20b84e9c5a42fd3a4855f4780a9c4dcf49975dab96ad31e3b1f49b5cb4407b930a11af7e2686f8cfa723762d194ab6948b923552dbe59d0a93a964c45791442b96e279e7d03a09ef5fd515ebc97b8ed43ff0cd7beae31c84f0af54a4ddc0fc34dbee91d87a893544c452cb4737d8bb9c760806cdd8399fa39ff13e7c9a1504a1cbc8610e8862f816776400075b5356a535300da3757b437b3081d4d7121ec2efc7af29657b92733f3be1c47d6376722d91f3891964427d8e3bcfc095b9b420e32b64337cb3aeea5bbfa3aeecf0c6af601f79749e0b594aa524030228bb2de9e0aa63d25cd3214c441a06b2d49b1452f83cd6dbc84da4b33f7c40b7398288a457cc3865025cb5bcf79091717b2d28f94c04c422b49369f4c98460f3d1457e0f26bd6d64af904deff82a0c7e6319761d5c204eb6da8d44c874b825b427976320dbdacaa59fd429e947fea8b8209d116818a2522d2e0615c9ac26808ead8d3af080c48b0310b76b0596274a7a4881e6afb0a975c11c7be90d9b52ff2ccb630796f767d0d1e0b460c03d00b77da9f106f340e23932d0e46e93c01a9bde7ebd0fd9bd19bfbc6e2cb8390a308d7e648e4610212c83bf001a04e8eb48050395704517755d9a33463714b8d1e9178c95616a976e7b655582a489a0e98a6d872a79928e3360e46309f49610c52f30a38916c97593d61d6e04bee0f03d3e2d486d883761433131e7c0b4adf04c8a3fbe18824d0eb793554594bed20c44a9d2d83e292dd5796f764b4be396026a43bbb06539fb40d5031bcdb5ea1956975e3a6842d4574ae8b5420818247997c57e59c2c53ef4b7682952de4ecd6c39ba0301e2a63dbe25d1146e9f8d7e88911988a8f132f15c15722fdd82629bde919ec8fb1fcbe9a04b94561ba6bfb8347c7f39ef1fa11cb86ec5415e675b7dba5937588b4d6f8be8a98d3b5eed45f3015f76b1b5a38770725846db214c73dbf00b0e64527308f62898a466617d6a2f1f5f3f7de1a1de066504e7d551324c4de61ece3a203a2dfb14d7064d255123fd03420646ecd67339f9d0958aed9d9a861706a0ce1ce3d0e6c3d1a3eaa7c0b0fe7d6a8aad59ded627d175d57e98c88405bafed6e84972c99ed17369f9fd8431115179b2ab73ebe575917b7bd2c2a7892e510a2f8b1a2af0e7074d22666b331229ce3a5a0edb3b309d4a2f5077c351451066c292ba4c44da02546ec74c7775c66492801ff1724257edd9320413fcf0db78cea9665ee0491414ca55ba3d61e565552b775ea1c6e632ab2fbe77ca13a8172361ca070b6ff7b09d03f2ce80ec622e8145745f3913e01a43b6eb91cc0467eb3c6c65320dc618f710c75bdab79f5c285b08b11c2a69f074aae59632a6a748310b66f303a39e7bfbe2113872cd21aa63d7c5ee28685caf6be60137d74175d062a0677a59631120c6f3b5bc44c288c79c8bec203340c465f74767c39cd80ef5fc68d98c9a90f5b370cf074f0d5e04b1c745ee679ace85ea53da55108ac9be9af3ea91182f439b8c9a5327af1df7baa9d980b65064524d540ebf5fafbcf16bb4b4592bd9237ade3f62d8722656711698b36c8e22ee28c8d6928115b59bf273fc3c72b8579bacbe0f392ca8a8a50992833a9d00faec084196cef1d32bf9176328adabb54117441b8d33cc55f0b5d105bb5a32eb4cd1824da66a920e1e8318d2e33f3967d5c42a8b9f6121a8f7008deaa92fce5755e9ddc627fc0e0f6e69545d987ebb325e3fd6157fc6b3347fd1a6419340acd14bce1fc1efa3b6471e4e5c0b484cd04c323eb1e9e786b3b532c2ca62f0a81cccad0b1f3f5e4817e078b58330655d2d03f952e5b3093370ea0ee563575b92988c12d8e58f7f9a2e906be0c04fcc4012e33ee00ab04112942b529fcc8e2bae341eec3ca2f1eb0e5fdd88b0b7d808411d39c55fdca2f4d77528e6a0617faff833ebd22cecc576af58e7d24e4c366cb0b58867face932107a11236c4c18028f70f3a8be99ee39083d497c633ead0527de129bd47e12fcee98659c8e005e8269295d6d662c98e6e956e3633b2898d49f59d72fb814c3d2256c594a7c70e01c6ab3e28a51af74b2a9414bc66bbcb22986e6a46d71e58bd1912da9c8d322a029efb607e851239da76efb24d5fcd44d6c167ddb68efed7b65cd38729f0c37d650be04c49160d7aed304f686936c6d2b11fbf2841d8d16fd54556cdc5efdf3b176c2a88e450db48dbb4e19342ab900809065142f983fdfd78d5bfafa163e3ffff031d1f5051f0b5fdaa8676c3bab5bda54edf4f91ea6f3b16a86dd5c39c65ec033244ce1f379730f44e3b6b47d77eaeee9afb0805e07320fc6e698cad18be8efaee3e47a80fc2248e6ac52c657df1edff2391f5c5d4542fbc6baf4d8e01bc272edef92f37bd7017735ccd71529f8712d29afdd85aaf13c8c2b4f9b5c0df109fe56a76269e58c9732487166677eea35a8aad338ed2ccc977381a502b49d7a8fa9c9903aaace6ebdac1e865e92bb0a1c924d465caec32b7653d6fcde1e17dcc7000841155a997acc043d66718bd570bee7e272c09799913bc3cd9d8c2c39e20d1f954f64a167172edbc1d0bca9fa4f3ba8789356bb1812b8e5c5392812507cdcc973a083d57dfe7b79bc533511476caff1ef91090c449a07ab9425735ae3bc0f6735cde5ae69f5a8ea2ed7d1c6c89d831caf0e71a6fb026e92443f813961102fb725d8093c0bd12e8c66f01ec138b5447917fca0cc1530f728c2e479ada391800102adc9317d1a1a055a92c6f4c2826306c09c7c76da7966cda8955e2b3d4de5dc86582fc6e59f5ac144f3d2f2bbcf93cf997e59ddf84c27fcf27a017596a8fdb68821db384ad1a57dba797f7e8b3cdd5ad89461994e4ecff200ccc035f5b56bc81466bf1a45c0e3e212a4fc0b4a6a4992f1ac1fbf30a6da34e5374f3b1a1e1c678a5a44ce7e84f3d69b77a7ae76544e9ec0b8023a0fa817a0e2b38a6460c7600795d6b5e711a6757a88c13358a681a761f64a697bd55c23e099de96d1a52aa3d19b85aa8ddfec7431dc3569ba6c9318f077d6c9e7c1c07dd89d0442c2166329491cdee4085a85af4d3cc6cddf407c5492722955a336256dc08436f80d021464d361937e5fcc46b340aafe05d824592feb4ec0552b4cd4e657195032ccef82b0cda94562d47fee75cebc39ebccce1737c812ebe0967a7455c83dbe3547fe1a7ad11fbb2972bc604e5740f34c236b60595e1b6133ea069a6ce6d5a1f00368b5566d5f3c196bdb77a26311d0b9135c37219349e38b92ed82cd79d4be95e8a3b8a3338861a1e7846152a61984ecf745a3bcfac98815cd96ab5600f26e26ff628c15cc27f881ba3705a052cfac4c22214003ae20b4aa07d79c24b35bc0017ca3b8bf73d2093ed6c72348d7e5682e8056ffbf78b781d6e5975228fd9eb587e1c842b1aac913071b39a5a81f0eb232361542ff448ff7845a8227de23d458c3f914b2669007dce3b9d0ec6068fd71d7ecc1747b45db298d0385f9baeb0467b4b85ec8129d305b0ce1405e224741c6e3db044830eefd2f50eefb4de22d332ba97c4de0ae64a5859558b46fe9ec6e9a45df6d67ee600ea9f2560e046a290e6019e3188eb1df71b4cc818fa7e4011d86f7f865ca2cb6abca3709e3e06b2b6815c6845c32368ece6b3a091456a3a9cd0e89c2967f8afce0216b79d72febbc347d64043366a9f85dd1931c882a7c5518774b1f51bcbc2d260aebe1f9acb2ca5d9c8c7ffb2e05e5c2562096b9d485a09a118a327c223b2c457dd44e200f190d9749a40e262fef1b50c6fa8dfcf37b3e0b78c7a80400dfc8dbdb8740db92033df33569ed6e7b2ef2c3dd3e3d42afdc23d2cf5098f6897f21a02ff42883280da58238fb2034e8beae0606c58eebb256d9fccf390dbcd72028acc83563db63464929bd9ebd8347e26221130b9eca8b567c2008002a4b800dbea3d9c2f3ad0bbd22baadf18ebe92b1277b973cb271194f68f3c0776a32e1233f0e0d5d1e20b8fdc62b2d35ab9b2609df6c54b40002b037f04858313b43d713f30a9930bb7a9044f3ce0bd5930da553c56ed08845b93387b46320a2f98ecf393041566a1ce69e7f43b0a9b670b35bc362c51215c7c42fe7a98cfddab619add1a94d931685cd62af4872e5b294f616f002a1e9800966f1c150841c22121ff1b95d05f7f6f15b411d5b3af759bdc8ee13e0afcc71c70b0b202565d64e9c405f54e73cc678ce7adfeecbbb5dfa7375b6e837845ab25fac4b6665f90e2c8f685aadf321c425b01a45635f379fba616c8bdb06cccb36db7904928a4e4ce3e2066e819c67852c30368e0bd0dbaa2e1ea16a2b40a7e83a867d0225ae13aefcb9088c72d3679c56d520fa125af4f1fab8ea30f0b08a3070469d3ad0ae7074c75703a910f94b914a41e5cdba65e76e328b1d9a6301ae8a706178a37cd5844eff3497e441b3fef82411d28a3d7912426a37f556cbc1440ea6881e93b530daeaaabe1816be1d8fbdfdcd4fad8efb11a19dfd701a3e8d8a303bf85fe482d4c67dc92ce5add6d354ef67881b397f53e700d7d984910b973ef9c3afa8fec8f0cf8d67cebe8b965e061358ee13757e9a0234983723480f24caf64728d933402d6f6d96d82e9b72bb6597f3d3ccb128d353bf297581cc51557c5c3ce988e0bbd2e5415ac08a3ec91929633fe21db60ac8e61fbdab36ea45c46d9b6d6685eeb3f328dd4e98b7b47377ba933f195a2d7fb6bb87a299d080d3cb733c5442f1ccfc90cb737112534987c56510f8e443fe46b0df881717b781254a7daf8f4887db402b93395059f3294f88164d8c506531a1e524aa973f58a4b984459a9ff15a138350583a9ac53a2fd25247d35d8c4a0ba5d7a172c40c78a5229e597f5a24760b732207d79b558ff8f3d5e23f4d1aeb066c2adc7b4b498c3ce0ce3b5263337929f7dc9f8586a1451d0cf66df2ff4b29722657f33b9dd4a3171da09d3aa388eb4b45b47743955d4bb23751eaae7a98793b5c789a188f546839c76d65b0ea8e3dd714072be9faf07b0a88ffb0f91d2f5bdd5cbe55f2456a050896edc3b020c0c2718836c8954de2a5db7bce469b3ac0562b2e9a06b10382d85f8ceb02b21e71466f255dd1472e44bd9993db2378fa8f8a8e789267384e332152f63fcc52fe21d0b2c12fb4a117176cbd5f1db16259a17419a55ab68c290d5433047ca7a25e4551d2c8800c161d5bf63f5dcc350639d49a4c168e1cd02335ad46b15f62905194c375c37d277d554cd0324edfed83bc750162ed4b6f80baec976ebe4f596feaa0c45c8fa5f7be0db66b37b7cfe5ec4430bf4a9f4dca7b15eeb8981e7d1e8bddaf39601f222430f58c732ba681f18df403ee934757c34dfbce53a0a07f0f5180c813f98b1efa86d9bd2fa34493a846842565563a32ee7ce92d9f5323e74fd2263aac70b98dbf721685319d013a5b29ce9a260cf940672ec56ef6775037a3b539269efe7b36cfa13f41ad014b0d515822c9c8a39d6fad835b0e11c063fe6272ef415ebb1c5232185b89167bdcd9b57499557dd017783d6681f33fcad90876f384356a7f3f9653c9e9d01fe922564f587636c0713b1fad2ad6748943a9234143d03d5258bbe2f3b9427fb07e09385c9ef6e652ca629140d140d4788a8eeef57a651f3c662404c3af6ce58f1067eccc7e03337ead2254eeb4d0c6ebf1a5842abea14c13bc9269b79009fcc89e8cdc2f85eb645a6ca7256bcded92bd905579fdcdf45b1d0d8a7095fb8abe64ca647d9279be54d09039a47a770354d2295ea7fe30f379482908595b22ce514d12930de2c256be724ac4e9d8bec40f3ffe6925485824598e90a46a5173242a13e025ae0a21e0759883174e09d658a409fb4c1b8a56483824850bf25d4cd5dc07d0e0ebeb76121c15c674fde9e6f74d69f18803b77bff027dee5475510acdb450013b1c2cb6245d746004fd2045a53ea1bcc05e9da9250b551f5153350116d7a529715b9498d90b1a745c56d49706ac22f1bd2c6ebd0622fbd0cb208a2f2850d010d6bd9477b00012bd6e4bf06e8e976b97f34e665cfeededc56d486fdd260e20958999b30e37a24b13f286aaa2cd00c821d7f5fb8bd0b86c732c4316dae718cdbcf4de34eb2275f010866167db68d3dd8b7752d9ba27a13b1e2da07634373c3155f17cfd4fc89a0ac20fddccfc64f81066171375a58181698b89e299cc43a7b58ff89417c17a69d14d5d20c0f230caef65658f684cf9d6a0c2db6e47a6086051887d65280d5c45de4dfdae94bd3b1da15ceda128937a5b3099b674bcd8bd23b4670513afd7426510dced1040a8c06e1acddcfb11e75a6d52d00de35964e11b645b1d93f92b3195f54e8ae4b97ffb1d7581994b27156c2cb9bc5291819c1caa149dc215a2cee8b2949175d1c2190e166de4b27dae43388415f02f6e670c841819dda5fb0cb17d20713265020a224a96d97f5a2c1c20119c93905cb59034d8dfea33ed1e76505c2245c71333d795f8704828bfed1c7836ef095a85f09ca6607f3cd4b90295ec2961da9a081b746520a59ef7f846a8795241a880a4b13c0d5994744551d7a46ba8149799fc416be5c8f87cd4dfdfe0442d60b56d9d72b578e2d48b3e8713ca8a385953a0dd8d38e2babdd26b9ad0016b9b302fa73cf57d94d043b0ab7d5fcb1aa9e7b1a26fb5cee23f0eae1cf832aaa9827177519e9ee6b1926a1c1cae2847c33cac7c88a1c2231efca8fbc3577ec3524938213930de15328613122400703dcfdeb5b083635d4767dbce247fabe2e33d2513f0b143528c7f851c4758c4f0d812739e9dea0638a57ec612de6dc0dd478fba0332aaae2fd37c7ee6628dfbc6a7776323c4c5ee75deb7198d56cefd2419f6b7cef350c61ed7e3d0b7c68f777c2b18551ed4a13327015c0963c24a22df04e22be8623912d5ee0f35d232a9b1dd64f05c3020ded7c301ffcdc376945f417529eaaac00f532a2d84eaa6e7f25e44997d9f30c1d510a91936946b93beee7b199ae892e19f46458963090707cfb36d5652477a83c51deae7d57e0a1db4c5ca1790f1bf017d1fb2d8931075c7545b677291dff2a57831bffbde2b54e976610ae9748d67a9aa88043d6a93167c7519b84867489d72492ec3ff8e9041ed1eaab3ed6db175fc2128b75a9f9a36bbc216c810c84c6aca78d3ad21e31f9cb3f1a118c4f8c400c33234783ba9dd34043dfa11ae55806cbb082a1301334ac3bfa37c919756797d929743d09a285cdb44a9b58dc4a5ed27dfa4d45fcb1cd0430c31bd4ef60a75a391504408f8fa2dce3a0ceb7e7fa826d34c23d831f001b1dcc6749c58684cde0f80df045767ee090346e8216614b1331a6bf98b0c58e7fd2eb141c0d3674703b3ba61a170c1215f0b0c2003efa97537433667c1b540bf9f9c8c5f099f7b65e51a61368c6ed688c3ec85093edfbcfa27577e15953275f0791c5c854fcf9fed9d2acd25fe2c09f29c6c2549f57ae863c028cb8d714e7cc872933e6fe24c068c4ac70dd511d608d2fd9687795e0efd38c6263151d342c8ce6d10ab2a8669daa3cb8b9926aefd1a0f2b7582684cfc9116b80af9e27ef8724cb021f2baf8c41aae9c820ab01ac5ccf7b90a0035da6a90e86e0919d17e031861683cff3cc9347539fd62960ec1d0f551a79f5ebda71a06319b09834da5c8b8c2ed464e8ab55f30c3b6ed515a89631fb67843cf03597a45812b998a9949e4d76aa11b4f6adb6b4a23c0588866bb9ae80f567b3058818cff3bddd1f1c5705e1d65f0ac0e789e4e7e436ff1c5e917e9b8ae589899124990ab1fc9768fd8ea9e5392ad1c752097e7fa13f334af61def2b021e0d26d9e59b8d238ffd4204bf7c06446192e5395975abdbdfab536b00daee1a3799f8f6d30c45810b0aa77e773f96514398ce5d265d7fcd935af435e3407259b2e0b1d48758aa1083dc07059afe959c47cc5f654b6dceb6bba393e5e5aa03fa94bfe69f30f5aff1a2b8d4d0ce47578b4c426edfa26414bfe1fa4aadbedae4becd78d011c63e5e8949ec310b15c44bbfb072b78d31a6f529159cdc4a896bb53bf0c698bcf616817de090e34b60083ae23f85edff549e5b889b483a59f007910773b81f287fd63566a11b278b77e715bcc16a25b6b068c62e3576d42ca580203d04ec96147e6756b452fa7b4d617cda25cb9f361bf5db94054604068202991ff536733ed171d92cd00dc594b0042ced2516719843f2c10b8a2ac54c22de2236b89134614dee39c3627064d06a84f8310e4485aefd716b370d2017638446c81076607462bd31a5925a0c7d44cf7205f891500a8fa5819083d275a2fe2a3de8bbe4bf9db8ce01d491ee1b4388304e1a223cf95ced7f67d97825f8b307ebcf593519d0e9f6f6fcd242a7698ebe213dd8eeb140796e142a86d0412d7df7e8a4274336c00b18514c1fc9fc442574a06ee31d3214c70c88e7c34777acc9de755f3f680034b88248cd05a239a06749a5da48d59e73ee4b26f6f9d987708785045f80bdf93006c2430c4f58738611a211d0771c304ac08ba8dbc6f776ac252d886ee2c68c97c5062b9f36fac79d2763b92b7854402e6e2b19245792a7aff57675144da46375e8bf9f9b4eccd4eb89fff3373a3827d00fc81a7dcb7a44d8f0f30eee9132f7dd77ec7aed5ce16787f816e9d0535099260cdbc3858bcfbbf053933532e8d50780697344af9c685255e6ff546b81e836c01a6b6445c9a1845aabf4d8d41c732e22463c34055507db86a0b4dc15067c4f1e6d5426b260f1b2725946a72f9034835894648eff43ee5e297b8159f5ff86c74e5c567a20d6f4dbdd7a6d87a309a576ada4a8a87c38d9d71c5d111983c60f6a7c23be3327dab25a31535f7084169c5e6c23ff551a3e14ed853788baf74351b955561715dbba28e76b9b351a5656ce020938ba69b2c03cb11eb1ee7577462b211b3a4f4f48ac5023956925de0890362b1974473cd176a8c33ecfb45569aea2c04a324789f8d5d69afd0b5a23a3f7f698986e1598947564a663c2a3dadd910e9e6e991d0a2736ddcf80bb691bc4a54ca42a3413ac692e9d2b215f39fd669a36cffc07f243b3e9619d5a6923c07ab3c3f0594416beeb2e0ff192c3463af74803820e55977d6da61b92baf30f87879a63c87af48ef8f3f6b513044383ff2de4a76bcc9b7f11581b4172479f6801528377c66c4605fcf36305fe753b6148c0feee84c5d599c25b326c35b0a5c2dda834a3e535931d34feb2acd51bd8a7024d3789d192cb35cd68d79f67fe3d011bdc54acce0bb426c386c3a69dfffaf27edbac9cf71d7e1e51e2949bc018277710d4e5e7081a93f54bdac49ca83ffcf704a6c377f9fc86fee1268a774c05d664967215200444150c25603859430efe5aaa6804087a63d7fc0c68862de81be657f26215943e7138bc42afb7e23adf53706ac834bf41bbbf6e29449af763681785e0cc28a47b811b8b032702f668e4bd112fd42c0d51afd61f9fa370326b24d212911ef751e5d5e3601a638540997b84f4cb0237a552a18f5bcaafc1f6b4f6fe784261f7ad82449516d80d9c61a37d16a46a62db11b16df8442074e2a7676ce73c33215f5c4bb12547a5ec67b6f3871c221b85f899eace76a6e1493faea033e8196c9cef17b18d01d851c6309dc40c114e1c5e396b572e96202513902897b9781026428e21d9149197bece759545061142a81a1f40857420a5f29eafdc22f086990ab59080dcc22823ce152453a198e8bf52e61ac86bb24ef1b2901d1ded5d9cc238c876fb329034dc1b003ab392a1943848a87a07f5acef79cc6c5a07bf831a9bf2077038d09db455ab1b51e498eadddc0ed95028142b16dae6ed3c6ab2c3efc43b0413fa01ae04134456743024371f7144d7a8c99eb184a65d9795b8cce90399bbcb2fbcb733d888dd56aeb6fa57574daa3d96a97289a1ccb8a71944e13637da42281fe6f1221e3ef94bad7dc79823eb88bf1f19c87c064054e7de4b58bbfb4b7de5b656c4c5b919a4539a44026b50be615619743018363fa560bffe524be20cdac53e673a7b0cd0da8d0b49167f3ad27736366223ff8e5757acae7e3192f12ee6b2ac35dc73f19f940cfdeef052d780fe954ab2b27ae76e66e5de9d65ff6f2617299ad68be04fd874b60bc43f7e288bbd19f9ccb65b25bc2e1ecfd37ef117027a8ad4d384edfb1f2f2b57390d524ddea561287acda6d910b269641569202c7c26b8d124baeeafaae739f0c7e4ee2e44492bcc01832feb96707a1569a74cd4f403f592ffcca66c7ccea34429d754fdb4fea0155199335a239e8c1c3be25019329070b84d72f1aa8ae59f0cb07f70d73e2517afb20602f0f6ecf257f8b6d8a48611a910d11c9b472ea2bb10a80df4f2511d42531140c1f42ca0a4ccf3c6e4efdd015301d95b00d233192f52998afc72cc258adfaa7d33bcb10580430712ac42c7af4fbf2b02ca18075e921ed27e963ce692b2a757373aa2a961d6f80563322b8784d84360f83bdf7eaa683608ac227fa9a754d9a880b5490acd74c95b8dc49d54e030aa2dcadbc2c2ce3c5fdad6d1a6a8cc45a15ad2124c7adf2f9ffa56d4c87e821d7679182311d49cf8bc4d54997de12219048b6138e2a3cdffd6dc4731bee5d8343b6a1af262023ad51cee411272d6d35845f0435efb6e3b9408bb932ab5f2c4c8f7a5d5bc636a2c3219c8d9411c3486baada37156615072317dd2a91c4fcd1bdb06c1f98092014aa5773a8293198d00bee7903496dcd3d692fed5ecf688ee24d0bd7ad2ff69e991237c83f9c7d349b1809012b213b691df3ba6235cffc68395a966c90fd373219fdccd0850f184029b7848b252b4e1a6a95d4090850d9f5ee195c5e57d64ccdac60bc0db4b4c37c6a020b3c0e24f4e0fd46f5675ec929dd4d423d5284e43b94cd50811852883c168c25e5c8e33bb7855cb36513d020a047c1db54baf093b5127250559782f558e74af450bde9160daf3919db3b5c85e247b82cf19b7e891a887fa70eb2419d39fbca0f026598e98417d06817974e16a45a3fcd979978ea2a2fe3d8b9c117033f08436c7084f17025df27fe10dc91f768f226f7faa82f4ec4857c2f1f70d89b9597939d9f8017ae18ae6e766d472f0e7d37b7f99ea50e904236babc665eaf17e0121acbd382cdcc73164a42254335f7b2c47e3548a906b869035a920f1c9dba8e7d145155a71e7adeba8b0d28ab1a6531efc85ded4f1cd15005b34108af6497fccc7d700422ce8f78da96899947a8910eb235124ed89970d0c797c2fad5c5ed0427792a32b3bc3e60dd7a8dc20ac5e7bc005244131a46ea3f2520b406a5e35a558f26c501f1952d1a5be7ba355c43ebd50d5ace14069606bd2941bcf80b013e07ceb5a4bd55926aeee14256f89f3b41c6334f7917c4011d4513cf717f8566c423d6e9da8854eceeb042730bec0109734fe181d6d172095b7fce3920a21cb33c94d73f681b44b25d1848e9d358db2eae56c19abda62ebb80ca12f8916f21240a352912a4a8e495d779c8496e2f7aa3530e3a2123d46f398972b209a81151f452de9defd22a70afe664dd985a82d6e8c5b0aff37b90867e5c8093f0cdcf874823ec0d8ab4cafedde68153dc542ca47b10f34b1d739b97396203267ae028743aa9975386e4d4057b3d0724b8bd93642b4c57bd395615dfbff94d1b1472696927ace21bfc4cf6f290c2a0aff09d97eb9a6120e008569b04a20d56d5f5a62e451f373c89e28555ff8e36d40eb20058783071a6619158ab750352a4410d7f402ddde32d2005750b42d188ffc3eb27d68f9e6ae47fbd26ddb3842219e2ea04956909c4343ba6145819c7ec9ceb64247d0fc6dd3813ecca2cc900863c81812686e55e35af98704778d76d36c143058cd06ec58f1db8b6abaa06f65cbd7bd1cddfe32b17d218bd83ab5c2446c37f6f27e2f3a112c7780b71c343a0ef1200aad2b8113d847d55fd4549c5883d8a5d2d80dc6630c91178b2f6db43b63473bc27ffd79f8cb1366a37b6f18c685a988e3d20bb1762cf93922d4440e38bbd0a640088d10c6eba7946b11e781fa7289ad5dbc306aa611271d7da8349475013b8afd2d37568ff89155e5c9a867d0f5bade5560a54e727f05b1e3266787d580ef8a281b935e86947ee85d2bda4a18885f43120f80c521255ee94e79a8f92ba0b8abd0e97a4bdb6e166a2d9a6f998445f25e5b7058fdb805f3d60880143237a4cfb8c5a9599116a970ce04eda783d94332ec08e6a9dc7a9c200b402c14726738d65b9a07857f0a990ebf3a395eb19c701bda1f51fc4251d4e797146f2d6a68d9e302daca814cb310c59b8a064e49c1c578206c6c001249ce9b16a0e374e872e3a4d9d00073aada183b4530737d17fc41d878f8855082b6f827ccf82a14ab60502bd6b8e7452269b409f8f1f8df57e69c74e154791efa55bc51ccd1ce06cd32f5d49705e3e104041a25a27de33679ca1ce96d7a261b35b48f67bfeda39c6b02cf0d6713220c213c5163645e7348d13fe6a3c3983f543f4f6bb48507883fface4d4735c3b8cfb2c0233d4cf416533e5f230b56e67ec8ab1b688ada083474a3f28548377cb415d2c1242ebe6055a7eb2d4184175b8b2ec22e346e9faf4433c2f8835e46f1da8e8e62770a4c355ea7616d8698c500b9adda1a5809f931376000199187220cb3267c9b85e6710a6f4ad1bdf6f31f0e234fecf86915e1ae37db6e2378ab1f0ab6ab340c5a1eef217fedd0d4f0d3db3e761d40d2a5768d99b95afe9e84c1d02631193095e8b220e0313916de22a629ba68838ad37926473b67e9a992630debcda39ec0999f37fb2238006d2085b269c80739ec54b314e25edc20b26bbd01cbbacf65d6253848c0f1287312eb9795978fc8ceb8fef19a5d8530cc75e92a681a53e1ecce57cfa0f8e866f8cd5064dedf4e5202dde66d9c1f6f35bc4c7e83cbd6ab4c9ced148e0d3478ba83df93740768958ef822da44cb977d36cc97af050a742f2665de3a87fe773a852a8d3131ed70e77b53c3c15e29bf75eb2c8d7e5ab90ec5f6ed466f65b2435d70435185c2dfb922278d5fe03a50c80453bc030fd041e691605c9210395c7160863eb5e9874f2a2b4e294105ed9e3cddd0ded890e583344cbd6d02b96624743104973b602f9085e7455767548aa967420228b8f9e4a39b273e06a3e827d3ba82e02ad7884babbd7a8d3dccb3b930c3a9d57e62d77770190c9a04538ec73eb5be11753ea323b174bcd2246c802c80e823f7ffa4f5958a68f9d214222b43dde32889906e422fca425fe18786b5d31b7d0b2597080bcf3d8890aeeabaa1f895b7ad4b7c9eaac54030323304fa3fb4ff3af94bf0cbdbbfd92416bae3bf4d16e6aaf76e910e47f244400808f9cbec14e14ceacd6350ae26b6629b154a7e6a25d2bfd00a35412780e4caf80ea17df9a3dbecaebda31259cac09eb43981bd947aea41804883510d13e2c5780e52cb00ccdaba5d9c0190f0e6a15668ad34b46596e2100f809d1cc2f8921ff1368f03be3bd3a2a96924b707d2578cc38b797d11a00ba2f70175cb0119cec2190aa10b9943b72102511e90f9df61492338f46339ac1d6c6abc224bc1d5b82bd64bad1a9c811c5f36568b4e02308cf8ca58a7e7b300108e16e45472e94158f5b60c23012f48bbce2bc1b7e780eb09490030180aa0f7e1954ff97aec884a0296cb64f3a0442105e3a46b10d9d702cc0a3ed8960ca4ae1debb2fb0ad9748ed8d394fbf7bc978ce013fab32af1e2d0e70bc3b6786b3ac8284e6e5eac70785b2307867728a607b3e5a77b1919854c6aaa0f3d23c4b91565d2502f8774dc958cfe47cb3d67efad08ce80eeda0f4bb642cc0120a30fc845d09c3837f8f78c296997ad13e711372dafa40d5811e2bc669bcdda4f6e129b3a63d72c6d627a33ee78afabdf43d6644805a3bdd6fa00aea9462b2755c3973ab055049667fee3469debf42040b26d6eb7932e2454d5770a1742e27e779754f1dbdec4d2514c134684c7a3a7cfc68cbe06736b108e376414372bb1b63459f94493362472f2a98a258cb89042be819e9cba3d322b555460eb2ca416b9bf866ce74851581a96a164f650a492edf0dd2522ad1e12971b9cc6b197230be5f2f5c915008460b5f8a6c0768044c04687596184c293f3b70053c543368c8340ccc979e45ac867d29d1846212324f44ebacfbd5efd4b62741d7207cf2303541630ce0eb594273fae2ff15c6dd93e18d14b0334ae1c86dd21b1639a59bcc69e966a555e3ccd064cd57813e49e48b139c8306dcb574484e1a02fc9435e4c07b115ac016d1c00ea34c3037143c4694388b72ed91c0da9d20d6296365dff4f242737cb1de91c06d63efa1847bda149ed1e4cbe31bc709e769e1e43b3787dfa50409a664e56417d5c2c0caa22606bddb379475cb752dc2219c781506d00599e013eb000fa91a4ae9392abce43f991754fa8820244ff297f48ceda05ecc20eabb0f5069ba3b019ccc99cb90d7968186afb1e8975bd713f9fb2bb19a5e00a303f0b0ddf910f6a8c344955150f94fd35400572f0b30dec8cc5a612d6813bb04a38ac385d0498368951965867d39cfce93824fab930ba0275612fffae62c0bb26c67beaa2197a1400e31e3c2e2db50d95a3869a08ff2eb798c4a0f8cca65173e974c28f8ddc83669d9cd4cfc63a2bf7ff371fafe321e2d5e324e505cf308216ee9a94d835ca9fd467dce7e0a405e481d1636c70e2ba7abe83797300b44762243cd17b212e97996f4d9d0ddcabf33670efe47307ca0b3116167acc3d1e6a5e4ba556291cafca18659e0426e1325660df03c74f0803fe0144ceefbb2b6d23d1422c80b533d5a1eaee47ccbc148a0d7e1b9226cead06acd34891feb8e5646c451f82aecbdd403503b0a632f2c15a4559f8f5e7c4ad13fe4cb3dcd29e504810d4b0c341c3f541324739c338aa65c77de092e50c252999a4e6f66ed9ec91eefbd79c2d417e173ac1ff009f9335edae6268e7de87c54a426e3cf02f5bc39447970de5c27d6031410a5d9a715356c0c119533039f313d6423a6068d5aafdb0d157092012c01b0a435e09ef6aa05d2a16e55409ba2e4065fea6b02e010bbc6ce95c33653c0989f888d7fb680a14682134819c78a19f5052b319fbd49487d91cfb2cd4aa9ffb87c5e8f2d79c98f85710339f4eec3fa0bc987abc9ecade094d087eb7e8e387236572059dd91520c98e1c24cbf714bf642e10983b2858db48eaadfce452d8e59a337725510328d7dd0b829c9a1feb1a3d7d2cf21ebccf5ffb55933b5d07974ff7d0d84c7ce14dde99476c52a03ca0ea18b62991c9682d2d7bed65e880d84daf57d27d1edc93fc1a45ed5c211643ee6fb8242e9a1085d9727d830118e6f958f5482b553cacb49943b11683ef25877be90850dd07ce0d9db5e54a677efcff1574f5b9f3fce95395cdcaae295b9405ece9863fe7d3dda99726c1372235ce26faca5e50a323375be5740715bf2f6b245e058ea039ffb2c785a16cacd281ebef4079fc246717f483cf75664f365fe5093ec20678d73c9b81aaeb4e3d898a4e506b0f356f361c3b38e5f1fce296a1e6465512eb1a5534ae9268ad10a8dcf0cc4cd8593bd2a6aafda9b71deac35a1b4b2d7e40bcf129c06ca72c7e2b3a2fbd262ff0ca0e70ce283adca4be28091d9b1ac84330f47de5aa1ade495a01992fdfd0f86bd1f7aca754bfed7b2243dc70bbf7d55581426b88eb03084d5060dfa0942424db78806f7652a2978eaf4bab7d984399b3bee8e8cfbe4ca90fc5254c988abc24e06ea405b0eb1fd0db2127080715b3fe460be74a370d04b582d12a1d922714d6d990956db0e35c2142049cefc0bce5b2914c9bc10c340ba4401fb5f3c122dbdf658cde17e09810067f17bb4472c3f1ef28ff4cb13d9f4132987c373aa477b0667289ea2b59c4dc43b2db9bcbaaa2213951880916052aeb95c2707e01de4522ce709b3b26b752b45e36ba01cddd9a54f4f617546d1de717c798da44f5a53c44da8c973c5e4130db8c990b3633fdcf1c1f8524dff4156bba69857b0b28798b62f5f53dd99bbc5a99683ee9f8a0001c499b5fcdf87174677bd97382b7ee1d56707fa6f0178ed0506a6e934b73341f4504baf6324346c076bab136b9d91bcd50624411793a43f9b6a7fe1d4f565e6a585baf964e5d585c8120174de1c38081e33d319860d8e23100a8bf9a39c9aad63b09b4881418b0498fe0861b6832a29e13af924bf542762f232793bb646a6b2d370dbedf74ef4a134bc40c94474b641e1bc47e91a6feabf40eaef6bfdd765637dca5c97c19238a35203f306473d56cdc7641da5c51670b1e6c2ec9f5614e75081eb7a43f0235f2fa246ac0ccf416ce5a593beec3ecc5d8718f362b82c24eb2f8e7a191c6fdfcd01997ac91dec86b038e0f2ab04d72c7ee73168515d35d7f7182161e206b8e1e13bbf38b34f2d6f166d233ccaf410b89652e9aacff78e441d9546c9ac917f85e6c8942a6712446cc11e824d9254dbab161b731fbbf809f04cd4f38f4b17d926b62a8be3f8ab6cb134d10eb891230f88eede8d24b15fa15cf1250f8cbfbd06c1d25fa6d062c9456a0e31e02855b46ae3404eb53d6d528b5619c2696a7cc6bedc75c0dde0f577da241ba363700d81054c3fae91439a073e64405e242f716dc69c50016760c048fa0dedcbfce69fb1d57b4de57566bfb50165529890e9fc82b4ae3ca609a767c8fe117740ae56a85b24701aa9d422d8cead67a5925387886cef11756bb4091c97e621393d2ae7076553bd162a140d32f10ca981902de970013e7a058e278d696a9c1eff1c28ae059853ab7ad6dc742d191c8b4bcdc1e85a4922a18c258de308c128a2d6014dfd7be5c7b4a50a5e78c22fe17d6392cfaac022b756813f2ddfc2fb6b16419bc2285f7e21e1dce07f797d341b48c0f0589fa999b165daa72c76f0d6d3c2873b1b168fbbdaad25fe2a359183058c44bb8016b1a165a311190b052ccf9365fb3f5df34ef7971241866d8277d8f53a0c9f0c93e31bd8104fb3223d2c7c5266685cfdcbbf3e09a10216fb2ab502990b9c97b06e93aded2edc78a707f7161d1937503bc64d4fe4210063eecfa9904f571cb6011c558de74804a291b909985a3d2e90e0f3c4ac6ac80201857cd852314c3dcba28d510108bdfa51c66c456d0cffe9ba57d12ab7d322b52be06430743574d42bb8f59c1d2ac29ab602eb517843cc0c837929e303e2cdd2b7028eb152d78b4f981ac231912dfe234feb133a3101c5aa3a458edd14113ed9e19c7fb5c0ae0e0925b6dbb32554a7f04f182794361de53fe5930ef623e6f37b7c6d155642f04639a17f9decce6ab25cfa12cd3f07119e762f9e38b8211d53fdb0f76409275c2caa2f8cb1e890c610aaf746c543b4afc69e1cd5184174d6341ba780fe057fc624e88d0df6fb26a25b523340348acbdbf8d1dce8119c9cd593a88238dce20bea7a8f9612fa46744ffb7ea09645f699a7639d5b1635410cfc90289f52d2b855e582b7c11a9bb6b39b7ac078e498588eadbb134029e4027863e05d3dd7ecafd0c45ab17cccddd6d988c5b5f3f6657f14d8364fb6ae3067938670b7a627470c6e25eed528f41ca40d4727318b0b0921a72a03cd86235bcc1e2e53d5ac8f45be5ce887e3bb3ba234455fb511d907f855eae0e6c2566df316a741876328f2d56979cf6a0d1ec67e509e27936cc82b9c4444f80a0963c44716b2ade465cfa556da51afc6416a5e810d777795d616602b1a71b553938dae398837c8530ce1c232018be3eae96a9fecb03e61b6c5132ecb0b75695a6873100f1a93106be6bc9b199b33ceee6026f0253adae5b461b24dd087d2d549f6cb4d391bc5946fe505e2920e000bbdb2789189bbb2cc3dd08c445fe7b8414c1f9d763fda62d5b2198fabca15629e1746b05a4f5147c776b4ccfd0b1e0b9a6abee8ca0593bbc46f5b137541348e034d21761b2f4587434985afced70a02ab70192ffc0f0aab21378f4449b13105f99d82237735ed03c7e5f541d83fa4384caab8dc3202fcf1cf783b5680296772f6b2167d7d7e3f092905cf30efdb0892649cda90b163f1f58058511d5acfc29e253cb508d87477e1c9065a59dea3b2c3757f0301732cb59ac1c2ccb1dbdc2305fc9f210615df3ca4726db0b515e16ee49a90ccc370d9918bf2d975ffb4caeb72696a6814f37179b879d376ce0a4c6881401ebde94a98ecf2bb1d974483c5c43798263d9c16f5f25f926fb5b2036647a08698b95f655b0229e93588368304c15877d65a0d253c106fad1f4e71efc08919d1fff77ffaff78763cc8a114bc14ff78a25f66df77a43f00e91928132eb8275d63193b396757c2fca51b57db01ee56507ef80583152597a1d9c0d270ddfe6cef97742f4dcbfac1af454968bc7b7c748417f7731ad66d0b68db4e5843d8c5ba0c4ecd71edbd1c2693df74789cf58e4307543482410211174540963915a9c8c59a7bbd66d9942f763098d6a40dc726e3492641a41d2a54d271e569a06c062e6b5097a4876c355f7bda46bc06ae4b2b5403a7fe80a79f1507144f8c99a5cb8ecaa55a6e99032e689db226e024576c030ad7402d4e7f62a84cf09e6838da107e9aad6ac141b9127fe32dd28e23f395d2cc5ad639344193c93926282ed1e727d07fbda6532bc25a571a06b6bfd5be0dde4da0d0772a969207d485f85bf50ca4e5cb4b1375a14ef63ed45c86e71268fd338dc3a80d3bf83719fc16f1abc17275c90a3509c0cdddec90acb6a3d062fd9b366d0f07e4bfbf5f4fabc6428a21474fbcbfd44012442b2fa9148d5cc8232a213987da8c1765bbe35f6341bd6006cc6ce3765d3b2111b0add3e6b1e7691bc04b4e8b345c4ce5b2ac37a79cd2f51190a1f8cacb4c2c05600af73779e48117c0312be52dfcef0a41744de5209d361209ac7532f4368e6d327c0d2460d7b31b294b72aa852f34f03b0e37a56aabf6a293f5142ca355b2c76f711a632c4b42148fbd90d91285d1490fd5d58689e996246c87a2ea906bd08bf6fe025c40577a389b87c78eebb5d26f7819675e8e52609ea36f6140aca1665bc9b10bd266c52ccb9f563edde9bd8fdc1754aab9a547cdef3a087f5cbd317303eb82b100a73fab2da1eab7bdcae58194b608fe23b95ede16ae16965faeba47950804b8707ae46a24b5843e2d7a7ecad1dbb56999c82d30e8b0174a47a561b00953d3ad68f6a2564f65365aff5ce2add0ff345477c306c7636036fc5e63097858c1bb68f4db3d99ca0282cc4b6b9bb4465f8a1fbc0d96c93b59cfec2925d36c140f0d79731c01188bd2f09e5deb4dfdde67ec9825526f4213ad10bdba9516063b6878cc7fb5b57d39b56f1da8389cb9279b1e0b24548d2068e413823c90cee3a16ec46c1fd564ee6d7a172b9af0103aea449db6a765f91cc365e0fb8e0814843ff704d0d601a0a47e496b100c2209a578200acce4d9ab1fed34757541d83325430c2e4810eeefe34081f96a8f812701d040b9f8ae1e455233019dd8fd745d1683f38454364825685f199f3a51eed170c127969a1753d4164a0ea8734ab03144b66c3c5eba96520993c4b68536d9968128723480d14cb220a157bb0e50a35919711cdd87eb9b0d39f15e4453a6f99979d5109c5e95fc14d26827052cc0a9da305f5867a7796bd5422798cdcfbf62ba2aafb2c32f2ebc8d6a5041ba4fe786dfa693b93aa71fd3b81190cf28c21fe44883590255607aa7a76910f3e500fc37e54e9e76346522206c8d8432431ca02912c80dc9b0655847d0f0bb42f9a8b514e2aeb27940388e52087ae7b9ada6ffc7549e9285825ef4eb91c3b61200248d7b35d77ab78697e2a731ae6508e27ec29fc351b098681eb6a7b12f573897684649546a6c48c09ce0f1287fcff83eff764e04cdc35309f38d2ee3c834775482016f5893190e6484a0a155d89e13233ff8662dc96f4c229b25070ed34ebf0ba9a6111be38ba9ff0d5ea2c797a999d5c422656219f404171e8162b1dd1e4667c82f793851b478f55c648da732d1cf4d06269adf75a045f78ef87cde98dfc8b698f50fd7d3643fb75b8a9ec58a4c210aaaf3e9804d3aa754fd7d668906091544ef5652445c5c1ee24dc69d54e1169a5695dcdad8bf86c076ee602c7539402a49c53aa56282eb046eaee173268fd8c1e1f5aa69222a27f48ce5f7e160e0f8bd964615471f88c7afda44dc28f161134b51e8d6248a2c26019a43a96b32a5a475cb6464f73d008f7cc642f9253f8df2173dabbc21619f70901732cf3d075946750eb3987756386b5c9a3304dd6f7b3b7de152010552a9fde01a4902a9bdfca4b97854339cdf3e1279e44704d8677a01a990b57687fafadb34ee315dd331ba169e4ae58088ea94da7debceaae1cc3a5712fee11e97aa8abe8c644acc08a9231f74c79b29886d47c848d9fda94db19487e634e7edb1e8d227b2a41a8c0ab972680021be1adb7ea42a7d340e074a3310a64d31ec9e5855c54b327366aeb724b48707e1ae54297a1847a71ff7683b7087357506823ca669ccd6492076d3085f1dd5ede15199d3799e2e848f57dab6071199ebe9d6c48778c313d0f7055cce5157ffba2ab7ae10615512a2c9a0793d059149436c8d7b44d82a20ee0f6701d69bd1fc02a885608369b9c12466b557e3e0f46b6a55e31c6a7fa07bd4ed9f2866e4035da31f5db04cfcc7006aee0ed538b0598ca3440d652d617adf3b695c833c426c53508ced9155ec22b18c4f6bc8fbf7ed1d66b564ebef3893fee1ff7dfdd4065381e6af6ad9985a8a8c60889e3411f4d44c5a8ad83b1926a7b123682a4f97a2a6e3dadbc87ffdda24281cf7418209a383cf3cb5ebb2bbbec9cda53486cd3251ebc8089e47c067928e1dab66d4ee9207987150b5e61860be8ca1e0fe347e391cdbfeb02f8de3bb58284eabd278b21af7e778ff1b24631ce67d27a83ee3ec87752377b6a644fabeedfac142fad5c97402cbc1fa45afe84429469328517e9808fa847209ff46fddc7ca5cd0bdec38be83c948706a6d5c6e6a431bfab7df95410188fb7894045f95540760ab88bd4bdc3ecf8750a7a3ed59694865a41b5e9c0b19c9c32c0698cce579e7c7526056b4f6fc8a33a00e13dfad65d969857006d3b77732f2c5728d604c367715c13c1f683c3339dd88f57346f134dd7fe3838efe40f6b15be48420f4fafb97ecb4dabe6488deba7eb86b126c2cbcb55b233b8784a1da5f179a7302a2e2956656935f1586d4d8e471c100cbbb08750bf11d21aa009e650dab7e3eb0022eca1e2ea377b171ea9e1d166c2dcdaebe8fbd8a2fcca78056f7e8ab4922b7482a79ed8eb71654d5f5e2283a2725996c1f434884c559b48efa5a28ae82838988f741edb1bb5260f96f44893a8427c8e80e40186129f4e11272704b35a87b900651fb3c05d0777e6f986797666fd40f1a3534ac01d178fbc2698d1e4bd63a807b52c7dec9eac606f2ad2d19cbad29d4bb27b4c39988377370207c06a6374305a17f5617b6d7ca2c87a3d4b0e1e2dbf025bda4763e7ae60f1f2bcea051b2b206e90277659d2eb92e2dfbec0139f6d59e87c572454ecad893fb898b7da636898913193908f2ff3a5a642e8f1cd46257cd1662188292e47b62ae5a16681e36970178bfe97c9ffbdee4eb7ca31e21bb89b15ae7df3f771ce54abf9aaa837914f7c96a4f6cc4c169ac39ff84e25ba8a45dbeb362828b1a8d4e4f77f018e9db2ccb94a14b8945c7548ae779a1957dfdc9207316ed3e100527f9e46b01bf43c6b2f056142a5293725854e44f5c0a6365f4c3b33505ca13c7c5920c358e20b66fd733c37a500c612d764b7dfbe6edf3e0379d43d2cf552a1cabd43e4468bee9b97b466332a4d9cb5eeb6d997c391f0c5df4fff05e3a09a8d96cdb9b4a0000c09cda1df49e239aa77adb53354ad30b396e7dcb34b26b29eb13a9a3ff0dbbb69fdfea4b9ef57cad444aea5c319ffe682920a99acec8224fa5a0121ca0f12ee25fa68a15351eaeaf5ea035d89be16abdd26387c40908656f04fdd82ebc8da52a600c85ccd9a1c45eb096241120eb2164392cd5213a2eb738f22c7f130524ae8afc74eb3cbf19198470915b8b85ad0a3edb9779c050c2651dcf40a30c9ff7e1536b382bcb8f52d4a0446f6c990fe290fcbe67c91d1dea17d25185d444b8cd974b34ab86471be94febb922752317a100ce5e0198d25e8432e47f45c7f35441a462bed9eaed043140a4b5fdfdaf048e946c72457482889f4fa95c44a711da9e41f0256c90995b041c5c19dc9d8925f99af013b8af764e7d85674ad5d49c48b7b0dcc149732bb2fcd4f0da16d7b29850b92d280ada55e6cc15f34a2c9373a6f7b2f99ed43822fbf187167a0470327a2a6bd649efce6541040a2ae71c06caa4098ef3d2ae5bd235838a99f8b8b2203a066b99237e67662fcf1535fa961cd1652c5f095ca83cda7442885bad233c7f69f8f44d258f2ccca37439afb9b71b29bf9b655234c47c5aef81a56603b5c02890e87dcb718f85faee8eb71dd35e0abac7e725ee2865c512d0c6b99e1899cb6201fd77061f2e4a039b1702172a70ac12bba52de5e7c0f3c19f79d9775e31b2936b75148dd776f050104a3459f8c44bf2d7ae2e9bf39ae18605e27cf9cdcd649ed0b8c94ed0451c61e447ed4b5f85700682f44721c9a81971080d48858b6083258cc14b0e616393e418672d767ea7864120c1002c537f52210ba38df16b671f51c10ab15a4d90dd3fd6366fb84334211cccbece9720a56535429893bb6031b1c982205248ffa2fdefcceae9307c36ea5dd45086610a35b75dc10abd755cff2430c41f73c1171b5e1a1ed28ad94bfb4bf3cfddd251fc26f3578f01289687d5cfee2c446be770b7c8e582634feabd05586c253f508f2ea3bf703de4c905b96740e3c80de47759051cabce828fec444d1b23eb3f60d8350ba4b9aecceec19589fde148efdeb1e8cebe1bbaba6b379c40bb9bf05e3ef3403fe57496b62f6c0f92a426e7bcbbc3a218d356dda0f566e3c69c378c7c9c2110ee7686850c32d35d2f0182b5313161d1cdec3fc8ddfeed299cc77e3af7e6dab80d94825dad9873037b1f56a8178888e72156d4cf8893a83d108d0456716d4a3faa85c22de752c13ba9bed9bd450878e855b54838587798397213ef0b4e43e5d6293b728119294e881edbe1b4d3f58d570bea20b708fdb0cab7f6d6da62c078a03d817476290621271af8f0c932e0ae96677af768755ef2887155d5d3aaee5697bf2da74217726b91f232dfa4ebedf6a9c9e14846428441aaaf366c98489529130e7a13558a5e190bb7cb61ed7994a28fffa876181b23a1aff92ee5e0b348eabc5e65f2609546cba55eb268364d58bc0b413c2f09dc54f70f92a5809e6cfee8dfa7355b7b81616e68fb0daf29b92d7bdb9ca09e1f7e21da43705bff71239658f530f7176cb4fb58695a39007ddcefbcf7453ade6d8b5a8639c7ddc97ee359f088127d3f31d920dff0f80a60b13741a863f1eb2760dfba16e97296969cd03f1fbed5c7cbcd3cd33ba0dd59eb2f23925355b94240d33d9288a7b4c38b4b427337e5985ea035c5a1fa11abddc3c3e28f0a9a6fa6341da7fab809ac37e20656a6f4879b3c09595f662aea1d2c6941605a4f7907f323be04b10c68f46d8d3312d74be66f2c05e74398ce3084c0170a83eb39f8020fdd25e296649a07c56975b9f590edbb612d239fb4150612282c07d133d2a31336ec41ea40e029a5cfb7133957d3d6a4fb92ab7e268a6e5cc9881c32428a4c0c413b31d8cfb72ac4557c26c67397488de7a7dfa14114e3383f62e9059a9cbf507bbb99fae2f793fd4e5d4ea1937ec013fc54068ad459232964c5f55ae6e5d54bef14d109c8f43a1640303be09030ab273db459881152995d565f28990edff286f8602660d781b2ac859fb6d654454ce1417a408eeb7c1a44e2af837456728fd5727c8fc6a68614b402c7ceaa4c1e82fed465f6c6a77cf905644aa8505294de719f62260a316bcd6653061dacc518adf78fc7bfde468d06865e34e87cd7e8a25e10a4a9346e65245d13c340bf1c7e93c8bd6ee26a9cdafe3dab669cdedc304b529e8d1680d5d61a997203cc7004f362814600df63298e05b56603525fc0b734fdf1c2ee10409a7b09f7c6471d96878e2b7d6b00cace31441f5a90747c91b4e37d5525449f2dc9e847cac3d8a5319e3e22a99ea18e06f5b3d1208b1fe1486634f4569599f7eaa366cd4053fcae74b9b970ff7b210ccf4d9e4cdbca662131a3a13a37ef4cac35520f6b39545ac622c72f05a4240cd1d2153ffb8be215848a9f9d3dbe91591e702e9a696334efa9c090e8ca9d73991a7dde18cab64cb9ca4ce927aaccf33a13a4c4ec20736a6922b9d5ffd5002da0c0ace27f4a3aff0164aeb9e1af892970ce5f92b6744f3b5b6b6db6bed7e30b7a3bf205fe0c77d0e07f11e920b77df342ea861105d1290e4e0771d2ec7a62bdeff41b7e8039e65d996e5f4fa4fa0fc5b1c71a9e9e62d60aa3a7b53250dfc93d03e966e554a390b9168cd85ecaf6c95669c6572545dfa64fff17242b0214c8cc9b89b8a9489f336b7ee8a4d923fa597b1314d9869f6ce2b4f30b6bf9ebfb3f212f47d4ebe585bfe53bf6b967e5e9e03c87b1417226ae08d9a1e45ff0c3acd523bd1631cf8f06814400da5191a5e0ff28a0c3d8e39635f6e8c614962f8c8f798f8e9f4ec2abfddc4166ac8af9ffa41fc206ae51c5799878938bfabb71c42b72772b9550cbf77861e6c5f4066ee202ece56b4c0d02784ab1383459bf304621820239caa1f7812274e494316a3ba5862fd09a29eb7415ad47a0b62f91f489e2d3407ed327590986f1ef47c61685ddd8fbf9360b00b61df666aec1ee2ff3273c8fb9e2ed52a4576a4ef10e8d7699e60b1936fe822acbd9660cf299fb1c71dc710da54803d4a911e28361b535f5d15d1a1a8235c872e61b9675291e22a001142539e936de81a9609c49fe49eabead0d054ac94cf0c39eb104779501beb198526632b6039c814f5e42a58888135ef9909f82d8d0e1c4bbb1d94ddc2d40e18d7a260205172856a9159299d920c9a46c706a83184e0712046507d613687e650a6fd803863dc0f51fd3118c5818dc2a78b48fc6d3345fd22ae400cc077310e40c3aa27b359cc2f65daef02465c7da02cbe99fee45dbe6771b96eef18aab4a8e45d5e6f30b37769980bb3bf7b02545eed2be815a3e8d11c35320e016520573a04feb155203ae07556d8f517a94ebce0150c8e7b17b64e5b6596172b0dcea2e41e6f5d7701d7d90db034dac23575abc83102f69941b64017959e3816e142dec44f2a3f585f5989477699428efb55cd35394d5a51d140446eba1617b815765f0c8cda8463cd7f3cfca3f2cfb6ba83f6e54655d17e079e6b587217862d8239cd92385a6ae2d3bf4e05aa406f6df84342aeb5755a96b48508c9339eda77d361dc7a475f021fa626370ed08acc9b1a986f0db0e36339480377ac951487d911015912b4a8b6412db5b13926f637825b30c5b77abfea6f89e7b9726ebe39521b2852d64ec7e9db01688ff394b2198d8b9103adab5ed972342861222e94df26913110c740d3127c56faaa10fb8ab1ceb25e493ab4bbc7064c5eb0deffc988aa2287d4c67d46dabc809567a8e3b36eec0e4874aa3c9da01a366a8da56bf60916fd29ed089e48796cddf96e2ae239a35b702da2d40d44cb3817d625afaa20ebcedd4dbeee6a62e421a3f63b3d242a617d7abd1b908b50f361026e3f6d905630ca11c5716917b3c1a85307d18cbbd0c27b0b9086f7484a19fdb097bc2f8829c4b80c19807a17895c9888e4e91599a63b0bde7b7bcef9474340cfe25a61669f65dbc27d1b1ce572cea2f2d03305d3dc9156276c80ca0e39c2c91fca42d91a1a2e9c5ce6c8fc3cc3e17348076682ae6685ccd698513b8db11a62f4a793888d934f9b3e8f5c67c847a9b68de5526ed7e4510dc5441ce89b4170bd10256e46284236a5ce2f60b128dbadb71a9d4c332aa5ec56554e8c8965f082d5fb6b5b5623dc0dcdda2fc96c957b545580e749dd6db8360bd77f9e31e49c9b980151d12e55ca8ecf6400a3d2bd848e0b080efdf1e01138f96c6dddc172237001e6cfa4941fc212c7b974609bf16ae41f926e4fc4b813ba80b8b10ef0171e3c5cdb95bd805c82478e9f08433dd735baff6cb25b6de10509e41ae6216db1c066c6ec7eb79f817462d1e41c61fc623cdda7bc3c28db7d80662a6e74ffdd31857cfda42c7b58fe2b49bfb310a915529eb43bea2077d63bf237073280559b7d083790f21f6cc0d561960d8eb226904ac51d23f5ed02f8f73f903e5709e707e2ef88b1316eef73a7e5747bc617a2476fa7a8f2a44f694ed4aaaa8d1de35ad4b91b2f87c0027e21ee2b656f2d32bb0605ddd9f797b26fd689098a33bd16fde9625f8060c89eeccc4f578d9fd286766aacd1327ec744e2564d9a7f01e7c04570df1631f0ccdd4a6843f82e978c6f9d6bd6e9c66f26a8131b3be98e3a669af58ae38584fcb4ce511c2785f793df29a6063f3db998da1dc32907e324e0e1ba80142489e6491ea62d021affbb28bc5ebf09949277601da7cd088299b18883c852516f1d6d48f88a4787df6c96f3c310b81a0cc2fd29b1b8a136eeb285d8f5e74faf6b24b39e8748195aec9b1be795f5500b1228eb50b308b95b4178895267720f767bfcd91517e20c4972ce0cef4f000ae1e8f2ce42fedf36a8cc47f2ceefae532086252e462a4b1cff1be92f377edfa90ac70063f034bce39c3ad242638db9a8edb3e46214f1bb7643ad5eb95bd5db08478948ad60c3871716b09c7544b0d76b7618ca7ea2acc2ea95dcb412a62a7112d7a7a524ed2066810d3c57ba9f9aa094f82a37d5bcd5a6bd0902bc67e4d34366869f2705c6f71c97c288da85d61b8df5426a5656c37d9dd35ad0294b345203282ecb4556d96f23c7bd07012a53ab50fa04c99e92da4f3f9cfeeb2a3c1ba13968ada98ec2233ad5c3d0420b41cf0f99384e9ca283ff7a7a8d92433ef81b5fa44c41c5dae93ac2b951aa79985eb3c0b7c9d91166d0875b104dd62a6484a2f4c6117a0190b0208e576da74e71cad66adf9e5f7f837ee0cdd14dd023315af1897cc45cdf3e78747e10de175dd6b3f0c38f65be606130cfe2da7cb32ae145074ce556b92f2d69b1b0bd7e363bfbf4c5259caff7e71012acd3d1cef558cdb616631ef5f98b0293d4b6999e8a37ea02dc17236b1c6ab7765c4ff452c671e3f67b8dd8bffd75724e8f36e8d38bb966bb0dedae5bad6f348e4aab5eba140f63797ab2c5c53ec6748ba97c51051f391e9174feb7808d72b766941d74b1f15796576c3736e49f1794cff14a0d8307d7a5af69f8389bf37e8f607907ccfcdd5bc6fa97c042296b223fdc7953ed253a236ce7c00bce98dce884b6bc2cebc4e841a961e7f2ba4feec5b0245813cd9bedc717173df517b0dc1570b139b255ee8f691d63f5659cc862c85f445fa6f3811e4555cffe59a855c5efec216da958a7e79e61947c2645c2c531c6c8c500e4d6b97b3acdfc098a5c7f16846f891959da1b2d21f0ac33e89f4487d319e6132e9a37e708475653f8071024c79c8776e1dcef9b49088926e2735e5bf91cdbd5fd934e49a306a8da4fec1e790f1fb8fc986b47baf844092070c2161ef532255d28eadda4f74b4fcae95d3736a54c4508e86622de3e173a82b0df93fbe77680f4bdb89dcffcd7f34ff5b6d183ef9e346d7c365f43fc4b4f789b16c1ce17201fe8de8da3d589300a88c8ad25c241be82faf281cfdff235937e43a4f467341b286d6477c7dcdba00312889829c27e88e9eca036c47169957884f8eae04a26275479dcf4d146f870c206b0a26c4f04f0c3a5148087d4c93ba6f9c88f5c9ea6a80eda80bc485342de70a859f4b775885a722583591eda5781e45f872deb4d95e80a3bea2978923e06e50135ea22b2bd9429b17741614950eee4940e7c3445f5d201e428b5f1d8bece6dee1dcc98bf5286c71c4e1ff922f70a1a687cc33fb2e9070cf3c4b38d1388342cc052e76c26bcc01a3d589dc0dd2802655c3c80eddb53f4f3ae2688f89c6df56713995d25b155987d99aa8ab1c56d3e6bad282fabcf73d3da5ae1d580a6d3a1bb65a92564105f4ed9082f22aff2c73c06bc1319c8d9a97b2c8b2ef09d4763a17406e4bba57b7cd0cc15ca2547c84da05c19ccd708c2dab67ecc413bfc97a0a229a53a75504b227873f7cb5e05856ff1f0c06a0f2acf210a26dbf1d1ec1d57cd1e5ed0a04a614d51d3138a4ddf2be72f69a2ff04975d7c0754a15e2aa9e8742c8c22466e1fe015c08700e67117bc0c5141f0fedd37f72ee9bd1988fd645163af305d53f3c3720f73d608fd772c19493363faa47b56d53aa486092e4c31cdbd1c3893f10a602f29da9118fe07d814e06eb0cd0a2fb4aabf2626f68b23ba4527afdc5c92fcb2762de40f616e98778ce4761ff274f2aa6b472c440b10c6a4a969b9a142ac1759acff300ac0751e9ac0401bb550fea782a3a9101cd173be5391c9852384c003c9805a4f01c9fc84cc92757d6e814337176763c23ed4109701bab95d5e9a6e009d0d2e25a1111f372141f2d1a8389a62b3724011af663f905fde9d644d476c91957c13c18ccdde2505687c1c1f7f7ee664b768de3ea6a6581ee2f9afe565a8f82ffcb6ec5df8729a352fa69e9b4b725b000808a64b0ef0ea8df906dcbd84ab9bccae81abc90c51eece0637120cbcd10deead7cda32e556b03c978b8edd9e96e7dde88e06cbcd95091e9907014c56588192b622869f8539325165bbc8814520885113e7baa4f069fde6f529820642b976a7ce5723791c27e55632c6603af8d20115f105b1813b64e0dbc4365d9ed8d7427d91ef40d07392857f8f825f2a9f77ad0ef850d9dd1c78824eccdb77d1882228f787619b8dd48e0a58c516597d566c2d3da450be16ace1a2b120a2c290cb24eee330663748fa395412c14cb52d31aa076d2b53481817a1b944358fa8ccde71364af7c13edadfd732975bf010a3b30833b24bbdc55966cb84222812435ad595a52b40548a8ea12fd45c7d088b52ab90d46be76c9ceb1b0ba94acd99f7cffe0656bc275c2724a75abccf450be2bc3f43a516c3c8f80822303f26f77cca607aa8b20312a0829def8b7a904b25c6a1f15232ed633346d0ee6488b058ec55dc30b1f00fd4fcf3bd5666e8de647b607e342b774d066c559830925d2e9ae820085d74b9106937747b4c81ef3fcc22374584b121ccc4971f34dbe00daa934ebada32deae68adf6ffe439cd08fe34777efc86c0c571b8f5686a641e3dcb388bd9ccc4a516edafa5d87cb5c59088cb0d9257594f09e8301173a11b9903392c1c2ef74cfc6be23a75db02f0ca024eeb4bda9a1f9dc815f77852d0c70c6cbdb44abf1c0df3fca60ad048c96f35ebb854735b0297eea01ea4505a8521549896f728604653259f608a7d4fa33480185f09babd0d470fe59706e36382853e6972587d7647d05ba0f4649394a5f2d849bc5006cf6776087dc3830e5ee3ccb0892d47e7a0c8acf8f2fef2577f10de372f2fd586262232cf87371c24c17f164652791b7fad87c704489381bfe770e34c7504760fe943d9f345a4c249a02c1c891459f8c028bb5bfcadc161369e057298b07772ba4b4a01c5ed0dd74fadc7f6abcf137ffd762e5fbd8af9fdef41ed2776e1554724acdd9f0cb9d9b125066fdb34815350a5259a85e963e6a0bd5da15b290622e9f4b116ac5d7133dc5bdc1730a9454d1fa96361470e40554b6385465eb5be3c5b4ae5a7e4649d08ed620eab5dfdf06ba77fe645bf756d9b0823f59c1a1b248e17b1ed1213bdd9fcc7101c78bd3353b8efeb46581aa364d1f62f55ebacbdd4cc615393f3dcec18ce45f47903e66ab3ff3ad0cc568da9afaca26fcea35adb55d6aa0cff2aebe8972488a8b7f37be647bd0533a6e3bff94188330b75fad727cba15ba1d10ee4e75dcdffc6b74549ab50bc17c91a4c41fa53eb303d2ccce71487fed0df933c808baca1963139934dfd7516f499f5017e4f11b9865321b66c3fbbda3b748e2309f673dece445cfcb7955652cabbdd4cd394626d86cf68f3c6339232b8a50a682b0f4c8837733262cd4ccc0331f094666dc914e3abccf76eb17cb2d258dccbfb58600b98b20a366689efd70529b721b49e7041f23f468c8e1e614bedfa6013f5c929283a61a979d4255b5ae0e0add2863f1eeff8d69c3a04143aef6eebd598173451f4e9daa10b9f76f7c32473b9bc5ecc5fe7fc8c5159b04c0882abcbd25674dffe3435f87f0cc95c8388e5a3fb605d500102696712035ab6bd834ca7adfec86216fb0f3a6081c8ff0d8f171a48b9c391ba5a7a100d5ae50fe1e4209d3a9ea82e1597cbd8eef50e061718c99123d9aecee9260b4873d56a594a3d4758df44476e5b8adb6e397ff0ab20fe2516ecb7e5acf662e6fc63082d9480434aca4be2984867e5a689ff76e97f1d2c3cc5f74d3d8d0a5917d80af41731fbb4edfaf0d0a0c322379a0c8b586c1833ab2d006e2645853c2bab9383e6118678ee27729310f07fdcd0200fa3ae6afabedfe6a0ca7ce36a08ca07bd5930f72c2eafbd4edaa41a496d4c0470193f3c52f2174447e71d401620861a48a4f57e00ca2925f41dc19be2dba262ea2a8f3ddb8331bab9f4ddaa23b554b8a04069a573eecad801d144a89851c805ea5f9f4683c3a9f01eba508629190cc8738662e3b9544d9ddcea4be6390244ea185b3ad186e04c1ff398cba4ff12187f77a4fd1aab40eaff5c28ad5b60ed3ca14f2886d6208323544af7b4e13cab88fb65d15eadbf81173076f86f04100d94f122648b04644ca9a1fce4939d3c03f243c6505d4d955435742b1f66e96d630853d5a215b288ed169df060b88917746927f99063bbd8eedb8525c454781b64f34dbb90ed59550380fade1e86ea29bb76ab629c4bffe4a1384e8f24286e4d28c53d96a65e611d7871f4adde939ea4373ef1a13e0e58499496adf957ae2aae1ee3561a95e14fbbaf5660b1027bf43713e24cf0a0fc5f0711f67b0df39b3b508ab1a9a3dd03d907555ff584bcd7e3a6eadc5f1786bef204be55d447e5b163f4f143fbbc50e55aeb279dd48f6c792036b29f218ceaf5578ed125f3d7b201a28087050cd18ce181677b37d01f1c03f71b7e67e413bcbe86338462d5ba5dbaf6cb6d30edc7a4ba6a06550a03cf35d44d0a474dafe900533bbb86cf8882318d5916f3038323542a81ee309861375f100101e79da93482402c80ba684b271a73e7e8ec23d19afe6ff204ea9321e144f0f6e01748e5b2f179a3416454422bb50b678ecb599596f1a5d88bcb462a23894d6e91991861ca4c8e0655e46e5c9a456736bfea3feda1dbf81ce1034936e4d81ae17213993fa8f4bf664abe6f4eb3167288d103e261a3f39e773fbff5eee749f54102831c4dec2ad1138a8374edc718c0608e6b8f1428c177ccfb6a1968c232ad06eee2b96d9c9caba13fdd15b46fda13f370e62ffba4bc1c729ce182c6278b467513b6b365b9756c27a4edbf789b0996ce3a9f674dca718be3d50526ab2e734841961818b59a2e784507a13c17f40e9cebe6f6c10cb8870d7d3329a02a67b8360d7cb77c9d52b17788f56439eefe577e1acf09663733aa17d7d79804029d0509b82c40f06701601e61afae84abd4c3070c1f4574566f30eded8ef7197c0001e1c24ac8698888328ebafbb46b9c38c4acab72c51f5910bccfc9e554f6c2cf3a2cec2f3a39f6487bc5755b361171574888b33a21a1e08036cb8b559541b4b1908191412004998a48a885fc29dc1cadbf5116fdf4d7905fa402366fcfe721099b7434aed46cc9cd8e8ba6402dfbb23fe22e16c94fed05fa0b8b92c9a70cdfb43585f7834d6581e693a895ae0e764a11cb991773da44c81c7f39f0127a1eda4ce7c7e6d14688c63125c367d746d51b3a04b54dfecfc0834398e9ccde329f63e61dadf7be8b5932750d52430cb57e189083269131b7b482139f3b432519272e0cd8452e6a1661df2cfabf26a21d5815721d00eac10a1305ead99f5996b4a58652b4d7937c1133d9bcb587f8c3557fea86f652349e30e689a8a7ee426a60522758304cfd78d5ff7851bec28f23ca46875ef8aefd28b3c46eaf19637e42f92e7ec05deee25b6644328b774e52caadb06a13003bb0fe1ff02319abcd84853ba974d47e37128b7e7557f3afffff2e5a02c481cb31e32d26dab4c30caec70b87884c7dddb427040eff34ebc6a909b950144d9e08c850f3d088f773e07331dcd4697438597906e04400866d3b29f8eff204e596ea9520231359170c3f866e964877dbe953592bac4d1ff213a52e47c2d9314abede1e1d99167c74471d4368821455bbca44186188dd2052c080876124c803af72e8c2f7fb9cb14af1fea4f120a2f411a5f73635a8b00199e283f21af260ca8f5ffa725d0327aeb24491eb576076cc700c2784146812121fe798b8c8262973366163e4f9d8dc6520e48ec87efb1957bbfab89bfad02bb430995c5cb54b4ba48aa63b6b4f0bd18210b8f39fb3d25c3ed7192d760f54957241e759800c0935e45b66a881d3dfdac0f459e26d01e6910281af223c4f8ee10498d9c144009d08611623bbc010f55914de6d217b6749b4c69da0837b8d4981e47f7fa53edb28116597b53276a4b09e3862b9a84c37450cf2ce3ba3be32be71caae486aaaf79c99b01cbf464fa4f606c0511db457f1b7adddd40cd1850db6f174b8feb79121188ea2f98ca7e80c90d4d9ca877f03e8e5d6c8c4a6a8d090d5f835b73041c6e51d3a78fd3d5bdd95494225eae2d035a951e2e0f1e15b031160f18f9aaab43de2da3929d201f40582b9bfeeecef0737a1e769d481861bfe7f4ccdd77a550bbe81aea1cc6b156a8d206b4a51bae0163121d8010820a3151ad72dbf32f53b81afd8eb9338dd0423cb2a396910563f9e04d0f439f419196f7d61947fd7202b3615c4c32134ac84aca089309b05e0de2684ffdd1dab015aa802a8334db0a7a0f4e8909376853d3c2f3b864ffab6aca7a523de36a3a207d563c0b325fdc886e90aff10e19ff74885318833b27d7f185962c9b003d505b6f1b871fd246a3dab411ce93c773f01e4b4f29351bef0cf8b98adb5fc6d60392897f56b62e4c6dc0c770299778bbf6a9b9a76030d76eda0048110ca2df0a5d1f4f5258db836e3c74b3489bd4724dc147e9791963df67de6456773e16bb242d34abba1d4e0ac4d43c7785b943fdf6779982b1738b41849a3355a54e36e7e2fe7553971e3e963f455e9fdd42745e8e433633a41bb5c0115ea67eede4b54c10910e957db26cdf1d84fe2ac2996da165744aa4b3a5aa65126c6b13bdc7d6169622cb49e97f1326287d8fc85f9162c44799afcb22d0ed535bd8c0c7baf2c06221d92f449bcbbab48e129b8afb8d613ab9c4759d5187297cac4143ffd848e463f98683acd78a5933ec74d914a90c7bcb9461ffef7eeddf7dd7bf47df08ace71178c5ad856f5c060b76e7a7499201da1aae0bdf1aa539ee7178a470bf5d7648c9f978974260708c80d19ffbdf0ccf06ac2f372f5c620638c6cfb165d14a6c65cec31da980492ac506df24b1eca33471e97cdea0f2df92f9b333c6f17dc09615bb6d7b5185072a841f26c49cd0564052dbd8b288f02e0e451fefd38006e013ebbbe9ca05c70902d21fadd4a6f7ad43cfb5f61c8862140cb398b9c97fcbcf15d9fe3411127756959b148e5a80e4ac3392eb3ce5a6c56270eb12f081fc7402807974cc8691afdcf282f8685209edab0ea607470f8994372c5807997c756614ac06129b56cc6301626b4423a0fcd7bfbbdd25b48781ba391077f82bff1b9c6131d2e66d6a5b24be123bc5b47b35300bb943f4a33105e11d9b742fa346ecb957a161261a07839f3c2a8a660991a27e74002d702942d59c8cd2cab85f04de73b4ec72273c163036714c260e68177c605bf1d1fb267d06e3528043ac8848ce096a72354830720ed3604d36a5610783bf1fa8ec1f148c6a8160e0c249ea904f5a84380e2cff57a305181fb7a33e632e7b603e53b50155778cfabbb4c208c34f482ca10cfbee0c92249267bb6911f2ada1bbb0a837f86efdf2a272278fc777b121bf5ba8b0fca9af65070905d60e4923ce59291d08163b6d07431415359d9975b3127a7eaaf4c20d9fdf81dd584fda0ae6ce1d63551f4e80bce17b5294417bb5ed725e5de6a90f3640db4e0036b5dafed017aec2c0f2b15968cb873ea5ca1c028585219cbed60ef4d4061300c5c1046489fea6014ff5f95ca52eee0414e20e8e94469df5ff0d0d955f9f75b34740bfe366ec8d41e1bc9dd62d5c175c6cbf2b4b5604bb1a58358d4a20ac6d45762b68b928baadf8a3f696c44ef3f533ef0b1677250e32a713f0b5921313fac4503151c7dab6638bba87194868c362b8ec74535f086f052c1748f5bd3ae369c8851907e52fe7055c182e6c68b26ad8a1f029e7e19d1570660ab75b47da961122ee89040c7368cdfb1e2ef3c72d1b26abb602eda81465a38977bb68e8b949e9d4e47e2a0269b184dee2b8c8298fc92c9e2bcb6aaa0f2781ddab89f83376a05dc43d9dc35e98cd0e272a0d2a2a7246c1db6df9b210fcea1a2cb8592e97b88cadc6331209ef961b687a04aa857a5d1fece871ec3d430489d8409c8e2e9b19ec9cbd7a2fccaf5a9dd15f1a95f8d2af940bc72485617843a4c1ab6606678d78406876d8defcd9797eb3dfdf52cf1d01b612e9d06dbe5c3a060028d143d810b602c59951587bb1098162edcdcda0df5bb29d2c9e5290581a2b44acdd74fa3755bf02f481405f6d664c5106dee9dc9b52e2fdb700de3822413abb2c4ebc96d2e9b62503c339c75596f0fdb680dcd88a2cf04d18d26f7974bc054cac711d60d3c20271a79163d5109dd4736d5cf337f7d08c57d6e764170f296164e02bdab0b90f2e35da337447f85f795dc65cb8e82da740fd1c900d8a1090150299617b34c6a9c0a0ea1ca4820ddde7bd487a741d22ac600cc794d59676c5290c6c76a705a6b66278cc2d0dc381a3acac4079f3db7c45fcd4d532b1d1415369f4ab84bd05f04d82b37901fbe1e2039fb30162251278898cb52d2ad0c03acf44bc32891ae14199ffa65c3fb7b13951fc647c25c3eff0747769b537f1a977058de29042a12ed5d227be277f762039ce5fd24c2d6aaee10aff4849798719431a3a318bff360a3669cd38467daa16a66d7152d9ce00f2cced079b1a7b7e569768ddbd5e223a3556f32a3efa06cc291b0a3d45b129b8ca8a8d9f6d5c15ea90e76c5f9137ce7241908963e949e6919196d65a5996bcbbeeb367b55e6d9ed2779875aa2aebdf901e32c4c3f694146bd84e99a9c2b5d314e3d6c1bdb707c6b987db4caebd50d476600ee7039d1b9502117e912b7501c06591030597ee18b8da2fb837093e08450a28d73ad55f1fed5f28a8224f4532fb27b2d4ec04ffb89fc96ce1e8f441b669f147ad60c47558214842701a42306c8793ab2e39ac28e73ca2e716acc2f941c85d7d6ebaa49bd91f7a2e9c713f3391f2e981fc7172d1d5b27d6160ef34c3ce654eb140e80825e75b4ef90ffe5d0aa6ef3fc8f77a5534209abe3bb2410cb8bbe602c9a3876772d4f36dc8282133e76ca9d418d039af45419534945c35f6e85be4b65630473fcb684041f206d5163ac6cc80d8d3ef016aea3b3d0182607f22637aa80f459abae89a8a6cc6fdba3e7f475694b66aae7282000806c7f7ab8b67f3005e754cb6c41b2a621f7db9588e43b592b616f961f5c334c5450b2015c8c2d71de2cae181108bd311161e73bb56651360369c9d0402b99c4a075654d3b104f34688f48dc25bd90d3a8c6b58be15bbbca1cc1d638c4ab05c0c8b878d3ecfea41d30f063f1d9d9a1436dbce0875804cbb432e4815a4d3bd5df0cedbc6219ad010f0e5ed6d20142faf1c1f5f295e0d46d4357674a71c4b4f29e01385fd03e8fc56655f9366a3d601d364bf13162b3b059637da1f762773e5a13cad336fb0ed25a22f75c83a9b7b267731c8d4a45abbadb8e2d2ce3262aa6e38e1b2ca5468288fb9bc8824b3f082ff1ccf365d4f10efadb8311beca8739cd71b27fafd1ede0cdf3cd9cc85e96a694ec2a18969f26b574215a4c3666924cb25570b778063e1696eded8f5ec3a048b741d7b864ee5e13e0af5d1c0603adaa93313cf35ed5546589781b6d7ef11d9abc1a09d24a2a2a89ac928d8797c5605df6669723a94894ffac90aec6574992b4a01c646d3a50f6a63425e5b926a2ce68626f083db7c690d7c8b0c770ce8dd7714c418cac9ae5c654b80dc988694bcea21207d2c39ecd49c87f5ed5fc14c90a4ca74af1a8fd3cbb79dbf315</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="Hey, password is required here.">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 杂项 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/4a17b156.html"/>
      <url>/4a17b156.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="cd1c11f6a838d77d2b4d8ce2667856d65ae3c3e67131bc971a35b01780a40bde">29bbbd3e11357400de0d36ca5de206e2df0f915bd27868c9c6c7759ca5cbc1cf318a1baac2ffa6945eed73e18d314368af2c83e7edbc4fb98c70f5883f75109dd3e98ab5996750faf9c9997971168e02bb51cf88aa33b542d4db37d519a5ccd61863c529a7de2ecf9e19230d736f13c9b94602190e8f4c1c768df67a3ddd30348a988aa4c9c4d83401390ac8c378576cdac11755f97acdc1c5a59fd97446a9da2bd974bf3dabedab7e52bb426b667a36e4cdb867baf6a71fa7d65e98b1010518eb7206868caf15a37dff8e7c8822e08eba3be92c3a50a333af3c7d8b56b670e71f9adb672b02a880c3c30ac222b263e474bdce2259692c40a7edd813357bd5f4d6093985578cb907ca16c4b1d5ca368b408135a5ef50225fff2c537abe801d7deb238cec28e263c1fe178faf8d9da527c116787ad653d1038e1b51b221eff616b1d3af5c7fabd3e24573f4146d5897cb844cf2f579bb507696672e11e1516651e85032dba4f7608527621b58396db417340af283fc2514f5dcdf7a863b1b367b765e37b38c240c5d3ae7bf956975035b5dea5ad9d1e5276976d087e49d69e87aeac8ce4dcfc7acad573962b88a78d24d2e545514563917a3f3c12112e30382f0449e1961401fb7bf4204b3a35a10495c47cb499bdd8b409cb349b5b5fdb3d611622b5d53f6d0ad6953075f8661eb92cb954c5e307a6224d35543cbed1f64246d76c5d840ad9c1552c294f206422cfc1c17e13c41c27e2c3b3aaa4f78f740949019b3a5961b4c4f49ee4cf693d83e4ffd55dc5f7c6ffd2744d5130ed3593bd999ad610bfa7e7d30054d7ef42c4357f6177297430610c10e3c7b311f375c9868a20d93bb36239cc9a1fc277ef6d2f9417a37100c3df6c3774a5456133c7a3b8e01f71a8abdf4161064f888c576d430369f517ee113ae3225aebff592c29d47192b2c2d7b1df7a0696860f24cdba14e83562684c57f88183255bbc4fbd44593f5303b024d13c215a601960ed8ae5a6ff097f90c29a92b60dbcc0f4bbc362ed79d648e1d628f561c8911890b1e8b6a412348146dc9ca5fbd762135bb3adbbc3de6688bc86e853d96f7c5cf1cbbaa3dae5b0d2c2f8d34eb2e7ec0c94290095fa9c1ad57adea5d88336faeda2549a6e2c02a5d994a985346836bb9ed9ec57121929e0a6fefba0ece487e6dc732739118d8d1d655a055f78b5095a96ac44d4ac158793171881dea0661c6bca36f8ddc2000d8fbe45d2ed2f692df9badcf62dc85aaa7f4318fcada5ec8ba921bdd337a8f6958442f775064bd3bebbeb7f07594f27c9fb396f2ffe43866f7636a5bbfbf8a374f73fbc8c80d61ba7350849e0f6a3d2eb3c26beaa78405950f7a53951cc3935af3b0bad3b875fa862613ff712933498e7934d3fc241b1acb11b56196a18655422787b6290181204534614590d83fb62da34db72f3682183646df21d363371bbd1188dba5e272f780fbd2267492bbcb237f2df6e226f9ec241dc2661777537b2ba43fe317f487cff9ee127c853c82cae930c41cdc9fd4d4d2274080afe62e31893fdee046bc56441f51db964b4e1fc23ba8956ce36ebad9c1e434abd1737b14b2d27998ce15fbf7a9ba76708180ef39c3a4024ab2b47389f33ae533b68852adb5cfa3de2870439f17b7a5774bc461892d56559df994f21ff554f1df695cd2fb8e9c49e4599013763485eb046fc488f8e909011c35240f8bcca99533a7147ce788fbee4ec0edf68e657079fdd68f98a18194ac0a0238e9be649462758aa2a2ed29e36b5bc52e0f6f9507c73b6f2306f706c6c1800871c9d37be0078e8e8fc2237801c5ec743982f3d86b091757bcb15f70da31ff7edc8a6e9fb6614a3dcd8630f32ff188f9b477102fa138da114dc4dd575e8febbd687d66b45b535714704f0d08499234d8478381be22e48dde9267986f0d786b36516fab933d7ba2e7d8f302f70db81ad62bf2ea0a28123d1c1720867fb33de7555f091e043ac13e6aa959d794e22067f6cf263663a745cd2fd47eae81f6e630399b1f54d03cc5232e417cef72d3e08b608e01564f460aab34164ccf0f9a8cea607184e06d82de558f63041eb813aed6bf590e950f4cda87f063d3638cf121f1333c374f6189b0c131038322129d9ba91712e2741b44879169436473460ac8d4ee13b9fad6faafafb18777191a5be8c924cd29ebb8cb8056ef737a1c160cf379dcf2e57be53856469a27d2db0c1331329d79ddce7b4ce2b00db014e51f94289f36e2913e924d738733b598b0c249ef378d1b2ce36ff687cbe6c772415843ba6f8c7253711a16e45b8ad7cd060341e0fb21ad89a79390a0cf8873781e793b679dea41273a36e8a6bd832586f9489fa7c59950ea7ae39b15a84e6a03773cb1342a6667f7ba959f546332c678eff11bc909821fa98314eb99878c8210e5f28ff03cacf435494accf19a530a49c3cecf34570c6f2ceb20b5a4dec8e4cb9c38561f69ef4a4206713264e6931d8b36b4623670b0368e215ddb9a7f5ca687cd46770a43e95dd3eac30a9e78324fdf1e356aa0afbfe8f3d1f64792318ea041aff145d139db41591c74a009310edb8df5e1547b9515fbe8ffee5aac2d450485b0d87fd680a27d0c128d59082f8b99f5a9e233b8823c362ecea509cd4e5970536c7c2181c3659b317e8577dab18143db8c866525c69e565f2374124e84fb1e4df3cf4fb05edcc2a5694c58d0bf67588e73936b6ab88ce0d8a468b52192486bfb303d01436514de037874b266ea9d74d9ab9e84af67d9fc6162310af916cb434a217d16919464e4d0115f7a45e111c7bbe584b91df9a4cdb29c5c8d6188f5de589b702475cbf721c2a80772cae64fa3f1be302200604547e035a042bc8f3b97b1b281eeab0dab72e4cff8fcd15582aa8387ff02c266010e2813abfb25d848a97b6311f0981626b25520bf52634f47dd962fadeb88cd9e78e02e7b1879e7a5e038ccc662bb741ab3a2ebee89fb98d520a41f627c78bda973986941f8430fc764241ec1b616b1326ca3a9ea4aa3dec2fa84c2d893de9eb667ce028c5e594e6ba06f06f5b0c99243a3c2aac37f69042b9b71dd4b786858f2ea7876e719312cccab0a9368d6cc1983191d1eb43064028d0312bd4095cf917d06224d3e011ae587581377c25eeb17d5e6ef1dc642e47f5dd83cd2c24d8cb775670af5302a2fdc1311f9950ac7116d0470c7f122a33f96419ab12550ea36a137a1381f08750c696224cf87cce45fbf4bbd336b51638c619d42c51a4bd77b9e1b05a3fbb553fe37c70e9bb42977710523834899365a16520e9db9b7980bbad14920cd9dc32c1fe13c3eeca125764e820612961f6cdc69c830a1209188faf07bd9e07e683ae1565446df0f83bdd5adbfe460542e0ca2ba071c4a44002a6eba9f09126e1b7f1de484437ccd91a067b00ccbdfa211357c5e19a493b9c798b95233acd1a1f6384f846ddd907277df963172b430940b9c696dfc3068eb795f195bc4f8915ee98527f2c62d74bce977dbf34cb7ae396affc6338d8b05afd2a1a6474ffb51f757bb9f5f8f895ff628174edc9c6a49fa569a341ca4aa23d98d98585ba789892f8ce2a1541cf640e5fabe10d924cff7e5e482d8be1ba1b16983705496ac13171f695d847100a7976d447713475d121f9476b55ac4fd2ae197fd5411512a4a0047791a827fb27dc4567513bdb0ae3ec4123202ea0b342a0b18b538ddb18f8974097d040b0d12b61b430ce9c9252bc3bf68ec4697c64dbf668e25e1567e861a01a9a14d29322706db4082011a53c88bc2a53ae35bda50eae3c3e34d62fe7486622c4709e029d382d8b17a6215e53c1e5e97f18aa16c052de5803d81539b045536581a99761ab4383468487b260ce25bad6c39ee2eb04cfe21ead2b194ba1687c1278196c4f51c03b8e92e48fc30343bc8e0e61a2c441707f2ccf8d99dc3719dbb11289d41499f806f06f4761a2635b6daa820c636b28ad338f61236b12d132505d9bf1140d4cb7d10e59f9dd0052b77541ad40e41285577cb6455a9eced1408b81980acbb360154077245aa612c08f9846cb35de687764c7144df0e094478a134f9cff135be53a1b74636aa302f1a98b75f367a124dbd119dbf93a0050436d32e0d2a100b1caec3bccb9e395fea2f6d263e1e73c41669c2ba246bb3ddb9234e76eca1735f4f468975ac10c165f5054a2277b4fe4d9b34e96dd1ee9e1da91dc85267057d7c4fb48d71096c5410fbcd4f24b5c25dc01076ec4463db133ff6c7965125b26a0e1295e9e29040e69a2fab24f706c3b0e5b23337b879883027ad00305fbd62bafd8724f34f51315dd5d930d5f147d6f0593273ab0b62cc7ade71e0910330ec359606d946ce2e04e130b3c634284cdec87a2c8177bd7f4a76d53c8da97eda87e4eb3d681573d4fe84d1a1f9eb5278c687e263ec63a0b737785fb6120efb2eef24a47c78b2a1959e5a1d59531a5ebf9c719b3b0f1bf172e59c5921cd42ad69eb9880686dcca8df7e8f7176a42ea4e5b8663460427dc3c96496ae1db9634c5b4582944e7b0bc6c69daba0e6fc41550f7d4215f515867b45067ba26dd3af08d809881608c081783cf92aeea0d512d9c7a9df0c05cd2f4b5f308a6ecdfbb27f46715f096c84c83314fce6a1e00b4f644690d422bd6b4b9bbb012aa65252b86b3c297b78a89c63b94e3500d0e95cf59433a54110936843c9249ac2fadc46f70f3303bfdc127b18b2c818b6036ee300b23ae4f85be5b5f58c2ae3877dcd4ef841d9de9e430a492e1609e41a99234ec9e1bb6e63dced00b0c4303ef7812738d12a97b0bb8a1b80119fb723a0bc61f12ae699545ac923b7227e8494096a594fa3d6d98fa21c2051dca6cb93ecddd57836e9fdf4488aa1d4b9b8ea34765c728b965e8d93bdbdfedab6be7a5b031e1e08395de67bdaf43218f10a6f105ef9ba66799804114ff07cdb51bd880ce7b4a5ad8c70e5985d4833e1cc670e49a10b0b4621ada53a4c7ed2f9244fbe2f5144b988ae5ba5e7ab2cee2307eac2498a12866ab8ee612ec80cee5c6744c191341cc1fc3fcd8ba7db6af257ba31bb8e59095912b24b069198997476a2d55a2a22edbcf8f726e23e74c17d21912e44fecadeae575e9c4c352399a8d606031feeaee6809c1cf14f42335920d3e1f1c77a9762c8b9bc76236fee59ada6170fa822953dfaa07631fc115a56657e2efb4c2f318e45205aa49b05c252a55c1251a7557b554cd427f5e1a05680adee7626a8b4384c9a7b82227e17e43bd7c2272298e83f69d0cf090f3fe70b32478601f651cda3b65118a32cc156710eb1278eedefd627a10960aa5c6f708c3b63b9c7b6b922f2a34b7e20790e88bcebe61d9382c9bd04f6a382d4f39faa1f5c83507091941a283352b20d92d53c24c0ae7ee99d2bf8b4f5c4e120c26febe31bc57c708d325cadbf3d10be64b365b13cd3744efb11d085913799224481f66e62832fd98dbd2c9ea6cd06f04b03e785992886db63cee08f616150c534a1cae9c1dfc006ff9c49c309be6174029d1924c926819560f7fe104329b9eb4f2cff9eb639b5194b8ffd6a6d4e9fd90e0e36dd46f12a298d678c094c8b5aec81d63fd1019e9acdce7b62a84e7ca414949cf3d0356d83fd0f3019230e37167e018566dea914d8ac6e9c7f9f1715b4d5180310cae6c03055cfb3071cd416f479a15f1a895cd12233fd5338233ff70551eb1e44427f3adef43a82bfda1fba1a089adb4897ce9e4c711fc69102611275b660d221dd92147324755dbf178bde7983cb307bcc359628ac665aadc3d99b62e8bcad539877ccc28ec650c820512196128fde73ed4eabe3e861a01b3da9e008256d46f89cfcd5a237467c9ceab923cf8f50956bf81c07e33de8287027ab52538e7057139ffd8b3735dc9afa165d242da3525838e1ee27c78874ff6e2a4138f2e2eed3aa1a0ee256fe4bf438ded5328d25de67b2f3dba1416c7b8c645d5bfb26bba6195e7d6a99ce513dea02ca23376f7b6dd46033a4b54001ac9d3feed39974b601bde5224fdc3f81ee3c04356ac0eb6b4e95a8ffdf70e6284b66633284ab623aab36830ddef228ce12d59b48192c9bd6c7abebf77f217a29ab6d0dad226fc41b11b205e36359f36f573a7af677f96a37f5bd3ebcfa08b164ad14f12460038b4a0d3c3f5246e71035105ee7720a19cd9380a4df8cd5ac1f6ae1f0d3dfb3531addf3904f39e4210c0ac24c3000b41c96d6341580fb1c4fa991983fed42deff3ba5be510c9efa054885d06756bfbcbca912bf1b424a2814a57eac82644142390e1a86c04bdd6a432b202d72f41dfc9e7c113c442b3d55a4b70f6d476ebd4e3c46959a34ea882ec23a9f4db6a91dc09a284d94781220ed72d7c67366977708d508f3f24b8521ee2735c73faf0d0ba19bde982d38155b21e895cd8e34c7fbe5c604be3a6a03fc6f01dc1a9a5f8752cb44f95d48c430d547069a7daa8f6f5a372a18183ef4bf64fe9469a55a3ca4458f6ac785e5a96eb864aea82f45f49dd3e360f73eff59f2e18d75b89e1f8fec155181bf0c652adbb7e39b7f7bf9938aa4716aedef9db27c432928606723bc9fb2ed7e47ce18a85265da0e9500fcab78034990e683898a3cfc9dcc40466c63e446d7269410ad2611912dc94b287ee92f36589c08195372d103d396fc7778a5cde408e935eb39ca0a1b764d5353cf9f71b16ff4608caab5a111eea31e4522a18ac048b10a99b0ece7add107757974cc2b15ec6395d74ff225520316e1f068a420ee5e5de3052dee2e377b2c0e6b2c005acf3396b9a73a877ee00b66be4fb154e9990899b6c3548546d14cd697e078b7a5d4efac995d7ae420da66fd3c053abdacea83ad31a71f038899bedd299b4101e96a8bf20fca49b0252a8ee5c5981048a7116fc79ed965eec70c8933451303ddd489a44f4bb50146a46381e59d45001da3c81a876fc4f961453f7016f5eaf2fe677fb36f795b85b6f1929d557e7a9f76ca208d332fa6960089906c2481e2031958192150fbec498d87698d42c9464e0700092c6b604ac4329dc8f2f1776fab2e5ffe515bca58391e071d5708c6547dcf009b02149e595730199f24d8fd4c4af254f98e7ebd305d6f9a1738185610367d55e93bb8a068e085231d4c69a3b35218c863413a3a3688f31036461e6ce9d031eff89665680768f659e87bcf541a71f67c3e9cea474ea7d7f459fa770fee74bb6de401b6e3a6950d1aa8a792360cafa9b083b6ef8ce90bf8c021ddcedb2407f58555dc41b7b2583c8f2987c940a6287a35452a0dad8b8936ed699b7e5b322766126a10649ccfc5b3b9f2aa5e914c01efe0a40115f2fa7d317dd581786cf780155274e1f272253e7a6a2531878f4a9800e9113e77a6a4cd8bb624850098d9663d19422968699fabc2412b821ab7ed039d3ba60ebe639608ce73cacafe836015ac6a9886493d67bde91ca989192ef76719b2d8af616cc39f51f252bcb274dc2003e25828cc5ee0ddac8c2355da4e15bce7263b5c399fe0d0a2dec6dc24dd5a51d0374a854ec4bc51f9cd3226f794da93f3bf1ae168fbb8afc4c24982f92bd3bb81e0595b3ca3df6e814512035c44e9dc0896e63b05ef0b95bd90830a92c939dff66e5e014606eaf4c6873d3096906795d9cd0375a6506fafcf562c27183fb2c4ca1ea2734eff05388c649277ae7f2d2442e7f4d5a145427cc59e74ec3a12befdd0920c39cd17a0f73ed1caf0b4e910dfbbe558445bcc2527ff91958b1480a18c0b4fb1b426157ab0c9a03f6902d87847989593619c3323df88da64a3b9da7d7c849bf63a85b7340c31743306bcdbc2dd482e644f5f868ebaaa11093d0fa479deb20bf4d959af595310111591aba94eb76d2e0d127d1d3ac96439d2dd9020e3d0ebd31e7d3bfd92077a11795b9f43fc3baeb81d5df1d9d2d618dac7a26d182f9fcbd27058eb273822fddd6930254c262096bf24bd0a5ced08d8c88e511af6f4f09bbae381afa6fe169ab150d07402946e1edb4b51279ab3006799e9b7fdea1a9a125dddb35c312d95a89f993a69c8982cabe6f86d8a81e1b0e2b58a9159aea64e471bef6e6dd69b4add1f519355791dd1e3a5966f760c93c3b922c09e49d3abd089b24a729fcf70d91bc31dca30c28d2078a28678e4159cc5bafb3c489071a6397501d20398e27f3f11aa0c32dc28b804d269d1729050ad116eb9ff30691cd326a7b1bfce593d946195c501eb6433b9cbc00217cc0fe15faa9efb542b59129e5fffa7c8695b15a76c0125d5351276f7942dc67fc32a4cf6a5b0f1516e808e328d9d247152f5e31a013946c9ab17d3d9f1a29b1e9f4512248d64d1256135c29d9805080157dd9351418334a3ab130fc0cbb0c66c59dd1a58a3c312381ec2292c8dca34b889f3dae403e1ab7c8003fd379bca911b8f47700ffa682a35e65f75bda8173567e38be490295ca5f61135f2d8a9e6b18196936448f00c2afd9320b7272e244c0ef93051ca23be2e0760e66f70724d94d7668a44f40ab783116b063022edde0cb92ffa54fe94a0389d1a1556d2724b6e06b44cb3bc62f87e0d1d540eed6b5c9515e3d7b59552ef3910bf86e7477046c09c6741fa3e14368c400eeb3395128d45559ffd781089ee2ca70917724edbac597a2b653a585a9da50e075acd7ce658eaf2c406dabcfa0e9b9dcb188d0764244c5aaa3ffe3c435b8d3bcf6043e563cb8940c089bd29d8189a2601e6b32e14422cbc9f8a11cb5ee44258c970211c903e5f4d23a83c261c9e1cfede55388ff24092db3c8d45f81311830294a2ca462154fe8d828607bf9731b5d98671ce925df32fa914cbbdfaffbfab6fbe23198c547cbbb3f8fd6bf10c36f4e8cbd88bee09da55d6748b6386a3946afd22c518223c812d57b4a86c8a6565f0efa5b6ab2547163ebe5aa439f9ab8d7cc1af84f8bf2ed77903da7c1caf8679d73d37bcad6bbd9167e46cb49dc8da407a9ce07d0282da0688f3f5b7f338605c69cb06381f16743127ec2a06ab2269434a3c50b4a669b61bde52c7b251382fdd807e9825f668ca259a29688e8419bd26b92219a4698605e30aff1cc0a81121826f03f1f5e8cb7bf80a2f766c363b29fd862e990dcd0c8abae008739b2711bebe187a41060bfe3b1d166a6a7cf4a3a68dbffb40c4ce0ddd2a437c7ab787a654b47c6aa34eb573d43e92a85aae9b1d86775770a4d8d57dc22d08ad72b900747a34e64486ca385a9f266d67aaeac8cb951214c4a935601d9bf68559e50081e8a93b8c7d4554d65cba08975cfa0b412054b19f910658f0018e9386506eab7a92bf3959485791e3eabf10cbb850981fded62e45c04a87bea97f9ee51d3b70f7edea9d7ceeee2f639fc798c017c9fe888f470922e5541fb6d9d8b31e6f3e5e3860be41c5bfea0cf2bb9e11d1b9c9fde65aa19280dd0c1251e2ac00f3a14a7a1dcc160df1a58c55a5efdfd4c0dddb468c0e5b31cd6ee40e4e6132c7ad03546e3c6efe6d4c1acfd436288621ded284bc2efb45be843e3ee2a4c554203b26ef5c6cddb6a388608ae1ea07c962c505b05ec1481b09b5847307d4fababe70c41f32cf76615d84e15ab3593d60f4e1c36db9668793bcaf005408c82b6e4b16cc0ab7b239294eb8b72bf51ddcaff2da4a70f27dcae9a5fefc48651964ef544f1922b59006db1a6170743994cb165df712e5e9206d8bf8c148a235b284a693098602701d2568ba313e3bb50c5ec4af1b1898f7a87dbbd9bb5e47d0a0b6c9372ceb439ed7b86cb11a54b32d7101b1269964cb67adbb7883991ce23eed8980f6942b4a34cd844bf36ce751df4ba4a7689f4288c87d31f9b46e79afe44f87a9083eaad66d5e02c1bccd42cc2222e1d75249c37b03673bee721e6d483f8bd2421f359fc876d07f4571535d5015e6530a5779876e4dac9a7df727a28039f8717e038906650e735627f2dfe1c429462671d6e67e44c72a0c6cf8f4095477c24dd096c0be2fec4ca064d2fcbcc2d3861be014c67e0ba2e7a3082ca5fbb296b1cc208fff30a6ef4fdffb06aa80e1fd55ed970350f96f396f38bebbe571fef9bd0f892343d735b8cedc0d19922e593669b9ff4e5f08e84bea7ae4757b58f15084298b95ac8aeeb033c579fef0adfd0b3b305adae0a889f95d28b757dda05ce10a009e648c0247350db082b0df19a72a2a04c4693807c4e0665477a962a56b6fe46629e33fb64fef0ab5bcb88091189ced2dcb86361add5f239de54f233944f1462a9d88f1eb99bab6ba7dae789e4105361e45e2f9e9aaccf0ceb6b94d8c66eb4fc6fb772cec344ed49df2e8d50f053b8f5c83be1f657394699df8e76b84dcac81e9f57974e9ec4a1c9517e635035145cbd54cb48d4dea6cd9b1d04bcbdf969b07180d1acdd972160dd9e11c93e64439d0aa1e3e5d1239dde5822ffd8ec1d3afed263d1686d10d81b37faaa6cdf99d8ca90f110712f2fbe3a1249c16eb74330b8c973ef02b2fe03d7b93a02c683a5b32f1c7fa6d26a03d9eadae18f31b21f951db88a0b35d3fea414dfdce515bb33e58ee68cf4fb01c0aadd2eb1fe3d8b12a55ce3ac33a36e5abfaed6050b6395268573407053e2d3aa173fd706139b9b98a11c12a3c3757613f831a65da5fa2438dc9dde85283d38bc824e60c5b51fee6c2dd712bc305bb31b194a5583c614bcaf6ec71e2e0ced325533e9b6bd0f4756c418461d472e4b3f2a03082bbb58c82327fb2413a4adb6089c90ff17344e69b0a29d9854675a8be3e6f57ce517c169a3713274d465234412b849379f69d175d5ae0570683e0c3eb0d828be62803f3c89a599611580064dbeb8963ecc71dd1bc2ce52c1cb88f1c62a1597cf2bc6bce061133a73b243521fb107afea4f76dacf56899fa7ac76d8c7f30a49799bbc373822d52378e1a5b42b38ba472fef2b736eea2f3a472bbf27b67a918a582a6363fc504b5ce20df9a0683169a04829340ae6bcf96a21de0327cffb16b0d52491ee08fc36a0c2cbdf0613eda6eee59b9b9625a3ef064b62e283395464bfb2cd5be09fab9ca6069832b10246a9b7e525068d638d57fdf2fa4ca996678d2ce4a9e508b9d733467ab7a2e864a2c50d39a4298a74035aee33d4167afaf97d501c41a1d26a737923af34c96eb2747d8bf2a0d7220218c92af2bff5352066546f72788bbf78068cce7d666d9b1e4dd35682c008a91218eaf4052cfdb90b510b96307465cd58a8a994965b6cc6eb513a50f9bd4c5fac0d78acce9ef1b7478d97ca0e6424f7ad06a12728f2cae8b2946f30d1c3bb3a4566793e84affbbb75a424625039c6d7d7f2476c4e6be4a4afe4254f28aee75e64d00928cd08ef2877352d69849ba536c1ed47f86fd125dd6117866058800e5180a6227ee7a446c02e1cd4e8e68a14e95422726571503db412cced37b3c4bc4512c0fcfa6c8a4d859127ee815fcaa87aba1a563255b14f16a888f1fab1b2b12a5e9c9b6825a86ade94110696b3490a9f0d2b411666b9ea602d4d410b9b713138ce4d39252a7d003a13743e9416fb7580e5f55ef2a47e8c6348f51db0f2d041817508e9b13561bc3a0467dd61651c3b5a4471aadf8e0e589837a40fff5895059ddac0608f5a6a046a5af12689ee5bf235c555f00d2ccbcdee708b7edb9042572797237a9925dde4682c47a6d221c0f8d029ace2637bbff4524a6cc69d585081ab63dd64422ab19f4ea96af075da4839a3f6d310d106a11d77721be8dc8403b11f1f30d7689f3b6de2ab112ab07b6a7a3d9109eb79e4be94fd2728fbd7fe14bef330ce1c09a6092381426a7737656aba2cfb29aad98c4195e7c8897362d474218da251f39ed7699848475cf8dbebc523f36303cf25826b31a8740d78d170b70d21aa1d23dafbaa5752669386d7d9f7d96b1a2a8b2178b43c983276906fa03195b3a967922bde1ba9c798079639b3320c4c4201ca5df6b0e3f66ebddd947a63e3f758be6e8b717a74e9fed521d819b5c04a0f9a8ebc191f98a5194b2df58a100248f286e2be7e6d3e75c5c61eaef8b81ce8dcac58a9217df11d1a52522a42736b697c7dbd00715afcd8c890ba565b53ef786a521a5e128bb14e729f5f5178edfd6e56b691f3cf775a2945319591daaa5cb09654c6b7ad985a387ed6620f04eb0cbbb4599178b4b868dd71a19455dc880f12ecae18c7ed324a247258f6de1089e4582a161d15b11c7a501178531d898fac27ae9003589426e1aa9d0c9bfc11c8eec7d21f081d305a9642a122027152f0f350e330cd356071ccb77a157df34667e4a3456a97e7a66eaac6b62926dfd06efe65fff60a52ac7fce7ac269ad547de117d668cbdda9df85705eccb51d234d1f5a60a93950f178383f75416ed13d678144b12785b1fe260dee95de092f1ff8c58a0e3319a1633b8fd5c4f0aec39154b9d1b495a67465c20f8c38da6c3a8410d325b6459bac91091154d43635e20f0a08ca428bcc9552f59d26c4c9fa806d012373e3ec97be67c4dbc8abf4392a17ec8f2b990d1574fb524a60db2421f3c7bdc878b921a381eb19adc3edca3e87bd33a24694cf6da600b87e94ece58c77a113ec96d16786cd9dd4b4b3b6c200a1aebecfdcb9199a140b4fd9a02cc27cfaebe14ae7fd755edb82330851cc69695e3488801ffe21785af05b755a89c67f05ab95b170988ba636f91bccd5e269b8df1f6b825b5ca88dc53a142b37d53f9e642d080cadcb06a7273d0350560d60441dcda9711b1c4d3be0d149c2c067f73aac691ba07e5d52d68e97912dc2d915f97a01085bbd180233960d31821da2c76b1ce02e8f7ffac17bb9294d2a833657d346b7e59fc22167c7b4839c4100e0924ab24ec924f8629784a7af68058611c95e8211b2286d5e9a98351077d092e1832b9b31160aefbf3f12db5a500d68ccdd8b47bd0bea48a7cd2b7c9197c8da34558e329fa0bfd1f137106eb6ce8c9c542e5b3339f5f59ef897e91de5130fec1bb462767fc9e4ddc3745a56821cee3770054b55177c5236fc860c85aaee50872f42dec71938c005c13114a7c862a6c1589e4d17fca5c3dcdce6a8f0e40921080b051a1cd20f54e9b3672a1f24c3e03cb9fa5d782c94fc919598f9359a473553febba58c9ab15ed5a1b7d127f783f24df17af1e2be37b018d15ef901eebc9ee5a31a937e379f00641d49cf00175a9cce8afae47c6cb2ef2a164847e8937b381b5ce6f9edbc1508cd912cb8eca534cdad8b9b9f1b59a8db909132f02cdbe095e093664970b9162751d4919a7443c7ed057149068aa1ebc855d9d175249ca8fffdaa066f54ce4c4d58ccf61b18febb6eb06e1f270197143eb9ac8fbaad8209bf891aca599264bc2903496a56213f5397603e2de24ab68e89ef4aa5f50a188213a0b6eaddcb4c240c59e546d477c05cc2e3d7613a97a2c7d852e03fe2ca76519fa4dbfd30630d4db1343ed0fd0eab991148c9d72570ebc2f066d84821011d592f270f6fba35ad7e45724169d41272e85e11ae3e5b2b6aa1ad5fcfa5fe2f8577c9e28e282f9a4d2891f53c5ee8a631275fdd7c3edba8bb9cad6466164e005bd44f774c6d60aeb06c2940caabf9c1248654edba6b9da1c19ff0649ea1feffc5a18c340f64f8ce14fab9eb50ba4af7a96b39ca58bd854d84248a21e19cc1430903614915fa0cb970391cad191727ee4aee7817976524d830f3429fcc85bece62f7b2253a4f76bd719a8534f473155514f2f15cfb075e38db6bf17437d5580ae9e37d857605589d9394c0a6b48bbb802fafec31455cd6f3123d7522e562f9f0aa2fa119c7fea44d43249e824d935d4ae086817403098e821955f4b96879a5639b0a767e3e738eedab43ebf79732b0cf2327fcaacb4642d03f456d9489bab89038f3fd569cbf55258a9e9c3017666b38ef3b6b8b7f02c2885314c83050bca17a88af1ea98712c93399fcc029a239af62fdbcc8ba3402ba8c8ec347fd5be2a224bc36910cc8a6f6387d4ab2ee9353fca0e705589df034cedfad97f6c1bfaf1127ed24f9c33294d44685ee5c4a5c2fbba394b2c796bc264b2d4192bd53d978ca7354f85c7da012500543e4fb532f8d7caa48ea2e0a6e8a78d6ff61ace0822a0ec0b217471bb6d4c359f4eb47c59c5cf534213b5f49f424fe6e880a60becf47c1427ebc6bde4e2ccb04000fd86f233e9cc94517fd43eaf59f4fdf01fc74561c600544d7fdc2dcc21e4cd35173aca82a51e9a313cddb250c092deb1424de61b469057765e54c1ef5ed01ced1c45154d95db050e32069861dbe6985965e7d615b01c1bdc65919eb5c646ce39381f52c1a5c7af164f30ce9f1fada946cea1edc160d83de806a1b6acfe5ebf54454a457a5eb6b3a8574ec0b01a907f96f851591469f170cda2c6f7fccaf7007ea3ce47a4c930f981ffbcf8e82d562f6c4217f435531f38a5720a77fbf520409cf6edf7d53e1ae9c639848afa80f414510b2a230aab261a4ba57cb2f5c5473e169ffc9e62d103c299f475c14bfa9ba3b9fba0508219a4619ebc33ec3168af8d38afe5fb23dbc9ec529a6bf6a62928349d63186c49770c974190b643bb2c538d63a662ac1b8bfc167b87109e433a9f82ae93341281665ef4ab14783def9e46b2612297fd8257e0f70de57d15bc6b273031ab26a08335d3835d392b90c4de49732c7acf926c1cfa69a05aac68f6b09980cb93b2a953f20f84e6a98692b62b2a0e211ae2ee8e289bd6776ca5c6464c13718472b4a43daffa4dbe50e17c4df1ad0416f245347df7f4df48d2d6bae61fbf3d5007735638a3f2216475e857e835074339bd19a9d5206cc28c0a57b1f0efb78db6f8636d281b8c64d6d30166e32356e6059c3efca657becc62f8b7ce81dafe843cb1aa058f9287f613bf9972fa91ea75433ee0b2a6573e0eb2ea42a07cc7d55371469004444b9b2dd7ed04575fdaafca89c97d9dbd9a84e048c9d6bd6a7083bb2d4456ad5e36f4dd2c88c615b68b4ffac0a3aba505a4905d738b412b39d8328bce9ea60a25316b4554ede78a0be13b83653b6cd39ff3f2cc7ffa70d875db19175677fbf78842877d35d535228298f0f54aff903accd23d9bfe9cb2f00d022917778258af2dbb3364b8cb468e4ac84fb69fcb88dd97ab72911706801764b1b0c221021238d0ed9d362693c9f2f42f5e64dd3fee83ae77c494cc588ed22bc702416df7a9d99a35bd7c93c3b21d2bf2417f173925b74341c6c325a50ef5eb5cf0302076a897db8155abe5a847633da4e1220303f16b4acab7400ce68fe541d795454607eca13e46a4c2c18e8d63198b381ce123c30bb7fa5f948f04979fbfb4b2972f77f5ca982a3569141eafea17d35804211da9467bc1da9f0a98148f3f78dddb567865393fbf540c82a8ee72c58ee26b8d58915ea1c5c620ccd727b3ae7b2af2cd08cac45d4d0447da2a4b53798248e2f099d2cc10158f01c43bd2be50f68851d5d889cd998c21f62b0b5cb757a09957f41340a636d94e874be621c824e63937ee3d07c4b9f048b072082f409bf2a6c4f03ac75d12f744652721e1624d13adf1ca8f64f41705ad18f57e9509bea4b45e3807a5ce710391606b8bfaaba39d845aebd6716375cca93ee18342cd582c08225af5d8b1a9be43ca35c239693f8e45bcf99a1a713fd83d8cba1e4a071e2124d64e75e582ba570aa2c0b6d1572890569a6baa2bc9adf3a46852f24c505f1f9cab979b92564d1fc2925f90dff4f182d73263d441aedd2fdfbb3f9328413454c55ea2a27172857eedc86faf83f62717f11dc4867e8ca992cf4a4b358894537ffcc62bb0118ca71aaba3b20410c4fbce2b2bfa726c68f1f778e0b605e7b327c67247f60991ef23842c8d22ebe74734389aa3484c10ec7f0ce40c8ab4e6e5ae575196c1904a2dfd088beaf657d014e09e4d802ab4e5bae92f0436bb9bfdad516c9aec6d0906d336c70413b7c52ff7b4b73996df2406acc974961ca143b41ae7b65a6cdd2292e0f8ee5f3951125bf94d96206917f8ee71b848dea759a409ac8a406f48465d0071be2fcbd6fdedb34feb621d4041dface30cc14472deaec656865177814592967c065f2ce61ced86d0320bc87fa9bfa8fdb3127cc0f8e32dbf498524c2a65a6289415e5fa255e05c99b4ddce3d8178bbf1ee9f2705213bfca799d67f638d4788954a7fe67ff99716a8a5d49841dcf6a0be02691f3d04cfc0ff7f133decbc244cb9fcf0d7d6c004a3165e96154271c12e5e3ae64bfa387f2cf5a2c995a3cc630331ec9ef0f4355b90b02fb510b31978f3efb2bb1f2b89e15ecf811b7f71778436e1590249b19f7b92fa90b5f9a2c0295008f8efad192dcfa766ba344580519ed6eb29c84415642be2805f33c72b40b03c4422138bf8c39e53b125bad11665e2c7f1f61c7763f23ea8c418f9dd010f1db13bcdc77447ab0c3fba7daa6ed29579a51d146ba8fc4fdc1fa7dadf99654c332103ae9244b239afa8dba902602fecbc194d11af114892fca156ede0d5f20d1892c121fd240ba7932624d57332e00788137ccfc276e945dcbb3430fd60548714c4149a9ea0fde9f58d2a13ae47f22cd2e4ce87ce5251af1bd57862127d63c9cd60d122f17b9bf6134591a2a66ac60fcb9a45a066f99e40777adb39099ebf3cf0b91cc147037b881efb8c1b85bc7e3e9deea673d166d752bd1f2016d9028d2a1d86f4da1b87c60deca857583de0badf1bd8f0eb3218258cd5a204c722867be6f26ac0afb2d6fb93a776e62155b77d1be4ac856045fa8678e44b2012572eb239e1a13beff3291df09546ee899ef046b6ff1beb3f192940f2f52b9be4cbc434276aa3e96187e074c8266e087e9a7801052d767c951fc121ce27f3d6dc3c8e2f4183dd31509bd5275d1d91ba1e030b333d1b98206f0c528a3aba2b717a81235288590ce639c484006603d8834f61c180217abf96aaa6a63f65110195996c8f102a838776471dceac3820a2e203587d08d89ef3fa421ac3271cf8b53810e10528e2ae1c52a9700eccd9ff00f839a54a25b63b82f5a8956dffa45320f727b2b42f9410279a615b64ea72c0ee3992bdad69305e8db54e250ec8c73354a23339d31e0753d1cfb3c601a53696b5239c0f5c558f4cd7eecfb7c684679da82b85c38ca527f02958a145b61ad2cd68fb8a227150d3f02d6dcc4c3d7f3a6614f76f9134daccb90f8e646918aa6eec6b22ab0020f51ed4138d9727b472cd207ac462e8412403612034593c32947308896d16e019970f682f6860bd462df4d5948fe6758e5782a2bdf10602802c7f71f5b82923d21150d78b59d8a41fdea69a9c9a8f12699779014deabb8a0d7e6811ccb0ac547c7d97783462df135b6745863ed8c980cd3fa975d48acf923102898011b3fa3392ac802478e758d7ddadd1482695f8e2491c7310bdcae4bf49de829d890dc40075d8c0689ce8179bad804a4f83cde48f8a1fdc24396ac42985d243fae636baa788d34015306546120579e2d63dc325fa3318d1427ec5b36fe1d93141a12f38c169a6383b1bf07dd813d1c2f632b948b8c1a45844c733e643f80052d41df106fbe3d4ae8401d22013d76237b068568252060126f84ed17ed18ae444a6931be3c5d6d8a9102a2eb994856fa7d653e48fc0cbb2d6dffe76a70c11b38c36efc515ba8b6ada6afa85e74a02180f9df6fe13384df355cb73cff382d2d08edbd8a228dfc304ae07dc46690ff5d4a6500a5ebffbcf5868ed6f1cef14c163efa7b983b385d54e3c88b4d00f7d27667404ae1fce1f14fd94251e9f36071024057be6254f15cbf1a9d5e41264fbaa0eb4802a5a7db7feca1397d7ec3dcbd0909666da6a6bc7f27df24ec6829a72fd898355171632a883f4588a6a109e84ec58d4f0c39802f13433bbd6ee64944593e5a9a54fd6619665bede537886a4aaec8e385de8c3fb75bd642670b4a0eb254583ae826014c17f5399a10e1c1f393c55731b9ca70a5528906b457ff7ac2240ad4c46da54fe648f849b883b740025cf0612b751fad93c3f922e32c9788a69423a24b130166738471504083a8d1f52f36b54a28d725ceacf6366e4d35a50824124c7cadcd7369c49713d23102830365b068a077b049c99a5dc9033edb0a2e7b353a35fc3cc430856ef01d69f3c31d294281ec5f6aa86c0959aa62ef533f019d4b885484ae8051d1311915772fd895dbc14344e360897c495e2e85e08f77059520100652775d69d50facfc3f18a4b3eac615489d2bc546bec60ebf1db4dd9a9284a8d20e2bd2be5289e3e267b244376ddbb84d7e74481d809f7dfb8f272cfde49ef4b11585736de08089ee3a47e793abab4dae4b29798ece4054699e05fcbb820735dab39e3c2a56291b2c729ed192e20bdba9e8c01d84a143b5537e15634bf4cabbd1694edc37103d152c856351f01517b37aaf00a04184c316e65a50630fda3d3696fac417cebb4e9ef8e1912dc73ea2dc2196b835f8a17141b63507dd13df195dcfecae25aee372674b6c1f2637e6c1911ebbee2eba857c5625d071eecfc8103a1b0bab17b6c911bfbff4526fa01e4a2384be5f295b44840ff10cca52cf3d26778569d84a7e97b73c128545c0302ff147a90e918ee56f645bb43454430fa1fafe703bdee5a6748cf084530d252500cbea333ec64b5e8142a39b59a96bf15ec81a65584ee6a0c2adb4c712fc689c6481400732c4816e501d0017d5b429a3fdf20d38c98fbbee90a466eec3f89954b46cf83969c1c2323d523ed68e331178e336737cd32854c25ffea05237b38e79ceef87575a08e5f36a561932d24e35bf1dd142d40081af7096cf159f7f1c5de1a89682879a272759e45c4bdda71a2a5b4c935f1138f648d0e11312df2bb9e7ffb596f2b463b6eec74e942b43c05147ee001a13a6198cc8100343442f47ccc4890d46133cab8f52157c9be325679f239d5ff206a81968289a474d583a2a89b77de16ce7ecaa850a5baae8593d6deb276de207a679701d3cf1cac0a297170485e412e89fe1a74d70a384ab0c940970cc0e73d3c34a8843c95cdfe6f1637f62a0555257c8dfc1a60e27c6c78f565768ffdbaee6bff67900c7edf533fa730991595de5c995d8038fc5095e85a79ab5d1866136f224ac4294e22b902bd34b74254676643e7392af05f690e422952024c10a0399aa13a079268e81a2f4d05957f3ae77275923785e2fb9f009526511c7af5a55bac7c32b4d76e72c314d177c0a65a7db1c3349f784bbbc2508238e3642e26c5da209ceb3d447cbea0c5176c53130807ae5691a4e4e9790f1346c9c9f8448bf6ab446e0b94b9377d979f794e447dda09ce4445d95507ff509766e2c807be2813a800c704b89c9b3f4638be0794472320d8ff807a30f11a7e61c24825398ff6ca2c9c25f46629f7737c030f7ac293d7ca72b1c4a1bde2efb5df820d7ef200b417d48ff17d51d50a36485a5f450ff5f191ca0c4143e8a0862a3c6de6732b86729a678f86d19812dfc0d0da3c9d1128733871d12fc6c7f48ad961826428578749b07ab172a6934ac02cd94686570f2135291a6a22a442ed1d1e724f514ad80283fd403645bc07484c878474f5403248cb12edcfbf3addf4e6c58e45fd0790c28eceed71c3d130dba069127bea70fd9c0e18090bbdec5300051f3af6489e8dba4a5b5cf34441dd577d0b8726ce8f83f6e01c69fcbb4a5b4007244cacf99f02f12576ecb582d621a1177cae4bc02e9f3ec8800cf58930c078426c53eca49d4e98d8fd52f61783f3c86419d54a254181e50d98cdb76b3370d49f9bf35df8d49bc50b83560121e540fcd9701d5896d308af23105f07987be776ecd2be9ce9140d677f48dfb9c59483be8ee88e225bdc4e0611b6c17993b0e62f94c93a61dfa34d88c02bc4066984b05ba4cbb96c742ee1099eb415301e6dc287495c2d6e7949801214e6571093df071ca691d09e391cad9ffae4535155cc65e54b5bbc577a152e742e70f67b6cc553c12827216681a832f4fff4122eedb54822c527b732737696e6cd71f4e8919382bfee7fbbafc41bdd23b77cf512661bd8a15cb1d10407ae105885e347d0b598d159c34020d028198a69ff91f26d61fa1ddd53ab20718a0884baab3ac23feba191edcb53443aa813c7f665757e1d8382b0d501acab37130b7abe7eb05d95b6566007fc0c8e0d6074adef1960c9b72da7dd1ca2a8de4448d725e2b388fde46421625adf623c706c9a933504dc7c95f720e43ed26b017d42a3b5be025a8817ba662a41730d788ea7bbf1d057281028642bb25c22aae8493eb20c3e77113b99f574b830229cc63c40ca33ba9ddd9bc5e5d03b434364f031be7635a93098e00daca70c87b3c0fffa5033571644daae130f124f4ed50edd8d60d8d15b42f2e4c357aef8614afc62c2ced207a7658279abf69558245f6b584f7535aa74d01fb4dcc0918c02f7234bb0026cb59083926776b2aa9aa7cdd8dfce2dd00f3cc36201889c3db497829260954207bcd94af4d21ae4577bb437d12214c1f3a87f9917a81b088117888ae24a16cf71ed6cba5a921949cc1e322e7c154c083915f2e9d8a4cd9062d29d94c85d5516af3cd468a4f814a7a373256bd842d8f2f154c66d4ef1b007823c1560bf1c630080efd17f2a3bd068fbd8b171a0a52c8cdb9d81698272cec37538f33b1153b60f890fb9a1a20cec056fc345409b67b77465720d48b1e378055da5b1762fd69d9c32a44f90ad5897e18d25dba9f36f97dcee0e71d16f253095b327b72493d97ed04526495bad71bfde4dcae65bea4f63dcfb468189c50d8dc650d464edb27a08c3baaa9d1e807289463bafa0b663b679e2869be02fe1fd24356dd51b05b71ae3eb134795cfc83799a644bf6f27050f703d9807fe98aa3a1abe9542a749a04034b22afb6cb934bfeb04ce2459250ecd30465a1f10014c2610e1bf50cc70c7751022ddd0ca71e800509689ad79e7915ece20d309c3c8dd6af2e01f1e7e2cf8ea39fa185bfda7187cd7d7b869348f76a01a06a6986e8a8fb605a82643f1a4f410cad33173c79a133c34410605dceb5098d9bc0a3ab49a24e3857b034a18852b3907e9a72317e724e21cd8360a368e13c1e38ef44b2585e597fb620340d67caabdc1ac5dbe4b494c1540b3fc11408c0cfa3efcbd148002c0c275d50d9ad54b22106415ced6141c6ac85a36df64b52960dec63eb4bddda194f16adca01fd3c4fc72de548236de274a5db0b57da5e033ba7725ff82d9b6bcf9bea25d1dadb5cc85ce2593ae046dc0d30e5ab85b5264e5e702235ff0abbe3d66d363670eb27fb60af38518215a4b3fa704c287d59929555cb6d7d8e56afdd12a2b495fc02e6ce395490d53aad85a6f874c15357141ccb5e668f35062a547ab5b226a729abe39e20ae2c987126994cfd9b69682645b1d8a4e06b4bdc0a66a7f85cc33795fbce13d851d18da9e02935de53d2dec26f78125d1eb8115df6be373d448cc7a4fb8c6614c104e3dbc0761bd6515f9f50f96677888914d476a243b949bd17488b2cd15d809b322beb61f3a5c159ec2e5cbe8cefeceedfdc85e2b627a1d7e8ec9635d975a6937f656346bdb7fce0cde63109665dc3353ccba5a5bcee48c301d274ed21a4314dc74c83170b6b6b8821a247a5be2e73a86d722ce71705cb3b089e68b04a4fdba56dbfce411d2df314c57a8b1429f9ba04063fc40ee514bcffd965c2ea6ae55334e160f98ffe31a81460d10d3e18013b3812162b741d78787c9250d01307fbb04be4c9ba5f5ebaf711b18d7879f7a8d55d8c0c74c3005c4fdda9fb820f36dd0481332e4f7c8a25a9181f52c6d26fe29a40e874f0adf6af811994daf3c5b6b477a8847b73a2fb5e3b3d31a7c7d80cab852c57b7ceb38920a14a28efea0ecb658b760401718cd12a00b144bdf909e49c383d3410ae9e04343bcf6ec62105b26a96f2495b54eeed767b63765dfa079311616585d0a0d48f6e590cb5c56d6695e910ee50bea32120332bac4e44c5de692978e40295648ce078fe62584bc8b42b9aa7ea774614f71eaccc1341805c613fa9cea196ed16d2adeb616857ca96ce2622a5f3e8da49b8ae61176bb9183f536a2ef879b7093261b9aa8143b06294d2eecb211db9b5f9469641bdc5ce2546121bdce4bb1fd3e8fac37e46310886cecd4d0189ee6a5e2fd02ea8b9cd073406fb6793a20e825ec44d7105a978e849864f969f63ae012f7771d39b397db3ec9eebb0ca48113d4ba706668716e6a2197896c2ecc518bb1823e9a15e90a35a9c71ef0dde51469c48038f006981d17e71f2211ab1fac18dbff73a8ff77174a7da1bd78a641887a64a736ec914d99a6c2475bbd42903f41b2ddd935641738a8db5edadb9cc61407a69eccbde6a00b28939d2549c2bfba8db55a103128129b72fd722fbfc4ca9ce0406dc62e110fde6cae35c325bce4ddd7674cbd9b3aab7c2c541916f0cdabf280b45556d8c3ee834c03617c51090cad73149e1700c19d9ecceb752c11b83c1f2761a986bde06ef9fc4acbed6955a3dba9836557f8d3c5bc97076ad697d8618f29fe27b645f7b7482cc123e01ce7a90bfc303fe971e2b6bc144adbbabc643a76bd06c680e2cbc7b47c8887f738b4b469de24126fdc53cc912c6fc259f8c14a26f240c8fbcb991be725770970dba280eefd97b7e6f058a3332f7d47781af8c1095044c46f370c5fd65bd78e6ec575e1196bbb01db8c73b9d82f5c45090d44d2769b962cea8c6e8d1f0244183e359a42b54efbbc0930a0a2f9442099354c37bdd391d61863c913591295082cffdb68e060bf409994a501adb0d87e1230d55414f738bf927d6664fcc1d7711bceef46ef8e7bd001921d6516f736d6a9e4b4e3955764d6da1c0912643a235f54a73d5f42c808e561d9f43ca6339a2f709d14fcb486ea67b017ae0cd1d20e01f3d492d8fd14420e927f6dca2824fbbfe65c484c66b6422024e4d13a8067628a5428680739d1e6907f641df7b6fa9f9f00a442101dd343ab9e543eb20ca39ffa1d9045936e13ef917e52fff6ea89d140f93cd305853e9d72e208afbed718a35533e9a5b52e0ee8d96fc8629874f76c19a84ffd338c6094d46acbae2286dbf9c1cf96eef8c0f5d18307c9a50a221206f6c0276d8e798c79d266b4fd69e1b361d3ad5213a177de5c0ab023a05ccb62f30f5f36bc003cab41cea4db6d0120448eca6c9446d5c454b117475f1ecfbd95f25473be1698071aefa3762435299f897d1229823e01944442a0f1bc6749b12064113c67f289cb0a97936cb5c4d390e143e184a4a7b395ad35e54678ffeb13b93f2f21cb3c10be0b755ef262da0f99fe581bf29af82a71b8a2e1a3088487edc85167f206b56af2706b35ce34a06b18c21a4c8fc4885ccbac339965d1663f029921d3ded3b95e765930e1d87dcdf1079387c82f92b568852d177b5774cae978ce3a9106626ad3a89d82d4be8a0ac8fcd4220812e5087182568a26ece808643c0a0969d1b518b420ef99a60e96296031d4eb6596dd6fdbd2623d7f7991d2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="Hey, password is required here.">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 杂项 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
